[I 2024-10-15 11:03:23,323] A new study created in memory with name: no-name-b235f8bd-c0c7-4a36-9f02-1e66674b7b8e
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/85
----------
parameter_search.py:42: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  lr = trial.suggest_loguniform('lr', 1e-6,1e-2)
parameter_search.py:44: FutureWarning: suggest_loguniform has been deprecated in v3.0.0. This feature will be removed in v6.0.0. See https://github.com/optuna/optuna/releases/tag/v3.0.0. Use suggest_float(..., log=True) instead.
  weight_decay = trial.suggest_loguniform('weight_decay', 1e-4,5e-1)
/isilon/datalake/cialab/scratch/cialab/Hao/miniconda3/envs/ear_video/lib/python3.8/site-packages/torchvision/models/_utils.py:208: UserWarning: The parameter 'pretrained' is deprecated since 0.13 and may be removed in the future, please use 'weights' instead.
  warnings.warn(
/isilon/datalake/cialab/scratch/cialab/Hao/miniconda3/envs/ear_video/lib/python3.8/site-packages/torchvision/models/_utils.py:223: UserWarning: Arguments other than a weight enum or `None` for 'weights' are deprecated since 0.13 and may be removed in the future. The current behavior is equivalent to passing `weights=ResNet34_Weights.IMAGENET1K_V1`. You can also use `weights=ResNet34_Weights.DEFAULT` to get the most up-to-date weights.
  warnings.warn(msg)
train Loss: 1.3969 Acc: 0.3422
val Loss: 1.3775 Acc: 0.4062
Epoch 2/85
----------
train Loss: 1.3748 Acc: 0.3623
val Loss: 1.3001 Acc: 0.4297
Epoch 3/85
----------
train Loss: 1.3401 Acc: 0.4073
val Loss: 1.2635 Acc: 0.4688
Epoch 4/85
----------
train Loss: 1.3113 Acc: 0.4240
val Loss: 1.2451 Acc: 0.4609
Epoch 5/85
----------
train Loss: 1.2857 Acc: 0.4374
val Loss: 1.2238 Acc: 0.4922
Epoch 6/85
----------
train Loss: 1.2620 Acc: 0.4775
val Loss: 1.2033 Acc: 0.5078
Epoch 7/85
----------
train Loss: 1.2327 Acc: 0.4975
val Loss: 1.1913 Acc: 0.5156
Epoch 8/85
----------
train Loss: 1.2089 Acc: 0.5125
val Loss: 1.1681 Acc: 0.5312
Epoch 9/85
----------
train Loss: 1.1972 Acc: 0.5309
val Loss: 1.1544 Acc: 0.5469
Epoch 10/85
----------
train Loss: 1.1645 Acc: 0.5492
val Loss: 1.1354 Acc: 0.5703
Epoch 11/85
----------
train Loss: 1.1438 Acc: 0.5609
val Loss: 1.1266 Acc: 0.5859
Epoch 12/85
----------
train Loss: 1.1259 Acc: 0.5776
val Loss: 1.1086 Acc: 0.5859
Epoch 13/85
----------
train Loss: 1.1061 Acc: 0.5776
val Loss: 1.0914 Acc: 0.5859
Epoch 14/85
----------
train Loss: 1.0787 Acc: 0.5927
val Loss: 1.0799 Acc: 0.5938
Epoch 15/85
----------
train Loss: 1.0635 Acc: 0.6010
val Loss: 1.0676 Acc: 0.5938
Epoch 16/85
----------
train Loss: 1.0440 Acc: 0.6327
val Loss: 1.0539 Acc: 0.5938
Epoch 17/85
----------
train Loss: 1.0202 Acc: 0.6177
val Loss: 1.0374 Acc: 0.5859
Epoch 18/85
----------
train Loss: 1.0058 Acc: 0.6411
val Loss: 1.0269 Acc: 0.5859
Epoch 19/85
----------
train Loss: 0.9812 Acc: 0.6678
val Loss: 1.0080 Acc: 0.6016
Epoch 20/85
----------
train Loss: 0.9591 Acc: 0.6861
val Loss: 1.0043 Acc: 0.6016
Epoch 21/85
----------
train Loss: 0.9555 Acc: 0.6761
val Loss: 0.9878 Acc: 0.6094
Epoch 22/85
----------
train Loss: 0.9314 Acc: 0.6912
val Loss: 0.9776 Acc: 0.6250
Epoch 23/85
----------
train Loss: 0.9153 Acc: 0.7195
val Loss: 0.9700 Acc: 0.6328
Epoch 24/85
----------
train Loss: 0.9009 Acc: 0.7346
val Loss: 0.9557 Acc: 0.6484
Epoch 25/85
----------
train Loss: 0.8789 Acc: 0.7429
val Loss: 0.9445 Acc: 0.6719
Epoch 26/85
----------
train Loss: 0.8662 Acc: 0.7429
val Loss: 0.9400 Acc: 0.6875
Epoch 27/85
----------
train Loss: 0.8580 Acc: 0.7713
val Loss: 0.9274 Acc: 0.6953
Epoch 28/85
----------
train Loss: 0.8338 Acc: 0.7713
val Loss: 0.9226 Acc: 0.6953
Epoch 29/85
----------
train Loss: 0.8314 Acc: 0.7830
val Loss: 0.9123 Acc: 0.7031
Epoch 30/85
----------
train Loss: 0.8205 Acc: 0.7746
val Loss: 0.9010 Acc: 0.7031
Epoch 31/85
----------
train Loss: 0.7961 Acc: 0.7947
val Loss: 0.8872 Acc: 0.7031
Epoch 32/85
----------
train Loss: 0.7857 Acc: 0.8114
val Loss: 0.8879 Acc: 0.7109
Epoch 33/85
----------
train Loss: 0.7687 Acc: 0.8164
val Loss: 0.8765 Acc: 0.7109
Epoch 34/85
----------
train Loss: 0.7536 Acc: 0.8264
val Loss: 0.8679 Acc: 0.7188
Epoch 35/85
----------
train Loss: 0.7512 Acc: 0.8230
val Loss: 0.8585 Acc: 0.7188
Epoch 36/85
----------
train Loss: 0.7268 Acc: 0.8347
val Loss: 0.8523 Acc: 0.7188
Epoch 37/85
----------
train Loss: 0.7221 Acc: 0.8381
val Loss: 0.8492 Acc: 0.7188
Epoch 38/85
----------
train Loss: 0.7163 Acc: 0.8297
val Loss: 0.8409 Acc: 0.7188
Epoch 39/85
----------
train Loss: 0.7075 Acc: 0.8331
val Loss: 0.8345 Acc: 0.7266
Epoch 40/85
----------
train Loss: 0.6895 Acc: 0.8564
val Loss: 0.8312 Acc: 0.7266
Epoch 41/85
----------
train Loss: 0.6817 Acc: 0.8514
val Loss: 0.8180 Acc: 0.7344
Epoch 42/85
----------
train Loss: 0.6707 Acc: 0.8631
val Loss: 0.8135 Acc: 0.7344
Epoch 43/85
----------
train Loss: 0.6696 Acc: 0.8564
val Loss: 0.8049 Acc: 0.7344
Epoch 44/85
----------
train Loss: 0.6565 Acc: 0.8548
val Loss: 0.8039 Acc: 0.7344
Epoch 45/85
----------
train Loss: 0.6410 Acc: 0.8631
val Loss: 0.8000 Acc: 0.7344
Epoch 46/85
----------
train Loss: 0.6303 Acc: 0.8748
val Loss: 0.7933 Acc: 0.7344
Epoch 47/85
----------
train Loss: 0.6213 Acc: 0.8698
val Loss: 0.7885 Acc: 0.7344
Epoch 48/85
----------
train Loss: 0.6139 Acc: 0.8748
val Loss: 0.7806 Acc: 0.7344
Epoch 49/85
----------
train Loss: 0.6041 Acc: 0.8765
val Loss: 0.7801 Acc: 0.7344
Epoch 50/85
----------
train Loss: 0.5953 Acc: 0.8898
val Loss: 0.7712 Acc: 0.7344
Epoch 51/85
----------
train Loss: 0.5929 Acc: 0.8715
val Loss: 0.7672 Acc: 0.7344
Epoch 52/85
----------
train Loss: 0.5808 Acc: 0.8831
val Loss: 0.7606 Acc: 0.7344
Epoch 53/85
----------
train Loss: 0.5617 Acc: 0.8965
val Loss: 0.7639 Acc: 0.7266
Epoch 54/85
----------
train Loss: 0.5719 Acc: 0.8898
val Loss: 0.7579 Acc: 0.7344
Epoch 55/85
----------
train Loss: 0.5572 Acc: 0.8898
val Loss: 0.7514 Acc: 0.7266
Epoch 56/85
----------
train Loss: 0.5420 Acc: 0.8915
val Loss: 0.7495 Acc: 0.7344
Epoch 57/85
----------
train Loss: 0.5473 Acc: 0.8948
val Loss: 0.7409 Acc: 0.7344
Epoch 58/85
----------
train Loss: 0.5342 Acc: 0.8982
val Loss: 0.7412 Acc: 0.7344
Epoch 59/85
----------
train Loss: 0.5174 Acc: 0.9149
val Loss: 0.7331 Acc: 0.7344
Epoch 60/85
----------
train Loss: 0.5305 Acc: 0.9032
val Loss: 0.7265 Acc: 0.7422
Epoch 61/85
----------
train Loss: 0.5123 Acc: 0.9115
val Loss: 0.7284 Acc: 0.7344
Epoch 62/85
----------
train Loss: 0.5062 Acc: 0.9215
val Loss: 0.7243 Acc: 0.7266
Epoch 63/85
----------
train Loss: 0.4970 Acc: 0.9132
val Loss: 0.7194 Acc: 0.7344
Epoch 64/85
----------
train Loss: 0.4858 Acc: 0.9132
val Loss: 0.7181 Acc: 0.7344
Epoch 65/85
----------
train Loss: 0.4895 Acc: 0.9149
val Loss: 0.7104 Acc: 0.7422
Epoch 66/85
----------
train Loss: 0.4841 Acc: 0.9265
val Loss: 0.7136 Acc: 0.7344
Epoch 67/85
----------
train Loss: 0.4664 Acc: 0.9215
val Loss: 0.7084 Acc: 0.7422
Epoch 68/85
----------
train Loss: 0.4589 Acc: 0.9232
val Loss: 0.7022 Acc: 0.7422
Epoch 69/85
----------
train Loss: 0.4630 Acc: 0.9249
val Loss: 0.7018 Acc: 0.7422
Epoch 70/85
----------
train Loss: 0.4522 Acc: 0.9199
val Loss: 0.7022 Acc: 0.7422
Epoch 71/85
----------
train Loss: 0.4592 Acc: 0.9132
val Loss: 0.7001 Acc: 0.7500
Epoch 72/85
----------
train Loss: 0.4283 Acc: 0.9349
val Loss: 0.6938 Acc: 0.7422
Epoch 73/85
----------
train Loss: 0.4360 Acc: 0.9382
val Loss: 0.6909 Acc: 0.7422
Epoch 74/85
----------
train Loss: 0.4318 Acc: 0.9432
val Loss: 0.6891 Acc: 0.7578
Epoch 75/85
----------
train Loss: 0.4252 Acc: 0.9366
val Loss: 0.6856 Acc: 0.7500
Epoch 76/85
----------
train Loss: 0.4144 Acc: 0.9349
val Loss: 0.6796 Acc: 0.7422
Epoch 77/85
----------
train Loss: 0.4140 Acc: 0.9366
val Loss: 0.6773 Acc: 0.7500
Epoch 78/85
----------
train Loss: 0.4052 Acc: 0.9366
val Loss: 0.6762 Acc: 0.7500
Epoch 79/85
----------
train Loss: 0.3948 Acc: 0.9466
val Loss: 0.6775 Acc: 0.7578
Epoch 80/85
----------
train Loss: 0.3904 Acc: 0.9499
val Loss: 0.6723 Acc: 0.7422
Epoch 81/85
----------
train Loss: 0.3928 Acc: 0.9516
val Loss: 0.6700 Acc: 0.7578
Epoch 82/85
----------
train Loss: 0.3843 Acc: 0.9533
val Loss: 0.6725 Acc: 0.7578
Epoch 83/85
----------
train Loss: 0.3772 Acc: 0.9599
val Loss: 0.6681 Acc: 0.7578
Epoch 84/85
----------
train Loss: 0.3776 Acc: 0.9549
val Loss: 0.6684 Acc: 0.7578
Epoch 85/85
----------
train Loss: 0.3657 Acc: 0.9516
[I 2024-10-15 11:09:46,932] Trial 0 finished with value: 0.7578125 and parameters: {'batch_size': 95, 'lr': 1.2038753705804408e-06, 'num_epochs': 85, 'weight_decay': 0.25546872760842304, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 0 with value: 0.7578125.
val Loss: 0.6662 Acc: 0.7578
Best val Acc: 0.757812
Model weights saved at ./model_weights/ResNet34_bs_95_lr_1.2038753705804408e-06_epoch_85_wd_0.25546872760842304_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/51
----------
train Loss: 1.2205 Acc: 0.5860
val Loss: 1.1563 Acc: 0.3906
Epoch 2/51
----------
train Loss: 0.8386 Acc: 0.7095
val Loss: 1.4034 Acc: 0.3828
Epoch 3/51
----------
train Loss: 0.8156 Acc: 0.7129
val Loss: 1.0564 Acc: 0.6875
Epoch 4/51
----------
train Loss: 0.9096 Acc: 0.6628
val Loss: 0.8748 Acc: 0.7578
Epoch 5/51
----------
train Loss: 0.8522 Acc: 0.6912
val Loss: 1.1082 Acc: 0.6328
Epoch 6/51
----------
train Loss: 0.8511 Acc: 0.7095
val Loss: 1.0921 Acc: 0.6641
Epoch 7/51
----------
train Loss: 0.8075 Acc: 0.7312
val Loss: 0.8845 Acc: 0.6719
Epoch 8/51
----------
train Loss: 0.7813 Acc: 0.7129
val Loss: 0.9831 Acc: 0.6484
Epoch 9/51
----------
train Loss: 0.8374 Acc: 0.7095
[I 2024-10-15 11:10:27,574] Trial 1 finished with value: 0.7578125 and parameters: {'batch_size': 63, 'lr': 0.0019147012167386693, 'num_epochs': 51, 'weight_decay': 0.01830891547849971, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 0 with value: 0.7578125.
val Loss: 1.2043 Acc: 0.6641
Early stopping at epoch 9 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.757812
Model weights saved at ./model_weights/ResNet34_bs_63_lr_0.0019147012167386693_epoch_51_wd_0.01830891547849971_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/83
----------
train Loss: 0.4987 Acc: 0.6077
val Loss: 48.6756 Acc: 0.6172
Epoch 2/83
----------
train Loss: 0.4415 Acc: 0.6277
val Loss: 0.4647 Acc: 0.6172
Epoch 3/83
----------
train Loss: 0.4423 Acc: 0.6277
val Loss: 0.4826 Acc: 0.6172
Epoch 4/83
----------
train Loss: 0.4577 Acc: 0.6327
val Loss: 0.4490 Acc: 0.6172
Epoch 5/83
----------
train Loss: 0.4443 Acc: 0.6277
val Loss: 0.4289 Acc: 0.6172
Epoch 6/83
----------
train Loss: 0.4314 Acc: 0.6377
val Loss: 0.4440 Acc: 0.6172
Epoch 7/83
----------
train Loss: 0.4273 Acc: 0.6528
val Loss: 0.4468 Acc: 0.6172
Epoch 8/83
----------
train Loss: 0.4319 Acc: 0.6344
val Loss: 0.4368 Acc: 0.6172
Epoch 9/83
----------
train Loss: 0.4276 Acc: 0.6477
val Loss: 0.4355 Acc: 0.6172
Epoch 10/83
----------
train Loss: 0.4310 Acc: 0.6411
val Loss: 0.4415 Acc: 0.6172
Epoch 11/83
----------
train Loss: 0.4227 Acc: 0.6561
val Loss: 0.4403 Acc: 0.6172
Epoch 12/83
----------
train Loss: 0.4302 Acc: 0.6411
val Loss: 0.4421 Acc: 0.6172
Epoch 13/83
----------
train Loss: 0.4300 Acc: 0.6461
val Loss: 0.4344 Acc: 0.6172
Epoch 14/83
----------
train Loss: 0.4179 Acc: 0.6578
val Loss: 0.4159 Acc: 0.6328
Epoch 15/83
----------
train Loss: 0.4174 Acc: 0.6578
val Loss: 0.4559 Acc: 0.6406
Epoch 16/83
----------
train Loss: 0.4194 Acc: 0.6544
val Loss: 0.5428 Acc: 0.6172
Epoch 17/83
----------
train Loss: 0.4266 Acc: 0.6494
val Loss: 0.4624 Acc: 0.6328
Epoch 18/83
----------
train Loss: 0.4149 Acc: 0.6511
val Loss: 0.6843 Acc: 0.6172
Epoch 19/83
----------
train Loss: 0.4170 Acc: 0.6477
val Loss: 0.4561 Acc: 0.6172
Epoch 20/83
----------
train Loss: 0.4180 Acc: 0.6528
val Loss: 0.4155 Acc: 0.6406
Epoch 21/83
----------
train Loss: 0.4082 Acc: 0.6611
val Loss: 0.4645 Acc: 0.6172
Epoch 22/83
----------
train Loss: 0.4211 Acc: 0.6544
val Loss: 0.4318 Acc: 0.6172
Epoch 23/83
----------
train Loss: 0.4219 Acc: 0.6361
val Loss: 0.4271 Acc: 0.6719
Epoch 24/83
----------
train Loss: 0.4145 Acc: 0.6528
val Loss: 0.4204 Acc: 0.6562
Epoch 25/83
----------
train Loss: 0.4145 Acc: 0.6578
val Loss: 0.4094 Acc: 0.6172
Epoch 26/83
----------
train Loss: 0.4080 Acc: 0.6528
val Loss: 0.4031 Acc: 0.6328
Epoch 27/83
----------
train Loss: 0.4065 Acc: 0.6544
val Loss: 0.4182 Acc: 0.6484
Epoch 28/83
----------
train Loss: 0.4057 Acc: 0.6811
val Loss: 0.4043 Acc: 0.6250
Epoch 29/83
----------
train Loss: 0.4173 Acc: 0.6377
val Loss: 0.4475 Acc: 0.6406
Epoch 30/83
----------
train Loss: 0.4159 Acc: 0.6594
val Loss: 0.4593 Acc: 0.6172
Epoch 31/83
----------
train Loss: 0.4146 Acc: 0.6594
val Loss: 0.4594 Acc: 0.6172
Epoch 32/83
----------
train Loss: 0.4162 Acc: 0.6561
val Loss: 0.4317 Acc: 0.6328
Epoch 33/83
----------
train Loss: 0.4170 Acc: 0.6394
val Loss: 0.4672 Acc: 0.5625
Epoch 34/83
----------
train Loss: 0.4088 Acc: 0.6544
val Loss: 0.4167 Acc: 0.6172
Epoch 35/83
----------
train Loss: 0.4156 Acc: 0.6427
val Loss: 0.4142 Acc: 0.6484
Epoch 36/83
----------
train Loss: 0.4014 Acc: 0.6578
val Loss: 0.8738 Acc: 0.1250
Epoch 37/83
----------
train Loss: 0.4020 Acc: 0.6728
val Loss: 0.4425 Acc: 0.6172
Epoch 38/83
----------
train Loss: 0.4069 Acc: 0.6644
val Loss: 0.4431 Acc: 0.6172
Epoch 39/83
----------
train Loss: 0.4149 Acc: 0.6561
val Loss: 0.5833 Acc: 0.1953
Epoch 40/83
----------
train Loss: 0.4170 Acc: 0.6494
val Loss: 0.4199 Acc: 0.6250
Epoch 41/83
----------
train Loss: 0.4143 Acc: 0.6444
val Loss: 0.4430 Acc: 0.6094
Epoch 42/83
----------
train Loss: 0.4068 Acc: 0.6644
val Loss: 0.4111 Acc: 0.6328
Epoch 43/83
----------
train Loss: 0.4113 Acc: 0.6611
val Loss: 0.4346 Acc: 0.6172
Epoch 44/83
----------
train Loss: 0.4053 Acc: 0.6661
val Loss: 0.4158 Acc: 0.6328
Epoch 45/83
----------
train Loss: 0.4144 Acc: 0.6528
val Loss: 0.5329 Acc: 0.5859
Epoch 46/83
----------
train Loss: 0.4079 Acc: 0.6561
val Loss: 0.4766 Acc: 0.6172
Epoch 47/83
----------
train Loss: 0.4029 Acc: 0.6561
val Loss: 0.4925 Acc: 0.5625
Epoch 48/83
----------
train Loss: 0.4100 Acc: 0.6594
val Loss: 0.4319 Acc: 0.6172
Epoch 49/83
----------
train Loss: 0.4105 Acc: 0.6511
val Loss: 0.6633 Acc: 0.0781
Epoch 50/83
----------
train Loss: 0.4180 Acc: 0.6411
val Loss: 0.4314 Acc: 0.6094
Epoch 51/83
----------
train Loss: 0.4164 Acc: 0.6427
val Loss: 0.4658 Acc: 0.6484
Epoch 52/83
----------
train Loss: 0.4129 Acc: 0.6461
val Loss: 0.4224 Acc: 0.6328
Epoch 53/83
----------
train Loss: 0.4096 Acc: 0.6678
val Loss: 0.4126 Acc: 0.6250
Epoch 54/83
----------
train Loss: 0.4052 Acc: 0.6494
val Loss: 0.5787 Acc: 0.1641
Epoch 55/83
----------
train Loss: 0.4089 Acc: 0.6494
val Loss: 0.5472 Acc: 0.4062
Epoch 56/83
----------
train Loss: 0.4048 Acc: 0.6628
val Loss: 0.4134 Acc: 0.6172
Epoch 57/83
----------
train Loss: 0.4027 Acc: 0.6694
val Loss: 0.4185 Acc: 0.6328
Epoch 58/83
----------
train Loss: 0.4065 Acc: 0.6661
val Loss: 0.4746 Acc: 0.6172
Epoch 59/83
----------
train Loss: 0.4099 Acc: 0.6628
val Loss: 0.4790 Acc: 0.6250
Epoch 60/83
----------
train Loss: 0.4033 Acc: 0.6494
val Loss: 0.4693 Acc: 0.6172
Epoch 61/83
----------
train Loss: 0.4062 Acc: 0.6728
val Loss: 0.5178 Acc: 0.5312
Epoch 62/83
----------
train Loss: 0.4006 Acc: 0.6678
val Loss: 0.5477 Acc: 0.2734
Epoch 63/83
----------
train Loss: 0.4058 Acc: 0.6561
val Loss: 0.4630 Acc: 0.6172
Epoch 64/83
----------
train Loss: 0.4065 Acc: 0.6594
val Loss: 0.4571 Acc: 0.6172
Epoch 65/83
----------
train Loss: 0.4028 Acc: 0.6628
val Loss: 0.4323 Acc: 0.6406
Epoch 66/83
----------
train Loss: 0.3970 Acc: 0.6644
val Loss: 0.4935 Acc: 0.5469
Epoch 67/83
----------
train Loss: 0.4102 Acc: 0.6528
val Loss: 0.7594 Acc: 0.0781
Epoch 68/83
----------
train Loss: 0.4087 Acc: 0.6477
val Loss: 0.4478 Acc: 0.6172
Epoch 69/83
----------
train Loss: 0.4006 Acc: 0.6461
val Loss: 0.4420 Acc: 0.6172
Epoch 70/83
----------
train Loss: 0.4056 Acc: 0.6528
val Loss: 0.4197 Acc: 0.6328
Epoch 71/83
----------
train Loss: 0.4093 Acc: 0.6427
val Loss: 0.6210 Acc: 0.1250
Epoch 72/83
----------
train Loss: 0.4049 Acc: 0.6528
val Loss: 0.6009 Acc: 0.0859
Epoch 73/83
----------
train Loss: 0.4101 Acc: 0.6477
val Loss: 0.3956 Acc: 0.6328
Epoch 74/83
----------
train Loss: 0.3991 Acc: 0.6628
val Loss: 0.4780 Acc: 0.6172
Epoch 75/83
----------
train Loss: 0.4108 Acc: 0.6611
val Loss: 0.4507 Acc: 0.6172
Epoch 76/83
----------
train Loss: 0.4069 Acc: 0.6394
val Loss: 0.4772 Acc: 0.4844
Epoch 77/83
----------
train Loss: 0.4090 Acc: 0.6411
val Loss: 0.4843 Acc: 0.6172
Epoch 78/83
----------
train Loss: 0.4049 Acc: 0.6394
val Loss: 0.4711 Acc: 0.6172
Epoch 79/83
----------
train Loss: 0.4137 Acc: 0.6444
val Loss: 0.4297 Acc: 0.6328
Epoch 80/83
----------
train Loss: 0.4008 Acc: 0.6411
val Loss: 0.7048 Acc: 0.0781
Epoch 81/83
----------
train Loss: 0.4006 Acc: 0.6528
val Loss: 0.4115 Acc: 0.6328
Epoch 82/83
----------
train Loss: 0.4055 Acc: 0.6411
val Loss: 0.4933 Acc: 0.6172
Epoch 83/83
----------
train Loss: 0.4044 Acc: 0.6477
[I 2024-10-15 11:16:34,351] Trial 2 finished with value: 0.6171875 and parameters: {'batch_size': 80, 'lr': 0.0019788913761353585, 'num_epochs': 83, 'weight_decay': 0.013822671317617156, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 0 with value: 0.7578125.
val Loss: 0.5359 Acc: 0.2969
Best val Acc: 0.617188
Model weights saved at ./model_weights/ResNet34_bs_80_lr_0.0019788913761353585_epoch_83_wd_0.013822671317617156_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/95
----------
train Loss: 5.0413 Acc: 0.2922
val Loss: 3.7186 Acc: 0.6250
Epoch 2/95
----------
train Loss: 3.3674 Acc: 0.6778
val Loss: 2.8512 Acc: 0.7266
Epoch 3/95
----------
train Loss: 2.5195 Acc: 0.7379
val Loss: 2.2729 Acc: 0.7578
Epoch 4/95
----------
train Loss: 2.1331 Acc: 0.7646
val Loss: 1.8833 Acc: 0.7734
Epoch 5/95
----------
train Loss: 1.9857 Acc: 0.7780
val Loss: 1.6518 Acc: 0.8047
Epoch 6/95
----------
train Loss: 1.7868 Acc: 0.8063
val Loss: 1.6204 Acc: 0.8047
Epoch 7/95
----------
train Loss: 1.8090 Acc: 0.7880
val Loss: 1.5323 Acc: 0.7812
Epoch 8/95
----------
train Loss: 1.7037 Acc: 0.8280
val Loss: 1.5569 Acc: 0.7969
Epoch 9/95
----------
train Loss: 1.6503 Acc: 0.8347
val Loss: 1.4117 Acc: 0.7969
Epoch 10/95
----------
train Loss: 1.5697 Acc: 0.8531
val Loss: 1.4480 Acc: 0.7969
Epoch 11/95
----------
train Loss: 1.4631 Acc: 0.8464
val Loss: 1.2499 Acc: 0.8047
Epoch 12/95
----------
train Loss: 1.5357 Acc: 0.8548
val Loss: 1.3480 Acc: 0.8047
Epoch 13/95
----------
train Loss: 1.3677 Acc: 0.8998
val Loss: 1.3071 Acc: 0.8047
Epoch 14/95
----------
train Loss: 1.3794 Acc: 0.9282
val Loss: 1.2015 Acc: 0.8047
Epoch 15/95
----------
train Loss: 1.3947 Acc: 0.8932
val Loss: 1.2357 Acc: 0.8281
Epoch 16/95
----------
train Loss: 1.4822 Acc: 0.9082
val Loss: 1.3867 Acc: 0.8047
Epoch 17/95
----------
train Loss: 1.3376 Acc: 0.9082
val Loss: 1.2238 Acc: 0.8047
Epoch 18/95
----------
train Loss: 1.5237 Acc: 0.8698
val Loss: 1.2649 Acc: 0.8125
Epoch 19/95
----------
train Loss: 1.3797 Acc: 0.8798
val Loss: 1.4070 Acc: 0.7969
Epoch 20/95
----------
train Loss: 1.2868 Acc: 0.8915
val Loss: 1.2718 Acc: 0.8281
Epoch 21/95
----------
train Loss: 1.2381 Acc: 0.9199
val Loss: 1.2575 Acc: 0.7969
Epoch 22/95
----------
train Loss: 1.2149 Acc: 0.9199
val Loss: 1.2006 Acc: 0.7891
Epoch 23/95
----------
train Loss: 1.3793 Acc: 0.8815
val Loss: 1.2737 Acc: 0.8047
Epoch 24/95
----------
train Loss: 1.1041 Acc: 0.9215
val Loss: 1.0728 Acc: 0.8047
Epoch 25/95
----------
train Loss: 1.4924 Acc: 0.8548
val Loss: 1.2589 Acc: 0.7812
Epoch 26/95
----------
train Loss: 1.4506 Acc: 0.8614
val Loss: 1.2447 Acc: 0.8203
Epoch 27/95
----------
train Loss: 1.3944 Acc: 0.9199
val Loss: 1.1996 Acc: 0.8125
Epoch 28/95
----------
train Loss: 1.2008 Acc: 0.9165
val Loss: 1.4136 Acc: 0.7969
Epoch 29/95
----------
train Loss: 1.1764 Acc: 0.8881
val Loss: 1.4285 Acc: 0.7891
Epoch 30/95
----------
train Loss: 1.1099 Acc: 0.9666
val Loss: 1.3065 Acc: 0.8438
Epoch 31/95
----------
train Loss: 1.4237 Acc: 0.9132
val Loss: 1.3276 Acc: 0.7969
Epoch 32/95
----------
train Loss: 1.3914 Acc: 0.9249
val Loss: 1.3116 Acc: 0.8047
Epoch 33/95
----------
train Loss: 1.2538 Acc: 0.9132
val Loss: 1.3110 Acc: 0.7969
Epoch 34/95
----------
train Loss: 1.3344 Acc: 0.8982
val Loss: 1.2285 Acc: 0.8047
Epoch 35/95
----------
train Loss: 1.3094 Acc: 0.8865
val Loss: 1.2567 Acc: 0.8047
Epoch 36/95
----------
train Loss: 1.3250 Acc: 0.8798
val Loss: 1.2591 Acc: 0.8125
Epoch 37/95
----------
train Loss: 1.0862 Acc: 0.9366
val Loss: 1.1264 Acc: 0.8047
Epoch 38/95
----------
train Loss: 1.3850 Acc: 0.8681
val Loss: 1.5130 Acc: 0.8125
Epoch 39/95
----------
train Loss: 1.3747 Acc: 0.8765
val Loss: 1.1707 Acc: 0.8203
Epoch 40/95
----------
train Loss: 1.3309 Acc: 0.9065
val Loss: 1.4219 Acc: 0.8047
Epoch 41/95
----------
train Loss: 1.1952 Acc: 0.9182
val Loss: 1.1600 Acc: 0.8281
Epoch 42/95
----------
train Loss: 1.2882 Acc: 0.8781
val Loss: 1.2711 Acc: 0.8438
Epoch 43/95
----------
train Loss: 1.1569 Acc: 0.9032
val Loss: 1.2732 Acc: 0.8125
Epoch 44/95
----------
train Loss: 1.2004 Acc: 0.8798
val Loss: 1.3885 Acc: 0.7812
Epoch 45/95
----------
train Loss: 1.0245 Acc: 0.9533
val Loss: 1.2449 Acc: 0.8281
Epoch 46/95
----------
train Loss: 1.2355 Acc: 0.9482
val Loss: 1.4190 Acc: 0.8047
Epoch 47/95
----------
train Loss: 1.0860 Acc: 0.9115
val Loss: 1.0674 Acc: 0.8281
Epoch 48/95
----------
train Loss: 1.1734 Acc: 0.9149
val Loss: 1.1445 Acc: 0.8203
Epoch 49/95
----------
train Loss: 1.3390 Acc: 0.9115
val Loss: 1.2163 Acc: 0.8359
Epoch 50/95
----------
train Loss: 1.3403 Acc: 0.8314
val Loss: 1.0737 Acc: 0.8516
Epoch 51/95
----------
train Loss: 1.3804 Acc: 0.8965
val Loss: 1.2791 Acc: 0.8438
Epoch 52/95
----------
train Loss: 1.2902 Acc: 0.9015
val Loss: 1.0620 Acc: 0.8203
Epoch 53/95
----------
train Loss: 1.2591 Acc: 0.9032
val Loss: 1.3477 Acc: 0.8047
Epoch 54/95
----------
train Loss: 1.0605 Acc: 0.9149
val Loss: 1.1268 Acc: 0.8203
Epoch 55/95
----------
train Loss: 1.3220 Acc: 0.8915
val Loss: 1.2294 Acc: 0.8359
Epoch 56/95
----------
train Loss: 1.1562 Acc: 0.9215
val Loss: 1.1179 Acc: 0.8359
Epoch 57/95
----------
train Loss: 1.1925 Acc: 0.9132
val Loss: 1.1054 Acc: 0.8203
Epoch 58/95
----------
train Loss: 1.2465 Acc: 0.9165
val Loss: 1.3222 Acc: 0.8359
Epoch 59/95
----------
train Loss: 1.3381 Acc: 0.8982
val Loss: 1.1307 Acc: 0.8359
Epoch 60/95
----------
train Loss: 1.3465 Acc: 0.8915
val Loss: 1.2430 Acc: 0.8438
Epoch 61/95
----------
train Loss: 1.0797 Acc: 0.9399
val Loss: 1.1592 Acc: 0.8359
Epoch 62/95
----------
train Loss: 1.3225 Acc: 0.9132
val Loss: 0.9513 Acc: 0.8594
Epoch 63/95
----------
train Loss: 1.3159 Acc: 0.8982
val Loss: 1.2648 Acc: 0.7969
Epoch 64/95
----------
train Loss: 1.2388 Acc: 0.9466
val Loss: 1.1867 Acc: 0.8047
Epoch 65/95
----------
train Loss: 1.2117 Acc: 0.9349
val Loss: 1.2328 Acc: 0.7969
Epoch 66/95
----------
train Loss: 1.1184 Acc: 0.9299
val Loss: 1.0889 Acc: 0.8281
Epoch 67/95
----------
train Loss: 1.2204 Acc: 0.9265
val Loss: 1.1035 Acc: 0.8672
Epoch 68/95
----------
train Loss: 1.2579 Acc: 0.9299
val Loss: 1.1451 Acc: 0.8516
Epoch 69/95
----------
train Loss: 1.1841 Acc: 0.9182
val Loss: 1.0090 Acc: 0.8672
Epoch 70/95
----------
train Loss: 1.1452 Acc: 0.9098
val Loss: 1.1676 Acc: 0.7734
Epoch 71/95
----------
train Loss: 1.2917 Acc: 0.8765
val Loss: 1.1303 Acc: 0.8359
Epoch 72/95
----------
train Loss: 1.3186 Acc: 0.9132
val Loss: 1.0975 Acc: 0.8281
Epoch 73/95
----------
train Loss: 1.2301 Acc: 0.9065
val Loss: 1.2521 Acc: 0.8281
Epoch 74/95
----------
train Loss: 1.3425 Acc: 0.8748
val Loss: 1.1195 Acc: 0.8359
Epoch 75/95
----------
train Loss: 1.3017 Acc: 0.8731
val Loss: 1.1320 Acc: 0.8359
Epoch 76/95
----------
train Loss: 1.1364 Acc: 0.9349
val Loss: 1.3104 Acc: 0.8203
Epoch 77/95
----------
train Loss: 1.1477 Acc: 0.9182
val Loss: 1.1395 Acc: 0.8125
Epoch 78/95
----------
train Loss: 1.1788 Acc: 0.9015
val Loss: 1.8978 Acc: 0.7734
Epoch 79/95
----------
train Loss: 1.1837 Acc: 0.9082
val Loss: 1.0616 Acc: 0.8516
Epoch 80/95
----------
train Loss: 1.2278 Acc: 0.9149
val Loss: 1.4031 Acc: 0.8516
Epoch 81/95
----------
train Loss: 1.3148 Acc: 0.8514
val Loss: 1.2291 Acc: 0.7891
Epoch 82/95
----------
train Loss: 1.1949 Acc: 0.8982
val Loss: 1.1451 Acc: 0.8047
Epoch 83/95
----------
train Loss: 1.3001 Acc: 0.8965
val Loss: 1.3361 Acc: 0.8359
Epoch 84/95
----------
train Loss: 1.2253 Acc: 0.9299
val Loss: 1.0908 Acc: 0.8125
Epoch 85/95
----------
train Loss: 1.2371 Acc: 0.9249
val Loss: 1.1391 Acc: 0.8359
Epoch 86/95
----------
train Loss: 1.1115 Acc: 0.9416
val Loss: 1.2168 Acc: 0.8359
Epoch 87/95
----------
train Loss: 1.2111 Acc: 0.8731
val Loss: 1.2137 Acc: 0.8203
Epoch 88/95
----------
train Loss: 1.2367 Acc: 0.9366
val Loss: 1.2617 Acc: 0.8438
Epoch 89/95
----------
train Loss: 1.2171 Acc: 0.9165
val Loss: 1.0910 Acc: 0.8438
Epoch 90/95
----------
train Loss: 1.0783 Acc: 0.9449
val Loss: 1.1556 Acc: 0.8125
Epoch 91/95
----------
train Loss: 1.2405 Acc: 0.9048
val Loss: 1.3035 Acc: 0.7969
Epoch 92/95
----------
train Loss: 1.2063 Acc: 0.9265
val Loss: 1.2827 Acc: 0.8359
Epoch 93/95
----------
train Loss: 1.1887 Acc: 0.8748
val Loss: 1.3332 Acc: 0.8047
Epoch 94/95
----------
train Loss: 1.2735 Acc: 0.9098
val Loss: 1.1211 Acc: 0.8281
Epoch 95/95
----------
train Loss: 1.2662 Acc: 0.9182
[I 2024-10-15 11:23:38,152] Trial 3 finished with value: 0.8359375 and parameters: {'batch_size': 82, 'lr': 3.601654639260127e-05, 'num_epochs': 95, 'weight_decay': 0.17353407297443357, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 3 with value: 0.8359375.
val Loss: 1.2686 Acc: 0.8359
Best val Acc: 0.835938
Model weights saved at ./model_weights/ResNet34_bs_82_lr_3.601654639260127e-05_epoch_95_wd_0.17353407297443357_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/65
----------
train Loss: 6.6366 Acc: 0.2855
val Loss: 918.2962 Acc: 0.0625
Epoch 2/65
----------
train Loss: 5.6886 Acc: 0.2104
val Loss: 26.8398 Acc: 0.2344
Epoch 3/65
----------
train Loss: 5.8577 Acc: 0.3623
val Loss: 39.5503 Acc: 0.2031
Epoch 4/65
----------
train Loss: 5.4553 Acc: 0.2554
val Loss: 5.6615 Acc: 0.1875
Epoch 5/65
----------
train Loss: 5.5860 Acc: 0.4942
val Loss: 5.5715 Acc: 0.6094
Epoch 6/65
----------
train Loss: 5.3123 Acc: 0.2187
val Loss: 5.4777 Acc: 0.2266
Epoch 7/65
----------
train Loss: 5.2899 Acc: 0.3890
val Loss: 5.5331 Acc: 0.1484
Epoch 8/65
----------
train Loss: 5.2313 Acc: 0.2688
val Loss: 5.1833 Acc: 0.1719
Epoch 9/65
----------
train Loss: 4.9660 Acc: 0.3205
val Loss: 5.6735 Acc: 0.1328
Epoch 10/65
----------
train Loss: 5.0944 Acc: 0.4341
[I 2024-10-15 11:24:23,093] Trial 4 finished with value: 0.609375 and parameters: {'batch_size': 101, 'lr': 0.0027787374498352085, 'num_epochs': 65, 'weight_decay': 0.029799789663362043, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 3 with value: 0.8359375.
val Loss: 5.2664 Acc: 0.2266
Early stopping at epoch 10 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.609375
Model weights saved at ./model_weights/ResNet34_bs_101_lr_0.0027787374498352085_epoch_65_wd_0.029799789663362043_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/70
----------
train Loss: 6.7643 Acc: 0.3406
val Loss: 643.5596 Acc: 0.1406
Epoch 2/70
----------
train Loss: 5.5225 Acc: 0.3706
val Loss: 21.8700 Acc: 0.2734
Epoch 3/70
----------
train Loss: 5.6663 Acc: 0.4307
val Loss: 6.2343 Acc: 0.3750
Epoch 4/70
----------
train Loss: 4.6212 Acc: 0.6327
val Loss: 4.8330 Acc: 0.5469
Epoch 5/70
----------
train Loss: 4.4886 Acc: 0.5776
val Loss: 6.2894 Acc: 0.5312
Epoch 6/70
----------
train Loss: 4.1854 Acc: 0.6110
val Loss: 6.0486 Acc: 0.3828
Epoch 7/70
----------
train Loss: 4.5342 Acc: 0.4891
val Loss: 4.8214 Acc: 0.3125
Epoch 8/70
----------
train Loss: 4.2082 Acc: 0.6277
val Loss: 6.1138 Acc: 0.2266
Epoch 9/70
----------
train Loss: 3.8827 Acc: 0.6194
val Loss: 10.3789 Acc: 0.5938
Epoch 10/70
----------
train Loss: 3.8801 Acc: 0.6027
val Loss: 4.6493 Acc: 0.6016
Epoch 11/70
----------
train Loss: 3.7148 Acc: 0.6110
val Loss: 4.7599 Acc: 0.7188
Epoch 12/70
----------
train Loss: 3.8442 Acc: 0.6795
val Loss: 9.7081 Acc: 0.3438
Epoch 13/70
----------
train Loss: 4.3709 Acc: 0.6093
val Loss: 10.4246 Acc: 0.3984
Epoch 14/70
----------
train Loss: 4.2379 Acc: 0.5643
val Loss: 6.9163 Acc: 0.4453
Epoch 15/70
----------
train Loss: 3.7262 Acc: 0.6461
val Loss: 6.3984 Acc: 0.2656
Epoch 16/70
----------
train Loss: 3.6911 Acc: 0.5776
[I 2024-10-15 11:25:35,151] Trial 5 finished with value: 0.71875 and parameters: {'batch_size': 124, 'lr': 0.0025596227990223423, 'num_epochs': 70, 'weight_decay': 0.001170554571027561, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 3 with value: 0.8359375.
val Loss: 7.3992 Acc: 0.2266
Early stopping at epoch 16 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.718750
Model weights saved at ./model_weights/ResNet34_bs_124_lr_0.0025596227990223423_epoch_70_wd_0.001170554571027561_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/27
----------
train Loss: 0.5351 Acc: 0.6027
val Loss: 0.4559 Acc: 0.6875
Epoch 2/27
----------
train Loss: 0.4061 Acc: 0.7446
val Loss: 0.3545 Acc: 0.7188
Epoch 3/27
----------
train Loss: 0.3526 Acc: 0.7696
val Loss: 0.3132 Acc: 0.7500
Epoch 4/27
----------
train Loss: 0.3157 Acc: 0.8247
val Loss: 0.2849 Acc: 0.8047
Epoch 5/27
----------
train Loss: 0.2767 Acc: 0.8664
val Loss: 0.2727 Acc: 0.8125
Epoch 6/27
----------
train Loss: 0.2660 Acc: 0.8564
val Loss: 0.2481 Acc: 0.8203
Epoch 7/27
----------
train Loss: 0.2567 Acc: 0.8731
val Loss: 0.2471 Acc: 0.7812
Epoch 8/27
----------
train Loss: 0.2523 Acc: 0.8748
val Loss: 0.2458 Acc: 0.8125
Epoch 9/27
----------
train Loss: 0.2592 Acc: 0.8698
val Loss: 0.2470 Acc: 0.8125
Epoch 10/27
----------
train Loss: 0.2765 Acc: 0.8598
val Loss: 0.2460 Acc: 0.8203
Epoch 11/27
----------
train Loss: 0.2250 Acc: 0.9015
val Loss: 0.2339 Acc: 0.8359
Epoch 12/27
----------
train Loss: 0.2126 Acc: 0.9048
val Loss: 0.2314 Acc: 0.8281
Epoch 13/27
----------
train Loss: 0.2319 Acc: 0.9232
val Loss: 0.2413 Acc: 0.8203
Epoch 14/27
----------
train Loss: 0.2378 Acc: 0.9249
val Loss: 0.2377 Acc: 0.8125
Epoch 15/27
----------
train Loss: 0.2179 Acc: 0.9199
val Loss: 0.2397 Acc: 0.8047
Epoch 16/27
----------
train Loss: 0.2191 Acc: 0.9215
val Loss: 0.2268 Acc: 0.8281
Epoch 17/27
----------
train Loss: 0.2145 Acc: 0.9199
val Loss: 0.2386 Acc: 0.8203
Epoch 18/27
----------
train Loss: 0.2366 Acc: 0.8848
val Loss: 0.2522 Acc: 0.8203
Epoch 19/27
----------
train Loss: 0.2446 Acc: 0.8664
val Loss: 0.2433 Acc: 0.8281
Epoch 20/27
----------
train Loss: 0.2232 Acc: 0.9249
val Loss: 0.2469 Acc: 0.7891
Epoch 21/27
----------
train Loss: 0.2237 Acc: 0.9132
val Loss: 0.2506 Acc: 0.7969
Epoch 22/27
----------
train Loss: 0.2203 Acc: 0.9432
val Loss: 0.2416 Acc: 0.8047
Epoch 23/27
----------
train Loss: 0.2291 Acc: 0.8982
val Loss: 0.2486 Acc: 0.8047
Epoch 24/27
----------
train Loss: 0.2218 Acc: 0.9482
val Loss: 0.2496 Acc: 0.7812
Epoch 25/27
----------
train Loss: 0.2454 Acc: 0.8831
val Loss: 0.2400 Acc: 0.7969
Epoch 26/27
----------
train Loss: 0.2259 Acc: 0.9316
val Loss: 0.2378 Acc: 0.7969
Epoch 27/27
----------
train Loss: 0.2486 Acc: 0.8748
[I 2024-10-15 11:27:35,968] Trial 6 finished with value: 0.796875 and parameters: {'batch_size': 18, 'lr': 3.348807697953458e-05, 'num_epochs': 27, 'weight_decay': 0.0016789105413488414, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 3 with value: 0.8359375.
val Loss: 0.2352 Acc: 0.7969
Best val Acc: 0.796875
Model weights saved at ./model_weights/ResNet34_bs_18_lr_3.348807697953458e-05_epoch_27_wd_0.0016789105413488414_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/53
----------
train Loss: 0.4732 Acc: 0.6144
val Loss: 0.3123 Acc: 0.7656
Epoch 2/53
----------
train Loss: 0.3678 Acc: 0.7262
val Loss: 0.5181 Acc: 0.6172
Epoch 3/53
----------
train Loss: 0.3577 Acc: 0.7095
val Loss: 0.2705 Acc: 0.8125
Epoch 4/53
----------
train Loss: 0.3591 Acc: 0.7162
val Loss: 0.3160 Acc: 0.7812
Epoch 5/53
----------
train Loss: 0.3525 Acc: 0.7312
val Loss: 0.2706 Acc: 0.7578
Epoch 6/53
----------
train Loss: 0.3656 Acc: 0.7195
val Loss: 0.2389 Acc: 0.8750
Epoch 7/53
----------
train Loss: 0.3512 Acc: 0.7162
val Loss: 0.4210 Acc: 0.6641
Epoch 8/53
----------
train Loss: 0.3475 Acc: 0.7195
val Loss: 0.4265 Acc: 0.6328
Epoch 9/53
----------
train Loss: 0.3977 Acc: 0.6811
val Loss: 0.2860 Acc: 0.8672
Epoch 10/53
----------
train Loss: 0.3748 Acc: 0.6978
val Loss: 0.3221 Acc: 0.7188
Epoch 11/53
----------
train Loss: 0.3829 Acc: 0.7028
val Loss: 0.2155 Acc: 0.8516
Epoch 12/53
----------
train Loss: 0.3633 Acc: 0.7229
val Loss: 0.3332 Acc: 0.7656
Epoch 13/53
----------
train Loss: 0.3689 Acc: 0.6995
val Loss: 0.2477 Acc: 0.7734
Epoch 14/53
----------
train Loss: 0.3881 Acc: 0.6995
val Loss: 0.2715 Acc: 0.8203
Epoch 15/53
----------
train Loss: 0.3863 Acc: 0.6728
val Loss: 0.2895 Acc: 0.7031
Epoch 16/53
----------
train Loss: 0.3690 Acc: 0.7412
val Loss: 0.3095 Acc: 0.7734
Epoch 17/53
----------
train Loss: 0.3820 Acc: 0.7095
val Loss: 0.3120 Acc: 0.7109
Epoch 18/53
----------
train Loss: 0.3572 Acc: 0.7145
val Loss: 0.2872 Acc: 0.7422
Epoch 19/53
----------
train Loss: 0.3838 Acc: 0.6912
val Loss: 0.3636 Acc: 0.6875
Epoch 20/53
----------
train Loss: 0.3737 Acc: 0.6795
val Loss: 0.4463 Acc: 0.6562
Epoch 21/53
----------
train Loss: 0.3722 Acc: 0.7112
val Loss: 0.3138 Acc: 0.7734
Epoch 22/53
----------
train Loss: 0.3734 Acc: 0.6912
val Loss: 0.3281 Acc: 0.7500
Epoch 23/53
----------
train Loss: 0.3695 Acc: 0.7179
val Loss: 0.4552 Acc: 0.4453
Epoch 24/53
----------
train Loss: 0.3759 Acc: 0.7195
val Loss: 0.2978 Acc: 0.7422
Epoch 25/53
----------
train Loss: 0.3826 Acc: 0.6878
val Loss: 0.3929 Acc: 0.7500
Epoch 26/53
----------
train Loss: 0.3616 Acc: 0.7312
val Loss: 0.3789 Acc: 0.6875
Epoch 27/53
----------
train Loss: 0.3657 Acc: 0.7112
val Loss: 0.3690 Acc: 0.6797
Epoch 28/53
----------
train Loss: 0.3710 Acc: 0.7195
val Loss: 1.2238 Acc: 0.6641
Epoch 29/53
----------
train Loss: 0.3810 Acc: 0.7095
val Loss: 0.3164 Acc: 0.6953
Epoch 30/53
----------
train Loss: 0.3805 Acc: 0.7212
val Loss: 0.3226 Acc: 0.7188
Epoch 31/53
----------
train Loss: 0.3725 Acc: 0.7078
val Loss: 0.4674 Acc: 0.6953
Epoch 32/53
----------
train Loss: 0.3758 Acc: 0.7028
val Loss: 0.3697 Acc: 0.7031
Epoch 33/53
----------
train Loss: 0.3709 Acc: 0.7095
val Loss: 0.3698 Acc: 0.6562
Epoch 34/53
----------
train Loss: 0.3626 Acc: 0.7396
val Loss: 0.3018 Acc: 0.7656
Epoch 35/53
----------
train Loss: 0.3842 Acc: 0.6878
val Loss: 0.3418 Acc: 0.6641
Epoch 36/53
----------
train Loss: 0.3684 Acc: 0.7279
val Loss: 0.4150 Acc: 0.6562
Epoch 37/53
----------
train Loss: 0.3724 Acc: 0.7078
val Loss: 0.3789 Acc: 0.7891
Epoch 38/53
----------
train Loss: 0.3600 Acc: 0.7279
val Loss: 0.3338 Acc: 0.7266
Epoch 39/53
----------
train Loss: 0.3837 Acc: 0.6912
val Loss: 0.3056 Acc: 0.7578
Epoch 40/53
----------
train Loss: 0.3639 Acc: 0.7062
val Loss: 0.3362 Acc: 0.8438
Epoch 41/53
----------
train Loss: 0.3664 Acc: 0.7429
val Loss: 0.2814 Acc: 0.7969
Epoch 42/53
----------
train Loss: 0.3680 Acc: 0.7179
val Loss: 0.3136 Acc: 0.6875
Epoch 43/53
----------
train Loss: 0.3680 Acc: 0.7129
val Loss: 0.2389 Acc: 0.8672
Epoch 44/53
----------
train Loss: 0.3795 Acc: 0.6795
val Loss: 0.3711 Acc: 0.6953
Epoch 45/53
----------
train Loss: 0.3769 Acc: 0.7062
val Loss: 0.3724 Acc: 0.7344
Epoch 46/53
----------
train Loss: 0.3707 Acc: 0.7078
val Loss: 0.6400 Acc: 0.5625
Epoch 47/53
----------
train Loss: 0.3827 Acc: 0.6945
val Loss: 0.3486 Acc: 0.6797
Epoch 48/53
----------
train Loss: 0.3820 Acc: 0.7012
[I 2024-10-15 11:31:10,926] Trial 7 finished with value: 0.8671875 and parameters: {'batch_size': 121, 'lr': 0.0004119510274895397, 'num_epochs': 53, 'weight_decay': 0.015776257028773385, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 7 with value: 0.8671875.
val Loss: 0.2664 Acc: 0.7812
Early stopping at epoch 48 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.867188
Model weights saved at ./model_weights/ResNet34_bs_121_lr_0.0004119510274895397_epoch_53_wd_0.015776257028773385_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/45
----------
train Loss: 1.8567 Acc: 0.4992
val Loss: 1.1015 Acc: 0.6250
Epoch 2/45
----------
train Loss: 1.1224 Acc: 0.6160
val Loss: 1.0952 Acc: 0.6250
Epoch 3/45
----------
train Loss: 1.1272 Acc: 0.6277
val Loss: 1.0980 Acc: 0.6250
Epoch 4/45
----------
train Loss: 1.0535 Acc: 0.6311
val Loss: 1.0736 Acc: 0.6250
Epoch 5/45
----------
train Loss: 1.0522 Acc: 0.6294
val Loss: 1.0506 Acc: 0.6250
Epoch 6/45
----------
train Loss: 0.9953 Acc: 0.6377
val Loss: 1.0790 Acc: 0.6250
Epoch 7/45
----------
train Loss: 0.9781 Acc: 0.6477
val Loss: 1.0577 Acc: 0.6250
Epoch 8/45
----------
train Loss: 0.9412 Acc: 0.6694
val Loss: 1.1162 Acc: 0.6250
Epoch 9/45
----------
train Loss: 0.9660 Acc: 0.6628
val Loss: 1.0294 Acc: 0.6406
Epoch 10/45
----------
train Loss: 0.9406 Acc: 0.6594
val Loss: 1.1892 Acc: 0.6250
Epoch 11/45
----------
train Loss: 0.9678 Acc: 0.6461
val Loss: 1.3096 Acc: 0.1328
Epoch 12/45
----------
train Loss: 1.0364 Acc: 0.6227
val Loss: 1.0817 Acc: 0.6250
Epoch 13/45
----------
train Loss: 0.9893 Acc: 0.6444
val Loss: 1.0179 Acc: 0.6250
Epoch 14/45
----------
train Loss: 0.9884 Acc: 0.6361
val Loss: 2.2703 Acc: 0.6250
Epoch 15/45
----------
train Loss: 0.9605 Acc: 0.6544
val Loss: 1.1700 Acc: 0.6250
Epoch 16/45
----------
train Loss: 0.9226 Acc: 0.6694
val Loss: 1.0835 Acc: 0.6250
Epoch 17/45
----------
train Loss: 0.9406 Acc: 0.6728
val Loss: 1.0477 Acc: 0.6250
Epoch 18/45
----------
train Loss: 0.9341 Acc: 0.6628
val Loss: 1.0189 Acc: 0.6250
Epoch 19/45
----------
train Loss: 0.9373 Acc: 0.6561
val Loss: 1.0683 Acc: 0.6250
Epoch 20/45
----------
train Loss: 0.9250 Acc: 0.6711
val Loss: 1.1343 Acc: 0.6250
Epoch 21/45
----------
train Loss: 0.9496 Acc: 0.6578
val Loss: 1.3280 Acc: 0.2578
Epoch 22/45
----------
train Loss: 0.9227 Acc: 0.6661
val Loss: 1.0043 Acc: 0.6406
Epoch 23/45
----------
train Loss: 0.9201 Acc: 0.6711
val Loss: 1.1579 Acc: 0.6250
Epoch 24/45
----------
train Loss: 0.9322 Acc: 0.6628
val Loss: 1.0087 Acc: 0.6250
Epoch 25/45
----------
train Loss: 0.9380 Acc: 0.6644
val Loss: 10.3515 Acc: 0.1250
Epoch 26/45
----------
train Loss: 0.9387 Acc: 0.6611
val Loss: 3.1100 Acc: 0.1641
Epoch 27/45
----------
train Loss: 0.9285 Acc: 0.6761
val Loss: 1.5188 Acc: 0.6250
Epoch 28/45
----------
train Loss: 0.9998 Acc: 0.6394
val Loss: 1.0110 Acc: 0.6328
Epoch 29/45
----------
train Loss: 0.9450 Acc: 0.6544
val Loss: 1.1162 Acc: 0.6250
Epoch 30/45
----------
train Loss: 0.9465 Acc: 0.6444
val Loss: 2.9524 Acc: 0.1250
Epoch 31/45
----------
train Loss: 0.9448 Acc: 0.6578
val Loss: 1.0272 Acc: 0.6250
Epoch 32/45
----------
train Loss: 0.9563 Acc: 0.6544
val Loss: 1.0273 Acc: 0.6250
Epoch 33/45
----------
train Loss: 0.9361 Acc: 0.6678
val Loss: 1.0699 Acc: 0.6250
Epoch 34/45
----------
train Loss: 0.9265 Acc: 0.6711
val Loss: 1.1054 Acc: 0.6250
Epoch 35/45
----------
train Loss: 0.9202 Acc: 0.6761
val Loss: 1.0941 Acc: 0.6328
Epoch 36/45
----------
train Loss: 0.9080 Acc: 0.6828
val Loss: 0.9793 Acc: 0.6406
Epoch 37/45
----------
train Loss: 0.9225 Acc: 0.6711
val Loss: 1.1346 Acc: 0.6250
Epoch 38/45
----------
train Loss: 0.9182 Acc: 0.6594
val Loss: 0.9510 Acc: 0.6484
Epoch 39/45
----------
train Loss: 0.9347 Acc: 0.6494
val Loss: 3.3823 Acc: 0.2500
Epoch 40/45
----------
train Loss: 0.9261 Acc: 0.6661
val Loss: 1.0635 Acc: 0.6250
Epoch 41/45
----------
train Loss: 0.9264 Acc: 0.6678
val Loss: 1.0755 Acc: 0.6250
Epoch 42/45
----------
train Loss: 0.9102 Acc: 0.6761
val Loss: 1.1481 Acc: 0.6250
Epoch 43/45
----------
train Loss: 0.9438 Acc: 0.6644
val Loss: 1.0135 Acc: 0.6250
Epoch 44/45
----------
train Loss: 0.9154 Acc: 0.6628
val Loss: 1.6670 Acc: 0.1797
Epoch 45/45
----------
train Loss: 0.9217 Acc: 0.6678
[I 2024-10-15 11:34:30,541] Trial 8 finished with value: 0.625 and parameters: {'batch_size': 37, 'lr': 0.008361974083558715, 'num_epochs': 45, 'weight_decay': 0.022206432319672297, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 7 with value: 0.8671875.
val Loss: 0.9732 Acc: 0.6250
Best val Acc: 0.625000
Model weights saved at ./model_weights/ResNet34_bs_37_lr_0.008361974083558715_epoch_45_wd_0.022206432319672297_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/39
----------
train Loss: 5.3992 Acc: 0.1419
val Loss: 4.6865 Acc: 0.2344
Epoch 2/39
----------
train Loss: 4.4753 Acc: 0.3105
val Loss: 3.9387 Acc: 0.4453
Epoch 3/39
----------
train Loss: 3.7510 Acc: 0.5543
val Loss: 3.3274 Acc: 0.6562
Epoch 4/39
----------
train Loss: 3.2389 Acc: 0.6561
val Loss: 2.8896 Acc: 0.7578
Epoch 5/39
----------
train Loss: 2.8668 Acc: 0.7262
val Loss: 2.5520 Acc: 0.7656
Epoch 6/39
----------
train Loss: 2.5573 Acc: 0.7529
val Loss: 2.3024 Acc: 0.7734
Epoch 7/39
----------
train Loss: 2.3658 Acc: 0.7646
val Loss: 2.1525 Acc: 0.7812
Epoch 8/39
----------
train Loss: 2.0794 Acc: 0.8097
val Loss: 1.9269 Acc: 0.8047
Epoch 9/39
----------
train Loss: 2.1314 Acc: 0.7596
val Loss: 1.7920 Acc: 0.8125
Epoch 10/39
----------
train Loss: 1.9265 Acc: 0.8214
val Loss: 1.6707 Acc: 0.8125
Epoch 11/39
----------
train Loss: 1.7001 Acc: 0.8397
val Loss: 1.5553 Acc: 0.8359
Epoch 12/39
----------
train Loss: 1.7480 Acc: 0.8130
val Loss: 1.4874 Acc: 0.8359
Epoch 13/39
----------
train Loss: 1.7895 Acc: 0.8197
val Loss: 1.4456 Acc: 0.8438
Epoch 14/39
----------
train Loss: 1.7702 Acc: 0.7696
val Loss: 1.4051 Acc: 0.8516
Epoch 15/39
----------
train Loss: 1.6468 Acc: 0.8230
val Loss: 1.3415 Acc: 0.8516
Epoch 16/39
----------
train Loss: 1.6609 Acc: 0.8715
val Loss: 1.2935 Acc: 0.8594
Epoch 17/39
----------
train Loss: 1.5447 Acc: 0.8431
val Loss: 1.2686 Acc: 0.8750
Epoch 18/39
----------
train Loss: 1.6263 Acc: 0.8147
val Loss: 1.2316 Acc: 0.8828
Epoch 19/39
----------
train Loss: 1.5037 Acc: 0.8481
val Loss: 1.2464 Acc: 0.8750
Epoch 20/39
----------
train Loss: 1.5334 Acc: 0.8581
val Loss: 1.2253 Acc: 0.8672
Epoch 21/39
----------
train Loss: 1.4881 Acc: 0.8781
val Loss: 1.2138 Acc: 0.8750
Epoch 22/39
----------
train Loss: 1.4432 Acc: 0.8531
val Loss: 1.2048 Acc: 0.8828
Epoch 23/39
----------
train Loss: 1.3420 Acc: 0.9015
val Loss: 1.1777 Acc: 0.8828
Epoch 24/39
----------
train Loss: 1.4991 Acc: 0.8664
val Loss: 1.2151 Acc: 0.8672
Epoch 25/39
----------
train Loss: 1.5637 Acc: 0.8180
val Loss: 1.1856 Acc: 0.8672
Epoch 26/39
----------
train Loss: 1.5103 Acc: 0.8197
val Loss: 1.1544 Acc: 0.8594
Epoch 27/39
----------
train Loss: 1.5338 Acc: 0.8765
val Loss: 1.2002 Acc: 0.8828
Epoch 28/39
----------
train Loss: 1.3656 Acc: 0.8982
val Loss: 1.1455 Acc: 0.8906
Epoch 29/39
----------
train Loss: 1.5979 Acc: 0.8381
val Loss: 1.2121 Acc: 0.8750
Epoch 30/39
----------
train Loss: 1.3978 Acc: 0.8698
val Loss: 1.2017 Acc: 0.8672
Epoch 31/39
----------
train Loss: 1.4333 Acc: 0.8531
val Loss: 1.2580 Acc: 0.8594
Epoch 32/39
----------
train Loss: 1.4770 Acc: 0.8765
val Loss: 1.1941 Acc: 0.8828
Epoch 33/39
----------
train Loss: 1.2577 Acc: 0.9366
val Loss: 1.1820 Acc: 0.8828
Epoch 34/39
----------
train Loss: 1.2489 Acc: 0.9032
val Loss: 1.1727 Acc: 0.8750
Epoch 35/39
----------
train Loss: 1.3355 Acc: 0.8698
val Loss: 1.1361 Acc: 0.8906
Epoch 36/39
----------
train Loss: 1.4065 Acc: 0.8331
val Loss: 1.1302 Acc: 0.8750
Epoch 37/39
----------
train Loss: 1.3826 Acc: 0.9115
val Loss: 1.1852 Acc: 0.8672
Epoch 38/39
----------
train Loss: 1.2382 Acc: 0.8798
val Loss: 1.1601 Acc: 0.8750
Epoch 39/39
----------
train Loss: 1.2974 Acc: 0.8798
[I 2024-10-15 11:37:24,191] Trial 9 finished with value: 0.875 and parameters: {'batch_size': 78, 'lr': 1.052573488576846e-05, 'num_epochs': 39, 'weight_decay': 0.002768472473869611, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 1.1693 Acc: 0.8750
Best val Acc: 0.875000
Model weights saved at ./model_weights/ResNet34_bs_78_lr_1.052573488576846e-05_epoch_39_wd_0.002768472473869611_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/26
----------
train Loss: 4.5160 Acc: 0.1319
val Loss: 4.5149 Acc: 0.1641
Epoch 2/26
----------
train Loss: 4.3289 Acc: 0.1853
val Loss: 4.4404 Acc: 0.2266
Epoch 3/26
----------
train Loss: 4.2006 Acc: 0.2321
val Loss: 4.2938 Acc: 0.3047
Epoch 4/26
----------
train Loss: 4.0268 Acc: 0.2905
val Loss: 4.1304 Acc: 0.3125
Epoch 5/26
----------
train Loss: 3.9350 Acc: 0.3406
val Loss: 3.9894 Acc: 0.3516
Epoch 6/26
----------
train Loss: 3.7845 Acc: 0.4023
val Loss: 3.8515 Acc: 0.4375
Epoch 7/26
----------
train Loss: 3.6277 Acc: 0.4674
val Loss: 3.7038 Acc: 0.5078
Epoch 8/26
----------
train Loss: 3.5709 Acc: 0.5008
val Loss: 3.6193 Acc: 0.5156
Epoch 9/26
----------
train Loss: 3.4494 Acc: 0.5426
val Loss: 3.5389 Acc: 0.6172
Epoch 10/26
----------
train Loss: 3.3178 Acc: 0.6227
val Loss: 3.4192 Acc: 0.6172
Epoch 11/26
----------
train Loss: 3.1805 Acc: 0.6411
val Loss: 3.3053 Acc: 0.6484
Epoch 12/26
----------
train Loss: 3.1893 Acc: 0.6227
val Loss: 3.2406 Acc: 0.6953
Epoch 13/26
----------
train Loss: 3.0437 Acc: 0.7162
val Loss: 3.1531 Acc: 0.6953
Epoch 14/26
----------
train Loss: 2.9484 Acc: 0.7245
val Loss: 3.0525 Acc: 0.7031
Epoch 15/26
----------
train Loss: 2.8687 Acc: 0.7195
val Loss: 2.9833 Acc: 0.7031
Epoch 16/26
----------
train Loss: 2.8003 Acc: 0.7362
val Loss: 2.9095 Acc: 0.7109
Epoch 17/26
----------
train Loss: 2.7229 Acc: 0.7479
val Loss: 2.8432 Acc: 0.7266
Epoch 18/26
----------
train Loss: 2.7112 Acc: 0.7446
val Loss: 2.7760 Acc: 0.7266
Epoch 19/26
----------
train Loss: 2.6476 Acc: 0.7362
val Loss: 2.7375 Acc: 0.7188
Epoch 20/26
----------
train Loss: 2.5662 Acc: 0.7579
val Loss: 2.6659 Acc: 0.7109
Epoch 21/26
----------
train Loss: 2.5611 Acc: 0.7429
val Loss: 2.6428 Acc: 0.7109
Epoch 22/26
----------
train Loss: 2.4328 Acc: 0.7730
val Loss: 2.5728 Acc: 0.7344
Epoch 23/26
----------
train Loss: 2.3421 Acc: 0.7880
val Loss: 2.5166 Acc: 0.7266
Epoch 24/26
----------
train Loss: 2.3442 Acc: 0.7780
val Loss: 2.4749 Acc: 0.7188
Epoch 25/26
----------
train Loss: 2.2886 Acc: 0.7913
val Loss: 2.4514 Acc: 0.7188
Epoch 26/26
----------
train Loss: 2.2515 Acc: 0.7830
[I 2024-10-15 11:39:20,008] Trial 10 finished with value: 0.71875 and parameters: {'batch_size': 52, 'lr': 2.0924641906021877e-06, 'num_epochs': 26, 'weight_decay': 0.00016439516160722103, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 2.4158 Acc: 0.7188
Best val Acc: 0.718750
Model weights saved at ./model_weights/ResNet34_bs_52_lr_2.0924641906021877e-06_epoch_26_wd_0.00016439516160722103_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/44
----------
train Loss: 3.1249 Acc: 0.6110
val Loss: 2.0318 Acc: 0.7266
Epoch 2/44
----------
train Loss: 1.9907 Acc: 0.7412
val Loss: 1.7787 Acc: 0.7578
Epoch 3/44
----------
train Loss: 1.7301 Acc: 0.7696
val Loss: 1.6793 Acc: 0.7969
Epoch 4/44
----------
train Loss: 1.4477 Acc: 0.8614
val Loss: 1.7800 Acc: 0.7500
Epoch 5/44
----------
train Loss: 1.5587 Acc: 0.8447
val Loss: 1.4099 Acc: 0.8359
Epoch 6/44
----------
train Loss: 1.4490 Acc: 0.8447
val Loss: 1.3863 Acc: 0.7891
Epoch 7/44
----------
train Loss: 1.5563 Acc: 0.8531
val Loss: 1.2981 Acc: 0.8516
Epoch 8/44
----------
train Loss: 1.3965 Acc: 0.8598
val Loss: 1.3914 Acc: 0.8281
Epoch 9/44
----------
train Loss: 1.4334 Acc: 0.9015
val Loss: 1.5533 Acc: 0.7422
Epoch 10/44
----------
train Loss: 1.3320 Acc: 0.8748
val Loss: 1.4101 Acc: 0.8047
Epoch 11/44
----------
train Loss: 1.2963 Acc: 0.8898
val Loss: 1.3625 Acc: 0.8125
Epoch 12/44
----------
train Loss: 1.3417 Acc: 0.8497
val Loss: 1.4079 Acc: 0.8047
Epoch 13/44
----------
train Loss: 1.2641 Acc: 0.8781
val Loss: 1.5331 Acc: 0.7812
Epoch 14/44
----------
train Loss: 1.3002 Acc: 0.9082
val Loss: 1.4359 Acc: 0.8125
Epoch 15/44
----------
train Loss: 1.3708 Acc: 0.8397
val Loss: 1.4765 Acc: 0.7500
Epoch 16/44
----------
train Loss: 1.2918 Acc: 0.8948
val Loss: 1.5219 Acc: 0.7969
Epoch 17/44
----------
train Loss: 1.3332 Acc: 0.8798
val Loss: 1.4494 Acc: 0.8125
Epoch 18/44
----------
train Loss: 1.3564 Acc: 0.8898
val Loss: 1.5075 Acc: 0.8281
Epoch 19/44
----------
train Loss: 1.1728 Acc: 0.8982
val Loss: 1.4615 Acc: 0.7812
Epoch 20/44
----------
train Loss: 1.1431 Acc: 0.9265
val Loss: 1.7586 Acc: 0.7656
Epoch 21/44
----------
train Loss: 1.1359 Acc: 0.9232
val Loss: 1.4584 Acc: 0.8125
Epoch 22/44
----------
train Loss: 1.2433 Acc: 0.9015
val Loss: 1.2064 Acc: 0.8438
Epoch 23/44
----------
train Loss: 1.1712 Acc: 0.8998
val Loss: 1.3271 Acc: 0.8047
Epoch 24/44
----------
train Loss: 1.1188 Acc: 0.9082
val Loss: 1.3028 Acc: 0.8125
Epoch 25/44
----------
train Loss: 1.2292 Acc: 0.9149
val Loss: 1.4439 Acc: 0.7891
Epoch 26/44
----------
train Loss: 1.2968 Acc: 0.8865
val Loss: 1.5814 Acc: 0.7891
Epoch 27/44
----------
train Loss: 1.1944 Acc: 0.9065
val Loss: 1.3793 Acc: 0.8438
Epoch 28/44
----------
train Loss: 1.2357 Acc: 0.8715
val Loss: 2.1221 Acc: 0.6094
Epoch 29/44
----------
train Loss: 1.0257 Acc: 0.9516
val Loss: 1.5728 Acc: 0.7812
Epoch 30/44
----------
train Loss: 1.2165 Acc: 0.8481
val Loss: 1.4908 Acc: 0.7891
Epoch 31/44
----------
train Loss: 1.0869 Acc: 0.9082
val Loss: 1.4285 Acc: 0.8438
Epoch 32/44
----------
train Loss: 1.1148 Acc: 0.8998
val Loss: 1.3231 Acc: 0.7969
Epoch 33/44
----------
train Loss: 1.2977 Acc: 0.8798
val Loss: 1.3637 Acc: 0.8438
Epoch 34/44
----------
train Loss: 1.2607 Acc: 0.9316
val Loss: 1.6791 Acc: 0.7578
Epoch 35/44
----------
train Loss: 1.3106 Acc: 0.8865
val Loss: 1.3776 Acc: 0.7891
Epoch 36/44
----------
train Loss: 1.2379 Acc: 0.9316
val Loss: 1.8311 Acc: 0.7578
Epoch 37/44
----------
train Loss: 1.1102 Acc: 0.9466
val Loss: 1.6070 Acc: 0.8047
Epoch 38/44
----------
train Loss: 1.2382 Acc: 0.9182
val Loss: 1.5178 Acc: 0.8203
Epoch 39/44
----------
train Loss: 1.2551 Acc: 0.8915
val Loss: 1.7454 Acc: 0.8125
Epoch 40/44
----------
train Loss: 1.0897 Acc: 0.9583
val Loss: 1.7935 Acc: 0.8047
Epoch 41/44
----------
train Loss: 1.1694 Acc: 0.9432
val Loss: 1.5317 Acc: 0.7812
Epoch 42/44
----------
train Loss: 1.2171 Acc: 0.8982
val Loss: 1.4338 Acc: 0.7969
Epoch 43/44
----------
train Loss: 1.0194 Acc: 0.9499
val Loss: 1.5751 Acc: 0.7734
Epoch 44/44
----------
train Loss: 1.2001 Acc: 0.9182
[I 2024-10-15 11:42:35,696] Trial 11 finished with value: 0.8046875 and parameters: {'batch_size': 124, 'lr': 0.00022605101789863506, 'num_epochs': 44, 'weight_decay': 0.00204056430157897, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 1.2893 Acc: 0.8047
Best val Acc: 0.804688
Model weights saved at ./model_weights/ResNet34_bs_124_lr_0.00022605101789863506_epoch_44_wd_0.00204056430157897_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/56
----------
train Loss: 0.5993 Acc: 0.3339
val Loss: 0.5184 Acc: 0.6406
Epoch 2/56
----------
train Loss: 0.5348 Acc: 0.5676
val Loss: 0.4712 Acc: 0.6719
Epoch 3/56
----------
train Loss: 0.4824 Acc: 0.6778
val Loss: 0.4206 Acc: 0.7734
Epoch 4/56
----------
train Loss: 0.4359 Acc: 0.7145
val Loss: 0.3827 Acc: 0.7891
Epoch 5/56
----------
train Loss: 0.4199 Acc: 0.7346
val Loss: 0.3560 Acc: 0.8125
Epoch 6/56
----------
train Loss: 0.3875 Acc: 0.7746
val Loss: 0.3309 Acc: 0.8281
Epoch 7/56
----------
train Loss: 0.3508 Acc: 0.8114
val Loss: 0.3043 Acc: 0.8203
Epoch 8/56
----------
train Loss: 0.3681 Acc: 0.7613
val Loss: 0.2920 Acc: 0.8438
Epoch 9/56
----------
train Loss: 0.3418 Acc: 0.7896
val Loss: 0.2800 Acc: 0.8438
Epoch 10/56
----------
train Loss: 0.3262 Acc: 0.8414
val Loss: 0.2710 Acc: 0.8672
Epoch 11/56
----------
train Loss: 0.3118 Acc: 0.8481
val Loss: 0.2557 Acc: 0.8516
Epoch 12/56
----------
train Loss: 0.2878 Acc: 0.8598
val Loss: 0.2408 Acc: 0.8750
Epoch 13/56
----------
train Loss: 0.3050 Acc: 0.8481
val Loss: 0.2408 Acc: 0.8828
Epoch 14/56
----------
train Loss: 0.2845 Acc: 0.8481
val Loss: 0.2344 Acc: 0.8672
Epoch 15/56
----------
train Loss: 0.2852 Acc: 0.8481
val Loss: 0.2283 Acc: 0.8750
Epoch 16/56
----------
train Loss: 0.2571 Acc: 0.9249
val Loss: 0.2139 Acc: 0.8672
Epoch 17/56
----------
train Loss: 0.2734 Acc: 0.8631
val Loss: 0.2111 Acc: 0.8906
Epoch 18/56
----------
train Loss: 0.2511 Acc: 0.8648
val Loss: 0.2126 Acc: 0.8750
Epoch 19/56
----------
train Loss: 0.2354 Acc: 0.9199
val Loss: 0.2120 Acc: 0.8750
Epoch 20/56
----------
train Loss: 0.2426 Acc: 0.8865
val Loss: 0.2049 Acc: 0.8594
Epoch 21/56
----------
train Loss: 0.2171 Acc: 0.9232
val Loss: 0.1942 Acc: 0.9141
Epoch 22/56
----------
train Loss: 0.2275 Acc: 0.8982
val Loss: 0.1939 Acc: 0.9141
Epoch 23/56
----------
train Loss: 0.2526 Acc: 0.9199
val Loss: 0.1987 Acc: 0.8828
Epoch 24/56
----------
train Loss: 0.2244 Acc: 0.9015
val Loss: 0.1904 Acc: 0.8906
Epoch 25/56
----------
train Loss: 0.2346 Acc: 0.8998
val Loss: 0.1925 Acc: 0.8906
Epoch 26/56
----------
train Loss: 0.2496 Acc: 0.9215
val Loss: 0.1934 Acc: 0.8828
Epoch 27/56
----------
train Loss: 0.2363 Acc: 0.9149
val Loss: 0.1901 Acc: 0.8828
Epoch 28/56
----------
train Loss: 0.2126 Acc: 0.9432
val Loss: 0.1831 Acc: 0.9219
Epoch 29/56
----------
train Loss: 0.2395 Acc: 0.9149
val Loss: 0.1837 Acc: 0.9141
Epoch 30/56
----------
train Loss: 0.2726 Acc: 0.8097
val Loss: 0.1891 Acc: 0.8906
Epoch 31/56
----------
train Loss: 0.2174 Acc: 0.9349
val Loss: 0.1905 Acc: 0.8828
Epoch 32/56
----------
train Loss: 0.2399 Acc: 0.9015
val Loss: 0.1934 Acc: 0.8906
Epoch 33/56
----------
train Loss: 0.2246 Acc: 0.9366
val Loss: 0.1867 Acc: 0.8828
Epoch 34/56
----------
train Loss: 0.2106 Acc: 0.9282
val Loss: 0.1952 Acc: 0.8828
Epoch 35/56
----------
train Loss: 0.2374 Acc: 0.9115
val Loss: 0.1861 Acc: 0.8828
Epoch 36/56
----------
train Loss: 0.2328 Acc: 0.9549
val Loss: 0.1869 Acc: 0.8672
Epoch 37/56
----------
train Loss: 0.2390 Acc: 0.9098
val Loss: 0.1877 Acc: 0.8750
Epoch 38/56
----------
train Loss: 0.2201 Acc: 0.9149
val Loss: 0.1870 Acc: 0.8750
Epoch 39/56
----------
train Loss: 0.2124 Acc: 0.9416
val Loss: 0.1751 Acc: 0.8828
Epoch 40/56
----------
train Loss: 0.2422 Acc: 0.8865
val Loss: 0.1787 Acc: 0.8750
Epoch 41/56
----------
train Loss: 0.2367 Acc: 0.8848
val Loss: 0.1825 Acc: 0.8750
Epoch 42/56
----------
train Loss: 0.2174 Acc: 0.9432
val Loss: 0.1815 Acc: 0.8984
Epoch 43/56
----------
train Loss: 0.2354 Acc: 0.9149
val Loss: 0.1828 Acc: 0.8594
Epoch 44/56
----------
train Loss: 0.2193 Acc: 0.9316
val Loss: 0.1856 Acc: 0.8594
Epoch 45/56
----------
train Loss: 0.2258 Acc: 0.9232
val Loss: 0.1788 Acc: 0.8594
Epoch 46/56
----------
train Loss: 0.2314 Acc: 0.8965
val Loss: 0.1784 Acc: 0.8750
Epoch 47/56
----------
train Loss: 0.2367 Acc: 0.8698
val Loss: 0.1774 Acc: 0.8906
Epoch 48/56
----------
train Loss: 0.2063 Acc: 0.9516
val Loss: 0.1821 Acc: 0.8672
Epoch 49/56
----------
train Loss: 0.2179 Acc: 0.9215
val Loss: 0.1764 Acc: 0.8594
Epoch 50/56
----------
train Loss: 0.2120 Acc: 0.9399
val Loss: 0.1788 Acc: 0.8828
Epoch 51/56
----------
train Loss: 0.2021 Acc: 0.9316
val Loss: 0.1779 Acc: 0.8594
Epoch 52/56
----------
train Loss: 0.2119 Acc: 0.9232
val Loss: 0.1725 Acc: 0.8828
Epoch 53/56
----------
train Loss: 0.2335 Acc: 0.8848
val Loss: 0.1788 Acc: 0.8750
Epoch 54/56
----------
train Loss: 0.2106 Acc: 0.9499
val Loss: 0.1855 Acc: 0.8750
Epoch 55/56
----------
train Loss: 0.1718 Acc: 0.9499
val Loss: 0.1719 Acc: 0.8672
Epoch 56/56
----------
train Loss: 0.2182 Acc: 0.9399
[I 2024-10-15 11:46:43,423] Trial 12 finished with value: 0.859375 and parameters: {'batch_size': 105, 'lr': 1.0106771022565444e-05, 'num_epochs': 56, 'weight_decay': 0.004079080349980929, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 0.1842 Acc: 0.8594
Best val Acc: 0.859375
Model weights saved at ./model_weights/ResNet34_bs_105_lr_1.0106771022565444e-05_epoch_56_wd_0.004079080349980929_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/37
----------
train Loss: 2.8604 Acc: 0.5960
val Loss: 2.8640 Acc: 0.4766
Epoch 2/37
----------
train Loss: 1.9249 Acc: 0.7446
val Loss: 1.5708 Acc: 0.7578
Epoch 3/37
----------
train Loss: 1.6554 Acc: 0.8164
val Loss: 1.6884 Acc: 0.6953
Epoch 4/37
----------
train Loss: 1.6659 Acc: 0.8214
val Loss: 1.4586 Acc: 0.7734
Epoch 5/37
----------
train Loss: 1.5683 Acc: 0.8397
val Loss: 1.3468 Acc: 0.7891
Epoch 6/37
----------
train Loss: 1.4687 Acc: 0.8715
val Loss: 1.3116 Acc: 0.7578
Epoch 7/37
----------
train Loss: 1.4277 Acc: 0.8614
val Loss: 1.5274 Acc: 0.7578
Epoch 8/37
----------
train Loss: 1.4728 Acc: 0.8331
val Loss: 1.5147 Acc: 0.7891
Epoch 9/37
----------
train Loss: 1.4133 Acc: 0.9015
val Loss: 1.6440 Acc: 0.7578
Epoch 10/37
----------
train Loss: 1.2728 Acc: 0.9165
val Loss: 1.7656 Acc: 0.7422
Epoch 11/37
----------
train Loss: 1.3644 Acc: 0.8698
val Loss: 1.7015 Acc: 0.7422
Epoch 12/37
----------
train Loss: 1.2241 Acc: 0.9015
val Loss: 1.5591 Acc: 0.7500
Epoch 13/37
----------
train Loss: 1.6038 Acc: 0.8130
val Loss: 1.6233 Acc: 0.7422
Epoch 14/37
----------
train Loss: 1.2177 Acc: 0.9115
val Loss: 1.5739 Acc: 0.7812
Epoch 15/37
----------
train Loss: 1.2997 Acc: 0.9048
val Loss: 1.6801 Acc: 0.7344
Epoch 16/37
----------
train Loss: 1.2224 Acc: 0.8614
val Loss: 1.5213 Acc: 0.7188
Epoch 17/37
----------
train Loss: 1.1830 Acc: 0.9082
val Loss: 1.5602 Acc: 0.7578
Epoch 18/37
----------
train Loss: 1.2813 Acc: 0.8982
val Loss: 1.6025 Acc: 0.7578
Epoch 19/37
----------
train Loss: 1.2519 Acc: 0.9282
val Loss: 1.5930 Acc: 0.7500
Epoch 20/37
----------
train Loss: 1.0783 Acc: 0.9382
val Loss: 1.7088 Acc: 0.7344
Epoch 21/37
----------
train Loss: 0.9844 Acc: 0.9215
val Loss: 1.5138 Acc: 0.6875
Epoch 22/37
----------
train Loss: 1.2479 Acc: 0.9032
val Loss: 1.6699 Acc: 0.7188
Epoch 23/37
----------
train Loss: 1.1982 Acc: 0.8932
val Loss: 1.6735 Acc: 0.7344
Epoch 24/37
----------
train Loss: 1.1421 Acc: 0.9316
val Loss: 1.5658 Acc: 0.7266
Epoch 25/37
----------
train Loss: 1.2604 Acc: 0.9215
val Loss: 1.4906 Acc: 0.7344
Epoch 26/37
----------
train Loss: 1.0547 Acc: 0.9249
val Loss: 1.4989 Acc: 0.7188
Epoch 27/37
----------
train Loss: 1.1799 Acc: 0.8982
val Loss: 1.6039 Acc: 0.6875
Epoch 28/37
----------
train Loss: 1.1419 Acc: 0.9048
val Loss: 1.6123 Acc: 0.7656
Epoch 29/37
----------
train Loss: 1.1648 Acc: 0.9032
val Loss: 1.5525 Acc: 0.7344
Epoch 30/37
----------
train Loss: 1.1526 Acc: 0.8948
val Loss: 1.5060 Acc: 0.7500
Epoch 31/37
----------
train Loss: 1.1809 Acc: 0.9098
val Loss: 1.4633 Acc: 0.7500
Epoch 32/37
----------
train Loss: 1.3122 Acc: 0.9032
val Loss: 1.5920 Acc: 0.7266
Epoch 33/37
----------
train Loss: 1.0996 Acc: 0.9349
val Loss: 1.6376 Acc: 0.7109
Epoch 34/37
----------
train Loss: 1.1914 Acc: 0.9366
val Loss: 1.6943 Acc: 0.7031
Epoch 35/37
----------
train Loss: 1.1237 Acc: 0.8915
val Loss: 1.5279 Acc: 0.6797
Epoch 36/37
----------
train Loss: 1.1665 Acc: 0.9048
val Loss: 1.5565 Acc: 0.6797
Epoch 37/37
----------
train Loss: 0.9490 Acc: 0.9549
[I 2024-10-15 11:49:26,966] Trial 13 finished with value: 0.734375 and parameters: {'batch_size': 45, 'lr': 0.00030171822300718854, 'num_epochs': 37, 'weight_decay': 0.0002726531000832719, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 1.5333 Acc: 0.7344
Best val Acc: 0.734375
Model weights saved at ./model_weights/ResNet34_bs_45_lr_0.00030171822300718854_epoch_37_wd_0.0002726531000832719_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/37
----------
train Loss: 0.6441 Acc: 0.6027
val Loss: 0.6192 Acc: 0.6094
Epoch 2/37
----------
train Loss: 0.6137 Acc: 0.6093
val Loss: 0.5960 Acc: 0.6406
Epoch 3/37
----------
train Loss: 0.5908 Acc: 0.6060
val Loss: 0.5624 Acc: 0.6484
Epoch 4/37
----------
train Loss: 0.5671 Acc: 0.6160
val Loss: 0.5435 Acc: 0.6562
Epoch 5/37
----------
train Loss: 0.5470 Acc: 0.6277
val Loss: 0.5201 Acc: 0.6562
Epoch 6/37
----------
train Loss: 0.5283 Acc: 0.6260
val Loss: 0.5056 Acc: 0.6562
Epoch 7/37
----------
train Loss: 0.5108 Acc: 0.6494
val Loss: 0.4893 Acc: 0.6797
Epoch 8/37
----------
train Loss: 0.4868 Acc: 0.6694
val Loss: 0.4684 Acc: 0.6719
Epoch 9/37
----------
train Loss: 0.4831 Acc: 0.6711
val Loss: 0.4560 Acc: 0.6797
Epoch 10/37
----------
train Loss: 0.4725 Acc: 0.6711
val Loss: 0.4451 Acc: 0.7031
Epoch 11/37
----------
train Loss: 0.4573 Acc: 0.6928
val Loss: 0.4351 Acc: 0.7109
Epoch 12/37
----------
train Loss: 0.4470 Acc: 0.6978
val Loss: 0.4194 Acc: 0.7109
Epoch 13/37
----------
train Loss: 0.4350 Acc: 0.7078
val Loss: 0.4097 Acc: 0.7109
Epoch 14/37
----------
train Loss: 0.4450 Acc: 0.6711
val Loss: 0.4059 Acc: 0.7109
Epoch 15/37
----------
train Loss: 0.4345 Acc: 0.6711
val Loss: 0.3995 Acc: 0.7188
Epoch 16/37
----------
train Loss: 0.4180 Acc: 0.6912
val Loss: 0.3935 Acc: 0.7109
Epoch 17/37
----------
train Loss: 0.4035 Acc: 0.7045
val Loss: 0.3789 Acc: 0.7266
Epoch 18/37
----------
train Loss: 0.4141 Acc: 0.7012
val Loss: 0.3756 Acc: 0.7422
Epoch 19/37
----------
train Loss: 0.3938 Acc: 0.7162
val Loss: 0.3694 Acc: 0.7422
Epoch 20/37
----------
train Loss: 0.3778 Acc: 0.7462
val Loss: 0.3596 Acc: 0.7422
Epoch 21/37
----------
train Loss: 0.3795 Acc: 0.7496
val Loss: 0.3555 Acc: 0.7422
Epoch 22/37
----------
train Loss: 0.3758 Acc: 0.7546
val Loss: 0.3551 Acc: 0.7422
Epoch 23/37
----------
train Loss: 0.3652 Acc: 0.7412
val Loss: 0.3461 Acc: 0.7500
Epoch 24/37
----------
train Loss: 0.3522 Acc: 0.7730
val Loss: 0.3361 Acc: 0.7578
Epoch 25/37
----------
train Loss: 0.3546 Acc: 0.7496
val Loss: 0.3318 Acc: 0.7734
Epoch 26/37
----------
train Loss: 0.3535 Acc: 0.7529
val Loss: 0.3284 Acc: 0.7734
Epoch 27/37
----------
train Loss: 0.3381 Acc: 0.7746
val Loss: 0.3242 Acc: 0.7656
Epoch 28/37
----------
train Loss: 0.3599 Acc: 0.7563
val Loss: 0.3258 Acc: 0.7812
Epoch 29/37
----------
train Loss: 0.3288 Acc: 0.8063
val Loss: 0.3162 Acc: 0.7812
Epoch 30/37
----------
train Loss: 0.3425 Acc: 0.7563
val Loss: 0.3144 Acc: 0.7812
Epoch 31/37
----------
train Loss: 0.3105 Acc: 0.8130
val Loss: 0.3077 Acc: 0.7969
Epoch 32/37
----------
train Loss: 0.3391 Acc: 0.7596
val Loss: 0.3099 Acc: 0.7969
Epoch 33/37
----------
train Loss: 0.3289 Acc: 0.8063
val Loss: 0.3042 Acc: 0.8125
Epoch 34/37
----------
train Loss: 0.2978 Acc: 0.8414
val Loss: 0.2944 Acc: 0.8047
Epoch 35/37
----------
train Loss: 0.3301 Acc: 0.7746
val Loss: 0.2967 Acc: 0.8125
Epoch 36/37
----------
train Loss: 0.3132 Acc: 0.8063
val Loss: 0.2880 Acc: 0.8047
Epoch 37/37
----------
train Loss: 0.3192 Acc: 0.7863
[I 2024-10-15 11:52:11,124] Trial 14 finished with value: 0.8125 and parameters: {'batch_size': 115, 'lr': 7.89054349958079e-06, 'num_epochs': 37, 'weight_decay': 0.09249041400207506, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 0.2902 Acc: 0.8125
Best val Acc: 0.812500
Model weights saved at ./model_weights/ResNet34_bs_115_lr_7.89054349958079e-06_epoch_37_wd_0.09249041400207506_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/58
----------
train Loss: 3.1935 Acc: 0.6344
val Loss: 2.1637 Acc: 0.7109
Epoch 2/58
----------
train Loss: 1.8855 Acc: 0.7429
val Loss: 2.0150 Acc: 0.6328
Epoch 3/58
----------
train Loss: 1.6768 Acc: 0.7763
val Loss: 1.4953 Acc: 0.7891
Epoch 4/58
----------
train Loss: 1.5159 Acc: 0.8314
val Loss: 1.8664 Acc: 0.7656
Epoch 5/58
----------
train Loss: 1.4560 Acc: 0.8481
val Loss: 1.7720 Acc: 0.7422
Epoch 6/58
----------
train Loss: 1.7110 Acc: 0.7763
val Loss: 1.8071 Acc: 0.7266
Epoch 7/58
----------
train Loss: 1.3795 Acc: 0.8648
val Loss: 1.4683 Acc: 0.7734
Epoch 8/58
----------
train Loss: 1.4235 Acc: 0.8481
val Loss: 1.4572 Acc: 0.8203
Epoch 9/58
----------
train Loss: 1.5376 Acc: 0.8381
val Loss: 1.6937 Acc: 0.7656
Epoch 10/58
----------
train Loss: 1.2718 Acc: 0.8698
val Loss: 1.5019 Acc: 0.7969
Epoch 11/58
----------
train Loss: 1.1494 Acc: 0.9199
val Loss: 1.6516 Acc: 0.8203
Epoch 12/58
----------
train Loss: 1.1814 Acc: 0.9149
val Loss: 1.2396 Acc: 0.8438
Epoch 13/58
----------
train Loss: 1.2644 Acc: 0.9115
val Loss: 1.2985 Acc: 0.7969
Epoch 14/58
----------
train Loss: 1.4501 Acc: 0.9098
val Loss: 1.7501 Acc: 0.7422
Epoch 15/58
----------
train Loss: 1.2480 Acc: 0.9132
val Loss: 1.2879 Acc: 0.7969
Epoch 16/58
----------
train Loss: 1.3725 Acc: 0.8497
val Loss: 1.7405 Acc: 0.7734
Epoch 17/58
----------
train Loss: 1.2782 Acc: 0.8948
val Loss: 1.8360 Acc: 0.7344
Epoch 18/58
----------
train Loss: 1.4455 Acc: 0.8765
val Loss: 1.9200 Acc: 0.7734
Epoch 19/58
----------
train Loss: 1.4618 Acc: 0.8364
val Loss: 1.5094 Acc: 0.8047
Epoch 20/58
----------
train Loss: 1.3261 Acc: 0.8798
val Loss: 1.7346 Acc: 0.7734
Epoch 21/58
----------
train Loss: 1.3069 Acc: 0.8915
val Loss: 2.0622 Acc: 0.7188
Epoch 22/58
----------
train Loss: 1.2489 Acc: 0.8965
val Loss: 1.7893 Acc: 0.7422
Epoch 23/58
----------
train Loss: 1.2826 Acc: 0.8865
val Loss: 1.7938 Acc: 0.7500
Epoch 24/58
----------
train Loss: 1.2482 Acc: 0.8681
val Loss: 1.7944 Acc: 0.7578
Epoch 25/58
----------
train Loss: 1.2763 Acc: 0.8948
val Loss: 2.1286 Acc: 0.7500
Epoch 26/58
----------
train Loss: 1.2915 Acc: 0.8948
val Loss: 1.8489 Acc: 0.7422
Epoch 27/58
----------
train Loss: 1.2095 Acc: 0.9132
val Loss: 1.6190 Acc: 0.7734
Epoch 28/58
----------
train Loss: 1.3530 Acc: 0.9082
val Loss: 2.0685 Acc: 0.7578
Epoch 29/58
----------
train Loss: 1.3194 Acc: 0.8715
val Loss: 1.6170 Acc: 0.8203
Epoch 30/58
----------
train Loss: 1.2479 Acc: 0.8815
val Loss: 1.5834 Acc: 0.8359
Epoch 31/58
----------
train Loss: 1.1908 Acc: 0.9282
val Loss: 1.6654 Acc: 0.7422
Epoch 32/58
----------
train Loss: 1.2133 Acc: 0.8998
val Loss: 1.7297 Acc: 0.7812
Epoch 33/58
----------
train Loss: 1.2793 Acc: 0.8731
val Loss: 1.8843 Acc: 0.7500
Epoch 34/58
----------
train Loss: 1.3474 Acc: 0.8631
val Loss: 2.0356 Acc: 0.7188
Epoch 35/58
----------
train Loss: 1.2150 Acc: 0.8631
[I 2024-10-15 11:54:48,324] Trial 15 finished with value: 0.8359375 and parameters: {'batch_size': 82, 'lr': 0.00031117610976577663, 'num_epochs': 58, 'weight_decay': 0.0054354292584264, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 1.9219 Acc: 0.6875
Early stopping at epoch 35 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.835938
Model weights saved at ./model_weights/ResNet34_bs_82_lr_0.00031117610976577663_epoch_58_wd_0.0054354292584264_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/67
----------
train Loss: 3.1164 Acc: 0.6477
val Loss: 2.1259 Acc: 0.7109
Epoch 2/67
----------
train Loss: 2.1057 Acc: 0.7546
val Loss: 1.5910 Acc: 0.7422
Epoch 3/67
----------
train Loss: 1.7807 Acc: 0.7529
val Loss: 1.2390 Acc: 0.7969
Epoch 4/67
----------
train Loss: 1.4546 Acc: 0.8531
val Loss: 1.1300 Acc: 0.8359
Epoch 5/67
----------
train Loss: 1.6302 Acc: 0.8030
val Loss: 1.1210 Acc: 0.8828
Epoch 6/67
----------
train Loss: 1.3502 Acc: 0.8831
val Loss: 1.0128 Acc: 0.8594
Epoch 7/67
----------
train Loss: 1.4179 Acc: 0.8664
val Loss: 1.0256 Acc: 0.8438
Epoch 8/67
----------
train Loss: 1.4316 Acc: 0.8865
val Loss: 1.0453 Acc: 0.8359
Epoch 9/67
----------
train Loss: 1.2947 Acc: 0.8932
val Loss: 1.0625 Acc: 0.8516
Epoch 10/67
----------
train Loss: 1.2853 Acc: 0.9366
val Loss: 1.0816 Acc: 0.8438
Epoch 11/67
----------
train Loss: 1.3494 Acc: 0.9015
val Loss: 1.0385 Acc: 0.8516
Epoch 12/67
----------
train Loss: 1.4164 Acc: 0.8664
val Loss: 1.0731 Acc: 0.8125
Epoch 13/67
----------
train Loss: 1.2842 Acc: 0.9098
val Loss: 1.0889 Acc: 0.7891
Epoch 14/67
----------
train Loss: 1.2435 Acc: 0.9449
val Loss: 1.2555 Acc: 0.7969
Epoch 15/67
----------
train Loss: 1.2273 Acc: 0.9132
val Loss: 1.0749 Acc: 0.8438
Epoch 16/67
----------
train Loss: 1.1331 Acc: 0.9282
val Loss: 1.0766 Acc: 0.8281
Epoch 17/67
----------
train Loss: 1.1411 Acc: 0.9215
val Loss: 1.0618 Acc: 0.8672
Epoch 18/67
----------
train Loss: 1.0333 Acc: 0.9533
val Loss: 1.0666 Acc: 0.8047
Epoch 19/67
----------
train Loss: 1.2122 Acc: 0.8998
val Loss: 0.9834 Acc: 0.8438
Epoch 20/67
----------
train Loss: 1.1221 Acc: 0.9399
val Loss: 1.0518 Acc: 0.8203
Epoch 21/67
----------
train Loss: 1.1307 Acc: 0.9332
val Loss: 0.9305 Acc: 0.8984
Epoch 22/67
----------
train Loss: 1.0913 Acc: 0.9416
val Loss: 0.9674 Acc: 0.8672
Epoch 23/67
----------
train Loss: 1.1293 Acc: 0.9265
val Loss: 1.0821 Acc: 0.8281
Epoch 24/67
----------
train Loss: 1.0572 Acc: 0.9432
val Loss: 1.0136 Acc: 0.8359
Epoch 25/67
----------
train Loss: 1.2227 Acc: 0.8681
val Loss: 1.0317 Acc: 0.8359
Epoch 26/67
----------
train Loss: 1.3624 Acc: 0.8715
val Loss: 1.1246 Acc: 0.8125
Epoch 27/67
----------
train Loss: 1.2382 Acc: 0.8998
val Loss: 1.1298 Acc: 0.8516
Epoch 28/67
----------
train Loss: 1.0596 Acc: 0.9599
val Loss: 1.0491 Acc: 0.8594
Epoch 29/67
----------
train Loss: 1.2531 Acc: 0.9432
val Loss: 1.0613 Acc: 0.8828
Epoch 30/67
----------
train Loss: 1.0816 Acc: 0.9399
val Loss: 1.1624 Acc: 0.8359
Epoch 31/67
----------
train Loss: 1.1612 Acc: 0.8982
val Loss: 1.1099 Acc: 0.8672
Epoch 32/67
----------
train Loss: 1.0854 Acc: 0.9382
val Loss: 1.1441 Acc: 0.8281
Epoch 33/67
----------
train Loss: 1.3141 Acc: 0.9165
val Loss: 1.0584 Acc: 0.8281
Epoch 34/67
----------
train Loss: 1.2235 Acc: 0.8998
val Loss: 1.0981 Acc: 0.8281
Epoch 35/67
----------
train Loss: 1.2539 Acc: 0.9232
val Loss: 1.1030 Acc: 0.8359
Epoch 36/67
----------
train Loss: 1.0897 Acc: 0.9366
val Loss: 1.0592 Acc: 0.8516
Epoch 37/67
----------
train Loss: 1.0690 Acc: 0.9282
val Loss: 0.9949 Acc: 0.8672
Epoch 38/67
----------
train Loss: 1.2115 Acc: 0.9199
val Loss: 1.1483 Acc: 0.8203
Epoch 39/67
----------
train Loss: 1.1655 Acc: 0.9065
val Loss: 1.1387 Acc: 0.8516
Epoch 40/67
----------
train Loss: 1.0846 Acc: 0.9349
val Loss: 1.0330 Acc: 0.8594
Epoch 41/67
----------
train Loss: 1.0982 Acc: 0.9516
val Loss: 1.0980 Acc: 0.8281
Epoch 42/67
----------
train Loss: 1.1199 Acc: 0.9082
val Loss: 1.1277 Acc: 0.8516
Epoch 43/67
----------
train Loss: 1.1659 Acc: 0.9048
val Loss: 1.0977 Acc: 0.8359
Epoch 44/67
----------
train Loss: 1.1338 Acc: 0.8948
val Loss: 1.0538 Acc: 0.8438
Epoch 45/67
----------
train Loss: 1.1403 Acc: 0.9082
val Loss: 1.1123 Acc: 0.8516
Epoch 46/67
----------
train Loss: 1.2470 Acc: 0.9115
val Loss: 1.1108 Acc: 0.8594
Epoch 47/67
----------
train Loss: 1.0315 Acc: 0.9382
val Loss: 1.1338 Acc: 0.8203
Epoch 48/67
----------
train Loss: 1.0772 Acc: 0.9082
val Loss: 1.1268 Acc: 0.8359
Epoch 49/67
----------
train Loss: 0.8666 Acc: 0.9800
val Loss: 1.0863 Acc: 0.7969
Epoch 50/67
----------
train Loss: 1.1672 Acc: 0.9182
val Loss: 1.1698 Acc: 0.8281
Epoch 51/67
----------
train Loss: 1.0520 Acc: 0.9533
val Loss: 1.1714 Acc: 0.8203
Epoch 52/67
----------
train Loss: 1.0903 Acc: 0.9549
val Loss: 1.0651 Acc: 0.8438
Epoch 53/67
----------
train Loss: 1.1484 Acc: 0.9416
val Loss: 1.1117 Acc: 0.8359
Epoch 54/67
----------
train Loss: 1.0442 Acc: 0.9299
val Loss: 1.1416 Acc: 0.8125
Epoch 55/67
----------
train Loss: 1.0250 Acc: 0.9599
val Loss: 1.0780 Acc: 0.8047
Epoch 56/67
----------
train Loss: 1.0042 Acc: 0.9516
val Loss: 1.0910 Acc: 0.8359
Epoch 57/67
----------
train Loss: 1.1293 Acc: 0.9149
val Loss: 1.1137 Acc: 0.8594
Epoch 58/67
----------
train Loss: 1.1009 Acc: 0.9382
val Loss: 1.1082 Acc: 0.8281
Epoch 59/67
----------
train Loss: 0.9725 Acc: 0.9349
val Loss: 1.0230 Acc: 0.8516
Epoch 60/67
----------
train Loss: 1.1501 Acc: 0.9299
val Loss: 1.0977 Acc: 0.8359
Epoch 61/67
----------
train Loss: 1.0775 Acc: 0.9382
val Loss: 1.0794 Acc: 0.8594
Epoch 62/67
----------
train Loss: 1.1363 Acc: 0.9048
val Loss: 1.1132 Acc: 0.8438
Epoch 63/67
----------
train Loss: 1.1011 Acc: 0.9199
val Loss: 1.0836 Acc: 0.8047
Epoch 64/67
----------
train Loss: 1.1958 Acc: 0.9132
val Loss: 1.1653 Acc: 0.7969
Epoch 65/67
----------
train Loss: 1.0998 Acc: 0.9182
val Loss: 1.1191 Acc: 0.8203
Epoch 66/67
----------
train Loss: 1.0725 Acc: 0.9466
val Loss: 1.1078 Acc: 0.7891
Epoch 67/67
----------
train Loss: 1.0826 Acc: 0.9182
[I 2024-10-15 11:59:47,253] Trial 16 finished with value: 0.84375 and parameters: {'batch_size': 23, 'lr': 4.972404430490969e-05, 'num_epochs': 67, 'weight_decay': 0.0006371429926830246, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 1.0903 Acc: 0.8438
Best val Acc: 0.843750
Model weights saved at ./model_weights/ResNet34_bs_23_lr_4.972404430490969e-05_epoch_67_wd_0.0006371429926830246_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/36
----------
train Loss: 0.7224 Acc: 0.1135
val Loss: 0.6947 Acc: 0.1250
Epoch 2/36
----------
train Loss: 0.6853 Acc: 0.1536
val Loss: 0.6622 Acc: 0.1875
Epoch 3/36
----------
train Loss: 0.6508 Acc: 0.2721
val Loss: 0.6299 Acc: 0.2656
Epoch 4/36
----------
train Loss: 0.6212 Acc: 0.3573
val Loss: 0.5930 Acc: 0.4453
Epoch 5/36
----------
train Loss: 0.5956 Acc: 0.4407
val Loss: 0.5752 Acc: 0.5000
Epoch 6/36
----------
train Loss: 0.5721 Acc: 0.5092
val Loss: 0.5471 Acc: 0.5938
Epoch 7/36
----------
train Loss: 0.5509 Acc: 0.5810
val Loss: 0.5289 Acc: 0.6328
Epoch 8/36
----------
train Loss: 0.5244 Acc: 0.6544
val Loss: 0.5093 Acc: 0.6484
Epoch 9/36
----------
train Loss: 0.5075 Acc: 0.6861
val Loss: 0.4906 Acc: 0.6562
Epoch 10/36
----------
train Loss: 0.4930 Acc: 0.7162
val Loss: 0.4693 Acc: 0.7031
Epoch 11/36
----------
train Loss: 0.4829 Acc: 0.7095
val Loss: 0.4562 Acc: 0.7031
Epoch 12/36
----------
train Loss: 0.4604 Acc: 0.7663
val Loss: 0.4448 Acc: 0.6875
Epoch 13/36
----------
train Loss: 0.4484 Acc: 0.7529
val Loss: 0.4312 Acc: 0.6875
Epoch 14/36
----------
train Loss: 0.4437 Acc: 0.7245
val Loss: 0.4225 Acc: 0.7266
Epoch 15/36
----------
train Loss: 0.4296 Acc: 0.7312
val Loss: 0.4141 Acc: 0.7266
Epoch 16/36
----------
train Loss: 0.4230 Acc: 0.7362
val Loss: 0.4024 Acc: 0.7266
Epoch 17/36
----------
train Loss: 0.4061 Acc: 0.7663
val Loss: 0.3897 Acc: 0.7266
Epoch 18/36
----------
train Loss: 0.3954 Acc: 0.7629
val Loss: 0.3839 Acc: 0.7188
Epoch 19/36
----------
train Loss: 0.3874 Acc: 0.7646
val Loss: 0.3775 Acc: 0.7422
Epoch 20/36
----------
train Loss: 0.3866 Acc: 0.7846
val Loss: 0.3694 Acc: 0.7422
Epoch 21/36
----------
train Loss: 0.3771 Acc: 0.7880
val Loss: 0.3641 Acc: 0.7578
Epoch 22/36
----------
train Loss: 0.3797 Acc: 0.7462
val Loss: 0.3548 Acc: 0.7578
Epoch 23/36
----------
train Loss: 0.3631 Acc: 0.7880
val Loss: 0.3515 Acc: 0.7734
Epoch 24/36
----------
train Loss: 0.3682 Acc: 0.7746
val Loss: 0.3459 Acc: 0.7656
Epoch 25/36
----------
train Loss: 0.3552 Acc: 0.8030
val Loss: 0.3437 Acc: 0.7734
Epoch 26/36
----------
train Loss: 0.3487 Acc: 0.8164
val Loss: 0.3377 Acc: 0.7578
Epoch 27/36
----------
train Loss: 0.3468 Acc: 0.7980
val Loss: 0.3366 Acc: 0.7734
Epoch 28/36
----------
train Loss: 0.3173 Acc: 0.8331
val Loss: 0.3297 Acc: 0.7812
Epoch 29/36
----------
train Loss: 0.2971 Acc: 0.8748
val Loss: 0.3213 Acc: 0.7812
Epoch 30/36
----------
train Loss: 0.3154 Acc: 0.8447
val Loss: 0.3157 Acc: 0.7969
Epoch 31/36
----------
train Loss: 0.2994 Acc: 0.8748
val Loss: 0.3135 Acc: 0.7734
Epoch 32/36
----------
train Loss: 0.3154 Acc: 0.8648
val Loss: 0.3123 Acc: 0.7734
Epoch 33/36
----------
train Loss: 0.3222 Acc: 0.8147
val Loss: 0.3124 Acc: 0.7734
Epoch 34/36
----------
train Loss: 0.3181 Acc: 0.8130
val Loss: 0.3062 Acc: 0.7656
Epoch 35/36
----------
train Loss: 0.3299 Acc: 0.8381
val Loss: 0.3066 Acc: 0.7656
Epoch 36/36
----------
train Loss: 0.2904 Acc: 0.8848
[I 2024-10-15 12:02:27,770] Trial 17 finished with value: 0.78125 and parameters: {'batch_size': 66, 'lr': 7.979491308684126e-06, 'num_epochs': 36, 'weight_decay': 0.0765114926435445, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 0.3024 Acc: 0.7812
Best val Acc: 0.781250
Model weights saved at ./model_weights/ResNet34_bs_66_lr_7.979491308684126e-06_epoch_36_wd_0.0765114926435445_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/49
----------
train Loss: 0.5009 Acc: 0.6344
val Loss: 0.3215 Acc: 0.7266
Epoch 2/49
----------
train Loss: 0.3301 Acc: 0.7646
val Loss: 0.2276 Acc: 0.8672
Epoch 3/49
----------
train Loss: 0.2527 Acc: 0.8598
val Loss: 0.2378 Acc: 0.8203
Epoch 4/49
----------
train Loss: 0.2913 Acc: 0.8130
val Loss: 0.2459 Acc: 0.8438
Epoch 5/49
----------
train Loss: 0.2824 Acc: 0.8130
val Loss: 0.2184 Acc: 0.8359
Epoch 6/49
----------
train Loss: 0.2582 Acc: 0.8564
val Loss: 0.2128 Acc: 0.8594
Epoch 7/49
----------
train Loss: 0.2472 Acc: 0.9032
val Loss: 0.2452 Acc: 0.8594
Epoch 8/49
----------
train Loss: 0.2529 Acc: 0.8631
val Loss: 0.2106 Acc: 0.8594
Epoch 9/49
----------
train Loss: 0.2643 Acc: 0.8230
val Loss: 0.2211 Acc: 0.8516
Epoch 10/49
----------
train Loss: 0.2404 Acc: 0.8715
val Loss: 0.2673 Acc: 0.8203
Epoch 11/49
----------
train Loss: 0.2663 Acc: 0.8497
val Loss: 0.2359 Acc: 0.8125
Epoch 12/49
----------
train Loss: 0.2357 Acc: 0.8798
val Loss: 0.2345 Acc: 0.8359
Epoch 13/49
----------
train Loss: 0.2663 Acc: 0.8347
val Loss: 0.2439 Acc: 0.8438
Epoch 14/49
----------
train Loss: 0.2684 Acc: 0.8915
val Loss: 0.2154 Acc: 0.8672
Epoch 15/49
----------
train Loss: 0.2669 Acc: 0.8648
val Loss: 0.2610 Acc: 0.7969
Epoch 16/49
----------
train Loss: 0.2272 Acc: 0.9032
val Loss: 0.2871 Acc: 0.7266
Epoch 17/49
----------
train Loss: 0.2313 Acc: 0.8848
val Loss: 0.2002 Acc: 0.8516
Epoch 18/49
----------
train Loss: 0.2827 Acc: 0.7913
val Loss: 0.2378 Acc: 0.8203
Epoch 19/49
----------
train Loss: 0.2152 Acc: 0.9048
val Loss: 0.2945 Acc: 0.7422
Epoch 20/49
----------
train Loss: 0.2465 Acc: 0.8464
val Loss: 0.2099 Acc: 0.8438
Epoch 21/49
----------
train Loss: 0.2430 Acc: 0.8915
val Loss: 0.3055 Acc: 0.7422
Epoch 22/49
----------
train Loss: 0.2785 Acc: 0.8381
val Loss: 0.2382 Acc: 0.7500
Epoch 23/49
----------
train Loss: 0.2397 Acc: 0.9165
val Loss: 0.2452 Acc: 0.8047
Epoch 24/49
----------
train Loss: 0.2511 Acc: 0.8865
val Loss: 0.2149 Acc: 0.8594
Epoch 25/49
----------
train Loss: 0.2513 Acc: 0.8932
val Loss: 0.2728 Acc: 0.8047
Epoch 26/49
----------
train Loss: 0.2462 Acc: 0.8798
val Loss: 0.2266 Acc: 0.8359
Epoch 27/49
----------
train Loss: 0.2232 Acc: 0.9048
val Loss: 0.2233 Acc: 0.8203
Epoch 28/49
----------
train Loss: 0.2213 Acc: 0.8865
val Loss: 0.2352 Acc: 0.8203
Epoch 29/49
----------
train Loss: 0.2390 Acc: 0.8781
val Loss: 0.2366 Acc: 0.8203
Epoch 30/49
----------
train Loss: 0.2365 Acc: 0.8898
val Loss: 0.2603 Acc: 0.7969
Epoch 31/49
----------
train Loss: 0.2379 Acc: 0.8648
val Loss: 0.3070 Acc: 0.7500
Epoch 32/49
----------
train Loss: 0.2405 Acc: 0.8631
val Loss: 0.2115 Acc: 0.8438
Epoch 33/49
----------
train Loss: 0.2113 Acc: 0.9165
val Loss: 0.1973 Acc: 0.8594
Epoch 34/49
----------
train Loss: 0.2585 Acc: 0.8631
val Loss: 0.2277 Acc: 0.8359
Epoch 35/49
----------
train Loss: 0.2404 Acc: 0.8681
val Loss: 0.2166 Acc: 0.8125
Epoch 36/49
----------
train Loss: 0.2262 Acc: 0.8915
val Loss: 0.2180 Acc: 0.8672
Epoch 37/49
----------
train Loss: 0.2243 Acc: 0.8965
val Loss: 0.2915 Acc: 0.7812
Epoch 38/49
----------
train Loss: 0.2454 Acc: 0.8548
val Loss: 0.2144 Acc: 0.8359
Epoch 39/49
----------
train Loss: 0.2349 Acc: 0.9182
val Loss: 0.2106 Acc: 0.8516
Epoch 40/49
----------
train Loss: 0.2442 Acc: 0.9182
val Loss: 0.2465 Acc: 0.7578
Epoch 41/49
----------
train Loss: 0.2392 Acc: 0.8715
val Loss: 0.2679 Acc: 0.7578
Epoch 42/49
----------
train Loss: 0.1857 Acc: 0.9182
val Loss: 0.3150 Acc: 0.7266
Epoch 43/49
----------
train Loss: 0.2214 Acc: 0.8765
val Loss: 0.2512 Acc: 0.8047
Epoch 44/49
----------
train Loss: 0.2600 Acc: 0.8815
val Loss: 0.2586 Acc: 0.7891
Epoch 45/49
----------
train Loss: 0.2691 Acc: 0.8297
val Loss: 0.2651 Acc: 0.8203
Epoch 46/49
----------
train Loss: 0.1929 Acc: 0.9098
val Loss: 0.2166 Acc: 0.8359
Epoch 47/49
----------
train Loss: 0.2363 Acc: 0.8998
val Loss: 0.3741 Acc: 0.6406
Epoch 48/49
----------
train Loss: 0.2391 Acc: 0.8798
val Loss: 0.2510 Acc: 0.7812
Epoch 49/49
----------
train Loss: 0.2266 Acc: 0.9199
[I 2024-10-15 12:06:05,587] Trial 18 finished with value: 0.8046875 and parameters: {'batch_size': 91, 'lr': 0.00013859061653980493, 'num_epochs': 49, 'weight_decay': 0.007508738598147693, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 0.2329 Acc: 0.8047
Best val Acc: 0.804688
Model weights saved at ./model_weights/ResNet34_bs_91_lr_0.00013859061653980493_epoch_49_wd_0.007508738598147693_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/80
----------
train Loss: 2.6220 Acc: 0.6277
val Loss: 2.3359 Acc: 0.7266
Epoch 2/80
----------
train Loss: 2.3321 Acc: 0.6711
val Loss: 2.0576 Acc: 0.6875
Epoch 3/80
----------
train Loss: 2.3700 Acc: 0.6711
val Loss: 2.0381 Acc: 0.6875
Epoch 4/80
----------
train Loss: 2.4030 Acc: 0.6694
val Loss: 2.1968 Acc: 0.7109
Epoch 5/80
----------
train Loss: 2.3793 Acc: 0.6544
val Loss: 2.3535 Acc: 0.6719
Epoch 6/80
----------
train Loss: 2.4920 Acc: 0.6294
val Loss: 15.8935 Acc: 0.1875
Epoch 7/80
----------
train Loss: 2.5117 Acc: 0.6327
val Loss: 2.4707 Acc: 0.6875
Epoch 8/80
----------
train Loss: 2.5310 Acc: 0.6027
val Loss: 2.6655 Acc: 0.6406
Epoch 9/80
----------
train Loss: 2.4997 Acc: 0.6177
val Loss: 2.5917 Acc: 0.7188
Epoch 10/80
----------
train Loss: 2.4614 Acc: 0.6311
val Loss: 2.6624 Acc: 0.6719
Epoch 11/80
----------
train Loss: 2.4633 Acc: 0.6444
val Loss: 2.1988 Acc: 0.6719
Epoch 12/80
----------
train Loss: 2.4495 Acc: 0.6477
val Loss: 2.6670 Acc: 0.7422
Epoch 13/80
----------
train Loss: 2.4607 Acc: 0.6344
val Loss: 6.5393 Acc: 0.2109
Epoch 14/80
----------
train Loss: 2.6611 Acc: 0.6043
val Loss: 2.8299 Acc: 0.6719
Epoch 15/80
----------
train Loss: 2.5706 Acc: 0.6060
val Loss: 2.6018 Acc: 0.6719
Epoch 16/80
----------
train Loss: 2.5825 Acc: 0.6043
val Loss: 2.6941 Acc: 0.6719
Epoch 17/80
----------
train Loss: 2.5603 Acc: 0.6027
[I 2024-10-15 12:07:21,431] Trial 19 finished with value: 0.7421875 and parameters: {'batch_size': 110, 'lr': 0.0006723198044179459, 'num_epochs': 80, 'weight_decay': 0.4649640334371963, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 2.4186 Acc: 0.6719
Early stopping at epoch 17 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.742188
Model weights saved at ./model_weights/ResNet34_bs_110_lr_0.0006723198044179459_epoch_80_wd_0.4649640334371963_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/74
----------
train Loss: 0.7163 Acc: 0.1252
val Loss: 0.7045 Acc: 0.1484
Epoch 2/74
----------
train Loss: 0.6724 Acc: 0.1836
val Loss: 0.6474 Acc: 0.2578
Epoch 3/74
----------
train Loss: 0.6430 Acc: 0.2654
val Loss: 0.6113 Acc: 0.3750
Epoch 4/74
----------
train Loss: 0.6079 Acc: 0.4040
val Loss: 0.5871 Acc: 0.4453
Epoch 5/74
----------
train Loss: 0.5821 Acc: 0.5192
val Loss: 0.5566 Acc: 0.5156
Epoch 6/74
----------
train Loss: 0.5585 Acc: 0.5659
val Loss: 0.5399 Acc: 0.5703
Epoch 7/74
----------
train Loss: 0.5366 Acc: 0.5927
val Loss: 0.5186 Acc: 0.6094
Epoch 8/74
----------
train Loss: 0.5240 Acc: 0.6511
val Loss: 0.4987 Acc: 0.6250
Epoch 9/74
----------
train Loss: 0.4919 Acc: 0.7245
val Loss: 0.4835 Acc: 0.6406
Epoch 10/74
----------
train Loss: 0.4766 Acc: 0.7195
val Loss: 0.4626 Acc: 0.6797
Epoch 11/74
----------
train Loss: 0.4638 Acc: 0.7513
val Loss: 0.4481 Acc: 0.7109
Epoch 12/74
----------
train Loss: 0.4448 Acc: 0.7613
val Loss: 0.4363 Acc: 0.7109
Epoch 13/74
----------
train Loss: 0.4411 Acc: 0.7679
val Loss: 0.4266 Acc: 0.7188
Epoch 14/74
----------
train Loss: 0.4265 Acc: 0.7947
val Loss: 0.4124 Acc: 0.7266
Epoch 15/74
----------
train Loss: 0.4074 Acc: 0.7947
val Loss: 0.4035 Acc: 0.7344
Epoch 16/74
----------
train Loss: 0.3951 Acc: 0.8164
val Loss: 0.3943 Acc: 0.7344
Epoch 17/74
----------
train Loss: 0.3766 Acc: 0.7997
val Loss: 0.3871 Acc: 0.7500
Epoch 18/74
----------
train Loss: 0.3822 Acc: 0.7813
val Loss: 0.3789 Acc: 0.7656
Epoch 19/74
----------
train Loss: 0.3593 Acc: 0.8414
val Loss: 0.3724 Acc: 0.7500
Epoch 20/74
----------
train Loss: 0.3489 Acc: 0.8214
val Loss: 0.3661 Acc: 0.7656
Epoch 21/74
----------
train Loss: 0.3337 Acc: 0.8531
val Loss: 0.3611 Acc: 0.7656
Epoch 22/74
----------
train Loss: 0.3304 Acc: 0.8598
val Loss: 0.3566 Acc: 0.7734
Epoch 23/74
----------
train Loss: 0.3393 Acc: 0.8531
val Loss: 0.3496 Acc: 0.7578
Epoch 24/74
----------
train Loss: 0.3019 Acc: 0.8698
val Loss: 0.3451 Acc: 0.7656
Epoch 25/74
----------
train Loss: 0.3233 Acc: 0.8664
val Loss: 0.3409 Acc: 0.7734
Epoch 26/74
----------
train Loss: 0.3412 Acc: 0.8214
val Loss: 0.3398 Acc: 0.7500
Epoch 27/74
----------
train Loss: 0.2999 Acc: 0.8681
val Loss: 0.3359 Acc: 0.7422
Epoch 28/74
----------
train Loss: 0.3173 Acc: 0.8614
val Loss: 0.3300 Acc: 0.7500
Epoch 29/74
----------
train Loss: 0.2911 Acc: 0.8915
val Loss: 0.3278 Acc: 0.7578
Epoch 30/74
----------
train Loss: 0.2708 Acc: 0.8982
val Loss: 0.3255 Acc: 0.7578
Epoch 31/74
----------
train Loss: 0.3069 Acc: 0.8815
val Loss: 0.3220 Acc: 0.7578
Epoch 32/74
----------
train Loss: 0.2970 Acc: 0.8297
val Loss: 0.3219 Acc: 0.7422
Epoch 33/74
----------
train Loss: 0.2764 Acc: 0.8998
val Loss: 0.3162 Acc: 0.7266
Epoch 34/74
----------
train Loss: 0.3071 Acc: 0.8581
val Loss: 0.3192 Acc: 0.7266
Epoch 35/74
----------
train Loss: 0.2762 Acc: 0.8748
val Loss: 0.3157 Acc: 0.7344
Epoch 36/74
----------
train Loss: 0.2791 Acc: 0.8481
val Loss: 0.3132 Acc: 0.7344
Epoch 37/74
----------
train Loss: 0.2615 Acc: 0.8898
val Loss: 0.3136 Acc: 0.7344
Epoch 38/74
----------
train Loss: 0.2565 Acc: 0.9165
val Loss: 0.3081 Acc: 0.7422
Epoch 39/74
----------
train Loss: 0.2653 Acc: 0.8765
val Loss: 0.3074 Acc: 0.7578
Epoch 40/74
----------
train Loss: 0.3100 Acc: 0.8331
val Loss: 0.3143 Acc: 0.7578
Epoch 41/74
----------
train Loss: 0.2544 Acc: 0.9015
val Loss: 0.3083 Acc: 0.7578
Epoch 42/74
----------
train Loss: 0.2584 Acc: 0.9032
val Loss: 0.3099 Acc: 0.7656
Epoch 43/74
----------
train Loss: 0.2690 Acc: 0.8197
val Loss: 0.3078 Acc: 0.7266
Epoch 44/74
----------
train Loss: 0.2795 Acc: 0.8497
val Loss: 0.3096 Acc: 0.7422
Epoch 45/74
----------
train Loss: 0.2721 Acc: 0.8915
val Loss: 0.3068 Acc: 0.7422
Epoch 46/74
----------
train Loss: 0.2523 Acc: 0.8815
val Loss: 0.3043 Acc: 0.7422
Epoch 47/74
----------
train Loss: 0.2491 Acc: 0.8815
val Loss: 0.3007 Acc: 0.7422
Epoch 48/74
----------
train Loss: 0.2349 Acc: 0.9249
val Loss: 0.3030 Acc: 0.7344
Epoch 49/74
----------
train Loss: 0.2449 Acc: 0.9115
val Loss: 0.3025 Acc: 0.7500
Epoch 50/74
----------
train Loss: 0.2587 Acc: 0.8898
val Loss: 0.3030 Acc: 0.7578
Epoch 51/74
----------
train Loss: 0.2330 Acc: 0.9132
val Loss: 0.3001 Acc: 0.7422
Epoch 52/74
----------
train Loss: 0.2572 Acc: 0.8781
val Loss: 0.3001 Acc: 0.7422
Epoch 53/74
----------
train Loss: 0.2531 Acc: 0.8598
val Loss: 0.3021 Acc: 0.7500
Epoch 54/74
----------
train Loss: 0.2306 Acc: 0.9098
val Loss: 0.3001 Acc: 0.7500
Epoch 55/74
----------
train Loss: 0.2463 Acc: 0.9149
val Loss: 0.3019 Acc: 0.7422
Epoch 56/74
----------
train Loss: 0.2257 Acc: 0.9232
val Loss: 0.3029 Acc: 0.7422
Epoch 57/74
----------
train Loss: 0.2364 Acc: 0.9098
val Loss: 0.3028 Acc: 0.7422
Epoch 58/74
----------
train Loss: 0.2518 Acc: 0.9115
val Loss: 0.3031 Acc: 0.7344
Epoch 59/74
----------
train Loss: 0.2409 Acc: 0.8898
val Loss: 0.3025 Acc: 0.7422
Epoch 60/74
----------
train Loss: 0.2463 Acc: 0.8815
val Loss: 0.2991 Acc: 0.7422
Epoch 61/74
----------
train Loss: 0.2297 Acc: 0.9015
val Loss: 0.2982 Acc: 0.7422
Epoch 62/74
----------
train Loss: 0.2338 Acc: 0.8881
val Loss: 0.2982 Acc: 0.7500
Epoch 63/74
----------
train Loss: 0.1964 Acc: 0.9716
val Loss: 0.2992 Acc: 0.7500
Epoch 64/74
----------
train Loss: 0.2505 Acc: 0.9032
val Loss: 0.2974 Acc: 0.7500
Epoch 65/74
----------
train Loss: 0.2289 Acc: 0.9332
val Loss: 0.2913 Acc: 0.7500
Epoch 66/74
----------
train Loss: 0.2298 Acc: 0.9282
val Loss: 0.2909 Acc: 0.7500
Epoch 67/74
----------
train Loss: 0.2313 Acc: 0.9366
val Loss: 0.2967 Acc: 0.7578
Epoch 68/74
----------
train Loss: 0.2155 Acc: 0.8798
val Loss: 0.2940 Acc: 0.7500
Epoch 69/74
----------
train Loss: 0.2535 Acc: 0.8865
val Loss: 0.2961 Acc: 0.7422
Epoch 70/74
----------
train Loss: 0.2042 Acc: 0.9382
val Loss: 0.2993 Acc: 0.7500
Epoch 71/74
----------
train Loss: 0.2222 Acc: 0.9115
val Loss: 0.2983 Acc: 0.7422
Epoch 72/74
----------
train Loss: 0.2566 Acc: 0.8447
val Loss: 0.2981 Acc: 0.7422
Epoch 73/74
----------
train Loss: 0.2188 Acc: 0.9366
val Loss: 0.2989 Acc: 0.7344
Epoch 74/74
----------
train Loss: 0.2157 Acc: 0.9215
[I 2024-10-15 12:12:53,298] Trial 20 finished with value: 0.7421875 and parameters: {'batch_size': 57, 'lr': 3.835133798248069e-06, 'num_epochs': 74, 'weight_decay': 0.0006029659015195192, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 0.2952 Acc: 0.7422
Best val Acc: 0.742188
Model weights saved at ./model_weights/ResNet34_bs_57_lr_3.835133798248069e-06_epoch_74_wd_0.0006029659015195192_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/57
----------
train Loss: 0.6496 Acc: 0.4758
val Loss: 0.5741 Acc: 0.7344
Epoch 2/57
----------
train Loss: 0.5540 Acc: 0.6628
val Loss: 0.4735 Acc: 0.8047
Epoch 3/57
----------
train Loss: 0.4792 Acc: 0.7279
val Loss: 0.4163 Acc: 0.8047
Epoch 4/57
----------
train Loss: 0.4313 Acc: 0.7446
val Loss: 0.3735 Acc: 0.8125
Epoch 5/57
----------
train Loss: 0.3928 Acc: 0.7780
val Loss: 0.3342 Acc: 0.8125
Epoch 6/57
----------
train Loss: 0.3649 Acc: 0.8013
val Loss: 0.3131 Acc: 0.8281
Epoch 7/57
----------
train Loss: 0.3431 Acc: 0.7746
val Loss: 0.2982 Acc: 0.8359
Epoch 8/57
----------
train Loss: 0.3110 Acc: 0.8297
val Loss: 0.2762 Acc: 0.8438
Epoch 9/57
----------
train Loss: 0.3314 Acc: 0.8130
val Loss: 0.2824 Acc: 0.8203
Epoch 10/57
----------
train Loss: 0.3149 Acc: 0.8364
val Loss: 0.2717 Acc: 0.8203
Epoch 11/57
----------
train Loss: 0.2921 Acc: 0.8447
val Loss: 0.2661 Acc: 0.8281
Epoch 12/57
----------
train Loss: 0.2983 Acc: 0.8464
val Loss: 0.2632 Acc: 0.8203
Epoch 13/57
----------
train Loss: 0.2736 Acc: 0.8848
val Loss: 0.2598 Acc: 0.8281
Epoch 14/57
----------
train Loss: 0.2770 Acc: 0.8831
val Loss: 0.2524 Acc: 0.8281
Epoch 15/57
----------
train Loss: 0.2842 Acc: 0.8698
val Loss: 0.2438 Acc: 0.8359
Epoch 16/57
----------
train Loss: 0.2642 Acc: 0.8848
val Loss: 0.2403 Acc: 0.8516
Epoch 17/57
----------
train Loss: 0.2280 Acc: 0.9165
val Loss: 0.2319 Acc: 0.8516
Epoch 18/57
----------
train Loss: 0.2664 Acc: 0.8848
val Loss: 0.2356 Acc: 0.8516
Epoch 19/57
----------
train Loss: 0.2520 Acc: 0.8865
val Loss: 0.2395 Acc: 0.8516
Epoch 20/57
----------
train Loss: 0.2519 Acc: 0.9516
val Loss: 0.2278 Acc: 0.8516
Epoch 21/57
----------
train Loss: 0.2423 Acc: 0.8698
val Loss: 0.2298 Acc: 0.8516
Epoch 22/57
----------
train Loss: 0.2467 Acc: 0.8998
val Loss: 0.2291 Acc: 0.8672
Epoch 23/57
----------
train Loss: 0.2217 Acc: 0.9082
val Loss: 0.2189 Acc: 0.8750
Epoch 24/57
----------
train Loss: 0.2132 Acc: 0.9199
val Loss: 0.2268 Acc: 0.8516
Epoch 25/57
----------
train Loss: 0.2440 Acc: 0.8915
val Loss: 0.2269 Acc: 0.8438
Epoch 26/57
----------
train Loss: 0.2104 Acc: 0.9432
val Loss: 0.2222 Acc: 0.8047
Epoch 27/57
----------
train Loss: 0.2543 Acc: 0.8865
val Loss: 0.2279 Acc: 0.8281
Epoch 28/57
----------
train Loss: 0.2486 Acc: 0.9082
val Loss: 0.2173 Acc: 0.8438
Epoch 29/57
----------
train Loss: 0.2042 Acc: 0.9299
val Loss: 0.2206 Acc: 0.8438
Epoch 30/57
----------
train Loss: 0.2598 Acc: 0.8915
val Loss: 0.2305 Acc: 0.8203
Epoch 31/57
----------
train Loss: 0.2302 Acc: 0.8998
val Loss: 0.2153 Acc: 0.8438
Epoch 32/57
----------
train Loss: 0.2269 Acc: 0.8982
val Loss: 0.2176 Acc: 0.8594
Epoch 33/57
----------
train Loss: 0.2227 Acc: 0.9048
val Loss: 0.2152 Acc: 0.8672
Epoch 34/57
----------
train Loss: 0.2057 Acc: 0.9182
val Loss: 0.2106 Acc: 0.8594
Epoch 35/57
----------
train Loss: 0.2140 Acc: 0.9232
val Loss: 0.2252 Acc: 0.8203
Epoch 36/57
----------
train Loss: 0.1825 Acc: 0.9533
val Loss: 0.2179 Acc: 0.8516
Epoch 37/57
----------
train Loss: 0.2304 Acc: 0.9082
val Loss: 0.2173 Acc: 0.8438
Epoch 38/57
----------
train Loss: 0.2521 Acc: 0.8497
val Loss: 0.2173 Acc: 0.8359
Epoch 39/57
----------
train Loss: 0.1925 Acc: 0.9366
val Loss: 0.2113 Acc: 0.8438
Epoch 40/57
----------
train Loss: 0.2043 Acc: 0.9115
val Loss: 0.2167 Acc: 0.8359
Epoch 41/57
----------
train Loss: 0.2020 Acc: 0.9265
val Loss: 0.2251 Acc: 0.8281
Epoch 42/57
----------
train Loss: 0.2513 Acc: 0.8831
val Loss: 0.2303 Acc: 0.8438
Epoch 43/57
----------
train Loss: 0.2229 Acc: 0.9299
val Loss: 0.2268 Acc: 0.8438
Epoch 44/57
----------
train Loss: 0.2098 Acc: 0.9182
val Loss: 0.2166 Acc: 0.8516
Epoch 45/57
----------
train Loss: 0.2240 Acc: 0.8698
val Loss: 0.2202 Acc: 0.8281
Epoch 46/57
----------
train Loss: 0.2090 Acc: 0.9165
val Loss: 0.2189 Acc: 0.8281
Epoch 47/57
----------
train Loss: 0.2221 Acc: 0.9149
val Loss: 0.2269 Acc: 0.8359
Epoch 48/57
----------
train Loss: 0.2318 Acc: 0.8932
val Loss: 0.2182 Acc: 0.8281
Epoch 49/57
----------
train Loss: 0.2058 Acc: 0.9466
val Loss: 0.2241 Acc: 0.8203
Epoch 50/57
----------
train Loss: 0.2134 Acc: 0.9232
val Loss: 0.2243 Acc: 0.8281
Epoch 51/57
----------
train Loss: 0.2355 Acc: 0.9232
val Loss: 0.2180 Acc: 0.8359
Epoch 52/57
----------
train Loss: 0.2107 Acc: 0.9265
val Loss: 0.2211 Acc: 0.8203
Epoch 53/57
----------
train Loss: 0.2276 Acc: 0.9215
val Loss: 0.2231 Acc: 0.8594
Epoch 54/57
----------
train Loss: 0.2443 Acc: 0.8715
val Loss: 0.2314 Acc: 0.8438
Epoch 55/57
----------
train Loss: 0.2118 Acc: 0.8982
val Loss: 0.2178 Acc: 0.8359
Epoch 56/57
----------
train Loss: 0.1949 Acc: 0.9382
val Loss: 0.2232 Acc: 0.8438
Epoch 57/57
----------
train Loss: 0.2037 Acc: 0.9399
[I 2024-10-15 12:17:08,357] Trial 21 finished with value: 0.84375 and parameters: {'batch_size': 110, 'lr': 1.4124038723403745e-05, 'num_epochs': 57, 'weight_decay': 0.003961917924330487, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 0.2215 Acc: 0.8438
Best val Acc: 0.843750
Model weights saved at ./model_weights/ResNet34_bs_110_lr_1.4124038723403745e-05_epoch_57_wd_0.003961917924330487_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/56
----------
train Loss: 0.5338 Acc: 0.6060
val Loss: 0.4594 Acc: 0.6484
Epoch 2/56
----------
train Loss: 0.4635 Acc: 0.7145
val Loss: 0.4049 Acc: 0.7266
Epoch 3/56
----------
train Loss: 0.4265 Acc: 0.7513
val Loss: 0.3711 Acc: 0.7266
Epoch 4/56
----------
train Loss: 0.3929 Acc: 0.7763
val Loss: 0.3500 Acc: 0.7578
Epoch 5/56
----------
train Loss: 0.3666 Acc: 0.7613
val Loss: 0.3355 Acc: 0.7500
Epoch 6/56
----------
train Loss: 0.3288 Acc: 0.8130
val Loss: 0.3171 Acc: 0.7656
Epoch 7/56
----------
train Loss: 0.3142 Acc: 0.8431
val Loss: 0.3029 Acc: 0.7656
Epoch 8/56
----------
train Loss: 0.3117 Acc: 0.8481
val Loss: 0.2997 Acc: 0.7656
Epoch 9/56
----------
train Loss: 0.3039 Acc: 0.8230
val Loss: 0.2857 Acc: 0.7656
Epoch 10/56
----------
train Loss: 0.3080 Acc: 0.8314
val Loss: 0.2746 Acc: 0.7891
Epoch 11/56
----------
train Loss: 0.2967 Acc: 0.8397
val Loss: 0.2753 Acc: 0.7891
Epoch 12/56
----------
train Loss: 0.2945 Acc: 0.8598
val Loss: 0.2589 Acc: 0.8203
Epoch 13/56
----------
train Loss: 0.2550 Acc: 0.8748
val Loss: 0.2550 Acc: 0.7891
Epoch 14/56
----------
train Loss: 0.2795 Acc: 0.8497
val Loss: 0.2521 Acc: 0.7891
Epoch 15/56
----------
train Loss: 0.2434 Acc: 0.9149
val Loss: 0.2439 Acc: 0.7891
Epoch 16/56
----------
train Loss: 0.2562 Acc: 0.8848
val Loss: 0.2376 Acc: 0.8203
Epoch 17/56
----------
train Loss: 0.2567 Acc: 0.8381
val Loss: 0.2383 Acc: 0.8203
Epoch 18/56
----------
train Loss: 0.2302 Acc: 0.9082
val Loss: 0.2344 Acc: 0.7969
Epoch 19/56
----------
train Loss: 0.2163 Acc: 0.9265
val Loss: 0.2318 Acc: 0.8125
Epoch 20/56
----------
train Loss: 0.2374 Acc: 0.8848
val Loss: 0.2409 Acc: 0.7891
Epoch 21/56
----------
train Loss: 0.2489 Acc: 0.8965
val Loss: 0.2371 Acc: 0.7812
Epoch 22/56
----------
train Loss: 0.2541 Acc: 0.8564
val Loss: 0.2322 Acc: 0.8281
Epoch 23/56
----------
train Loss: 0.2266 Acc: 0.8982
val Loss: 0.2351 Acc: 0.7891
Epoch 24/56
----------
train Loss: 0.2254 Acc: 0.9199
val Loss: 0.2405 Acc: 0.7891
Epoch 25/56
----------
train Loss: 0.2329 Acc: 0.8898
val Loss: 0.2389 Acc: 0.8203
Epoch 26/56
----------
train Loss: 0.2139 Acc: 0.8982
val Loss: 0.2332 Acc: 0.8047
Epoch 27/56
----------
train Loss: 0.2393 Acc: 0.9115
val Loss: 0.2387 Acc: 0.8047
Epoch 28/56
----------
train Loss: 0.2267 Acc: 0.9232
val Loss: 0.2405 Acc: 0.7969
Epoch 29/56
----------
train Loss: 0.2398 Acc: 0.9132
val Loss: 0.2376 Acc: 0.8125
Epoch 30/56
----------
train Loss: 0.2342 Acc: 0.8831
val Loss: 0.2409 Acc: 0.7969
Epoch 31/56
----------
train Loss: 0.2065 Acc: 0.8982
val Loss: 0.2327 Acc: 0.7812
Epoch 32/56
----------
train Loss: 0.2116 Acc: 0.9499
val Loss: 0.2323 Acc: 0.7969
Epoch 33/56
----------
train Loss: 0.2315 Acc: 0.9182
val Loss: 0.2362 Acc: 0.8125
Epoch 34/56
----------
train Loss: 0.2184 Acc: 0.9015
val Loss: 0.2315 Acc: 0.7812
Epoch 35/56
----------
train Loss: 0.2266 Acc: 0.9098
val Loss: 0.2368 Acc: 0.7891
Epoch 36/56
----------
train Loss: 0.1910 Acc: 0.9249
val Loss: 0.2339 Acc: 0.7969
Epoch 37/56
----------
train Loss: 0.2202 Acc: 0.9482
val Loss: 0.2356 Acc: 0.8047
Epoch 38/56
----------
train Loss: 0.2218 Acc: 0.9282
val Loss: 0.2305 Acc: 0.8125
Epoch 39/56
----------
train Loss: 0.2064 Acc: 0.9399
val Loss: 0.2303 Acc: 0.7969
Epoch 40/56
----------
train Loss: 0.1849 Acc: 0.9416
val Loss: 0.2370 Acc: 0.7734
Epoch 41/56
----------
train Loss: 0.1961 Acc: 0.9466
val Loss: 0.2282 Acc: 0.8125
Epoch 42/56
----------
train Loss: 0.2108 Acc: 0.8865
val Loss: 0.2313 Acc: 0.7891
Epoch 43/56
----------
train Loss: 0.2324 Acc: 0.8848
val Loss: 0.2379 Acc: 0.7969
Epoch 44/56
----------
train Loss: 0.2039 Acc: 0.9432
val Loss: 0.2351 Acc: 0.7734
Epoch 45/56
----------
train Loss: 0.1862 Acc: 0.9249
val Loss: 0.2286 Acc: 0.7969
Epoch 46/56
----------
train Loss: 0.2425 Acc: 0.8948
val Loss: 0.2380 Acc: 0.7891
Epoch 47/56
----------
train Loss: 0.1943 Acc: 0.9683
val Loss: 0.2273 Acc: 0.7656
Epoch 48/56
----------
train Loss: 0.1789 Acc: 0.9566
val Loss: 0.2254 Acc: 0.7969
Epoch 49/56
----------
train Loss: 0.2290 Acc: 0.9115
val Loss: 0.2388 Acc: 0.7812
Epoch 50/56
----------
train Loss: 0.2007 Acc: 0.9366
val Loss: 0.2299 Acc: 0.8047
Epoch 51/56
----------
train Loss: 0.1987 Acc: 0.9165
val Loss: 0.2226 Acc: 0.8047
Epoch 52/56
----------
train Loss: 0.2272 Acc: 0.9332
val Loss: 0.2296 Acc: 0.8125
Epoch 53/56
----------
train Loss: 0.1701 Acc: 0.9432
val Loss: 0.2298 Acc: 0.7891
Epoch 54/56
----------
train Loss: 0.2164 Acc: 0.9549
val Loss: 0.2285 Acc: 0.7656
Epoch 55/56
----------
train Loss: 0.2106 Acc: 0.9366
val Loss: 0.2291 Acc: 0.7891
Epoch 56/56
----------
train Loss: 0.2214 Acc: 0.9232
[I 2024-10-15 12:21:19,598] Trial 22 finished with value: 0.78125 and parameters: {'batch_size': 100, 'lr': 1.332882537019046e-05, 'num_epochs': 56, 'weight_decay': 0.0037130031396019527, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 0.2409 Acc: 0.7812
Best val Acc: 0.781250
Model weights saved at ./model_weights/ResNet34_bs_100_lr_1.332882537019046e-05_epoch_56_wd_0.0037130031396019527_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/44
----------
train Loss: 0.4257 Acc: 0.6544
val Loss: 0.5104 Acc: 0.7578
Epoch 2/44
----------
train Loss: 0.3697 Acc: 0.7095
val Loss: 0.4424 Acc: 0.6875
Epoch 3/44
----------
train Loss: 0.3831 Acc: 0.6895
val Loss: 0.3843 Acc: 0.6328
Epoch 4/44
----------
train Loss: 0.3813 Acc: 0.7028
val Loss: 0.4087 Acc: 0.6484
Epoch 5/44
----------
train Loss: 0.3671 Acc: 0.7028
val Loss: 0.3916 Acc: 0.6172
Epoch 6/44
----------
train Loss: 0.3763 Acc: 0.6945
[I 2024-10-15 12:21:46,947] Trial 23 finished with value: 0.7578125 and parameters: {'batch_size': 128, 'lr': 0.0007520857827730049, 'num_epochs': 44, 'weight_decay': 0.011971075335903237, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 0.4742 Acc: 0.5859
Early stopping at epoch 6 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.757812
Model weights saved at ./model_weights/ResNet34_bs_128_lr_0.0007520857827730049_epoch_44_wd_0.011971075335903237_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/61
----------
train Loss: 0.6592 Acc: 0.4107
val Loss: 0.4766 Acc: 0.6562
Epoch 2/61
----------
train Loss: 0.3930 Acc: 0.7696
val Loss: 0.3191 Acc: 0.7812
Epoch 3/61
----------
train Loss: 0.3391 Acc: 0.7579
val Loss: 0.3070 Acc: 0.7344
Epoch 4/61
----------
train Loss: 0.3053 Acc: 0.7880
val Loss: 0.2975 Acc: 0.7422
Epoch 5/61
----------
train Loss: 0.2997 Acc: 0.8047
val Loss: 0.2825 Acc: 0.7812
Epoch 6/61
----------
train Loss: 0.2856 Acc: 0.8331
val Loss: 0.2666 Acc: 0.7734
Epoch 7/61
----------
train Loss: 0.2885 Acc: 0.8564
val Loss: 0.3192 Acc: 0.7031
Epoch 8/61
----------
train Loss: 0.2821 Acc: 0.8130
val Loss: 0.2840 Acc: 0.7578
Epoch 9/61
----------
train Loss: 0.2705 Acc: 0.8464
val Loss: 0.2553 Acc: 0.7656
Epoch 10/61
----------
train Loss: 0.2471 Acc: 0.8748
val Loss: 0.2653 Acc: 0.7891
Epoch 11/61
----------
train Loss: 0.2327 Acc: 0.8898
val Loss: 0.3019 Acc: 0.7109
Epoch 12/61
----------
train Loss: 0.2401 Acc: 0.8948
val Loss: 0.2886 Acc: 0.7500
Epoch 13/61
----------
train Loss: 0.2591 Acc: 0.8965
val Loss: 0.3175 Acc: 0.7266
Epoch 14/61
----------
train Loss: 0.2760 Acc: 0.8347
val Loss: 0.2637 Acc: 0.7969
Epoch 15/61
----------
train Loss: 0.2623 Acc: 0.8798
val Loss: 0.2879 Acc: 0.7188
Epoch 16/61
----------
train Loss: 0.2404 Acc: 0.8765
val Loss: 0.3088 Acc: 0.7422
Epoch 17/61
----------
train Loss: 0.2583 Acc: 0.8715
val Loss: 0.3074 Acc: 0.7266
Epoch 18/61
----------
train Loss: 0.2111 Acc: 0.9098
val Loss: 0.3213 Acc: 0.7344
Epoch 19/61
----------
train Loss: 0.2851 Acc: 0.8381
val Loss: 0.3064 Acc: 0.7734
Epoch 20/61
----------
train Loss: 0.2396 Acc: 0.8831
val Loss: 0.3539 Acc: 0.7266
Epoch 21/61
----------
train Loss: 0.2190 Acc: 0.8881
val Loss: 0.2552 Acc: 0.8203
Epoch 22/61
----------
train Loss: 0.2412 Acc: 0.9165
val Loss: 0.3220 Acc: 0.7031
Epoch 23/61
----------
train Loss: 0.2580 Acc: 0.8715
val Loss: 0.2847 Acc: 0.7500
Epoch 24/61
----------
train Loss: 0.2449 Acc: 0.8731
val Loss: 0.3104 Acc: 0.7578
Epoch 25/61
----------
train Loss: 0.2598 Acc: 0.8347
val Loss: 0.3027 Acc: 0.7656
Epoch 26/61
----------
train Loss: 0.2170 Acc: 0.9015
val Loss: 0.2734 Acc: 0.7969
Epoch 27/61
----------
train Loss: 0.2500 Acc: 0.8898
val Loss: 0.3019 Acc: 0.7891
Epoch 28/61
----------
train Loss: 0.2513 Acc: 0.8881
val Loss: 0.2992 Acc: 0.7734
Epoch 29/61
----------
train Loss: 0.2360 Acc: 0.8948
val Loss: 0.2991 Acc: 0.7578
Epoch 30/61
----------
train Loss: 0.2726 Acc: 0.8481
val Loss: 0.2568 Acc: 0.8125
Epoch 31/61
----------
train Loss: 0.2484 Acc: 0.8831
val Loss: 0.3293 Acc: 0.7578
Epoch 32/61
----------
train Loss: 0.2440 Acc: 0.8731
val Loss: 0.2916 Acc: 0.7500
Epoch 33/61
----------
train Loss: 0.2905 Acc: 0.8264
val Loss: 0.2816 Acc: 0.7656
Epoch 34/61
----------
train Loss: 0.2464 Acc: 0.8815
val Loss: 0.3274 Acc: 0.7188
Epoch 35/61
----------
train Loss: 0.2147 Acc: 0.8881
val Loss: 0.3107 Acc: 0.7578
Epoch 36/61
----------
train Loss: 0.2707 Acc: 0.8230
val Loss: 0.3985 Acc: 0.7188
Epoch 37/61
----------
train Loss: 0.2347 Acc: 0.8698
val Loss: 0.3474 Acc: 0.7422
Epoch 38/61
----------
train Loss: 0.2449 Acc: 0.8848
val Loss: 0.2624 Acc: 0.8281
Epoch 39/61
----------
train Loss: 0.2296 Acc: 0.8982
val Loss: 0.3062 Acc: 0.7500
Epoch 40/61
----------
train Loss: 0.2625 Acc: 0.8497
val Loss: 0.3941 Acc: 0.6172
Epoch 41/61
----------
train Loss: 0.2397 Acc: 0.8915
val Loss: 0.2707 Acc: 0.7891
Epoch 42/61
----------
train Loss: 0.2213 Acc: 0.8915
val Loss: 0.5576 Acc: 0.6641
Epoch 43/61
----------
train Loss: 0.2521 Acc: 0.8664
val Loss: 0.2832 Acc: 0.7734
Epoch 44/61
----------
train Loss: 0.2354 Acc: 0.9015
val Loss: 0.2990 Acc: 0.7422
Epoch 45/61
----------
train Loss: 0.2377 Acc: 0.8614
val Loss: 0.4321 Acc: 0.7188
Epoch 46/61
----------
train Loss: 0.2589 Acc: 0.8514
val Loss: 0.7583 Acc: 0.6484
Epoch 47/61
----------
train Loss: 0.2256 Acc: 0.9132
val Loss: 0.2839 Acc: 0.7812
Epoch 48/61
----------
train Loss: 0.2637 Acc: 0.8648
val Loss: 0.3135 Acc: 0.7188
Epoch 49/61
----------
train Loss: 0.2237 Acc: 0.9048
val Loss: 0.2841 Acc: 0.7578
Epoch 50/61
----------
train Loss: 0.2526 Acc: 0.8447
val Loss: 0.2891 Acc: 0.7969
Epoch 51/61
----------
train Loss: 0.2652 Acc: 0.8614
val Loss: 0.3084 Acc: 0.7578
Epoch 52/61
----------
train Loss: 0.2545 Acc: 0.8865
val Loss: 0.3148 Acc: 0.7656
Epoch 53/61
----------
train Loss: 0.2369 Acc: 0.8748
val Loss: 0.3412 Acc: 0.7188
Epoch 54/61
----------
train Loss: 0.2438 Acc: 0.8715
val Loss: 0.3079 Acc: 0.7422
Epoch 55/61
----------
train Loss: 0.2524 Acc: 0.8548
val Loss: 0.2863 Acc: 0.7344
Epoch 56/61
----------
train Loss: 0.2450 Acc: 0.8915
val Loss: 0.2916 Acc: 0.7500
Epoch 57/61
----------
train Loss: 0.2568 Acc: 0.8815
val Loss: 0.2959 Acc: 0.7734
Epoch 58/61
----------
train Loss: 0.2584 Acc: 0.8297
val Loss: 0.3398 Acc: 0.7266
Epoch 59/61
----------
train Loss: 0.2549 Acc: 0.8865
val Loss: 0.3079 Acc: 0.7578
Epoch 60/61
----------
train Loss: 0.2428 Acc: 0.9048
val Loss: 0.3300 Acc: 0.7109
Epoch 61/61
----------
train Loss: 0.2606 Acc: 0.8765
[I 2024-10-15 12:26:22,791] Trial 24 finished with value: 0.78125 and parameters: {'batch_size': 75, 'lr': 9.018553423219672e-05, 'num_epochs': 61, 'weight_decay': 0.0359581950807546, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 0.2690 Acc: 0.7812
Best val Acc: 0.781250
Model weights saved at ./model_weights/ResNet34_bs_75_lr_9.018553423219672e-05_epoch_61_wd_0.0359581950807546_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/51
----------
train Loss: 0.6915 Acc: 0.2154
val Loss: 0.6687 Acc: 0.3906
Epoch 2/51
----------
train Loss: 0.6546 Acc: 0.3105
val Loss: 0.6304 Acc: 0.4844
Epoch 3/51
----------
train Loss: 0.6249 Acc: 0.4508
val Loss: 0.6017 Acc: 0.5312
Epoch 4/51
----------
train Loss: 0.6010 Acc: 0.5376
val Loss: 0.5714 Acc: 0.5625
Epoch 5/51
----------
train Loss: 0.5687 Acc: 0.6511
val Loss: 0.5483 Acc: 0.5703
Epoch 6/51
----------
train Loss: 0.5346 Acc: 0.6928
val Loss: 0.5213 Acc: 0.6484
Epoch 7/51
----------
train Loss: 0.5172 Acc: 0.7062
val Loss: 0.4949 Acc: 0.6719
Epoch 8/51
----------
train Loss: 0.5105 Acc: 0.7095
val Loss: 0.4845 Acc: 0.6719
Epoch 9/51
----------
train Loss: 0.4799 Acc: 0.7479
val Loss: 0.4606 Acc: 0.7109
Epoch 10/51
----------
train Loss: 0.4854 Acc: 0.7179
val Loss: 0.4444 Acc: 0.7266
Epoch 11/51
----------
train Loss: 0.4545 Acc: 0.7563
val Loss: 0.4279 Acc: 0.7344
Epoch 12/51
----------
train Loss: 0.4559 Acc: 0.7379
val Loss: 0.4087 Acc: 0.7578
Epoch 13/51
----------
train Loss: 0.4355 Acc: 0.7830
val Loss: 0.3996 Acc: 0.7500
Epoch 14/51
----------
train Loss: 0.4178 Acc: 0.7913
val Loss: 0.3900 Acc: 0.7578
Epoch 15/51
----------
train Loss: 0.4056 Acc: 0.7947
val Loss: 0.3753 Acc: 0.7734
Epoch 16/51
----------
train Loss: 0.3779 Acc: 0.8197
val Loss: 0.3642 Acc: 0.7734
Epoch 17/51
----------
train Loss: 0.3802 Acc: 0.8381
val Loss: 0.3552 Acc: 0.7734
Epoch 18/51
----------
train Loss: 0.3578 Acc: 0.8397
val Loss: 0.3458 Acc: 0.7734
Epoch 19/51
----------
train Loss: 0.3631 Acc: 0.8314
val Loss: 0.3396 Acc: 0.7656
Epoch 20/51
----------
train Loss: 0.3867 Acc: 0.7947
val Loss: 0.3283 Acc: 0.7734
Epoch 21/51
----------
train Loss: 0.3492 Acc: 0.8564
val Loss: 0.3179 Acc: 0.8047
Epoch 22/51
----------
train Loss: 0.3572 Acc: 0.8047
val Loss: 0.3148 Acc: 0.7891
Epoch 23/51
----------
train Loss: 0.3513 Acc: 0.8314
val Loss: 0.3122 Acc: 0.7969
Epoch 24/51
----------
train Loss: 0.3461 Acc: 0.8214
val Loss: 0.3057 Acc: 0.8047
Epoch 25/51
----------
train Loss: 0.3407 Acc: 0.8331
val Loss: 0.3001 Acc: 0.8125
Epoch 26/51
----------
train Loss: 0.3329 Acc: 0.8247
val Loss: 0.2935 Acc: 0.8359
Epoch 27/51
----------
train Loss: 0.3408 Acc: 0.8197
val Loss: 0.2942 Acc: 0.8047
Epoch 28/51
----------
train Loss: 0.3123 Acc: 0.8431
val Loss: 0.2871 Acc: 0.8125
Epoch 29/51
----------
train Loss: 0.3165 Acc: 0.8497
val Loss: 0.2793 Acc: 0.8125
Epoch 30/51
----------
train Loss: 0.3071 Acc: 0.8531
val Loss: 0.2759 Acc: 0.8203
Epoch 31/51
----------
train Loss: 0.2985 Acc: 0.8347
val Loss: 0.2690 Acc: 0.8359
Epoch 32/51
----------
train Loss: 0.2935 Acc: 0.8631
val Loss: 0.2625 Acc: 0.8359
Epoch 33/51
----------
train Loss: 0.3013 Acc: 0.8447
val Loss: 0.2618 Acc: 0.8359
Epoch 34/51
----------
train Loss: 0.2751 Acc: 0.9048
val Loss: 0.2588 Acc: 0.8359
Epoch 35/51
----------
train Loss: 0.2676 Acc: 0.9065
val Loss: 0.2551 Acc: 0.8359
Epoch 36/51
----------
train Loss: 0.3054 Acc: 0.8531
val Loss: 0.2555 Acc: 0.8438
Epoch 37/51
----------
train Loss: 0.2849 Acc: 0.8614
val Loss: 0.2525 Acc: 0.8359
Epoch 38/51
----------
train Loss: 0.2858 Acc: 0.8765
val Loss: 0.2526 Acc: 0.8359
Epoch 39/51
----------
train Loss: 0.2891 Acc: 0.8998
val Loss: 0.2508 Acc: 0.8281
Epoch 40/51
----------
train Loss: 0.3036 Acc: 0.8581
val Loss: 0.2514 Acc: 0.8359
Epoch 41/51
----------
train Loss: 0.2919 Acc: 0.8831
val Loss: 0.2512 Acc: 0.8359
Epoch 42/51
----------
train Loss: 0.2717 Acc: 0.8848
val Loss: 0.2491 Acc: 0.8438
Epoch 43/51
----------
train Loss: 0.2587 Acc: 0.9132
val Loss: 0.2474 Acc: 0.8359
Epoch 44/51
----------
train Loss: 0.2884 Acc: 0.8264
val Loss: 0.2402 Acc: 0.8516
Epoch 45/51
----------
train Loss: 0.2823 Acc: 0.8614
val Loss: 0.2418 Acc: 0.8438
Epoch 46/51
----------
train Loss: 0.2832 Acc: 0.8648
val Loss: 0.2428 Acc: 0.8516
Epoch 47/51
----------
train Loss: 0.2816 Acc: 0.8548
val Loss: 0.2369 Acc: 0.8516
Epoch 48/51
----------
train Loss: 0.2346 Acc: 0.9165
val Loss: 0.2356 Acc: 0.8438
Epoch 49/51
----------
train Loss: 0.2282 Acc: 0.9065
val Loss: 0.2326 Acc: 0.8516
Epoch 50/51
----------
train Loss: 0.2654 Acc: 0.8748
val Loss: 0.2307 Acc: 0.8438
Epoch 51/51
----------
train Loss: 0.2547 Acc: 0.9332
[I 2024-10-15 12:30:11,075] Trial 25 finished with value: 0.84375 and parameters: {'batch_size': 114, 'lr': 3.780412551136557e-06, 'num_epochs': 51, 'weight_decay': 0.002636211017683139, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 0.2297 Acc: 0.8438
Best val Acc: 0.843750
Model weights saved at ./model_weights/ResNet34_bs_114_lr_3.780412551136557e-06_epoch_51_wd_0.002636211017683139_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/33
----------
train Loss: 4.9603 Acc: 0.6828
val Loss: 3.8361 Acc: 0.7500
Epoch 2/33
----------
train Loss: 2.1365 Acc: 0.8381
val Loss: 2.8942 Acc: 0.7734
Epoch 3/33
----------
train Loss: 1.2007 Acc: 0.9098
val Loss: 2.6394 Acc: 0.8047
Epoch 4/33
----------
train Loss: 0.7205 Acc: 0.9566
val Loss: 2.6040 Acc: 0.8125
Epoch 5/33
----------
train Loss: 0.4278 Acc: 0.9816
val Loss: 2.5863 Acc: 0.8281
Epoch 6/33
----------
train Loss: 0.3042 Acc: 0.9950
val Loss: 2.5578 Acc: 0.8594
Epoch 7/33
----------
train Loss: 0.2354 Acc: 0.9967
val Loss: 2.6652 Acc: 0.8594
Epoch 8/33
----------
train Loss: 0.1465 Acc: 0.9983
val Loss: 2.6983 Acc: 0.8594
Epoch 9/33
----------
train Loss: 0.1197 Acc: 0.9983
val Loss: 2.7582 Acc: 0.8672
Epoch 10/33
----------
train Loss: 0.0972 Acc: 1.0000
val Loss: 2.8659 Acc: 0.8438
Epoch 11/33
----------
train Loss: 0.0845 Acc: 0.9983
val Loss: 2.7666 Acc: 0.8594
Epoch 12/33
----------
train Loss: 0.0855 Acc: 0.9983
val Loss: 2.8489 Acc: 0.8594
Epoch 13/33
----------
train Loss: 0.0662 Acc: 0.9983
val Loss: 2.9054 Acc: 0.8594
Epoch 14/33
----------
train Loss: 0.0596 Acc: 0.9983
val Loss: 3.0531 Acc: 0.8594
Epoch 15/33
----------
train Loss: 0.0498 Acc: 0.9983
val Loss: 3.0109 Acc: 0.8516
Epoch 16/33
----------
train Loss: 0.0441 Acc: 0.9983
val Loss: 3.1056 Acc: 0.8438
Epoch 17/33
----------
train Loss: 0.0443 Acc: 0.9983
val Loss: 3.1506 Acc: 0.8516
Epoch 18/33
----------
train Loss: 0.0444 Acc: 0.9983
val Loss: 3.1114 Acc: 0.8672
Epoch 19/33
----------
train Loss: 0.0370 Acc: 0.9983
val Loss: 3.2496 Acc: 0.8594
Epoch 20/33
----------
train Loss: 0.0399 Acc: 0.9983
val Loss: 3.3404 Acc: 0.8516
Epoch 21/33
----------
train Loss: 0.0273 Acc: 0.9983
val Loss: 3.3001 Acc: 0.8594
Epoch 22/33
----------
train Loss: 0.0329 Acc: 0.9983
val Loss: 3.1997 Acc: 0.8672
Epoch 23/33
----------
train Loss: 0.0348 Acc: 0.9983
val Loss: 3.3848 Acc: 0.8594
Epoch 24/33
----------
train Loss: 0.0296 Acc: 0.9983
val Loss: 3.3470 Acc: 0.8594
Epoch 25/33
----------
train Loss: 0.0291 Acc: 0.9983
val Loss: 3.3188 Acc: 0.8594
Epoch 26/33
----------
train Loss: 0.0302 Acc: 0.9983
val Loss: 3.4996 Acc: 0.8594
Epoch 27/33
----------
train Loss: 0.0265 Acc: 0.9983
val Loss: 3.4578 Acc: 0.8594
Epoch 28/33
----------
train Loss: 0.0208 Acc: 0.9983
val Loss: 3.5673 Acc: 0.8516
Epoch 29/33
----------
train Loss: 0.0215 Acc: 0.9983
val Loss: 3.5408 Acc: 0.8516
Epoch 30/33
----------
train Loss: 0.0224 Acc: 0.9983
val Loss: 3.6628 Acc: 0.8438
Epoch 31/33
----------
train Loss: 0.0257 Acc: 0.9983
val Loss: 3.6183 Acc: 0.8438
Epoch 32/33
----------
train Loss: 0.0199 Acc: 0.9983
val Loss: 3.5375 Acc: 0.8516
Epoch 33/33
----------
train Loss: 0.0180 Acc: 0.9983
[I 2024-10-15 12:32:39,760] Trial 26 finished with value: 0.8515625 and parameters: {'batch_size': 90, 'lr': 2.4142447165040012e-05, 'num_epochs': 33, 'weight_decay': 0.00088012963338807, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.875.
val Loss: 3.5071 Acc: 0.8516
Best val Acc: 0.851562
Model weights saved at ./model_weights/ResNet34_bs_90_lr_2.4142447165040012e-05_epoch_33_wd_0.00088012963338807_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/41
----------
train Loss: 0.5822 Acc: 0.4574
val Loss: 0.4121 Acc: 0.7656
Epoch 2/41
----------
train Loss: 0.3969 Acc: 0.7212
val Loss: 0.3110 Acc: 0.7969
Epoch 3/41
----------
train Loss: 0.3276 Acc: 0.7780
val Loss: 0.2651 Acc: 0.7969
Epoch 4/41
----------
train Loss: 0.3024 Acc: 0.8180
val Loss: 0.2511 Acc: 0.7969
Epoch 5/41
----------
train Loss: 0.3045 Acc: 0.8397
val Loss: 0.2585 Acc: 0.7891
Epoch 6/41
----------
train Loss: 0.3007 Acc: 0.8314
val Loss: 0.2347 Acc: 0.8516
Epoch 7/41
----------
train Loss: 0.3051 Acc: 0.8347
val Loss: 0.2186 Acc: 0.8438
Epoch 8/41
----------
train Loss: 0.2916 Acc: 0.8364
val Loss: 0.2686 Acc: 0.8125
Epoch 9/41
----------
train Loss: 0.2849 Acc: 0.8564
val Loss: 0.2118 Acc: 0.8516
Epoch 10/41
----------
train Loss: 0.2935 Acc: 0.8381
val Loss: 0.2465 Acc: 0.8438
Epoch 11/41
----------
train Loss: 0.2728 Acc: 0.8614
val Loss: 0.2465 Acc: 0.8125
Epoch 12/41
----------
train Loss: 0.2794 Acc: 0.8447
val Loss: 0.2520 Acc: 0.8125
Epoch 13/41
----------
train Loss: 0.2707 Acc: 0.8464
val Loss: 0.2294 Acc: 0.8047
Epoch 14/41
----------
train Loss: 0.2560 Acc: 0.8881
val Loss: 0.2218 Acc: 0.8281
Epoch 15/41
----------
train Loss: 0.2762 Acc: 0.8598
val Loss: 0.2265 Acc: 0.8203
Epoch 16/41
----------
train Loss: 0.2563 Acc: 0.9032
val Loss: 0.2621 Acc: 0.8203
Epoch 17/41
----------
train Loss: 0.2772 Acc: 0.8631
val Loss: 0.3089 Acc: 0.7422
Epoch 18/41
----------
train Loss: 0.2368 Acc: 0.8865
val Loss: 0.2068 Acc: 0.8359
Epoch 19/41
----------
train Loss: 0.2596 Acc: 0.8865
val Loss: 0.2055 Acc: 0.8672
Epoch 20/41
----------
train Loss: 0.2728 Acc: 0.8447
val Loss: 0.2242 Acc: 0.8359
Epoch 21/41
----------
train Loss: 0.2867 Acc: 0.8013
val Loss: 0.3076 Acc: 0.7422
Epoch 22/41
----------
train Loss: 0.2588 Acc: 0.8648
val Loss: 0.2836 Acc: 0.7344
Epoch 23/41
----------
train Loss: 0.2876 Acc: 0.8347
val Loss: 0.2232 Acc: 0.7891
Epoch 24/41
----------
train Loss: 0.2603 Acc: 0.8548
val Loss: 0.2081 Acc: 0.8125
Epoch 25/41
----------
train Loss: 0.2888 Acc: 0.8030
val Loss: 0.2597 Acc: 0.8438
Epoch 26/41
----------
train Loss: 0.2233 Acc: 0.8798
val Loss: 0.2468 Acc: 0.7969
Epoch 27/41
----------
train Loss: 0.2138 Acc: 0.9015
val Loss: 0.2178 Acc: 0.7969
Epoch 28/41
----------
train Loss: 0.2944 Acc: 0.8230
val Loss: 0.2304 Acc: 0.8672
Epoch 29/41
----------
train Loss: 0.2740 Acc: 0.8264
val Loss: 0.2730 Acc: 0.7969
Epoch 30/41
----------
train Loss: 0.2756 Acc: 0.8297
val Loss: 0.2650 Acc: 0.7500
Epoch 31/41
----------
train Loss: 0.2420 Acc: 0.8564
val Loss: 0.2071 Acc: 0.8125
Epoch 32/41
----------
train Loss: 0.2690 Acc: 0.8581
val Loss: 0.2498 Acc: 0.7891
Epoch 33/41
----------
train Loss: 0.2818 Acc: 0.8164
val Loss: 0.2267 Acc: 0.8203
Epoch 34/41
----------
train Loss: 0.2467 Acc: 0.8564
val Loss: 0.3128 Acc: 0.7500
Epoch 35/41
----------
train Loss: 0.2403 Acc: 0.8664
val Loss: 0.2946 Acc: 0.7422
Epoch 36/41
----------
train Loss: 0.2769 Acc: 0.8280
val Loss: 0.2772 Acc: 0.7656
Epoch 37/41
----------
train Loss: 0.2637 Acc: 0.8381
val Loss: 0.2618 Acc: 0.7969
Epoch 38/41
----------
train Loss: 0.2688 Acc: 0.8431
val Loss: 0.2426 Acc: 0.7812
Epoch 39/41
----------
train Loss: 0.2892 Acc: 0.8481
val Loss: 0.2723 Acc: 0.8359
Epoch 40/41
----------
train Loss: 0.2498 Acc: 0.8631
val Loss: 0.2396 Acc: 0.7812
Epoch 41/41
----------
train Loss: 0.2615 Acc: 0.8230
[I 2024-10-15 12:35:42,989] Trial 27 finished with value: 0.8125 and parameters: {'batch_size': 105, 'lr': 8.862325254053492e-05, 'num_epochs': 41, 'weight_decay': 0.05048940037705634, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 0.2303 Acc: 0.8125
Best val Acc: 0.812500
Model weights saved at ./model_weights/ResNet34_bs_105_lr_8.862325254053492e-05_epoch_41_wd_0.05048940037705634_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/52
----------
train Loss: 5.4827 Acc: 0.1152
val Loss: 5.9158 Acc: 0.1172
Epoch 2/52
----------
train Loss: 5.3451 Acc: 0.1786
val Loss: 5.5570 Acc: 0.0938
Epoch 3/52
----------
train Loss: 5.2901 Acc: 0.1503
val Loss: 5.4207 Acc: 0.1250
Epoch 4/52
----------
train Loss: 5.1837 Acc: 0.1836
val Loss: 5.3093 Acc: 0.1562
Epoch 5/52
----------
train Loss: 5.0693 Acc: 0.2170
val Loss: 5.2078 Acc: 0.1641
Epoch 6/52
----------
train Loss: 5.0155 Acc: 0.2104
val Loss: 5.2232 Acc: 0.1484
Epoch 7/52
----------
train Loss: 4.8956 Acc: 0.2554
val Loss: 5.0215 Acc: 0.1875
Epoch 8/52
----------
train Loss: 4.8008 Acc: 0.2805
val Loss: 4.8637 Acc: 0.2500
Epoch 9/52
----------
train Loss: 4.7390 Acc: 0.2955
val Loss: 4.8000 Acc: 0.2656
Epoch 10/52
----------
train Loss: 4.6273 Acc: 0.3088
val Loss: 4.7636 Acc: 0.2812
Epoch 11/52
----------
train Loss: 4.5918 Acc: 0.3523
val Loss: 4.6889 Acc: 0.3125
Epoch 12/52
----------
train Loss: 4.4791 Acc: 0.3689
val Loss: 4.6021 Acc: 0.3750
Epoch 13/52
----------
train Loss: 4.4100 Acc: 0.3957
val Loss: 4.4694 Acc: 0.4141
Epoch 14/52
----------
train Loss: 4.3564 Acc: 0.4257
val Loss: 4.4095 Acc: 0.4297
Epoch 15/52
----------
train Loss: 4.2897 Acc: 0.4257
val Loss: 4.3600 Acc: 0.4219
Epoch 16/52
----------
train Loss: 4.2255 Acc: 0.4942
val Loss: 4.2179 Acc: 0.4844
Epoch 17/52
----------
train Loss: 4.1745 Acc: 0.4925
val Loss: 4.2477 Acc: 0.4609
Epoch 18/52
----------
train Loss: 4.0287 Acc: 0.5559
val Loss: 4.1138 Acc: 0.5156
Epoch 19/52
----------
train Loss: 4.0029 Acc: 0.5192
val Loss: 4.0392 Acc: 0.5391
Epoch 20/52
----------
train Loss: 3.9171 Acc: 0.5760
val Loss: 4.0161 Acc: 0.5000
Epoch 21/52
----------
train Loss: 3.8818 Acc: 0.5760
val Loss: 3.9110 Acc: 0.5625
Epoch 22/52
----------
train Loss: 3.8132 Acc: 0.5810
val Loss: 3.8525 Acc: 0.5781
Epoch 23/52
----------
train Loss: 3.8048 Acc: 0.5927
val Loss: 3.8128 Acc: 0.5781
Epoch 24/52
----------
train Loss: 3.6661 Acc: 0.6427
val Loss: 3.7425 Acc: 0.5703
Epoch 25/52
----------
train Loss: 3.6679 Acc: 0.6277
val Loss: 3.6908 Acc: 0.6172
Epoch 26/52
----------
train Loss: 3.6200 Acc: 0.6260
val Loss: 3.6432 Acc: 0.6016
Epoch 27/52
----------
train Loss: 3.5275 Acc: 0.6611
val Loss: 3.5471 Acc: 0.6094
Epoch 28/52
----------
train Loss: 3.5159 Acc: 0.6461
val Loss: 3.5092 Acc: 0.6406
Epoch 29/52
----------
train Loss: 3.4508 Acc: 0.6778
val Loss: 3.4960 Acc: 0.6484
Epoch 30/52
----------
train Loss: 3.3796 Acc: 0.6845
val Loss: 3.3980 Acc: 0.6406
Epoch 31/52
----------
train Loss: 3.3249 Acc: 0.6711
val Loss: 3.3447 Acc: 0.6562
Epoch 32/52
----------
train Loss: 3.2421 Acc: 0.7095
val Loss: 3.2940 Acc: 0.6484
Epoch 33/52
----------
train Loss: 3.2509 Acc: 0.7062
val Loss: 3.2620 Acc: 0.6641
Epoch 34/52
----------
train Loss: 3.1957 Acc: 0.7078
val Loss: 3.2225 Acc: 0.6562
Epoch 35/52
----------
train Loss: 3.1498 Acc: 0.7045
val Loss: 3.1688 Acc: 0.6484
Epoch 36/52
----------
train Loss: 3.0983 Acc: 0.7262
val Loss: 3.1215 Acc: 0.6641
Epoch 37/52
----------
train Loss: 3.0792 Acc: 0.7329
val Loss: 3.0925 Acc: 0.6562
Epoch 38/52
----------
train Loss: 3.0668 Acc: 0.6745
val Loss: 3.0170 Acc: 0.6797
Epoch 39/52
----------
train Loss: 2.9455 Acc: 0.7613
val Loss: 2.9843 Acc: 0.6641
Epoch 40/52
----------
train Loss: 3.0197 Acc: 0.7162
val Loss: 2.9563 Acc: 0.6797
Epoch 41/52
----------
train Loss: 2.9567 Acc: 0.7078
val Loss: 2.9174 Acc: 0.6797
Epoch 42/52
----------
train Loss: 2.8815 Acc: 0.7446
val Loss: 2.8876 Acc: 0.6875
Epoch 43/52
----------
train Loss: 2.8351 Acc: 0.7112
val Loss: 2.8411 Acc: 0.7031
Epoch 44/52
----------
train Loss: 2.8275 Acc: 0.7412
val Loss: 2.8084 Acc: 0.7188
Epoch 45/52
----------
train Loss: 2.7958 Acc: 0.7629
val Loss: 2.7997 Acc: 0.7188
Epoch 46/52
----------
train Loss: 2.7396 Acc: 0.7596
val Loss: 2.7328 Acc: 0.6953
Epoch 47/52
----------
train Loss: 2.7580 Acc: 0.7262
val Loss: 2.7109 Acc: 0.7109
Epoch 48/52
----------
train Loss: 2.6709 Acc: 0.7396
val Loss: 2.6836 Acc: 0.7031
Epoch 49/52
----------
train Loss: 2.6535 Acc: 0.7596
val Loss: 2.6546 Acc: 0.7031
Epoch 50/52
----------
train Loss: 2.6586 Acc: 0.7496
val Loss: 2.6257 Acc: 0.6953
Epoch 51/52
----------
train Loss: 2.6044 Acc: 0.7429
val Loss: 2.5811 Acc: 0.6953
Epoch 52/52
----------
train Loss: 2.5277 Acc: 0.7746
[I 2024-10-15 12:39:35,871] Trial 28 finished with value: 0.703125 and parameters: {'batch_size': 119, 'lr': 1.0095992325736306e-06, 'num_epochs': 52, 'weight_decay': 0.006698117980680224, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 2.5509 Acc: 0.7031
Best val Acc: 0.703125
Model weights saved at ./model_weights/ResNet34_bs_119_lr_1.0095992325736306e-06_epoch_52_wd_0.006698117980680224_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/98
----------
train Loss: 1.8840 Acc: 0.1636
val Loss: 1.8337 Acc: 0.1406
Epoch 2/98
----------
train Loss: 1.7044 Acc: 0.1987
val Loss: 1.6986 Acc: 0.1797
Epoch 3/98
----------
train Loss: 1.5508 Acc: 0.2437
val Loss: 1.5833 Acc: 0.2031
Epoch 4/98
----------
train Loss: 1.4083 Acc: 0.3072
val Loss: 1.4687 Acc: 0.2734
Epoch 5/98
----------
train Loss: 1.2858 Acc: 0.4290
val Loss: 1.3529 Acc: 0.3438
Epoch 6/98
----------
train Loss: 1.1617 Acc: 0.5526
val Loss: 1.2789 Acc: 0.4766
Epoch 7/98
----------
train Loss: 1.0540 Acc: 0.6311
val Loss: 1.2000 Acc: 0.5234
Epoch 8/98
----------
train Loss: 0.9576 Acc: 0.7045
val Loss: 1.0968 Acc: 0.6172
Epoch 9/98
----------
train Loss: 0.8555 Acc: 0.7579
val Loss: 1.0402 Acc: 0.6719
Epoch 10/98
----------
train Loss: 0.7580 Acc: 0.8214
val Loss: 0.9328 Acc: 0.6875
Epoch 11/98
----------
train Loss: 0.7005 Acc: 0.8447
val Loss: 0.8723 Acc: 0.7500
Epoch 12/98
----------
train Loss: 0.6015 Acc: 0.8915
val Loss: 0.8187 Acc: 0.7734
Epoch 13/98
----------
train Loss: 0.5402 Acc: 0.9032
val Loss: 0.7827 Acc: 0.7734
Epoch 14/98
----------
train Loss: 0.4832 Acc: 0.9282
val Loss: 0.7294 Acc: 0.7734
Epoch 15/98
----------
train Loss: 0.4298 Acc: 0.9382
val Loss: 0.6950 Acc: 0.7812
Epoch 16/98
----------
train Loss: 0.3784 Acc: 0.9583
val Loss: 0.6485 Acc: 0.7969
Epoch 17/98
----------
train Loss: 0.3492 Acc: 0.9583
val Loss: 0.6457 Acc: 0.7812
Epoch 18/98
----------
train Loss: 0.3179 Acc: 0.9616
val Loss: 0.6238 Acc: 0.7656
Epoch 19/98
----------
train Loss: 0.2807 Acc: 0.9850
val Loss: 0.6110 Acc: 0.7656
Epoch 20/98
----------
train Loss: 0.2873 Acc: 0.9699
val Loss: 0.5930 Acc: 0.7734
Epoch 21/98
----------
train Loss: 0.2321 Acc: 0.9766
val Loss: 0.6000 Acc: 0.7812
Epoch 22/98
----------
train Loss: 0.2249 Acc: 0.9783
val Loss: 0.5877 Acc: 0.7812
Epoch 23/98
----------
train Loss: 0.1894 Acc: 0.9900
val Loss: 0.5619 Acc: 0.7734
Epoch 24/98
----------
train Loss: 0.1948 Acc: 0.9816
val Loss: 0.5550 Acc: 0.7812
Epoch 25/98
----------
train Loss: 0.1639 Acc: 0.9933
val Loss: 0.5557 Acc: 0.7812
Epoch 26/98
----------
train Loss: 0.1658 Acc: 0.9917
val Loss: 0.5394 Acc: 0.8047
Epoch 27/98
----------
train Loss: 0.1584 Acc: 0.9900
val Loss: 0.5290 Acc: 0.8125
Epoch 28/98
----------
train Loss: 0.1278 Acc: 0.9900
val Loss: 0.5421 Acc: 0.7891
Epoch 29/98
----------
train Loss: 0.1240 Acc: 0.9950
val Loss: 0.5397 Acc: 0.7969
Epoch 30/98
----------
train Loss: 0.1186 Acc: 0.9933
val Loss: 0.5382 Acc: 0.8047
Epoch 31/98
----------
train Loss: 0.1152 Acc: 0.9883
val Loss: 0.5579 Acc: 0.7969
Epoch 32/98
----------
train Loss: 0.1113 Acc: 0.9933
val Loss: 0.5347 Acc: 0.8125
Epoch 33/98
----------
train Loss: 0.1032 Acc: 0.9917
val Loss: 0.5187 Acc: 0.8047
Epoch 34/98
----------
train Loss: 0.0900 Acc: 0.9933
val Loss: 0.5345 Acc: 0.8125
Epoch 35/98
----------
train Loss: 0.0877 Acc: 0.9950
val Loss: 0.5356 Acc: 0.8047
Epoch 36/98
----------
train Loss: 0.0851 Acc: 0.9933
val Loss: 0.5396 Acc: 0.8125
Epoch 37/98
----------
train Loss: 0.0846 Acc: 0.9933
val Loss: 0.5231 Acc: 0.8125
Epoch 38/98
----------
train Loss: 0.0664 Acc: 0.9967
val Loss: 0.5190 Acc: 0.8281
Epoch 39/98
----------
train Loss: 0.0723 Acc: 0.9950
val Loss: 0.5225 Acc: 0.8125
Epoch 40/98
----------
train Loss: 0.0692 Acc: 0.9933
val Loss: 0.5362 Acc: 0.8047
Epoch 41/98
----------
train Loss: 0.0646 Acc: 0.9950
val Loss: 0.5235 Acc: 0.8125
Epoch 42/98
----------
train Loss: 0.0594 Acc: 0.9933
val Loss: 0.5230 Acc: 0.8125
Epoch 43/98
----------
train Loss: 0.0661 Acc: 0.9950
val Loss: 0.5239 Acc: 0.8203
Epoch 44/98
----------
train Loss: 0.0559 Acc: 0.9933
val Loss: 0.5357 Acc: 0.8125
Epoch 45/98
----------
train Loss: 0.0675 Acc: 0.9933
val Loss: 0.5417 Acc: 0.8125
Epoch 46/98
----------
train Loss: 0.0522 Acc: 0.9933
val Loss: 0.5232 Acc: 0.8281
Epoch 47/98
----------
train Loss: 0.0535 Acc: 0.9950
val Loss: 0.5198 Acc: 0.8281
Epoch 48/98
----------
train Loss: 0.0573 Acc: 0.9933
val Loss: 0.5381 Acc: 0.8125
Epoch 49/98
----------
train Loss: 0.0468 Acc: 0.9950
val Loss: 0.5264 Acc: 0.8203
Epoch 50/98
----------
train Loss: 0.0426 Acc: 0.9967
val Loss: 0.5220 Acc: 0.8281
Epoch 51/98
----------
train Loss: 0.0496 Acc: 0.9967
val Loss: 0.5325 Acc: 0.8125
Epoch 52/98
----------
train Loss: 0.0472 Acc: 0.9950
val Loss: 0.5501 Acc: 0.8125
Epoch 53/98
----------
train Loss: 0.0421 Acc: 0.9967
val Loss: 0.5402 Acc: 0.8281
Epoch 54/98
----------
train Loss: 0.0461 Acc: 0.9917
val Loss: 0.5287 Acc: 0.8359
Epoch 55/98
----------
train Loss: 0.0415 Acc: 0.9950
val Loss: 0.5195 Acc: 0.8203
Epoch 56/98
----------
train Loss: 0.0415 Acc: 0.9933
val Loss: 0.5296 Acc: 0.8281
Epoch 57/98
----------
train Loss: 0.0410 Acc: 0.9950
val Loss: 0.5227 Acc: 0.8359
Epoch 58/98
----------
train Loss: 0.0348 Acc: 0.9950
val Loss: 0.5291 Acc: 0.8359
Epoch 59/98
----------
train Loss: 0.0373 Acc: 0.9933
val Loss: 0.5267 Acc: 0.8359
Epoch 60/98
----------
train Loss: 0.0370 Acc: 0.9950
val Loss: 0.5449 Acc: 0.8125
Epoch 61/98
----------
train Loss: 0.0436 Acc: 0.9950
val Loss: 0.5227 Acc: 0.8359
Epoch 62/98
----------
train Loss: 0.0378 Acc: 0.9933
val Loss: 0.5441 Acc: 0.8203
Epoch 63/98
----------
train Loss: 0.0315 Acc: 0.9933
val Loss: 0.5319 Acc: 0.8203
Epoch 64/98
----------
train Loss: 0.0301 Acc: 0.9950
val Loss: 0.5356 Acc: 0.8203
Epoch 65/98
----------
train Loss: 0.0406 Acc: 0.9917
val Loss: 0.5467 Acc: 0.8203
Epoch 66/98
----------
train Loss: 0.0323 Acc: 0.9967
val Loss: 0.5448 Acc: 0.8125
Epoch 67/98
----------
train Loss: 0.0274 Acc: 0.9950
val Loss: 0.5554 Acc: 0.8047
Epoch 68/98
----------
train Loss: 0.0393 Acc: 0.9917
val Loss: 0.5304 Acc: 0.8281
Epoch 69/98
----------
train Loss: 0.0294 Acc: 0.9933
val Loss: 0.5441 Acc: 0.8125
Epoch 70/98
----------
train Loss: 0.0391 Acc: 0.9900
val Loss: 0.5426 Acc: 0.8281
Epoch 71/98
----------
train Loss: 0.0273 Acc: 0.9950
val Loss: 0.5345 Acc: 0.8281
Epoch 72/98
----------
train Loss: 0.0244 Acc: 0.9967
val Loss: 0.5342 Acc: 0.8281
Epoch 73/98
----------
train Loss: 0.0367 Acc: 0.9900
val Loss: 0.5499 Acc: 0.8203
Epoch 74/98
----------
train Loss: 0.0326 Acc: 0.9933
val Loss: 0.5533 Acc: 0.8203
Epoch 75/98
----------
train Loss: 0.0313 Acc: 0.9950
val Loss: 0.5343 Acc: 0.8281
Epoch 76/98
----------
train Loss: 0.0291 Acc: 0.9950
val Loss: 0.5338 Acc: 0.8203
Epoch 77/98
----------
train Loss: 0.0251 Acc: 0.9967
val Loss: 0.5330 Acc: 0.8281
Epoch 78/98
----------
train Loss: 0.0247 Acc: 0.9950
val Loss: 0.5395 Acc: 0.8203
Epoch 79/98
----------
train Loss: 0.0227 Acc: 0.9950
val Loss: 0.5344 Acc: 0.8203
Epoch 80/98
----------
train Loss: 0.0240 Acc: 0.9933
val Loss: 0.5377 Acc: 0.8203
Epoch 81/98
----------
train Loss: 0.0260 Acc: 0.9933
val Loss: 0.5349 Acc: 0.8203
Epoch 82/98
----------
train Loss: 0.0206 Acc: 0.9950
val Loss: 0.5388 Acc: 0.8203
Epoch 83/98
----------
train Loss: 0.0234 Acc: 0.9933
val Loss: 0.5364 Acc: 0.8359
Epoch 84/98
----------
train Loss: 0.0306 Acc: 0.9933
val Loss: 0.5546 Acc: 0.8281
Epoch 85/98
----------
train Loss: 0.0240 Acc: 0.9933
val Loss: 0.5440 Acc: 0.8203
Epoch 86/98
----------
train Loss: 0.0225 Acc: 0.9967
val Loss: 0.5407 Acc: 0.8281
Epoch 87/98
----------
train Loss: 0.0264 Acc: 0.9933
val Loss: 0.5480 Acc: 0.8203
Epoch 88/98
----------
train Loss: 0.0208 Acc: 0.9983
val Loss: 0.5434 Acc: 0.8125
Epoch 89/98
----------
train Loss: 0.0255 Acc: 0.9933
val Loss: 0.5499 Acc: 0.8203
Epoch 90/98
----------
train Loss: 0.0256 Acc: 0.9917
val Loss: 0.5451 Acc: 0.8203
Epoch 91/98
----------
train Loss: 0.0202 Acc: 0.9933
val Loss: 0.5538 Acc: 0.8203
Epoch 92/98
----------
train Loss: 0.0261 Acc: 0.9933
val Loss: 0.5453 Acc: 0.8281
Epoch 93/98
----------
train Loss: 0.0189 Acc: 0.9967
val Loss: 0.5549 Acc: 0.8203
Epoch 94/98
----------
train Loss: 0.0299 Acc: 0.9933
val Loss: 0.5485 Acc: 0.8203
Epoch 95/98
----------
train Loss: 0.0212 Acc: 0.9950
val Loss: 0.5432 Acc: 0.8203
Epoch 96/98
----------
train Loss: 0.0235 Acc: 0.9933
val Loss: 0.5436 Acc: 0.8125
Epoch 97/98
----------
train Loss: 0.0237 Acc: 0.9950
val Loss: 0.5387 Acc: 0.8281
Epoch 98/98
----------
train Loss: 0.0166 Acc: 0.9983
[I 2024-10-15 12:46:53,837] Trial 29 finished with value: 0.8359375 and parameters: {'batch_size': 90, 'lr': 2.633046401009932e-06, 'num_epochs': 98, 'weight_decay': 0.009116885742441273, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 9 with value: 0.875.
val Loss: 0.5397 Acc: 0.8359
Best val Acc: 0.835938
Model weights saved at ./model_weights/ResNet34_bs_90_lr_2.633046401009932e-06_epoch_98_wd_0.009116885742441273_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/31
----------
train Loss: 0.4543 Acc: 0.6210
val Loss: 0.5943 Acc: 0.4922
Epoch 2/31
----------
train Loss: 0.3726 Acc: 0.7112
val Loss: 0.3084 Acc: 0.7266
Epoch 3/31
----------
train Loss: 0.3392 Acc: 0.7312
val Loss: 0.2582 Acc: 0.7891
Epoch 4/31
----------
train Loss: 0.3391 Acc: 0.7362
val Loss: 0.2745 Acc: 0.7422
Epoch 5/31
----------
train Loss: 0.3246 Acc: 0.7446
val Loss: 0.3077 Acc: 0.7656
Epoch 6/31
----------
train Loss: 0.3308 Acc: 0.7513
val Loss: 0.2616 Acc: 0.7969
Epoch 7/31
----------
train Loss: 0.3083 Acc: 0.7880
val Loss: 0.2691 Acc: 0.7969
Epoch 8/31
----------
train Loss: 0.3090 Acc: 0.7980
val Loss: 0.2482 Acc: 0.8125
Epoch 9/31
----------
train Loss: 0.2853 Acc: 0.7997
val Loss: 0.2753 Acc: 0.7734
Epoch 10/31
----------
train Loss: 0.3008 Acc: 0.7846
val Loss: 0.2564 Acc: 0.8203
Epoch 11/31
----------
train Loss: 0.2755 Acc: 0.8114
val Loss: 0.3053 Acc: 0.7266
Epoch 12/31
----------
train Loss: 0.2978 Acc: 0.7713
val Loss: 0.2346 Acc: 0.8281
Epoch 13/31
----------
train Loss: 0.2506 Acc: 0.8664
val Loss: 0.2381 Acc: 0.8281
Epoch 14/31
----------
train Loss: 0.2655 Acc: 0.8598
val Loss: 0.2404 Acc: 0.8203
Epoch 15/31
----------
train Loss: 0.2686 Acc: 0.8548
val Loss: 0.2231 Acc: 0.8203
Epoch 16/31
----------
train Loss: 0.2731 Acc: 0.8798
val Loss: 0.2342 Acc: 0.8047
Epoch 17/31
----------
train Loss: 0.2773 Acc: 0.8180
val Loss: 0.2264 Acc: 0.8047
Epoch 18/31
----------
train Loss: 0.2393 Acc: 0.8464
val Loss: 0.2745 Acc: 0.7969
Epoch 19/31
----------
train Loss: 0.2478 Acc: 0.8648
val Loss: 0.2885 Acc: 0.7812
Epoch 20/31
----------
train Loss: 0.2387 Acc: 0.8715
val Loss: 0.2675 Acc: 0.8125
Epoch 21/31
----------
train Loss: 0.2688 Acc: 0.8247
val Loss: 0.2483 Acc: 0.8125
Epoch 22/31
----------
train Loss: 0.2693 Acc: 0.8297
val Loss: 0.2826 Acc: 0.7656
Epoch 23/31
----------
train Loss: 0.2477 Acc: 0.8614
val Loss: 0.2480 Acc: 0.8047
Epoch 24/31
----------
train Loss: 0.2359 Acc: 0.9098
val Loss: 0.2361 Acc: 0.8125
Epoch 25/31
----------
train Loss: 0.2465 Acc: 0.8831
val Loss: 0.3052 Acc: 0.7578
Epoch 26/31
----------
train Loss: 0.2704 Acc: 0.8598
val Loss: 0.2440 Acc: 0.8359
Epoch 27/31
----------
train Loss: 0.2299 Acc: 0.8998
val Loss: 0.2544 Acc: 0.8516
Epoch 28/31
----------
train Loss: 0.2548 Acc: 0.8431
val Loss: 0.2425 Acc: 0.7891
Epoch 29/31
----------
train Loss: 0.2575 Acc: 0.8581
val Loss: 0.2499 Acc: 0.8203
Epoch 30/31
----------
train Loss: 0.2338 Acc: 0.8431
val Loss: 0.2611 Acc: 0.8203
Epoch 31/31
----------
train Loss: 0.2372 Acc: 0.9132
[I 2024-10-15 12:49:12,374] Trial 30 finished with value: 0.8203125 and parameters: {'batch_size': 96, 'lr': 0.0006320404255422741, 'num_epochs': 31, 'weight_decay': 0.0003177483400564204, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 0.3831 Acc: 0.6562
Best val Acc: 0.820312
Model weights saved at ./model_weights/ResNet34_bs_96_lr_0.0006320404255422741_epoch_31_wd_0.0003177483400564204_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/39
----------
train Loss: 5.6029 Acc: 0.2337
val Loss: 4.2578 Acc: 0.3438
Epoch 2/39
----------
train Loss: 2.8747 Acc: 0.5743
val Loss: 3.3177 Acc: 0.6094
Epoch 3/39
----------
train Loss: 1.7118 Acc: 0.8013
val Loss: 2.9086 Acc: 0.7266
Epoch 4/39
----------
train Loss: 1.0523 Acc: 0.9065
val Loss: 2.7431 Acc: 0.8203
Epoch 5/39
----------
train Loss: 0.6887 Acc: 0.9549
val Loss: 2.6554 Acc: 0.8438
Epoch 6/39
----------
train Loss: 0.4309 Acc: 0.9866
val Loss: 2.7901 Acc: 0.8516
Epoch 7/39
----------
train Loss: 0.2696 Acc: 0.9983
val Loss: 2.7884 Acc: 0.8516
Epoch 8/39
----------
train Loss: 0.1862 Acc: 1.0000
val Loss: 2.9480 Acc: 0.8672
Epoch 9/39
----------
train Loss: 0.1417 Acc: 1.0000
val Loss: 3.0891 Acc: 0.8750
Epoch 10/39
----------
train Loss: 0.0968 Acc: 1.0000
val Loss: 3.2285 Acc: 0.8594
Epoch 11/39
----------
train Loss: 0.0901 Acc: 1.0000
val Loss: 3.2497 Acc: 0.8516
Epoch 12/39
----------
train Loss: 0.0762 Acc: 1.0000
val Loss: 3.3817 Acc: 0.8594
Epoch 13/39
----------
train Loss: 0.0840 Acc: 1.0000
val Loss: 3.4171 Acc: 0.8750
Epoch 14/39
----------
train Loss: 0.0737 Acc: 0.9983
val Loss: 3.3824 Acc: 0.8750
Epoch 15/39
----------
train Loss: 0.0445 Acc: 1.0000
val Loss: 3.4805 Acc: 0.8750
Epoch 16/39
----------
train Loss: 0.0473 Acc: 1.0000
val Loss: 3.5163 Acc: 0.8750
Epoch 17/39
----------
train Loss: 0.0438 Acc: 1.0000
val Loss: 3.7398 Acc: 0.8672
Epoch 18/39
----------
train Loss: 0.0383 Acc: 1.0000
val Loss: 3.9239 Acc: 0.8516
Epoch 19/39
----------
train Loss: 0.0311 Acc: 1.0000
val Loss: 3.6805 Acc: 0.8672
Epoch 20/39
----------
train Loss: 0.0381 Acc: 1.0000
val Loss: 3.7856 Acc: 0.8672
Epoch 21/39
----------
train Loss: 0.0235 Acc: 1.0000
val Loss: 3.8889 Acc: 0.8672
Epoch 22/39
----------
train Loss: 0.0210 Acc: 1.0000
val Loss: 4.1686 Acc: 0.8672
Epoch 23/39
----------
train Loss: 0.0213 Acc: 1.0000
val Loss: 4.0860 Acc: 0.8594
Epoch 24/39
----------
train Loss: 0.0207 Acc: 1.0000
val Loss: 4.0230 Acc: 0.8750
Epoch 25/39
----------
train Loss: 0.0169 Acc: 1.0000
val Loss: 4.2642 Acc: 0.8516
Epoch 26/39
----------
train Loss: 0.0179 Acc: 1.0000
val Loss: 4.5186 Acc: 0.8594
Epoch 27/39
----------
train Loss: 0.0217 Acc: 1.0000
val Loss: 4.3615 Acc: 0.8672
Epoch 28/39
----------
train Loss: 0.0187 Acc: 1.0000
val Loss: 4.0317 Acc: 0.8594
Epoch 29/39
----------
train Loss: 0.0150 Acc: 1.0000
val Loss: 3.9834 Acc: 0.8672
Epoch 30/39
----------
train Loss: 0.0117 Acc: 1.0000
val Loss: 4.2013 Acc: 0.8594
Epoch 31/39
----------
train Loss: 0.0125 Acc: 1.0000
val Loss: 4.3097 Acc: 0.8594
Epoch 32/39
----------
train Loss: 0.0176 Acc: 1.0000
val Loss: 4.3808 Acc: 0.8672
Epoch 33/39
----------
train Loss: 0.0209 Acc: 1.0000
val Loss: 4.4125 Acc: 0.8594
Epoch 34/39
----------
train Loss: 0.0163 Acc: 0.9983
val Loss: 4.2690 Acc: 0.8672
Epoch 35/39
----------
train Loss: 0.0251 Acc: 0.9983
val Loss: 4.3455 Acc: 0.8672
Epoch 36/39
----------
train Loss: 0.0427 Acc: 0.9983
val Loss: 4.4497 Acc: 0.8594
Epoch 37/39
----------
train Loss: 0.0168 Acc: 1.0000
val Loss: 5.0097 Acc: 0.8516
Epoch 38/39
----------
train Loss: 0.0109 Acc: 1.0000
val Loss: 4.9557 Acc: 0.8594
Epoch 39/39
----------
train Loss: 0.0128 Acc: 1.0000
[I 2024-10-15 12:52:06,859] Trial 31 finished with value: 0.8515625 and parameters: {'batch_size': 90, 'lr': 2.0790684959875016e-05, 'num_epochs': 39, 'weight_decay': 0.0007862593240667841, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.875.
val Loss: 5.0449 Acc: 0.8516
Best val Acc: 0.851562
Model weights saved at ./model_weights/ResNet34_bs_90_lr_2.0790684959875016e-05_epoch_39_wd_0.0007862593240667841_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/33
----------
train Loss: 5.7351 Acc: 0.3339
val Loss: 5.5644 Acc: 0.4453
Epoch 2/33
----------
train Loss: 4.1273 Acc: 0.5242
val Loss: 4.7869 Acc: 0.5312
Epoch 3/33
----------
train Loss: 3.1085 Acc: 0.6778
val Loss: 4.3001 Acc: 0.5859
Epoch 4/33
----------
train Loss: 2.4255 Acc: 0.7563
val Loss: 3.9113 Acc: 0.6484
Epoch 5/33
----------
train Loss: 1.9045 Acc: 0.8013
val Loss: 3.6505 Acc: 0.6875
Epoch 6/33
----------
train Loss: 1.5152 Acc: 0.8564
val Loss: 3.3801 Acc: 0.7031
Epoch 7/33
----------
train Loss: 1.2311 Acc: 0.8815
val Loss: 3.3114 Acc: 0.7109
Epoch 8/33
----------
train Loss: 1.0039 Acc: 0.9149
val Loss: 3.2091 Acc: 0.7188
Epoch 9/33
----------
train Loss: 0.8840 Acc: 0.9299
val Loss: 3.1152 Acc: 0.7266
Epoch 10/33
----------
train Loss: 0.6867 Acc: 0.9566
val Loss: 3.0388 Acc: 0.7578
Epoch 11/33
----------
train Loss: 0.6331 Acc: 0.9699
val Loss: 3.0367 Acc: 0.7578
Epoch 12/33
----------
train Loss: 0.5144 Acc: 0.9716
val Loss: 2.9764 Acc: 0.7734
Epoch 13/33
----------
train Loss: 0.4574 Acc: 0.9866
val Loss: 3.0219 Acc: 0.7656
Epoch 14/33
----------
train Loss: 0.3674 Acc: 0.9883
val Loss: 3.1207 Acc: 0.7656
Epoch 15/33
----------
train Loss: 0.3249 Acc: 0.9883
val Loss: 3.0434 Acc: 0.7734
Epoch 16/33
----------
train Loss: 0.2758 Acc: 0.9933
val Loss: 3.0135 Acc: 0.7734
Epoch 17/33
----------
train Loss: 0.2516 Acc: 0.9933
val Loss: 2.9850 Acc: 0.7812
Epoch 18/33
----------
train Loss: 0.2052 Acc: 0.9967
val Loss: 3.0030 Acc: 0.7812
Epoch 19/33
----------
train Loss: 0.2110 Acc: 0.9967
val Loss: 2.9750 Acc: 0.7656
Epoch 20/33
----------
train Loss: 0.1819 Acc: 0.9950
val Loss: 3.0091 Acc: 0.7812
Epoch 21/33
----------
train Loss: 0.1653 Acc: 0.9967
val Loss: 3.1658 Acc: 0.7734
Epoch 22/33
----------
train Loss: 0.1707 Acc: 0.9950
val Loss: 3.1783 Acc: 0.7734
Epoch 23/33
----------
train Loss: 0.1545 Acc: 0.9967
val Loss: 3.0953 Acc: 0.7734
Epoch 24/33
----------
train Loss: 0.1301 Acc: 0.9967
val Loss: 3.2098 Acc: 0.7734
Epoch 25/33
----------
train Loss: 0.1185 Acc: 0.9967
val Loss: 3.1968 Acc: 0.7734
Epoch 26/33
----------
train Loss: 0.1184 Acc: 0.9967
val Loss: 3.1994 Acc: 0.7812
Epoch 27/33
----------
train Loss: 0.0994 Acc: 0.9967
val Loss: 3.2197 Acc: 0.7734
Epoch 28/33
----------
train Loss: 0.1239 Acc: 0.9950
val Loss: 3.2995 Acc: 0.7812
Epoch 29/33
----------
train Loss: 0.1227 Acc: 0.9950
val Loss: 3.2852 Acc: 0.7812
Epoch 30/33
----------
train Loss: 0.0973 Acc: 0.9967
val Loss: 3.2661 Acc: 0.7891
Epoch 31/33
----------
train Loss: 0.0885 Acc: 0.9967
val Loss: 3.2836 Acc: 0.7891
Epoch 32/33
----------
train Loss: 0.0819 Acc: 0.9983
val Loss: 3.2778 Acc: 0.7891
Epoch 33/33
----------
train Loss: 0.0888 Acc: 0.9967
[I 2024-10-15 12:54:34,801] Trial 32 finished with value: 0.7890625 and parameters: {'batch_size': 70, 'lr': 7.99899096014406e-06, 'num_epochs': 33, 'weight_decay': 0.001280624026580983, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.875.
val Loss: 3.3293 Acc: 0.7891
Best val Acc: 0.789062
Model weights saved at ./model_weights/ResNet34_bs_70_lr_7.99899096014406e-06_epoch_33_wd_0.001280624026580983_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/31
----------
train Loss: 4.5020 Acc: 0.3856
val Loss: 3.3240 Acc: 0.6953
Epoch 2/31
----------
train Loss: 1.2451 Acc: 0.8230
val Loss: 3.1223 Acc: 0.8203
Epoch 3/31
----------
train Loss: 0.4251 Acc: 0.9616
val Loss: 3.4209 Acc: 0.8047
Epoch 4/31
----------
train Loss: 0.2333 Acc: 0.9900
val Loss: 3.4467 Acc: 0.8047
Epoch 5/31
----------
train Loss: 0.1319 Acc: 0.9950
val Loss: 3.8348 Acc: 0.8281
Epoch 6/31
----------
train Loss: 0.1029 Acc: 0.9950
val Loss: 3.9056 Acc: 0.8281
Epoch 7/31
----------
train Loss: 0.0707 Acc: 0.9967
val Loss: 4.0797 Acc: 0.8203
Epoch 8/31
----------
train Loss: 0.0803 Acc: 0.9933
val Loss: 4.0661 Acc: 0.8359
Epoch 9/31
----------
train Loss: 0.0412 Acc: 0.9967
val Loss: 4.2961 Acc: 0.8359
Epoch 10/31
----------
train Loss: 0.0349 Acc: 0.9983
val Loss: 4.3021 Acc: 0.8125
Epoch 11/31
----------
train Loss: 0.0316 Acc: 0.9983
val Loss: 4.3988 Acc: 0.8203
Epoch 12/31
----------
train Loss: 0.0285 Acc: 0.9983
val Loss: 4.5044 Acc: 0.8125
Epoch 13/31
----------
train Loss: 0.0204 Acc: 0.9983
val Loss: 4.5770 Acc: 0.8203
Epoch 14/31
----------
train Loss: 0.0200 Acc: 0.9983
val Loss: 4.6364 Acc: 0.8203
Epoch 15/31
----------
train Loss: 0.0265 Acc: 0.9983
val Loss: 4.6325 Acc: 0.8359
Epoch 16/31
----------
train Loss: 0.0193 Acc: 0.9983
val Loss: 4.7519 Acc: 0.8281
Epoch 17/31
----------
train Loss: 0.0234 Acc: 0.9983
val Loss: 4.6755 Acc: 0.8281
Epoch 18/31
----------
train Loss: 0.0191 Acc: 0.9983
val Loss: 4.7000 Acc: 0.8281
Epoch 19/31
----------
train Loss: 0.0190 Acc: 0.9983
val Loss: 4.9816 Acc: 0.8203
Epoch 20/31
----------
train Loss: 0.0230 Acc: 0.9983
val Loss: 5.1272 Acc: 0.8281
Epoch 21/31
----------
train Loss: 0.0264 Acc: 0.9967
val Loss: 4.8226 Acc: 0.8203
Epoch 22/31
----------
train Loss: 0.0210 Acc: 0.9983
val Loss: 4.8652 Acc: 0.8359
Epoch 23/31
----------
train Loss: 0.0148 Acc: 0.9983
val Loss: 4.9855 Acc: 0.8359
Epoch 24/31
----------
train Loss: 0.0189 Acc: 0.9983
val Loss: 4.9876 Acc: 0.8359
Epoch 25/31
----------
train Loss: 0.0146 Acc: 0.9983
val Loss: 5.1296 Acc: 0.8359
Epoch 26/31
----------
train Loss: 0.0158 Acc: 0.9983
val Loss: 5.2498 Acc: 0.8281
Epoch 27/31
----------
train Loss: 0.0236 Acc: 0.9983
val Loss: 4.8609 Acc: 0.8281
Epoch 28/31
----------
train Loss: 0.0161 Acc: 0.9983
val Loss: 4.6739 Acc: 0.8281
Epoch 29/31
----------
train Loss: 0.0856 Acc: 0.9917
val Loss: 5.2417 Acc: 0.8281
Epoch 30/31
----------
train Loss: 0.0669 Acc: 0.9917
val Loss: 5.1717 Acc: 0.8125
Epoch 31/31
----------
train Loss: 0.0577 Acc: 0.9967
[I 2024-10-15 12:56:53,388] Trial 33 finished with value: 0.8203125 and parameters: {'batch_size': 107, 'lr': 5.4964044012185556e-05, 'num_epochs': 31, 'weight_decay': 0.0025191238919099078, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.875.
val Loss: 4.6944 Acc: 0.8203
Best val Acc: 0.820312
Model weights saved at ./model_weights/ResNet34_bs_107_lr_5.4964044012185556e-05_epoch_31_wd_0.0025191238919099078_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/47
----------
train Loss: 5.0746 Acc: 0.6477
val Loss: 4.3996 Acc: 0.7266
Epoch 2/47
----------
train Loss: 2.2719 Acc: 0.8497
val Loss: 3.0905 Acc: 0.7891
Epoch 3/47
----------
train Loss: 1.3601 Acc: 0.8614
val Loss: 2.6471 Acc: 0.7734
Epoch 4/47
----------
train Loss: 0.9077 Acc: 0.9165
val Loss: 2.3885 Acc: 0.7891
Epoch 5/47
----------
train Loss: 0.6190 Acc: 0.9549
val Loss: 2.3750 Acc: 0.8203
Epoch 6/47
----------
train Loss: 0.3982 Acc: 0.9866
val Loss: 2.3303 Acc: 0.8516
Epoch 7/47
----------
train Loss: 0.3055 Acc: 0.9950
val Loss: 2.3253 Acc: 0.8594
Epoch 8/47
----------
train Loss: 0.2707 Acc: 0.9866
val Loss: 2.3462 Acc: 0.8516
Epoch 9/47
----------
train Loss: 0.2160 Acc: 0.9883
val Loss: 2.4160 Acc: 0.8438
Epoch 10/47
----------
train Loss: 0.1724 Acc: 0.9917
val Loss: 2.3106 Acc: 0.8438
Epoch 11/47
----------
train Loss: 0.1954 Acc: 0.9950
val Loss: 2.4054 Acc: 0.8594
Epoch 12/47
----------
train Loss: 0.1420 Acc: 0.9933
val Loss: 2.5235 Acc: 0.8516
Epoch 13/47
----------
train Loss: 0.1289 Acc: 0.9933
val Loss: 2.4822 Acc: 0.8516
Epoch 14/47
----------
train Loss: 0.1166 Acc: 0.9950
val Loss: 2.4498 Acc: 0.8516
Epoch 15/47
----------
train Loss: 0.1084 Acc: 0.9933
val Loss: 2.4119 Acc: 0.8438
Epoch 16/47
----------
train Loss: 0.1026 Acc: 0.9950
val Loss: 2.4946 Acc: 0.8359
Epoch 17/47
----------
train Loss: 0.0789 Acc: 0.9933
val Loss: 2.4631 Acc: 0.8359
Epoch 18/47
----------
train Loss: 0.1057 Acc: 0.9933
val Loss: 2.3030 Acc: 0.8516
Epoch 19/47
----------
train Loss: 0.0810 Acc: 0.9967
val Loss: 2.3566 Acc: 0.8516
Epoch 20/47
----------
train Loss: 0.0897 Acc: 0.9950
val Loss: 2.4654 Acc: 0.8438
Epoch 21/47
----------
train Loss: 0.0657 Acc: 0.9950
val Loss: 2.6366 Acc: 0.8594
Epoch 22/47
----------
train Loss: 0.0581 Acc: 0.9950
val Loss: 2.4944 Acc: 0.8516
Epoch 23/47
----------
train Loss: 0.0657 Acc: 0.9950
val Loss: 2.4472 Acc: 0.8516
Epoch 24/47
----------
train Loss: 0.0702 Acc: 0.9933
val Loss: 2.6520 Acc: 0.8516
Epoch 25/47
----------
train Loss: 0.0544 Acc: 0.9967
val Loss: 2.5769 Acc: 0.8672
Epoch 26/47
----------
train Loss: 0.0702 Acc: 0.9917
val Loss: 2.4951 Acc: 0.8359
Epoch 27/47
----------
train Loss: 0.0755 Acc: 0.9933
val Loss: 2.6119 Acc: 0.8516
Epoch 28/47
----------
train Loss: 0.0580 Acc: 0.9950
val Loss: 2.6941 Acc: 0.8438
Epoch 29/47
----------
train Loss: 0.0655 Acc: 0.9933
val Loss: 2.6224 Acc: 0.8516
Epoch 30/47
----------
train Loss: 0.0603 Acc: 0.9950
val Loss: 2.7699 Acc: 0.8516
Epoch 31/47
----------
train Loss: 0.0654 Acc: 0.9933
val Loss: 2.6301 Acc: 0.8516
Epoch 32/47
----------
train Loss: 0.0530 Acc: 0.9950
val Loss: 2.7578 Acc: 0.8438
Epoch 33/47
----------
train Loss: 0.0577 Acc: 0.9950
val Loss: 2.7558 Acc: 0.8594
Epoch 34/47
----------
train Loss: 0.0541 Acc: 0.9950
val Loss: 2.8156 Acc: 0.8594
Epoch 35/47
----------
train Loss: 0.0446 Acc: 0.9950
val Loss: 2.6769 Acc: 0.8594
Epoch 36/47
----------
train Loss: 0.0533 Acc: 0.9933
val Loss: 2.7814 Acc: 0.8750
Epoch 37/47
----------
train Loss: 0.0523 Acc: 0.9950
val Loss: 2.7863 Acc: 0.8516
Epoch 38/47
----------
train Loss: 0.0591 Acc: 0.9967
val Loss: 2.6194 Acc: 0.8594
Epoch 39/47
----------
train Loss: 0.0430 Acc: 0.9967
val Loss: 2.8442 Acc: 0.8594
Epoch 40/47
----------
train Loss: 0.0399 Acc: 0.9950
val Loss: 2.8859 Acc: 0.8516
Epoch 41/47
----------
train Loss: 0.0585 Acc: 0.9933
val Loss: 2.6864 Acc: 0.8594
Epoch 42/47
----------
train Loss: 0.0500 Acc: 0.9950
val Loss: 2.7518 Acc: 0.8594
Epoch 43/47
----------
train Loss: 0.0458 Acc: 0.9950
val Loss: 2.8643 Acc: 0.8516
Epoch 44/47
----------
train Loss: 0.0433 Acc: 0.9950
val Loss: 2.7309 Acc: 0.8594
Epoch 45/47
----------
train Loss: 0.0445 Acc: 0.9950
val Loss: 2.8704 Acc: 0.8516
Epoch 46/47
----------
train Loss: 0.0395 Acc: 0.9967
val Loss: 2.4995 Acc: 0.8828
Epoch 47/47
----------
train Loss: 0.0405 Acc: 0.9967
[I 2024-10-15 13:00:25,543] Trial 34 finished with value: 0.859375 and parameters: {'batch_size': 79, 'lr': 2.055351609103999e-05, 'num_epochs': 47, 'weight_decay': 0.013455824962397432, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.875.
val Loss: 2.8114 Acc: 0.8594
Best val Acc: 0.859375
Model weights saved at ./model_weights/ResNet34_bs_79_lr_2.055351609103999e-05_epoch_47_wd_0.013455824962397432_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/54
----------
train Loss: 5.3267 Acc: 0.3306
val Loss: 5.3731 Acc: 0.4062
Epoch 2/54
----------
train Loss: 3.0712 Acc: 0.6461
val Loss: 4.1767 Acc: 0.6172
Epoch 3/54
----------
train Loss: 2.0507 Acc: 0.7913
val Loss: 3.7220 Acc: 0.6797
Epoch 4/54
----------
train Loss: 1.4446 Acc: 0.8397
val Loss: 3.5212 Acc: 0.6797
Epoch 5/54
----------
train Loss: 1.0682 Acc: 0.9098
val Loss: 3.4201 Acc: 0.6875
Epoch 6/54
----------
train Loss: 0.7949 Acc: 0.9416
val Loss: 3.3649 Acc: 0.7188
Epoch 7/54
----------
train Loss: 0.5835 Acc: 0.9716
val Loss: 3.3662 Acc: 0.7344
Epoch 8/54
----------
train Loss: 0.4413 Acc: 0.9967
val Loss: 3.4129 Acc: 0.7344
Epoch 9/54
----------
train Loss: 0.3766 Acc: 0.9917
val Loss: 3.4730 Acc: 0.7344
Epoch 10/54
----------
train Loss: 0.2984 Acc: 0.9967
val Loss: 3.6192 Acc: 0.7656
Epoch 11/54
----------
train Loss: 0.2560 Acc: 0.9967
val Loss: 3.7313 Acc: 0.7734
Epoch 12/54
----------
train Loss: 0.1694 Acc: 1.0000
val Loss: 3.7558 Acc: 0.7656
Epoch 13/54
----------
train Loss: 0.1647 Acc: 1.0000
val Loss: 3.8568 Acc: 0.7656
Epoch 14/54
----------
train Loss: 0.1215 Acc: 1.0000
val Loss: 4.0015 Acc: 0.7734
Epoch 15/54
----------
train Loss: 0.1297 Acc: 1.0000
val Loss: 4.0084 Acc: 0.7656
Epoch 16/54
----------
train Loss: 0.1225 Acc: 0.9983
val Loss: 4.1167 Acc: 0.7734
Epoch 17/54
----------
train Loss: 0.0823 Acc: 1.0000
val Loss: 4.0313 Acc: 0.7656
Epoch 18/54
----------
train Loss: 0.0777 Acc: 1.0000
val Loss: 4.1967 Acc: 0.7656
Epoch 19/54
----------
train Loss: 0.0630 Acc: 1.0000
val Loss: 4.2281 Acc: 0.7734
Epoch 20/54
----------
train Loss: 0.0606 Acc: 1.0000
val Loss: 4.2739 Acc: 0.7734
Epoch 21/54
----------
train Loss: 0.0702 Acc: 1.0000
val Loss: 4.4105 Acc: 0.7656
Epoch 22/54
----------
train Loss: 0.0748 Acc: 1.0000
val Loss: 4.3914 Acc: 0.7734
Epoch 23/54
----------
train Loss: 0.0491 Acc: 1.0000
val Loss: 4.0843 Acc: 0.7500
Epoch 24/54
----------
train Loss: 0.0478 Acc: 1.0000
val Loss: 4.2071 Acc: 0.7578
Epoch 25/54
----------
train Loss: 0.0392 Acc: 1.0000
val Loss: 4.3281 Acc: 0.7656
Epoch 26/54
----------
train Loss: 0.0422 Acc: 1.0000
val Loss: 4.4192 Acc: 0.7734
Epoch 27/54
----------
train Loss: 0.0394 Acc: 1.0000
val Loss: 4.4513 Acc: 0.7656
Epoch 28/54
----------
train Loss: 0.0313 Acc: 1.0000
val Loss: 4.5641 Acc: 0.7734
Epoch 29/54
----------
train Loss: 0.0267 Acc: 1.0000
val Loss: 4.5561 Acc: 0.7734
Epoch 30/54
----------
train Loss: 0.0286 Acc: 1.0000
val Loss: 4.5622 Acc: 0.7812
Epoch 31/54
----------
train Loss: 0.0280 Acc: 1.0000
val Loss: 4.5565 Acc: 0.7656
Epoch 32/54
----------
train Loss: 0.0429 Acc: 1.0000
val Loss: 4.6227 Acc: 0.7812
Epoch 33/54
----------
train Loss: 0.0262 Acc: 1.0000
val Loss: 4.5581 Acc: 0.7656
Epoch 34/54
----------
train Loss: 0.0269 Acc: 1.0000
val Loss: 4.5496 Acc: 0.7656
Epoch 35/54
----------
train Loss: 0.0230 Acc: 1.0000
val Loss: 4.7715 Acc: 0.7578
Epoch 36/54
----------
train Loss: 0.0269 Acc: 1.0000
val Loss: 4.7492 Acc: 0.7656
Epoch 37/54
----------
train Loss: 0.0232 Acc: 1.0000
val Loss: 4.9385 Acc: 0.7734
Epoch 38/54
----------
train Loss: 0.0218 Acc: 1.0000
val Loss: 4.8339 Acc: 0.7734
Epoch 39/54
----------
train Loss: 0.0204 Acc: 1.0000
val Loss: 4.9651 Acc: 0.7734
Epoch 40/54
----------
train Loss: 0.0182 Acc: 1.0000
val Loss: 4.9353 Acc: 0.7734
Epoch 41/54
----------
train Loss: 0.0175 Acc: 1.0000
val Loss: 4.9190 Acc: 0.7734
Epoch 42/54
----------
train Loss: 0.0219 Acc: 1.0000
val Loss: 5.2070 Acc: 0.7656
Epoch 43/54
----------
train Loss: 0.0181 Acc: 1.0000
val Loss: 5.1549 Acc: 0.7734
Epoch 44/54
----------
train Loss: 0.0194 Acc: 1.0000
val Loss: 5.0012 Acc: 0.7656
Epoch 45/54
----------
train Loss: 0.0177 Acc: 1.0000
val Loss: 5.1070 Acc: 0.7656
Epoch 46/54
----------
train Loss: 0.0158 Acc: 1.0000
val Loss: 5.1671 Acc: 0.7656
Epoch 47/54
----------
train Loss: 0.0141 Acc: 1.0000
val Loss: 5.1011 Acc: 0.7656
Epoch 48/54
----------
train Loss: 0.0127 Acc: 1.0000
val Loss: 5.2642 Acc: 0.7734
Epoch 49/54
----------
train Loss: 0.0140 Acc: 1.0000
val Loss: 5.2002 Acc: 0.7734
Epoch 50/54
----------
train Loss: 0.0127 Acc: 1.0000
val Loss: 5.2321 Acc: 0.7734
Epoch 51/54
----------
train Loss: 0.0150 Acc: 1.0000
val Loss: 5.1952 Acc: 0.7656
Epoch 52/54
----------
train Loss: 0.0116 Acc: 1.0000
val Loss: 5.2098 Acc: 0.7656
Epoch 53/54
----------
train Loss: 0.0145 Acc: 1.0000
val Loss: 5.1957 Acc: 0.7812
Epoch 54/54
----------
train Loss: 0.0122 Acc: 1.0000
[I 2024-10-15 13:04:27,324] Trial 35 finished with value: 0.765625 and parameters: {'batch_size': 78, 'lr': 1.3186354638847672e-05, 'num_epochs': 54, 'weight_decay': 0.013735353784400845, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.875.
val Loss: 5.4783 Acc: 0.7656
Best val Acc: 0.765625
Model weights saved at ./model_weights/ResNet34_bs_78_lr_1.3186354638847672e-05_epoch_54_wd_0.013735353784400845_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/48
----------
train Loss: 5.7575 Acc: 0.4825
val Loss: 4.2530 Acc: 0.6641
Epoch 2/48
----------
train Loss: 4.5549 Acc: 0.6745
val Loss: 3.7511 Acc: 0.6562
Epoch 3/48
----------
train Loss: 3.8121 Acc: 0.7513
val Loss: 3.4116 Acc: 0.7031
Epoch 4/48
----------
train Loss: 3.2141 Acc: 0.7997
val Loss: 3.2066 Acc: 0.6875
Epoch 5/48
----------
train Loss: 2.7009 Acc: 0.8214
val Loss: 3.0474 Acc: 0.7031
Epoch 6/48
----------
train Loss: 2.3365 Acc: 0.8481
val Loss: 2.9079 Acc: 0.7188
Epoch 7/48
----------
train Loss: 1.9863 Acc: 0.8614
val Loss: 2.7905 Acc: 0.7266
Epoch 8/48
----------
train Loss: 1.7118 Acc: 0.8865
val Loss: 2.7030 Acc: 0.7344
Epoch 9/48
----------
train Loss: 1.5076 Acc: 0.9048
val Loss: 2.6218 Acc: 0.7344
Epoch 10/48
----------
train Loss: 1.3143 Acc: 0.9098
val Loss: 2.5391 Acc: 0.7500
Epoch 11/48
----------
train Loss: 1.1699 Acc: 0.9215
val Loss: 2.4879 Acc: 0.7578
Epoch 12/48
----------
train Loss: 1.0488 Acc: 0.9316
val Loss: 2.4333 Acc: 0.7656
Epoch 13/48
----------
train Loss: 0.9280 Acc: 0.9466
val Loss: 2.3978 Acc: 0.7656
Epoch 14/48
----------
train Loss: 0.8485 Acc: 0.9466
val Loss: 2.3321 Acc: 0.7656
Epoch 15/48
----------
train Loss: 0.7461 Acc: 0.9482
val Loss: 2.3327 Acc: 0.7656
Epoch 16/48
----------
train Loss: 0.6779 Acc: 0.9599
val Loss: 2.3183 Acc: 0.7656
Epoch 17/48
----------
train Loss: 0.5974 Acc: 0.9683
val Loss: 2.3152 Acc: 0.7734
Epoch 18/48
----------
train Loss: 0.5441 Acc: 0.9683
val Loss: 2.2805 Acc: 0.7969
Epoch 19/48
----------
train Loss: 0.5797 Acc: 0.9666
val Loss: 2.2584 Acc: 0.7891
Epoch 20/48
----------
train Loss: 0.4544 Acc: 0.9866
val Loss: 2.2902 Acc: 0.8047
Epoch 21/48
----------
train Loss: 0.3900 Acc: 0.9917
val Loss: 2.2586 Acc: 0.7891
Epoch 22/48
----------
train Loss: 0.3884 Acc: 0.9883
val Loss: 2.2466 Acc: 0.7891
Epoch 23/48
----------
train Loss: 0.3420 Acc: 0.9933
val Loss: 2.2321 Acc: 0.7891
Epoch 24/48
----------
train Loss: 0.2960 Acc: 0.9967
val Loss: 2.2949 Acc: 0.8125
Epoch 25/48
----------
train Loss: 0.2976 Acc: 0.9883
val Loss: 2.2865 Acc: 0.7891
Epoch 26/48
----------
train Loss: 0.2736 Acc: 0.9967
val Loss: 2.2588 Acc: 0.7969
Epoch 27/48
----------
train Loss: 0.2339 Acc: 0.9983
val Loss: 2.2753 Acc: 0.8047
Epoch 28/48
----------
train Loss: 0.2160 Acc: 0.9967
val Loss: 2.3175 Acc: 0.8125
Epoch 29/48
----------
train Loss: 0.2351 Acc: 0.9967
val Loss: 2.3482 Acc: 0.8125
Epoch 30/48
----------
train Loss: 0.1837 Acc: 0.9983
val Loss: 2.2598 Acc: 0.7969
Epoch 31/48
----------
train Loss: 0.1734 Acc: 0.9967
val Loss: 2.2992 Acc: 0.8125
Epoch 32/48
----------
train Loss: 0.1678 Acc: 0.9950
val Loss: 2.2954 Acc: 0.8047
Epoch 33/48
----------
train Loss: 0.1695 Acc: 0.9983
val Loss: 2.3017 Acc: 0.8125
Epoch 34/48
----------
train Loss: 0.1537 Acc: 0.9950
val Loss: 2.2949 Acc: 0.8047
Epoch 35/48
----------
train Loss: 0.1392 Acc: 0.9967
val Loss: 2.3491 Acc: 0.8125
Epoch 36/48
----------
train Loss: 0.1619 Acc: 0.9967
val Loss: 2.3936 Acc: 0.8125
Epoch 37/48
----------
train Loss: 0.1388 Acc: 0.9983
val Loss: 2.2937 Acc: 0.8047
Epoch 38/48
----------
train Loss: 0.1137 Acc: 0.9983
val Loss: 2.3234 Acc: 0.8047
Epoch 39/48
----------
train Loss: 0.1146 Acc: 0.9967
val Loss: 2.3550 Acc: 0.8047
Epoch 40/48
----------
train Loss: 0.0962 Acc: 0.9983
val Loss: 2.4058 Acc: 0.8125
Epoch 41/48
----------
train Loss: 0.1048 Acc: 0.9983
val Loss: 2.4022 Acc: 0.8125
Epoch 42/48
----------
train Loss: 0.1044 Acc: 0.9983
val Loss: 2.3898 Acc: 0.8047
Epoch 43/48
----------
train Loss: 0.1010 Acc: 0.9983
val Loss: 2.3915 Acc: 0.8125
Epoch 44/48
----------
train Loss: 0.0760 Acc: 0.9983
val Loss: 2.3916 Acc: 0.8047
Epoch 45/48
----------
train Loss: 0.0889 Acc: 0.9983
val Loss: 2.4509 Acc: 0.8281
Epoch 46/48
----------
train Loss: 0.0913 Acc: 0.9983
val Loss: 2.4485 Acc: 0.8281
Epoch 47/48
----------
train Loss: 0.0689 Acc: 0.9983
val Loss: 2.4570 Acc: 0.8281
Epoch 48/48
----------
train Loss: 0.0871 Acc: 0.9983
[I 2024-10-15 13:08:01,609] Trial 36 finished with value: 0.828125 and parameters: {'batch_size': 74, 'lr': 4.704181656192928e-06, 'num_epochs': 48, 'weight_decay': 0.020599462111033025, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.875.
val Loss: 2.4660 Acc: 0.8281
Best val Acc: 0.828125
Model weights saved at ./model_weights/ResNet34_bs_74_lr_4.704181656192928e-06_epoch_48_wd_0.020599462111033025_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/61
----------
train Loss: 2.0070 Acc: 0.0785
val Loss: 1.6860 Acc: 0.1016
Epoch 2/61
----------
train Loss: 1.8622 Acc: 0.0835
val Loss: 1.7021 Acc: 0.0859
Epoch 3/61
----------
train Loss: 1.7440 Acc: 0.0952
val Loss: 1.6328 Acc: 0.1016
Epoch 4/61
----------
train Loss: 1.6329 Acc: 0.1369
val Loss: 1.5552 Acc: 0.1094
Epoch 5/61
----------
train Loss: 1.5254 Acc: 0.1820
val Loss: 1.4897 Acc: 0.1641
Epoch 6/61
----------
train Loss: 1.4203 Acc: 0.2387
val Loss: 1.4233 Acc: 0.2109
Epoch 7/61
----------
train Loss: 1.3215 Acc: 0.2988
val Loss: 1.3508 Acc: 0.3047
Epoch 8/61
----------
train Loss: 1.2408 Acc: 0.3723
val Loss: 1.2995 Acc: 0.3281
Epoch 9/61
----------
train Loss: 1.1464 Acc: 0.4908
val Loss: 1.2287 Acc: 0.4453
Epoch 10/61
----------
train Loss: 1.0716 Acc: 0.5526
val Loss: 1.1833 Acc: 0.4844
Epoch 11/61
----------
train Loss: 0.9959 Acc: 0.6010
val Loss: 1.1395 Acc: 0.5469
Epoch 12/61
----------
train Loss: 0.9167 Acc: 0.6811
val Loss: 1.0815 Acc: 0.5859
Epoch 13/61
----------
train Loss: 0.8473 Acc: 0.7362
val Loss: 1.0254 Acc: 0.6328
Epoch 14/61
----------
train Loss: 0.7784 Acc: 0.7947
val Loss: 0.9973 Acc: 0.6484
Epoch 15/61
----------
train Loss: 0.7187 Acc: 0.8214
val Loss: 0.9704 Acc: 0.6641
Epoch 16/61
----------
train Loss: 0.6533 Acc: 0.8514
val Loss: 0.9364 Acc: 0.6797
Epoch 17/61
----------
train Loss: 0.5911 Acc: 0.8932
val Loss: 0.9069 Acc: 0.7031
Epoch 18/61
----------
train Loss: 0.5398 Acc: 0.9232
val Loss: 0.8980 Acc: 0.7031
Epoch 19/61
----------
train Loss: 0.5107 Acc: 0.9132
val Loss: 0.8790 Acc: 0.7109
Epoch 20/61
----------
train Loss: 0.4571 Acc: 0.9566
val Loss: 0.8693 Acc: 0.7188
Epoch 21/61
----------
train Loss: 0.4242 Acc: 0.9516
val Loss: 0.8551 Acc: 0.7188
Epoch 22/61
----------
train Loss: 0.3852 Acc: 0.9583
val Loss: 0.8471 Acc: 0.7266
Epoch 23/61
----------
train Loss: 0.3584 Acc: 0.9666
val Loss: 0.8344 Acc: 0.7344
Epoch 24/61
----------
train Loss: 0.3232 Acc: 0.9800
val Loss: 0.8306 Acc: 0.7266
Epoch 25/61
----------
train Loss: 0.3089 Acc: 0.9733
val Loss: 0.8250 Acc: 0.7344
Epoch 26/61
----------
train Loss: 0.2722 Acc: 0.9866
val Loss: 0.8207 Acc: 0.7344
Epoch 27/61
----------
train Loss: 0.2627 Acc: 0.9833
val Loss: 0.8125 Acc: 0.7188
Epoch 28/61
----------
train Loss: 0.2510 Acc: 0.9816
val Loss: 0.8133 Acc: 0.7266
Epoch 29/61
----------
train Loss: 0.2196 Acc: 0.9900
val Loss: 0.8165 Acc: 0.7266
Epoch 30/61
----------
train Loss: 0.2072 Acc: 0.9866
val Loss: 0.8090 Acc: 0.7188
Epoch 31/61
----------
train Loss: 0.1899 Acc: 0.9900
val Loss: 0.8098 Acc: 0.7188
Epoch 32/61
----------
train Loss: 0.1946 Acc: 0.9883
val Loss: 0.8024 Acc: 0.7266
Epoch 33/61
----------
train Loss: 0.1684 Acc: 0.9950
val Loss: 0.8167 Acc: 0.7188
Epoch 34/61
----------
train Loss: 0.1792 Acc: 0.9850
val Loss: 0.8022 Acc: 0.7344
Epoch 35/61
----------
train Loss: 0.1601 Acc: 0.9883
val Loss: 0.8080 Acc: 0.7344
Epoch 36/61
----------
train Loss: 0.1308 Acc: 0.9950
val Loss: 0.8104 Acc: 0.7344
Epoch 37/61
----------
train Loss: 0.1425 Acc: 0.9866
val Loss: 0.8138 Acc: 0.7188
Epoch 38/61
----------
train Loss: 0.1294 Acc: 0.9933
val Loss: 0.8061 Acc: 0.7344
Epoch 39/61
----------
train Loss: 0.1209 Acc: 0.9917
val Loss: 0.8115 Acc: 0.7266
Epoch 40/61
----------
train Loss: 0.1080 Acc: 0.9967
val Loss: 0.8112 Acc: 0.7266
Epoch 41/61
----------
train Loss: 0.1258 Acc: 0.9917
val Loss: 0.8076 Acc: 0.7344
Epoch 42/61
----------
train Loss: 0.0934 Acc: 0.9950
val Loss: 0.8102 Acc: 0.7266
Epoch 43/61
----------
train Loss: 0.1115 Acc: 0.9900
val Loss: 0.8126 Acc: 0.7344
Epoch 44/61
----------
train Loss: 0.1028 Acc: 0.9917
val Loss: 0.8240 Acc: 0.7344
Epoch 45/61
----------
train Loss: 0.1005 Acc: 0.9967
val Loss: 0.8057 Acc: 0.7266
Epoch 46/61
----------
train Loss: 0.0850 Acc: 0.9967
val Loss: 0.8162 Acc: 0.7188
Epoch 47/61
----------
train Loss: 0.0805 Acc: 0.9967
val Loss: 0.8198 Acc: 0.7188
Epoch 48/61
----------
train Loss: 0.0737 Acc: 0.9967
val Loss: 0.8057 Acc: 0.7266
Epoch 49/61
----------
train Loss: 0.0791 Acc: 0.9967
val Loss: 0.8163 Acc: 0.7344
Epoch 50/61
----------
train Loss: 0.0698 Acc: 0.9967
val Loss: 0.8341 Acc: 0.7266
Epoch 51/61
----------
train Loss: 0.0661 Acc: 0.9983
val Loss: 0.8286 Acc: 0.7266
Epoch 52/61
----------
train Loss: 0.0636 Acc: 0.9983
val Loss: 0.8219 Acc: 0.7266
Epoch 53/61
----------
train Loss: 0.0633 Acc: 0.9967
val Loss: 0.8185 Acc: 0.7422
Epoch 54/61
----------
train Loss: 0.0688 Acc: 0.9967
val Loss: 0.8281 Acc: 0.7266
Epoch 55/61
----------
train Loss: 0.0588 Acc: 0.9983
val Loss: 0.8324 Acc: 0.7266
Epoch 56/61
----------
train Loss: 0.0540 Acc: 0.9967
val Loss: 0.8393 Acc: 0.7344
Epoch 57/61
----------
train Loss: 0.0623 Acc: 0.9967
val Loss: 0.8436 Acc: 0.7266
Epoch 58/61
----------
train Loss: 0.0554 Acc: 1.0000
val Loss: 0.8339 Acc: 0.7422
Epoch 59/61
----------
train Loss: 0.0468 Acc: 0.9967
val Loss: 0.8447 Acc: 0.7422
Epoch 60/61
----------
train Loss: 0.0484 Acc: 1.0000
val Loss: 0.8403 Acc: 0.7344
Epoch 61/61
----------
train Loss: 0.0516 Acc: 0.9983
[I 2024-10-15 13:12:32,696] Trial 37 finished with value: 0.734375 and parameters: {'batch_size': 63, 'lr': 1.999544145241786e-06, 'num_epochs': 61, 'weight_decay': 0.010329004361318202, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 9 with value: 0.875.
val Loss: 0.8408 Acc: 0.7344
Best val Acc: 0.734375
Model weights saved at ./model_weights/ResNet34_bs_63_lr_1.999544145241786e-06_epoch_61_wd_0.010329004361318202_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/46
----------
train Loss: 3.4752 Acc: 0.6027
val Loss: 2.4386 Acc: 0.7344
Epoch 2/46
----------
train Loss: 2.2456 Acc: 0.7346
val Loss: 1.8382 Acc: 0.7188
Epoch 3/46
----------
train Loss: 1.7587 Acc: 0.7763
val Loss: 1.8274 Acc: 0.7734
Epoch 4/46
----------
train Loss: 1.5585 Acc: 0.8548
val Loss: 1.4424 Acc: 0.7656
Epoch 5/46
----------
train Loss: 1.3540 Acc: 0.8765
val Loss: 1.4623 Acc: 0.7891
Epoch 6/46
----------
train Loss: 1.4113 Acc: 0.8698
val Loss: 1.4109 Acc: 0.7969
Epoch 7/46
----------
train Loss: 1.3578 Acc: 0.8932
val Loss: 1.5849 Acc: 0.8047
Epoch 8/46
----------
train Loss: 1.2498 Acc: 0.8982
val Loss: 1.5642 Acc: 0.7969
Epoch 9/46
----------
train Loss: 1.3510 Acc: 0.8915
val Loss: 1.6725 Acc: 0.7578
Epoch 10/46
----------
train Loss: 1.2544 Acc: 0.9282
val Loss: 1.5550 Acc: 0.8203
Epoch 11/46
----------
train Loss: 1.3873 Acc: 0.9032
val Loss: 1.5556 Acc: 0.7891
Epoch 12/46
----------
train Loss: 1.2960 Acc: 0.8815
val Loss: 1.6914 Acc: 0.7812
Epoch 13/46
----------
train Loss: 1.2135 Acc: 0.9382
val Loss: 1.5658 Acc: 0.7656
Epoch 14/46
----------
train Loss: 1.1658 Acc: 0.9199
val Loss: 1.6064 Acc: 0.8047
Epoch 15/46
----------
train Loss: 1.2449 Acc: 0.9349
val Loss: 1.5196 Acc: 0.7891
Epoch 16/46
----------
train Loss: 1.2685 Acc: 0.9215
val Loss: 1.4187 Acc: 0.8203
Epoch 17/46
----------
train Loss: 1.2776 Acc: 0.8965
val Loss: 1.4476 Acc: 0.7969
Epoch 18/46
----------
train Loss: 1.1005 Acc: 0.9416
val Loss: 1.5291 Acc: 0.7812
Epoch 19/46
----------
train Loss: 1.1777 Acc: 0.9482
val Loss: 1.4523 Acc: 0.8125
Epoch 20/46
----------
train Loss: 1.2367 Acc: 0.9382
val Loss: 1.5845 Acc: 0.7891
Epoch 21/46
----------
train Loss: 1.1110 Acc: 0.9065
val Loss: 1.4579 Acc: 0.8047
Epoch 22/46
----------
train Loss: 1.1459 Acc: 0.9499
val Loss: 1.4402 Acc: 0.8047
Epoch 23/46
----------
train Loss: 1.2469 Acc: 0.9165
val Loss: 1.4248 Acc: 0.7812
Epoch 24/46
----------
train Loss: 1.1262 Acc: 0.9282
val Loss: 1.4031 Acc: 0.7969
Epoch 25/46
----------
train Loss: 1.3770 Acc: 0.8748
val Loss: 1.4929 Acc: 0.8203
Epoch 26/46
----------
train Loss: 1.1083 Acc: 0.9499
val Loss: 1.5674 Acc: 0.7891
Epoch 27/46
----------
train Loss: 1.1932 Acc: 0.8915
val Loss: 1.4853 Acc: 0.8281
Epoch 28/46
----------
train Loss: 1.2183 Acc: 0.9215
val Loss: 1.6407 Acc: 0.7891
Epoch 29/46
----------
train Loss: 1.3415 Acc: 0.8748
val Loss: 1.5077 Acc: 0.8047
Epoch 30/46
----------
train Loss: 1.0388 Acc: 0.9232
val Loss: 1.4854 Acc: 0.8047
Epoch 31/46
----------
train Loss: 1.1687 Acc: 0.9065
val Loss: 1.5022 Acc: 0.8125
Epoch 32/46
----------
train Loss: 1.1510 Acc: 0.9599
val Loss: 1.5456 Acc: 0.7812
Epoch 33/46
----------
train Loss: 1.1404 Acc: 0.9316
val Loss: 1.5062 Acc: 0.7891
Epoch 34/46
----------
train Loss: 1.1797 Acc: 0.8948
val Loss: 1.5127 Acc: 0.8203
Epoch 35/46
----------
train Loss: 1.0868 Acc: 0.9265
val Loss: 1.6407 Acc: 0.7891
Epoch 36/46
----------
train Loss: 1.1567 Acc: 0.9332
val Loss: 1.5682 Acc: 0.7969
Epoch 37/46
----------
train Loss: 1.1329 Acc: 0.9566
val Loss: 1.5149 Acc: 0.7969
Epoch 38/46
----------
train Loss: 1.0721 Acc: 0.9549
val Loss: 1.4668 Acc: 0.8125
Epoch 39/46
----------
train Loss: 1.2086 Acc: 0.9065
val Loss: 1.6326 Acc: 0.7344
Epoch 40/46
----------
train Loss: 1.2309 Acc: 0.9282
val Loss: 1.6049 Acc: 0.7656
Epoch 41/46
----------
train Loss: 1.0250 Acc: 0.9382
val Loss: 1.6303 Acc: 0.8047
Epoch 42/46
----------
train Loss: 1.0826 Acc: 0.9533
val Loss: 1.7116 Acc: 0.7656
Epoch 43/46
----------
train Loss: 1.1447 Acc: 0.9432
val Loss: 1.6616 Acc: 0.7812
Epoch 44/46
----------
train Loss: 1.0088 Acc: 0.9683
val Loss: 1.5905 Acc: 0.7969
Epoch 45/46
----------
train Loss: 1.2285 Acc: 0.8915
val Loss: 1.6439 Acc: 0.7656
Epoch 46/46
----------
train Loss: 1.1717 Acc: 0.8831
[I 2024-10-15 13:15:58,762] Trial 38 finished with value: 0.78125 and parameters: {'batch_size': 99, 'lr': 5.073269824658007e-05, 'num_epochs': 46, 'weight_decay': 0.005285337257769266, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 1.6702 Acc: 0.7812
Best val Acc: 0.781250
Model weights saved at ./model_weights/ResNet34_bs_99_lr_5.073269824658007e-05_epoch_46_wd_0.005285337257769266_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/72
----------
train Loss: 1.6317 Acc: 0.5526
val Loss: 2135.2774 Acc: 0.5859
Epoch 2/72
----------
train Loss: 1.0695 Acc: 0.6127
val Loss: 1.1512 Acc: 0.5859
Epoch 3/72
----------
train Loss: 1.1110 Acc: 0.6144
val Loss: 1.1314 Acc: 0.5859
Epoch 4/72
----------
train Loss: 1.0483 Acc: 0.6327
val Loss: 1.1584 Acc: 0.5859
Epoch 5/72
----------
train Loss: 1.0485 Acc: 0.6194
val Loss: 1.1299 Acc: 0.5859
Epoch 6/72
----------
train Loss: 1.0147 Acc: 0.6311
val Loss: 2.1607 Acc: 0.5547
Epoch 7/72
----------
train Loss: 1.0136 Acc: 0.6344
val Loss: 1.0498 Acc: 0.5859
Epoch 8/72
----------
train Loss: 1.0132 Acc: 0.6327
val Loss: 7.1527 Acc: 0.1875
Epoch 9/72
----------
train Loss: 0.9797 Acc: 0.6311
val Loss: 1.0535 Acc: 0.5859
Epoch 10/72
----------
train Loss: 0.9530 Acc: 0.6377
val Loss: 1.1530 Acc: 0.5859
Epoch 11/72
----------
train Loss: 0.9674 Acc: 0.6427
val Loss: 1.0966 Acc: 0.5859
Epoch 12/72
----------
train Loss: 0.9867 Acc: 0.6361
val Loss: 2.5388 Acc: 0.5859
Epoch 13/72
----------
train Loss: 0.9933 Acc: 0.6394
val Loss: 0.9974 Acc: 0.6641
Epoch 14/72
----------
train Loss: 0.9418 Acc: 0.6544
val Loss: 0.9767 Acc: 0.6406
Epoch 15/72
----------
train Loss: 0.9469 Acc: 0.6678
val Loss: 1.1363 Acc: 0.5859
Epoch 16/72
----------
train Loss: 0.9585 Acc: 0.6578
val Loss: 1.2139 Acc: 0.5859
Epoch 17/72
----------
train Loss: 0.9405 Acc: 0.6544
val Loss: 2.2633 Acc: 0.5000
Epoch 18/72
----------
train Loss: 0.9430 Acc: 0.6661
val Loss: 1.2051 Acc: 0.5859
Epoch 19/72
----------
train Loss: 0.9450 Acc: 0.6678
[I 2024-10-15 13:17:24,389] Trial 39 finished with value: 0.640625 and parameters: {'batch_size': 120, 'lr': 0.004708030611634488, 'num_epochs': 72, 'weight_decay': 0.017519766217849363, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 9 with value: 0.875.
val Loss: 1.1806 Acc: 0.5859
Early stopping at epoch 19 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.640625
Model weights saved at ./model_weights/ResNet34_bs_120_lr_0.004708030611634488_epoch_72_wd_0.017519766217849363_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/65
----------
train Loss: 2.8417 Acc: 0.6110
val Loss: 3.1861 Acc: 0.4062
Epoch 2/65
----------
train Loss: 2.4843 Acc: 0.6461
val Loss: 3.7956 Acc: 0.5859
Epoch 3/65
----------
train Loss: 2.2637 Acc: 0.6828
val Loss: 2.7494 Acc: 0.6016
Epoch 4/65
----------
train Loss: 2.3430 Acc: 0.6711
val Loss: 2.6965 Acc: 0.6016
Epoch 5/65
----------
train Loss: 2.5043 Acc: 0.6344
val Loss: 3.2763 Acc: 0.5859
Epoch 6/65
----------
train Loss: 2.3283 Acc: 0.6945
val Loss: 11.6459 Acc: 0.4062
Epoch 7/65
----------
train Loss: 2.4657 Acc: 0.6377
val Loss: 2.8520 Acc: 0.6016
Epoch 8/65
----------
train Loss: 2.4767 Acc: 0.6377
val Loss: 5.3579 Acc: 0.6094
Epoch 9/65
----------
train Loss: 2.4584 Acc: 0.6461
val Loss: 2.7777 Acc: 0.6016
Epoch 10/65
----------
train Loss: 2.4019 Acc: 0.6528
val Loss: 2.5347 Acc: 0.6250
Epoch 11/65
----------
train Loss: 2.4041 Acc: 0.6311
val Loss: 2.8564 Acc: 0.6016
Epoch 12/65
----------
train Loss: 2.4012 Acc: 0.6244
val Loss: 2.8025 Acc: 0.6172
Epoch 13/65
----------
train Loss: 2.4101 Acc: 0.6311
val Loss: 2.6648 Acc: 0.6172
Epoch 14/65
----------
train Loss: 2.4261 Acc: 0.6411
val Loss: 4.2891 Acc: 0.5625
Epoch 15/65
----------
train Loss: 2.4185 Acc: 0.6494
val Loss: 2.7999 Acc: 0.6172
Epoch 16/65
----------
train Loss: 2.3885 Acc: 0.6461
val Loss: 2.6907 Acc: 0.6406
Epoch 17/65
----------
train Loss: 2.3672 Acc: 0.6628
val Loss: 2.8502 Acc: 0.6172
Epoch 18/65
----------
train Loss: 2.4517 Acc: 0.6244
val Loss: 5.0241 Acc: 0.6016
Epoch 19/65
----------
train Loss: 2.3011 Acc: 0.6811
val Loss: 2.8169 Acc: 0.6094
Epoch 20/65
----------
train Loss: 2.3074 Acc: 0.6828
val Loss: 2.7796 Acc: 0.6250
Epoch 21/65
----------
train Loss: 2.2862 Acc: 0.6811
val Loss: 4.5102 Acc: 0.6094
Epoch 22/65
----------
train Loss: 2.2813 Acc: 0.6427
val Loss: 2.7789 Acc: 0.6016
Epoch 23/65
----------
train Loss: 2.3632 Acc: 0.6728
val Loss: 2.8898 Acc: 0.6406
Epoch 24/65
----------
train Loss: 2.2598 Acc: 0.6878
val Loss: 2.7217 Acc: 0.6328
Epoch 25/65
----------
train Loss: 2.3509 Acc: 0.6511
val Loss: 2.5366 Acc: 0.6016
Epoch 26/65
----------
train Loss: 2.2506 Acc: 0.6795
val Loss: 5.7390 Acc: 0.1953
Epoch 27/65
----------
train Loss: 2.2856 Acc: 0.6811
val Loss: 3.3119 Acc: 0.4062
Epoch 28/65
----------
train Loss: 2.2401 Acc: 0.7045
val Loss: 3.1212 Acc: 0.6172
Epoch 29/65
----------
train Loss: 2.2173 Acc: 0.7045
val Loss: 2.3753 Acc: 0.6797
Epoch 30/65
----------
train Loss: 2.2201 Acc: 0.6811
val Loss: 2.4422 Acc: 0.6562
Epoch 31/65
----------
train Loss: 2.1899 Acc: 0.7012
val Loss: 2.4928 Acc: 0.7031
Epoch 32/65
----------
train Loss: 2.2351 Acc: 0.6962
val Loss: 2.7939 Acc: 0.6094
Epoch 33/65
----------
train Loss: 2.2275 Acc: 0.7129
val Loss: 2.7683 Acc: 0.5625
Epoch 34/65
----------
train Loss: 2.2798 Acc: 0.6811
val Loss: 3.1186 Acc: 0.5625
Epoch 35/65
----------
train Loss: 2.2287 Acc: 0.7062
val Loss: 2.3038 Acc: 0.7109
Epoch 36/65
----------
train Loss: 2.2542 Acc: 0.6995
val Loss: 2.8834 Acc: 0.4844
Epoch 37/65
----------
train Loss: 2.2316 Acc: 0.6945
val Loss: 2.3783 Acc: 0.6641
Epoch 38/65
----------
train Loss: 2.1914 Acc: 0.7162
val Loss: 2.7162 Acc: 0.5234
Epoch 39/65
----------
train Loss: 2.2595 Acc: 0.7012
val Loss: 2.4358 Acc: 0.7031
Epoch 40/65
----------
train Loss: 2.2375 Acc: 0.6978
val Loss: 2.4919 Acc: 0.7188
Epoch 41/65
----------
train Loss: 2.1500 Acc: 0.7078
val Loss: 2.6909 Acc: 0.4531
Epoch 42/65
----------
train Loss: 2.2534 Acc: 0.6761
val Loss: 2.8612 Acc: 0.5312
Epoch 43/65
----------
train Loss: 2.2302 Acc: 0.6895
val Loss: 3.6738 Acc: 0.3516
Epoch 44/65
----------
train Loss: 2.2309 Acc: 0.6878
val Loss: 2.3782 Acc: 0.7109
Epoch 45/65
----------
train Loss: 2.1986 Acc: 0.7012
val Loss: 3.5643 Acc: 0.6406
Epoch 46/65
----------
train Loss: 2.1281 Acc: 0.7078
val Loss: 4.6121 Acc: 0.2031
Epoch 47/65
----------
train Loss: 2.1211 Acc: 0.7295
val Loss: 4.8776 Acc: 0.6094
Epoch 48/65
----------
train Loss: 2.1899 Acc: 0.6945
val Loss: 2.5633 Acc: 0.6875
Epoch 49/65
----------
train Loss: 2.1746 Acc: 0.7162
val Loss: 2.5115 Acc: 0.7500
Epoch 50/65
----------
train Loss: 2.1570 Acc: 0.7012
val Loss: 2.4504 Acc: 0.6562
Epoch 51/65
----------
train Loss: 2.1870 Acc: 0.7028
val Loss: 3.1463 Acc: 0.3828
Epoch 52/65
----------
train Loss: 2.1579 Acc: 0.6995
val Loss: 2.7862 Acc: 0.6484
Epoch 53/65
----------
train Loss: 2.1798 Acc: 0.7045
val Loss: 2.8776 Acc: 0.4062
Epoch 54/65
----------
train Loss: 2.1846 Acc: 0.7112
val Loss: 2.5215 Acc: 0.7266
Epoch 55/65
----------
train Loss: 2.2228 Acc: 0.6845
val Loss: 2.4923 Acc: 0.6641
Epoch 56/65
----------
train Loss: 2.2098 Acc: 0.6995
val Loss: 2.3235 Acc: 0.7422
Epoch 57/65
----------
train Loss: 2.1614 Acc: 0.7162
val Loss: 2.3361 Acc: 0.7109
Epoch 58/65
----------
train Loss: 2.1324 Acc: 0.7195
val Loss: 2.8013 Acc: 0.4609
Epoch 59/65
----------
train Loss: 2.1392 Acc: 0.7045
val Loss: 2.4970 Acc: 0.7344
Epoch 60/65
----------
train Loss: 2.1673 Acc: 0.7312
val Loss: 2.7228 Acc: 0.6797
Epoch 61/65
----------
train Loss: 2.1224 Acc: 0.7145
val Loss: 2.5327 Acc: 0.6328
Epoch 62/65
----------
train Loss: 2.1540 Acc: 0.7179
val Loss: 2.7750 Acc: 0.6250
Epoch 63/65
----------
train Loss: 2.2360 Acc: 0.6978
val Loss: 2.5946 Acc: 0.6641
Epoch 64/65
----------
train Loss: 2.1311 Acc: 0.6928
[I 2024-10-15 13:22:13,082] Trial 40 finished with value: 0.734375 and parameters: {'batch_size': 56, 'lr': 0.0014595393476534379, 'num_epochs': 65, 'weight_decay': 0.036838477097902673, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 4.6795 Acc: 0.1953
Early stopping at epoch 64 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.734375
Model weights saved at ./model_weights/ResNet34_bs_56_lr_0.0014595393476534379_epoch_65_wd_0.036838477097902673_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/41
----------
train Loss: 4.7846 Acc: 0.4658
val Loss: 4.0487 Acc: 0.6328
Epoch 2/41
----------
train Loss: 2.0434 Acc: 0.7513
val Loss: 3.4776 Acc: 0.6250
Epoch 3/41
----------
train Loss: 1.1932 Acc: 0.8481
val Loss: 3.1808 Acc: 0.7031
Epoch 4/41
----------
train Loss: 0.6898 Acc: 0.9316
val Loss: 3.0332 Acc: 0.7344
Epoch 5/41
----------
train Loss: 0.4230 Acc: 0.9683
val Loss: 3.1325 Acc: 0.7344
Epoch 6/41
----------
train Loss: 0.2998 Acc: 0.9883
val Loss: 3.3118 Acc: 0.7812
Epoch 7/41
----------
train Loss: 0.2064 Acc: 0.9917
val Loss: 3.3128 Acc: 0.7734
Epoch 8/41
----------
train Loss: 0.1755 Acc: 0.9933
val Loss: 3.3261 Acc: 0.7812
Epoch 9/41
----------
train Loss: 0.1390 Acc: 0.9967
val Loss: 3.3848 Acc: 0.7891
Epoch 10/41
----------
train Loss: 0.1348 Acc: 0.9933
val Loss: 3.5886 Acc: 0.8125
Epoch 11/41
----------
train Loss: 0.0941 Acc: 0.9933
val Loss: 3.6468 Acc: 0.8047
Epoch 12/41
----------
train Loss: 0.0980 Acc: 0.9933
val Loss: 3.7730 Acc: 0.8047
Epoch 13/41
----------
train Loss: 0.1089 Acc: 0.9917
val Loss: 3.8798 Acc: 0.7812
Epoch 14/41
----------
train Loss: 0.1102 Acc: 0.9900
val Loss: 3.8973 Acc: 0.7812
Epoch 15/41
----------
train Loss: 0.0782 Acc: 0.9933
val Loss: 3.9098 Acc: 0.7734
Epoch 16/41
----------
train Loss: 0.1007 Acc: 0.9917
val Loss: 4.1808 Acc: 0.8203
Epoch 17/41
----------
train Loss: 0.0727 Acc: 0.9917
val Loss: 4.1816 Acc: 0.7969
Epoch 18/41
----------
train Loss: 0.0686 Acc: 0.9933
val Loss: 4.1836 Acc: 0.7969
Epoch 19/41
----------
train Loss: 0.0634 Acc: 0.9933
val Loss: 4.1710 Acc: 0.7812
Epoch 20/41
----------
train Loss: 0.0618 Acc: 0.9950
val Loss: 4.1552 Acc: 0.7969
Epoch 21/41
----------
train Loss: 0.0780 Acc: 0.9933
val Loss: 4.3574 Acc: 0.8047
Epoch 22/41
----------
train Loss: 0.0606 Acc: 0.9933
val Loss: 4.3560 Acc: 0.7891
Epoch 23/41
----------
train Loss: 0.0729 Acc: 0.9933
val Loss: 4.3367 Acc: 0.7891
Epoch 24/41
----------
train Loss: 0.0558 Acc: 0.9950
val Loss: 4.3928 Acc: 0.8047
Epoch 25/41
----------
train Loss: 0.0568 Acc: 0.9950
val Loss: 4.3994 Acc: 0.7969
Epoch 26/41
----------
train Loss: 0.0572 Acc: 0.9950
val Loss: 4.1142 Acc: 0.7969
Epoch 27/41
----------
train Loss: 0.0513 Acc: 0.9950
val Loss: 4.4309 Acc: 0.8125
Epoch 28/41
----------
train Loss: 0.0442 Acc: 0.9950
val Loss: 4.4002 Acc: 0.7891
Epoch 29/41
----------
train Loss: 0.0447 Acc: 0.9950
val Loss: 4.5885 Acc: 0.8125
Epoch 30/41
----------
train Loss: 0.0693 Acc: 0.9950
val Loss: 4.2723 Acc: 0.7969
Epoch 31/41
----------
train Loss: 0.0615 Acc: 0.9917
val Loss: 4.2322 Acc: 0.7734
Epoch 32/41
----------
train Loss: 0.0462 Acc: 0.9950
val Loss: 4.5761 Acc: 0.8125
Epoch 33/41
----------
train Loss: 0.0471 Acc: 0.9950
val Loss: 4.6284 Acc: 0.8125
Epoch 34/41
----------
train Loss: 0.0459 Acc: 0.9967
val Loss: 4.5243 Acc: 0.7969
Epoch 35/41
----------
train Loss: 0.0533 Acc: 0.9950
val Loss: 4.5801 Acc: 0.7969
Epoch 36/41
----------
train Loss: 0.0548 Acc: 0.9933
val Loss: 4.6786 Acc: 0.7969
Epoch 37/41
----------
train Loss: 0.0363 Acc: 0.9967
val Loss: 4.5572 Acc: 0.7812
Epoch 38/41
----------
train Loss: 0.0474 Acc: 0.9933
val Loss: 4.7526 Acc: 0.7969
Epoch 39/41
----------
train Loss: 0.0392 Acc: 0.9967
val Loss: 4.7442 Acc: 0.8047
Epoch 40/41
----------
train Loss: 0.0461 Acc: 0.9933
val Loss: 4.5065 Acc: 0.7969
Epoch 41/41
----------
train Loss: 0.0525 Acc: 0.9950
[I 2024-10-15 13:25:16,205] Trial 41 finished with value: 0.8203125 and parameters: {'batch_size': 84, 'lr': 2.610786351050051e-05, 'num_epochs': 41, 'weight_decay': 0.0010034892173010899, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.875.
val Loss: 4.8215 Acc: 0.8203
Best val Acc: 0.820312
Model weights saved at ./model_weights/ResNet34_bs_84_lr_2.610786351050051e-05_epoch_41_wd_0.0010034892173010899_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/29
----------
train Loss: 5.4707 Acc: 0.2588
val Loss: 4.7834 Acc: 0.5859
Epoch 2/29
----------
train Loss: 2.9672 Acc: 0.6511
val Loss: 3.7410 Acc: 0.6797
Epoch 3/29
----------
train Loss: 1.8013 Acc: 0.8047
val Loss: 3.2589 Acc: 0.7031
Epoch 4/29
----------
train Loss: 1.2152 Acc: 0.8915
val Loss: 2.9701 Acc: 0.7422
Epoch 5/29
----------
train Loss: 0.8612 Acc: 0.9332
val Loss: 2.8330 Acc: 0.7812
Epoch 6/29
----------
train Loss: 0.6180 Acc: 0.9666
val Loss: 2.7473 Acc: 0.7891
Epoch 7/29
----------
train Loss: 0.4831 Acc: 0.9816
val Loss: 2.8057 Acc: 0.8047
Epoch 8/29
----------
train Loss: 0.3398 Acc: 0.9833
val Loss: 2.8061 Acc: 0.8047
Epoch 9/29
----------
train Loss: 0.3098 Acc: 0.9850
val Loss: 2.8680 Acc: 0.7891
Epoch 10/29
----------
train Loss: 0.2557 Acc: 0.9917
val Loss: 2.7858 Acc: 0.7969
Epoch 11/29
----------
train Loss: 0.2151 Acc: 0.9917
val Loss: 2.9722 Acc: 0.7812
Epoch 12/29
----------
train Loss: 0.2081 Acc: 0.9900
val Loss: 2.8841 Acc: 0.7891
Epoch 13/29
----------
train Loss: 0.1706 Acc: 0.9917
val Loss: 2.8770 Acc: 0.7969
Epoch 14/29
----------
train Loss: 0.1630 Acc: 0.9917
val Loss: 2.8849 Acc: 0.8125
Epoch 15/29
----------
train Loss: 0.1328 Acc: 0.9900
val Loss: 3.0293 Acc: 0.7812
Epoch 16/29
----------
train Loss: 0.1263 Acc: 0.9933
val Loss: 3.1676 Acc: 0.7812
Epoch 17/29
----------
train Loss: 0.1197 Acc: 0.9900
val Loss: 3.2058 Acc: 0.7812
Epoch 18/29
----------
train Loss: 0.1072 Acc: 0.9917
val Loss: 3.1904 Acc: 0.7734
Epoch 19/29
----------
train Loss: 0.1115 Acc: 0.9900
val Loss: 3.1555 Acc: 0.7891
Epoch 20/29
----------
train Loss: 0.1013 Acc: 0.9917
val Loss: 3.1971 Acc: 0.7734
Epoch 21/29
----------
train Loss: 0.1089 Acc: 0.9900
val Loss: 3.1517 Acc: 0.7812
Epoch 22/29
----------
train Loss: 0.0977 Acc: 0.9900
val Loss: 3.2378 Acc: 0.7891
Epoch 23/29
----------
train Loss: 0.1014 Acc: 0.9900
val Loss: 3.1068 Acc: 0.7812
Epoch 24/29
----------
train Loss: 0.0841 Acc: 0.9917
val Loss: 3.3702 Acc: 0.7812
Epoch 25/29
----------
train Loss: 0.0925 Acc: 0.9917
val Loss: 3.2079 Acc: 0.7656
Epoch 26/29
----------
train Loss: 0.0754 Acc: 0.9917
val Loss: 3.3059 Acc: 0.7734
Epoch 27/29
----------
train Loss: 0.0927 Acc: 0.9900
val Loss: 3.2765 Acc: 0.7812
Epoch 28/29
----------
train Loss: 0.0820 Acc: 0.9900
val Loss: 3.4253 Acc: 0.7812
Epoch 29/29
----------
train Loss: 0.0788 Acc: 0.9917
[I 2024-10-15 13:27:25,974] Trial 42 finished with value: 0.765625 and parameters: {'batch_size': 85, 'lr': 1.614210511068795e-05, 'num_epochs': 29, 'weight_decay': 0.0034607578702263325, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.875.
val Loss: 3.3440 Acc: 0.7656
Best val Acc: 0.765625
Model weights saved at ./model_weights/ResNet34_bs_85_lr_1.614210511068795e-05_epoch_29_wd_0.0034607578702263325_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/42
----------
train Loss: 4.7913 Acc: 0.5159
val Loss: 4.9029 Acc: 0.6953
Epoch 2/42
----------
train Loss: 1.7938 Acc: 0.7880
val Loss: 3.5816 Acc: 0.7500
Epoch 3/42
----------
train Loss: 0.8963 Acc: 0.9165
val Loss: 3.1963 Acc: 0.8047
Epoch 4/42
----------
train Loss: 0.5084 Acc: 0.9766
val Loss: 3.1038 Acc: 0.8047
Epoch 5/42
----------
train Loss: 0.3028 Acc: 0.9883
val Loss: 3.2572 Acc: 0.7969
Epoch 6/42
----------
train Loss: 0.2058 Acc: 0.9933
val Loss: 3.3098 Acc: 0.8047
Epoch 7/42
----------
train Loss: 0.1435 Acc: 0.9967
val Loss: 3.2550 Acc: 0.8125
Epoch 8/42
----------
train Loss: 0.1116 Acc: 0.9967
val Loss: 3.4976 Acc: 0.8125
Epoch 9/42
----------
train Loss: 0.0823 Acc: 0.9983
val Loss: 3.4553 Acc: 0.7734
Epoch 10/42
----------
train Loss: 0.0700 Acc: 0.9983
val Loss: 3.5943 Acc: 0.8047
Epoch 11/42
----------
train Loss: 0.0736 Acc: 0.9967
val Loss: 3.7717 Acc: 0.7969
Epoch 12/42
----------
train Loss: 0.0611 Acc: 0.9983
val Loss: 3.6421 Acc: 0.8203
Epoch 13/42
----------
train Loss: 0.0560 Acc: 0.9983
val Loss: 3.5911 Acc: 0.7969
Epoch 14/42
----------
train Loss: 0.0420 Acc: 0.9983
val Loss: 3.6584 Acc: 0.8047
Epoch 15/42
----------
train Loss: 0.0368 Acc: 0.9983
val Loss: 3.6983 Acc: 0.8047
Epoch 16/42
----------
train Loss: 0.0345 Acc: 0.9983
val Loss: 3.6786 Acc: 0.7969
Epoch 17/42
----------
train Loss: 0.0368 Acc: 0.9983
val Loss: 3.9029 Acc: 0.8125
Epoch 18/42
----------
train Loss: 0.0282 Acc: 0.9983
val Loss: 3.9229 Acc: 0.8047
Epoch 19/42
----------
train Loss: 0.0297 Acc: 0.9983
val Loss: 3.9526 Acc: 0.8125
Epoch 20/42
----------
train Loss: 0.0309 Acc: 0.9983
val Loss: 3.6213 Acc: 0.8047
Epoch 21/42
----------
train Loss: 0.0245 Acc: 1.0000
val Loss: 3.9926 Acc: 0.8125
Epoch 22/42
----------
train Loss: 0.0276 Acc: 0.9983
val Loss: 4.0214 Acc: 0.8125
Epoch 23/42
----------
train Loss: 0.0254 Acc: 0.9983
val Loss: 3.9855 Acc: 0.8125
Epoch 24/42
----------
train Loss: 0.0215 Acc: 0.9983
val Loss: 3.9978 Acc: 0.8203
Epoch 25/42
----------
train Loss: 0.0182 Acc: 0.9983
val Loss: 4.0874 Acc: 0.8203
Epoch 26/42
----------
train Loss: 0.0243 Acc: 0.9983
val Loss: 4.0155 Acc: 0.7969
Epoch 27/42
----------
train Loss: 0.0168 Acc: 0.9983
val Loss: 4.1528 Acc: 0.8125
Epoch 28/42
----------
train Loss: 0.0184 Acc: 0.9983
val Loss: 3.9900 Acc: 0.8047
Epoch 29/42
----------
train Loss: 0.0203 Acc: 0.9983
val Loss: 4.1858 Acc: 0.8047
Epoch 30/42
----------
train Loss: 0.0183 Acc: 0.9983
val Loss: 4.1863 Acc: 0.7891
Epoch 31/42
----------
train Loss: 0.0166 Acc: 0.9983
val Loss: 4.2142 Acc: 0.8125
Epoch 32/42
----------
train Loss: 0.0147 Acc: 0.9983
val Loss: 4.1249 Acc: 0.8047
Epoch 33/42
----------
train Loss: 0.0220 Acc: 0.9983
val Loss: 4.2213 Acc: 0.8047
Epoch 34/42
----------
train Loss: 0.0232 Acc: 0.9983
val Loss: 4.2975 Acc: 0.8203
Epoch 35/42
----------
train Loss: 0.0203 Acc: 0.9983
val Loss: 4.1362 Acc: 0.8047
Epoch 36/42
----------
train Loss: 0.0168 Acc: 0.9983
val Loss: 4.1654 Acc: 0.7969
Epoch 37/42
----------
train Loss: 0.0201 Acc: 0.9983
val Loss: 4.3629 Acc: 0.8047
Epoch 38/42
----------
train Loss: 0.0144 Acc: 0.9983
val Loss: 4.3992 Acc: 0.7969
Epoch 39/42
----------
train Loss: 0.0149 Acc: 0.9983
val Loss: 4.2672 Acc: 0.8047
Epoch 40/42
----------
train Loss: 0.0155 Acc: 0.9983
val Loss: 4.5477 Acc: 0.8047
Epoch 41/42
----------
train Loss: 0.0131 Acc: 0.9983
val Loss: 4.5190 Acc: 0.8047
Epoch 42/42
----------
train Loss: 0.0292 Acc: 0.9983
[I 2024-10-15 13:30:33,004] Trial 43 finished with value: 0.8125 and parameters: {'batch_size': 94, 'lr': 3.204181954327449e-05, 'num_epochs': 42, 'weight_decay': 0.001525436844440593, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.875.
val Loss: 4.5722 Acc: 0.8125
Best val Acc: 0.812500
Model weights saved at ./model_weights/ResNet34_bs_94_lr_3.204181954327449e-05_epoch_42_wd_0.001525436844440593_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/34
----------
train Loss: 5.5351 Acc: 0.2187
val Loss: 4.9000 Acc: 0.2734
Epoch 2/34
----------
train Loss: 4.2285 Acc: 0.4374
val Loss: 4.2916 Acc: 0.4141
Epoch 3/34
----------
train Loss: 3.4076 Acc: 0.5442
val Loss: 3.8853 Acc: 0.4844
Epoch 4/34
----------
train Loss: 2.8079 Acc: 0.6678
val Loss: 3.5953 Acc: 0.5703
Epoch 5/34
----------
train Loss: 2.3642 Acc: 0.6912
val Loss: 3.3079 Acc: 0.6250
Epoch 6/34
----------
train Loss: 1.9571 Acc: 0.7746
val Loss: 3.1101 Acc: 0.6797
Epoch 7/34
----------
train Loss: 1.6645 Acc: 0.8030
val Loss: 2.9388 Acc: 0.6953
Epoch 8/34
----------
train Loss: 1.4374 Acc: 0.8431
val Loss: 2.7835 Acc: 0.7188
Epoch 9/34
----------
train Loss: 1.1675 Acc: 0.8932
val Loss: 2.6601 Acc: 0.7500
Epoch 10/34
----------
train Loss: 1.0224 Acc: 0.9115
val Loss: 2.5923 Acc: 0.7656
Epoch 11/34
----------
train Loss: 0.8399 Acc: 0.9349
val Loss: 2.5280 Acc: 0.7734
Epoch 12/34
----------
train Loss: 0.6988 Acc: 0.9666
val Loss: 2.4374 Acc: 0.7969
Epoch 13/34
----------
train Loss: 0.6808 Acc: 0.9633
val Loss: 2.4109 Acc: 0.8047
Epoch 14/34
----------
train Loss: 0.5522 Acc: 0.9683
val Loss: 2.3851 Acc: 0.8047
Epoch 15/34
----------
train Loss: 0.4820 Acc: 0.9750
val Loss: 2.3477 Acc: 0.8125
Epoch 16/34
----------
train Loss: 0.4147 Acc: 0.9800
val Loss: 2.3485 Acc: 0.8203
Epoch 17/34
----------
train Loss: 0.4062 Acc: 0.9750
val Loss: 2.3182 Acc: 0.8281
Epoch 18/34
----------
train Loss: 0.3191 Acc: 0.9850
val Loss: 2.3842 Acc: 0.8438
Epoch 19/34
----------
train Loss: 0.2953 Acc: 0.9883
val Loss: 2.3547 Acc: 0.8359
Epoch 20/34
----------
train Loss: 0.2623 Acc: 0.9866
val Loss: 2.3729 Acc: 0.8516
Epoch 21/34
----------
train Loss: 0.2358 Acc: 0.9917
val Loss: 2.3432 Acc: 0.8203
Epoch 22/34
----------
train Loss: 0.2126 Acc: 0.9900
val Loss: 2.3935 Acc: 0.8359
Epoch 23/34
----------
train Loss: 0.1920 Acc: 0.9900
val Loss: 2.4120 Acc: 0.8438
Epoch 24/34
----------
train Loss: 0.1760 Acc: 0.9917
val Loss: 2.3813 Acc: 0.8516
Epoch 25/34
----------
train Loss: 0.1650 Acc: 0.9900
val Loss: 2.4145 Acc: 0.8359
Epoch 26/34
----------
train Loss: 0.1630 Acc: 0.9933
val Loss: 2.4548 Acc: 0.8438
Epoch 27/34
----------
train Loss: 0.1579 Acc: 0.9933
val Loss: 2.5490 Acc: 0.8281
Epoch 28/34
----------
train Loss: 0.1427 Acc: 0.9933
val Loss: 2.5217 Acc: 0.8438
Epoch 29/34
----------
train Loss: 0.1451 Acc: 0.9933
val Loss: 2.4980 Acc: 0.8438
Epoch 30/34
----------
train Loss: 0.1194 Acc: 0.9933
val Loss: 2.6244 Acc: 0.8203
Epoch 31/34
----------
train Loss: 0.1435 Acc: 0.9917
val Loss: 2.6397 Acc: 0.8281
Epoch 32/34
----------
train Loss: 0.1502 Acc: 0.9950
val Loss: 2.6178 Acc: 0.8281
Epoch 33/34
----------
train Loss: 0.0956 Acc: 0.9917
val Loss: 2.5922 Acc: 0.8281
Epoch 34/34
----------
train Loss: 0.1123 Acc: 0.9933
[I 2024-10-15 13:33:05,472] Trial 44 finished with value: 0.84375 and parameters: {'batch_size': 86, 'lr': 6.376505825516742e-06, 'num_epochs': 34, 'weight_decay': 0.00010985812823510558, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.875.
val Loss: 2.4919 Acc: 0.8438
Best val Acc: 0.843750
Model weights saved at ./model_weights/ResNet34_bs_86_lr_6.376505825516742e-06_epoch_34_wd_0.00010985812823510558_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/47
----------
train Loss: 3.8830 Acc: 0.5209
val Loss: 3.7881 Acc: 0.7578
Epoch 2/47
----------
train Loss: 1.1162 Acc: 0.8781
val Loss: 2.6025 Acc: 0.7422
Epoch 3/47
----------
train Loss: 0.6005 Acc: 0.9366
val Loss: 3.6500 Acc: 0.7500
Epoch 4/47
----------
train Loss: 0.5609 Acc: 0.9399
val Loss: 3.6494 Acc: 0.8438
Epoch 5/47
----------
train Loss: 0.5740 Acc: 0.9249
val Loss: 2.9007 Acc: 0.8125
Epoch 6/47
----------
train Loss: 0.5583 Acc: 0.9499
val Loss: 2.7209 Acc: 0.7656
Epoch 7/47
----------
train Loss: 0.3356 Acc: 0.9616
val Loss: 3.4255 Acc: 0.8281
Epoch 8/47
----------
train Loss: 0.2055 Acc: 0.9766
val Loss: 3.4824 Acc: 0.8359
Epoch 9/47
----------
train Loss: 0.1734 Acc: 0.9783
val Loss: 3.0468 Acc: 0.8203
Epoch 10/47
----------
train Loss: 0.1468 Acc: 0.9850
val Loss: 2.9336 Acc: 0.8359
Epoch 11/47
----------
train Loss: 0.1574 Acc: 0.9883
val Loss: 4.0307 Acc: 0.7109
Epoch 12/47
----------
train Loss: 0.1179 Acc: 0.9833
val Loss: 3.9723 Acc: 0.8125
Epoch 13/47
----------
train Loss: 0.2391 Acc: 0.9750
val Loss: 2.9479 Acc: 0.8828
Epoch 14/47
----------
train Loss: 0.1669 Acc: 0.9816
val Loss: 3.2221 Acc: 0.8125
Epoch 15/47
----------
train Loss: 0.2062 Acc: 0.9716
val Loss: 4.0211 Acc: 0.8359
Epoch 16/47
----------
train Loss: 0.1170 Acc: 0.9883
val Loss: 3.0881 Acc: 0.8047
Epoch 17/47
----------
train Loss: 0.2548 Acc: 0.9649
val Loss: 3.5966 Acc: 0.7656
Epoch 18/47
----------
train Loss: 0.4147 Acc: 0.9549
val Loss: 4.9083 Acc: 0.7500
Epoch 19/47
----------
train Loss: 0.2401 Acc: 0.9683
val Loss: 5.3610 Acc: 0.8203
Epoch 20/47
----------
train Loss: 0.1407 Acc: 0.9833
val Loss: 4.9933 Acc: 0.6250
Epoch 21/47
----------
train Loss: 0.2914 Acc: 0.9683
val Loss: 5.6516 Acc: 0.7344
Epoch 22/47
----------
train Loss: 0.1991 Acc: 0.9783
val Loss: 4.0990 Acc: 0.8125
Epoch 23/47
----------
train Loss: 0.1638 Acc: 0.9699
val Loss: 3.6216 Acc: 0.7812
Epoch 24/47
----------
train Loss: 0.0874 Acc: 0.9850
val Loss: 3.9261 Acc: 0.8125
Epoch 25/47
----------
train Loss: 0.0902 Acc: 0.9883
val Loss: 4.1358 Acc: 0.8594
Epoch 26/47
----------
train Loss: 0.0581 Acc: 0.9950
val Loss: 3.8322 Acc: 0.7969
Epoch 27/47
----------
train Loss: 0.0270 Acc: 0.9950
val Loss: 4.0059 Acc: 0.8359
Epoch 28/47
----------
train Loss: 0.0574 Acc: 0.9917
val Loss: 5.0386 Acc: 0.8281
Epoch 29/47
----------
train Loss: 0.0388 Acc: 0.9933
val Loss: 4.9936 Acc: 0.8203
Epoch 30/47
----------
train Loss: 0.0425 Acc: 0.9950
val Loss: 4.7581 Acc: 0.8047
Epoch 31/47
----------
train Loss: 0.0331 Acc: 0.9933
val Loss: 4.0152 Acc: 0.8281
Epoch 32/47
----------
train Loss: 0.0224 Acc: 0.9967
val Loss: 4.2025 Acc: 0.8438
Epoch 33/47
----------
train Loss: 0.0244 Acc: 0.9967
val Loss: 4.5498 Acc: 0.8359
Epoch 34/47
----------
train Loss: 0.0273 Acc: 0.9967
val Loss: 4.4343 Acc: 0.8438
Epoch 35/47
----------
train Loss: 0.0171 Acc: 0.9967
val Loss: 4.1648 Acc: 0.8359
Epoch 36/47
----------
train Loss: 0.0209 Acc: 0.9967
val Loss: 4.4861 Acc: 0.8359
Epoch 37/47
----------
train Loss: 0.0230 Acc: 0.9967
val Loss: 4.8585 Acc: 0.8438
Epoch 38/47
----------
train Loss: 0.0211 Acc: 0.9950
val Loss: 4.8164 Acc: 0.8203
Epoch 39/47
----------
train Loss: 0.0184 Acc: 0.9967
val Loss: 4.6314 Acc: 0.8281
Epoch 40/47
----------
train Loss: 0.0239 Acc: 0.9967
val Loss: 5.0619 Acc: 0.8438
Epoch 41/47
----------
train Loss: 0.0288 Acc: 0.9967
val Loss: 5.0995 Acc: 0.8125
Epoch 42/47
----------
train Loss: 0.0274 Acc: 0.9967
val Loss: 4.7099 Acc: 0.8047
Epoch 43/47
----------
train Loss: 0.0489 Acc: 0.9950
val Loss: 4.1739 Acc: 0.8438
Epoch 44/47
----------
train Loss: 0.0238 Acc: 0.9967
val Loss: 3.8040 Acc: 0.8438
Epoch 45/47
----------
train Loss: 0.0188 Acc: 0.9967
val Loss: 3.8873 Acc: 0.8516
Epoch 46/47
----------
train Loss: 0.0166 Acc: 0.9967
val Loss: 4.0458 Acc: 0.8516
Epoch 47/47
----------
train Loss: 0.0239 Acc: 0.9967
[I 2024-10-15 13:36:36,549] Trial 45 finished with value: 0.8671875 and parameters: {'batch_size': 70, 'lr': 0.00017893070393886447, 'num_epochs': 47, 'weight_decay': 0.0004099752445398594, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.875.
val Loss: 4.0272 Acc: 0.8672
Best val Acc: 0.867188
Model weights saved at ./model_weights/ResNet34_bs_70_lr_0.00017893070393886447_epoch_47_wd_0.0004099752445398594_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/49
----------
train Loss: 4.3815 Acc: 0.5275
val Loss: 15.7008 Acc: 0.3359
Epoch 2/49
----------
train Loss: 2.4105 Acc: 0.7479
val Loss: 3.6461 Acc: 0.7031
Epoch 3/49
----------
train Loss: 1.2533 Acc: 0.8581
val Loss: 3.5311 Acc: 0.6719
Epoch 4/49
----------
train Loss: 1.0518 Acc: 0.8765
val Loss: 5.0325 Acc: 0.7344
Epoch 5/49
----------
train Loss: 0.4945 Acc: 0.9549
val Loss: 3.0758 Acc: 0.6641
Epoch 6/49
----------
train Loss: 0.6527 Acc: 0.9399
val Loss: 3.5972 Acc: 0.6562
Epoch 7/49
----------
train Loss: 1.0371 Acc: 0.8881
val Loss: 4.8138 Acc: 0.6094
Epoch 8/49
----------
train Loss: 1.3027 Acc: 0.8631
val Loss: 3.8165 Acc: 0.7891
Epoch 9/49
----------
train Loss: 0.4719 Acc: 0.9249
val Loss: 3.8605 Acc: 0.7891
Epoch 10/49
----------
train Loss: 0.5335 Acc: 0.9416
val Loss: 6.7048 Acc: 0.7500
Epoch 11/49
----------
train Loss: 0.7165 Acc: 0.9416
val Loss: 3.5259 Acc: 0.7344
Epoch 12/49
----------
train Loss: 0.3283 Acc: 0.9583
val Loss: 2.7336 Acc: 0.7734
Epoch 13/49
----------
train Loss: 0.2443 Acc: 0.9683
val Loss: 3.3075 Acc: 0.7969
Epoch 14/49
----------
train Loss: 0.1609 Acc: 0.9850
val Loss: 3.4016 Acc: 0.7734
Epoch 15/49
----------
train Loss: 0.1326 Acc: 0.9866
val Loss: 3.7696 Acc: 0.8125
Epoch 16/49
----------
train Loss: 0.1762 Acc: 0.9816
val Loss: 4.6335 Acc: 0.7578
Epoch 17/49
----------
train Loss: 0.2429 Acc: 0.9683
val Loss: 4.9505 Acc: 0.7969
Epoch 18/49
----------
train Loss: 0.1296 Acc: 0.9833
val Loss: 3.3627 Acc: 0.8047
Epoch 19/49
----------
train Loss: 0.0978 Acc: 0.9933
val Loss: 4.1702 Acc: 0.8125
Epoch 20/49
----------
train Loss: 0.0714 Acc: 0.9917
val Loss: 5.1557 Acc: 0.8203
Epoch 21/49
----------
train Loss: 0.0622 Acc: 0.9983
val Loss: 4.2993 Acc: 0.8125
Epoch 22/49
----------
train Loss: 0.0603 Acc: 0.9967
val Loss: 5.0860 Acc: 0.8125
Epoch 23/49
----------
train Loss: 0.0423 Acc: 0.9967
val Loss: 5.1100 Acc: 0.8281
Epoch 24/49
----------
train Loss: 0.0342 Acc: 0.9933
val Loss: 5.2575 Acc: 0.8203
Epoch 25/49
----------
train Loss: 0.0264 Acc: 0.9983
val Loss: 5.5685 Acc: 0.8203
Epoch 26/49
----------
train Loss: 0.0367 Acc: 0.9983
val Loss: 6.0430 Acc: 0.8203
Epoch 27/49
----------
train Loss: 0.1423 Acc: 0.9733
val Loss: 5.8071 Acc: 0.8047
Epoch 28/49
----------
train Loss: 0.2273 Acc: 0.9766
val Loss: 5.5400 Acc: 0.7266
Epoch 29/49
----------
train Loss: 0.2493 Acc: 0.9583
val Loss: 5.5092 Acc: 0.7812
Epoch 30/49
----------
train Loss: 0.2058 Acc: 0.9783
val Loss: 4.4174 Acc: 0.7734
Epoch 31/49
----------
train Loss: 0.3978 Acc: 0.9533
val Loss: 5.7938 Acc: 0.6094
Epoch 32/49
----------
train Loss: 0.6407 Acc: 0.9299
val Loss: 3.7324 Acc: 0.7422
Epoch 33/49
----------
train Loss: 1.2570 Acc: 0.9215
val Loss: 19.2030 Acc: 0.4922
Epoch 34/49
----------
train Loss: 1.4500 Acc: 0.8815
val Loss: 6.6531 Acc: 0.7109
Epoch 35/49
----------
train Loss: 0.4654 Acc: 0.9366
val Loss: 4.0782 Acc: 0.7500
Epoch 36/49
----------
train Loss: 0.3660 Acc: 0.9583
val Loss: 3.9254 Acc: 0.7969
Epoch 37/49
----------
train Loss: 0.2644 Acc: 0.9800
val Loss: 4.1254 Acc: 0.7969
Epoch 38/49
----------
train Loss: 0.1205 Acc: 0.9816
val Loss: 4.7078 Acc: 0.7969
Epoch 39/49
----------
train Loss: 0.0886 Acc: 0.9933
val Loss: 3.5753 Acc: 0.7891
Epoch 40/49
----------
train Loss: 0.0623 Acc: 0.9933
val Loss: 3.7438 Acc: 0.8203
Epoch 41/49
----------
train Loss: 0.0340 Acc: 0.9950
val Loss: 4.0028 Acc: 0.8047
Epoch 42/49
----------
train Loss: 0.0331 Acc: 0.9950
val Loss: 3.7828 Acc: 0.8359
Epoch 43/49
----------
train Loss: 0.0216 Acc: 0.9983
val Loss: 3.7423 Acc: 0.8125
Epoch 44/49
----------
train Loss: 0.0369 Acc: 0.9967
val Loss: 3.9256 Acc: 0.8203
Epoch 45/49
----------
train Loss: 0.0214 Acc: 0.9983
val Loss: 3.9978 Acc: 0.8203
Epoch 46/49
----------
train Loss: 0.0261 Acc: 0.9967
val Loss: 4.1688 Acc: 0.8281
Epoch 47/49
----------
train Loss: 0.0190 Acc: 0.9983
val Loss: 3.9412 Acc: 0.8281
Epoch 48/49
----------
train Loss: 0.0184 Acc: 1.0000
val Loss: 3.7706 Acc: 0.8281
Epoch 49/49
----------
train Loss: 0.0260 Acc: 0.9967
[I 2024-10-15 13:40:20,058] Trial 46 finished with value: 0.8359375 and parameters: {'batch_size': 30, 'lr': 0.0003966144196035202, 'num_epochs': 49, 'weight_decay': 0.0004835265070419388, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 9 with value: 0.875.
val Loss: 3.7721 Acc: 0.8359
Best val Acc: 0.835938
Model weights saved at ./model_weights/ResNet34_bs_30_lr_0.0003966144196035202_epoch_49_wd_0.0004835265070419388_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/55
----------
train Loss: 2.8922 Acc: 0.6878
val Loss: 1.6664 Acc: 0.7422
Epoch 2/55
----------
train Loss: 1.7854 Acc: 0.7896
val Loss: 1.3680 Acc: 0.8047
Epoch 3/55
----------
train Loss: 1.5768 Acc: 0.8130
val Loss: 1.2742 Acc: 0.8281
Epoch 4/55
----------
train Loss: 1.3520 Acc: 0.8598
val Loss: 1.1752 Acc: 0.8594
Epoch 5/55
----------
train Loss: 1.5802 Acc: 0.8397
val Loss: 1.1927 Acc: 0.8516
Epoch 6/55
----------
train Loss: 1.4487 Acc: 0.8798
val Loss: 1.1650 Acc: 0.8516
Epoch 7/55
----------
train Loss: 1.4525 Acc: 0.8514
val Loss: 1.2326 Acc: 0.8359
Epoch 8/55
----------
train Loss: 1.2921 Acc: 0.9149
val Loss: 1.2387 Acc: 0.8281
Epoch 9/55
----------
train Loss: 1.4468 Acc: 0.8414
val Loss: 1.1457 Acc: 0.8516
Epoch 10/55
----------
train Loss: 1.2548 Acc: 0.9065
val Loss: 1.2068 Acc: 0.8594
Epoch 11/55
----------
train Loss: 1.4397 Acc: 0.8681
val Loss: 1.2410 Acc: 0.8281
Epoch 12/55
----------
train Loss: 1.1561 Acc: 0.9332
val Loss: 1.3235 Acc: 0.8672
Epoch 13/55
----------
train Loss: 1.2865 Acc: 0.9265
val Loss: 1.4143 Acc: 0.7500
Epoch 14/55
----------
train Loss: 1.4335 Acc: 0.8147
val Loss: 1.4765 Acc: 0.8203
Epoch 15/55
----------
train Loss: 1.2986 Acc: 0.9115
val Loss: 1.1327 Acc: 0.8281
Epoch 16/55
----------
train Loss: 1.3036 Acc: 0.8982
val Loss: 1.2561 Acc: 0.8125
Epoch 17/55
----------
train Loss: 1.3052 Acc: 0.8848
val Loss: 1.4611 Acc: 0.7969
Epoch 18/55
----------
train Loss: 1.3680 Acc: 0.9015
val Loss: 1.3753 Acc: 0.8125
Epoch 19/55
----------
train Loss: 1.3226 Acc: 0.9232
val Loss: 1.1380 Acc: 0.8438
Epoch 20/55
----------
train Loss: 1.2288 Acc: 0.9432
val Loss: 1.2623 Acc: 0.8438
Epoch 21/55
----------
train Loss: 1.4010 Acc: 0.9098
val Loss: 1.5033 Acc: 0.7969
Epoch 22/55
----------
train Loss: 1.1851 Acc: 0.8932
val Loss: 1.4071 Acc: 0.7656
Epoch 23/55
----------
train Loss: 1.2362 Acc: 0.8648
val Loss: 1.5446 Acc: 0.8125
Epoch 24/55
----------
train Loss: 1.0545 Acc: 0.9366
val Loss: 1.1503 Acc: 0.8672
Epoch 25/55
----------
train Loss: 1.5073 Acc: 0.8681
val Loss: 1.0704 Acc: 0.8672
Epoch 26/55
----------
train Loss: 1.2176 Acc: 0.9065
val Loss: 1.3455 Acc: 0.7891
Epoch 27/55
----------
train Loss: 1.3633 Acc: 0.8965
val Loss: 1.3338 Acc: 0.8281
Epoch 28/55
----------
train Loss: 1.2140 Acc: 0.9165
val Loss: 1.2962 Acc: 0.8438
Epoch 29/55
----------
train Loss: 1.1891 Acc: 0.9366
val Loss: 1.2039 Acc: 0.8359
Epoch 30/55
----------
train Loss: 1.2605 Acc: 0.9032
val Loss: 1.3854 Acc: 0.8203
Epoch 31/55
----------
train Loss: 1.1518 Acc: 0.9048
val Loss: 1.3069 Acc: 0.8281
Epoch 32/55
----------
train Loss: 1.3199 Acc: 0.8848
val Loss: 1.3127 Acc: 0.8203
Epoch 33/55
----------
train Loss: 1.3383 Acc: 0.8898
val Loss: 1.4836 Acc: 0.8047
Epoch 34/55
----------
train Loss: 1.4513 Acc: 0.8765
val Loss: 1.2999 Acc: 0.8438
Epoch 35/55
----------
train Loss: 1.4153 Acc: 0.8481
val Loss: 1.6507 Acc: 0.7812
Epoch 36/55
----------
train Loss: 1.3702 Acc: 0.8564
val Loss: 1.6620 Acc: 0.7500
Epoch 37/55
----------
train Loss: 1.2642 Acc: 0.8765
val Loss: 1.8789 Acc: 0.7969
Epoch 38/55
----------
train Loss: 1.4118 Acc: 0.8765
val Loss: 1.4906 Acc: 0.7734
Epoch 39/55
----------
train Loss: 1.2768 Acc: 0.9115
val Loss: 1.3509 Acc: 0.8047
Epoch 40/55
----------
train Loss: 1.3712 Acc: 0.9299
val Loss: 1.3269 Acc: 0.7969
Epoch 41/55
----------
train Loss: 1.1627 Acc: 0.8965
val Loss: 1.4279 Acc: 0.7734
Epoch 42/55
----------
train Loss: 1.0918 Acc: 0.9282
val Loss: 1.2326 Acc: 0.8203
Epoch 43/55
----------
train Loss: 1.1355 Acc: 0.9098
val Loss: 1.2942 Acc: 0.8203
Epoch 44/55
----------
train Loss: 1.3899 Acc: 0.8664
val Loss: 1.4046 Acc: 0.8203
Epoch 45/55
----------
train Loss: 1.3981 Acc: 0.9082
val Loss: 1.6237 Acc: 0.7578
Epoch 46/55
----------
train Loss: 1.3288 Acc: 0.9048
val Loss: 1.6906 Acc: 0.7500
Epoch 47/55
----------
train Loss: 1.3016 Acc: 0.9115
val Loss: 1.2864 Acc: 0.8203
Epoch 48/55
----------
train Loss: 1.3204 Acc: 0.9015
val Loss: 1.5696 Acc: 0.7578
Epoch 49/55
----------
train Loss: 1.2527 Acc: 0.9115
val Loss: 1.3477 Acc: 0.8203
Epoch 50/55
----------
train Loss: 1.1890 Acc: 0.9032
val Loss: 1.4552 Acc: 0.7812
Epoch 51/55
----------
train Loss: 1.3790 Acc: 0.8614
val Loss: 1.3181 Acc: 0.7578
Epoch 52/55
----------
train Loss: 1.2624 Acc: 0.9015
val Loss: 1.6589 Acc: 0.7031
Epoch 53/55
----------
train Loss: 1.2013 Acc: 0.9182
val Loss: 1.2779 Acc: 0.8047
Epoch 54/55
----------
train Loss: 1.3620 Acc: 0.8681
val Loss: 1.4261 Acc: 0.7812
Epoch 55/55
----------
train Loss: 1.3619 Acc: 0.8765
[I 2024-10-15 13:44:27,049] Trial 47 finished with value: 0.7890625 and parameters: {'batch_size': 70, 'lr': 0.00010899906305007557, 'num_epochs': 55, 'weight_decay': 0.027895524513597923, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 1.5169 Acc: 0.7891
Best val Acc: 0.789062
Model weights saved at ./model_weights/ResNet34_bs_70_lr_0.00010899906305007557_epoch_55_wd_0.027895524513597923_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/59
----------
train Loss: 0.4565 Acc: 0.6778
val Loss: 0.2742 Acc: 0.7656
Epoch 2/59
----------
train Loss: 0.3299 Acc: 0.7529
val Loss: 0.2436 Acc: 0.8203
Epoch 3/59
----------
train Loss: 0.2848 Acc: 0.8314
val Loss: 0.2075 Acc: 0.8438
Epoch 4/59
----------
train Loss: 0.2711 Acc: 0.8865
val Loss: 0.2056 Acc: 0.8828
Epoch 5/59
----------
train Loss: 0.2454 Acc: 0.8781
val Loss: 0.2101 Acc: 0.8359
Epoch 6/59
----------
train Loss: 0.2293 Acc: 0.9015
val Loss: 0.1984 Acc: 0.8438
Epoch 7/59
----------
train Loss: 0.2742 Acc: 0.8731
val Loss: 0.2180 Acc: 0.8359
Epoch 8/59
----------
train Loss: 0.2694 Acc: 0.8598
val Loss: 0.2244 Acc: 0.8438
Epoch 9/59
----------
train Loss: 0.2620 Acc: 0.8798
val Loss: 0.2149 Acc: 0.8672
Epoch 10/59
----------
train Loss: 0.2384 Acc: 0.9065
val Loss: 0.2418 Acc: 0.7734
Epoch 11/59
----------
train Loss: 0.2474 Acc: 0.8765
val Loss: 0.2121 Acc: 0.8594
Epoch 12/59
----------
train Loss: 0.2277 Acc: 0.8932
val Loss: 0.2303 Acc: 0.8359
Epoch 13/59
----------
train Loss: 0.2243 Acc: 0.9232
val Loss: 0.2656 Acc: 0.7812
Epoch 14/59
----------
train Loss: 0.2230 Acc: 0.9299
val Loss: 0.1907 Acc: 0.8672
Epoch 15/59
----------
train Loss: 0.2415 Acc: 0.8848
val Loss: 0.2491 Acc: 0.7812
Epoch 16/59
----------
train Loss: 0.1959 Acc: 0.9750
val Loss: 0.1770 Acc: 0.8516
Epoch 17/59
----------
train Loss: 0.2381 Acc: 0.8965
val Loss: 0.2039 Acc: 0.8594
Epoch 18/59
----------
train Loss: 0.1972 Acc: 0.9149
val Loss: 0.2066 Acc: 0.8594
Epoch 19/59
----------
train Loss: 0.2391 Acc: 0.8881
val Loss: 0.2125 Acc: 0.8125
Epoch 20/59
----------
train Loss: 0.2174 Acc: 0.8915
val Loss: 0.2076 Acc: 0.8438
Epoch 21/59
----------
train Loss: 0.2141 Acc: 0.9232
val Loss: 0.2119 Acc: 0.8594
Epoch 22/59
----------
train Loss: 0.2354 Acc: 0.9082
val Loss: 0.2060 Acc: 0.8281
Epoch 23/59
----------
train Loss: 0.2400 Acc: 0.9316
val Loss: 0.2377 Acc: 0.8125
Epoch 24/59
----------
train Loss: 0.2067 Acc: 0.9449
val Loss: 0.2092 Acc: 0.8281
Epoch 25/59
----------
train Loss: 0.2028 Acc: 0.9416
val Loss: 0.2204 Acc: 0.8125
Epoch 26/59
----------
train Loss: 0.2150 Acc: 0.9265
val Loss: 0.2237 Acc: 0.8203
Epoch 27/59
----------
train Loss: 0.2257 Acc: 0.9349
val Loss: 0.2210 Acc: 0.8125
Epoch 28/59
----------
train Loss: 0.2204 Acc: 0.9382
val Loss: 0.2258 Acc: 0.7969
Epoch 29/59
----------
train Loss: 0.2111 Acc: 0.9098
val Loss: 0.2141 Acc: 0.8516
Epoch 30/59
----------
train Loss: 0.2140 Acc: 0.9366
val Loss: 0.2020 Acc: 0.8359
Epoch 31/59
----------
train Loss: 0.2083 Acc: 0.9082
val Loss: 0.2144 Acc: 0.8281
Epoch 32/59
----------
train Loss: 0.2319 Acc: 0.8648
val Loss: 0.2179 Acc: 0.8359
Epoch 33/59
----------
train Loss: 0.1805 Acc: 0.9482
val Loss: 0.2273 Acc: 0.8281
Epoch 34/59
----------
train Loss: 0.2186 Acc: 0.9182
val Loss: 0.1928 Acc: 0.8516
Epoch 35/59
----------
train Loss: 0.1918 Acc: 0.9366
val Loss: 0.1927 Acc: 0.8516
Epoch 36/59
----------
train Loss: 0.1910 Acc: 0.9533
val Loss: 0.2256 Acc: 0.7969
Epoch 37/59
----------
train Loss: 0.1909 Acc: 0.9299
val Loss: 0.2063 Acc: 0.8281
Epoch 38/59
----------
train Loss: 0.2223 Acc: 0.9115
val Loss: 0.2083 Acc: 0.8359
Epoch 39/59
----------
train Loss: 0.1979 Acc: 0.9399
val Loss: 0.1883 Acc: 0.8359
Epoch 40/59
----------
train Loss: 0.2063 Acc: 0.9249
val Loss: 0.1910 Acc: 0.8672
Epoch 41/59
----------
train Loss: 0.1794 Acc: 0.9566
val Loss: 0.1985 Acc: 0.8750
Epoch 42/59
----------
train Loss: 0.2018 Acc: 0.9549
val Loss: 0.2026 Acc: 0.8516
Epoch 43/59
----------
train Loss: 0.2078 Acc: 0.9299
val Loss: 0.2433 Acc: 0.8203
Epoch 44/59
----------
train Loss: 0.2032 Acc: 0.9282
val Loss: 0.2215 Acc: 0.8203
Epoch 45/59
----------
train Loss: 0.1973 Acc: 0.9733
val Loss: 0.1995 Acc: 0.8594
Epoch 46/59
----------
train Loss: 0.1934 Acc: 0.9182
val Loss: 0.2354 Acc: 0.7812
Epoch 47/59
----------
train Loss: 0.2196 Acc: 0.9065
val Loss: 0.2305 Acc: 0.8281
Epoch 48/59
----------
train Loss: 0.1894 Acc: 0.9232
val Loss: 0.1852 Acc: 0.8594
Epoch 49/59
----------
train Loss: 0.2199 Acc: 0.8982
val Loss: 0.2386 Acc: 0.8203
Epoch 50/59
----------
train Loss: 0.2258 Acc: 0.8982
val Loss: 0.2376 Acc: 0.8281
Epoch 51/59
----------
train Loss: 0.2038 Acc: 0.9215
val Loss: 0.1892 Acc: 0.8281
Epoch 52/59
----------
train Loss: 0.2142 Acc: 0.9349
val Loss: 0.2067 Acc: 0.8438
Epoch 53/59
----------
train Loss: 0.2049 Acc: 0.9382
val Loss: 0.2437 Acc: 0.8125
Epoch 54/59
----------
train Loss: 0.1863 Acc: 0.9316
val Loss: 0.2182 Acc: 0.8281
Epoch 55/59
----------
train Loss: 0.1898 Acc: 0.9449
val Loss: 0.2060 Acc: 0.8438
Epoch 56/59
----------
train Loss: 0.2094 Acc: 0.9649
val Loss: 0.2253 Acc: 0.8125
Epoch 57/59
----------
train Loss: 0.2133 Acc: 0.9182
val Loss: 0.2082 Acc: 0.8281
Epoch 58/59
----------
train Loss: 0.2075 Acc: 0.9265
val Loss: 0.2189 Acc: 0.8203
Epoch 59/59
----------
train Loss: 0.1579 Acc: 0.9683
[I 2024-10-15 13:48:54,212] Trial 48 finished with value: 0.8125 and parameters: {'batch_size': 47, 'lr': 0.00018741903991959977, 'num_epochs': 59, 'weight_decay': 0.00021397005141430384, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 0.2182 Acc: 0.8125
Best val Acc: 0.812500
Model weights saved at ./model_weights/ResNet34_bs_47_lr_0.00018741903991959977_epoch_59_wd_0.00021397005141430384_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/88
----------
train Loss: 2.7491 Acc: 0.6427
val Loss: 5.2324 Acc: 0.1797
Epoch 2/88
----------
train Loss: 2.5441 Acc: 0.6477
val Loss: 2.6089 Acc: 0.6328
Epoch 3/88
----------
train Loss: 2.6361 Acc: 0.6093
val Loss: 2.7394 Acc: 0.6328
Epoch 4/88
----------
train Loss: 2.7172 Acc: 0.6127
val Loss: 3.1016 Acc: 0.5469
Epoch 5/88
----------
train Loss: 2.6805 Acc: 0.6110
val Loss: 2.8439 Acc: 0.6328
Epoch 6/88
----------
train Loss: 2.6515 Acc: 0.6060
val Loss: 2.8902 Acc: 0.6328
Epoch 7/88
----------
train Loss: 2.5618 Acc: 0.6160
val Loss: 4.1892 Acc: 0.3125
Epoch 8/88
----------
train Loss: 2.7086 Acc: 0.6093
val Loss: 2.5984 Acc: 0.6328
Epoch 9/88
----------
train Loss: 2.6338 Acc: 0.6093
val Loss: 2.6928 Acc: 0.6328
Epoch 10/88
----------
train Loss: 2.5122 Acc: 0.6294
val Loss: 2.6295 Acc: 0.6328
Epoch 11/88
----------
train Loss: 2.5246 Acc: 0.6327
val Loss: 2.6007 Acc: 0.6328
Epoch 12/88
----------
train Loss: 2.5893 Acc: 0.6127
val Loss: 2.7517 Acc: 0.6406
Epoch 13/88
----------
train Loss: 2.5682 Acc: 0.6260
val Loss: 2.6565 Acc: 0.6328
Epoch 14/88
----------
train Loss: 2.6618 Acc: 0.6160
val Loss: 2.9302 Acc: 0.6328
Epoch 15/88
----------
train Loss: 2.5754 Acc: 0.6127
val Loss: 2.8365 Acc: 0.6484
Epoch 16/88
----------
train Loss: 2.5684 Acc: 0.5943
val Loss: 2.7365 Acc: 0.6172
Epoch 17/88
----------
train Loss: 2.5689 Acc: 0.6060
val Loss: 2.8846 Acc: 0.5625
Epoch 18/88
----------
train Loss: 2.5576 Acc: 0.6010
val Loss: 2.9043 Acc: 0.6094
Epoch 19/88
----------
train Loss: 2.5542 Acc: 0.6227
val Loss: 2.7285 Acc: 0.6328
Epoch 20/88
----------
train Loss: 2.5421 Acc: 0.6043
val Loss: 2.6386 Acc: 0.6406
Epoch 21/88
----------
train Loss: 2.5389 Acc: 0.6110
val Loss: 2.7853 Acc: 0.6562
Epoch 22/88
----------
train Loss: 2.4960 Acc: 0.6294
val Loss: 2.8864 Acc: 0.6328
Epoch 23/88
----------
train Loss: 2.4740 Acc: 0.6244
val Loss: 2.9082 Acc: 0.5938
Epoch 24/88
----------
train Loss: 2.4853 Acc: 0.6377
val Loss: 2.5636 Acc: 0.6484
Epoch 25/88
----------
train Loss: 2.4328 Acc: 0.6394
val Loss: 2.9281 Acc: 0.6484
Epoch 26/88
----------
train Loss: 2.4903 Acc: 0.6344
val Loss: 2.6573 Acc: 0.6328
Epoch 27/88
----------
train Loss: 2.4564 Acc: 0.6461
val Loss: 5.1555 Acc: 0.6328
Epoch 28/88
----------
train Loss: 2.4767 Acc: 0.6327
val Loss: 2.6231 Acc: 0.6250
Epoch 29/88
----------
train Loss: 2.4705 Acc: 0.6311
val Loss: 2.6481 Acc: 0.6562
Epoch 30/88
----------
train Loss: 2.4293 Acc: 0.6461
val Loss: 2.8092 Acc: 0.6328
Epoch 31/88
----------
train Loss: 2.4361 Acc: 0.6277
val Loss: 2.6140 Acc: 0.6641
Epoch 32/88
----------
train Loss: 2.4217 Acc: 0.6427
val Loss: 2.8653 Acc: 0.6094
Epoch 33/88
----------
train Loss: 2.4129 Acc: 0.6644
val Loss: 3.9872 Acc: 0.1250
Epoch 34/88
----------
train Loss: 2.4189 Acc: 0.6427
val Loss: 2.8656 Acc: 0.6406
Epoch 35/88
----------
train Loss: 2.4240 Acc: 0.6628
val Loss: 2.6620 Acc: 0.6406
Epoch 36/88
----------
train Loss: 2.4120 Acc: 0.6628
val Loss: 3.4364 Acc: 0.3672
Epoch 37/88
----------
train Loss: 2.4240 Acc: 0.6377
val Loss: 2.9812 Acc: 0.4453
Epoch 38/88
----------
train Loss: 2.3773 Acc: 0.6528
val Loss: 2.7458 Acc: 0.6562
Epoch 39/88
----------
train Loss: 2.4500 Acc: 0.6361
val Loss: 2.5325 Acc: 0.6406
Epoch 40/88
----------
train Loss: 2.4099 Acc: 0.6427
val Loss: 3.0380 Acc: 0.6562
Epoch 41/88
----------
train Loss: 2.4115 Acc: 0.6311
val Loss: 2.6205 Acc: 0.6641
Epoch 42/88
----------
train Loss: 2.4245 Acc: 0.6377
val Loss: 2.9508 Acc: 0.6641
Epoch 43/88
----------
train Loss: 2.4768 Acc: 0.6327
val Loss: 2.7460 Acc: 0.6328
Epoch 44/88
----------
train Loss: 2.4171 Acc: 0.6377
val Loss: 2.9375 Acc: 0.5469
Epoch 45/88
----------
train Loss: 2.4604 Acc: 0.6444
val Loss: 2.7080 Acc: 0.6641
Epoch 46/88
----------
train Loss: 2.4785 Acc: 0.6210
val Loss: 2.5391 Acc: 0.6406
Epoch 47/88
----------
train Loss: 2.4229 Acc: 0.6394
val Loss: 2.7950 Acc: 0.6406
Epoch 48/88
----------
train Loss: 2.4452 Acc: 0.6327
val Loss: 2.8622 Acc: 0.5078
Epoch 49/88
----------
train Loss: 2.3544 Acc: 0.6394
val Loss: 3.3283 Acc: 0.2812
Epoch 50/88
----------
train Loss: 2.3827 Acc: 0.6361
val Loss: 2.8195 Acc: 0.6250
Epoch 51/88
----------
train Loss: 2.4111 Acc: 0.6494
val Loss: 2.7603 Acc: 0.5938
Epoch 52/88
----------
train Loss: 2.4359 Acc: 0.6344
val Loss: 3.2816 Acc: 0.6328
Epoch 53/88
----------
train Loss: 2.3194 Acc: 0.6511
val Loss: 2.5395 Acc: 0.6875
Epoch 54/88
----------
train Loss: 2.3159 Acc: 0.6544
val Loss: 2.5645 Acc: 0.6484
Epoch 55/88
----------
train Loss: 2.3772 Acc: 0.6394
val Loss: 3.1094 Acc: 0.3672
Epoch 56/88
----------
train Loss: 2.3552 Acc: 0.6544
val Loss: 2.4422 Acc: 0.6719
Epoch 57/88
----------
train Loss: 2.3588 Acc: 0.6578
val Loss: 2.6174 Acc: 0.6641
Epoch 58/88
----------
train Loss: 2.3098 Acc: 0.6661
val Loss: 3.4415 Acc: 0.1406
Epoch 59/88
----------
train Loss: 2.2776 Acc: 0.6811
val Loss: 2.8421 Acc: 0.3359
Epoch 60/88
----------
train Loss: 2.2617 Acc: 0.7045
val Loss: 2.9391 Acc: 0.3516
Epoch 61/88
----------
train Loss: 2.3213 Acc: 0.6795
val Loss: 3.4850 Acc: 0.6484
Epoch 62/88
----------
train Loss: 2.2916 Acc: 0.6745
val Loss: 2.6538 Acc: 0.7031
Epoch 63/88
----------
train Loss: 2.2744 Acc: 0.6978
val Loss: 2.5494 Acc: 0.6484
Epoch 64/88
----------
train Loss: 2.3503 Acc: 0.6678
val Loss: 2.9178 Acc: 0.3828
Epoch 65/88
----------
train Loss: 2.2894 Acc: 0.6778
val Loss: 3.2563 Acc: 0.2500
Epoch 66/88
----------
train Loss: 2.2758 Acc: 0.6761
val Loss: 3.4106 Acc: 0.6562
Epoch 67/88
----------
train Loss: 2.3334 Acc: 0.6811
val Loss: 2.6526 Acc: 0.6719
Epoch 68/88
----------
train Loss: 2.2981 Acc: 0.6861
val Loss: 3.2544 Acc: 0.1406
Epoch 69/88
----------
train Loss: 2.2998 Acc: 0.6878
val Loss: 5.0359 Acc: 0.6328
Epoch 70/88
----------
train Loss: 2.2497 Acc: 0.6928
val Loss: 3.2712 Acc: 0.1484
Epoch 71/88
----------
train Loss: 2.2552 Acc: 0.7012
val Loss: 2.7711 Acc: 0.6719
Epoch 72/88
----------
train Loss: 2.3077 Acc: 0.6761
val Loss: 3.0530 Acc: 0.3125
Epoch 73/88
----------
train Loss: 2.3283 Acc: 0.6444
val Loss: 2.6811 Acc: 0.6562
Epoch 74/88
----------
train Loss: 2.2893 Acc: 0.6962
val Loss: 2.7560 Acc: 0.5469
Epoch 75/88
----------
train Loss: 2.3003 Acc: 0.6628
val Loss: 2.6393 Acc: 0.6328
Epoch 76/88
----------
train Loss: 2.3711 Acc: 0.6427
val Loss: 3.8319 Acc: 0.6641
Epoch 77/88
----------
train Loss: 2.3696 Acc: 0.6477
val Loss: 5.0929 Acc: 0.1250
Epoch 78/88
----------
train Loss: 2.3093 Acc: 0.6678
val Loss: 3.1335 Acc: 0.1719
Epoch 79/88
----------
train Loss: 2.3180 Acc: 0.6594
val Loss: 2.8862 Acc: 0.6250
Epoch 80/88
----------
train Loss: 2.3254 Acc: 0.6644
val Loss: 2.7685 Acc: 0.6250
Epoch 81/88
----------
train Loss: 2.2847 Acc: 0.6578
val Loss: 3.0557 Acc: 0.2109
Epoch 82/88
----------
train Loss: 2.3209 Acc: 0.6678
val Loss: 4.1882 Acc: 0.6328
Epoch 83/88
----------
train Loss: 2.2483 Acc: 0.6795
val Loss: 2.9643 Acc: 0.2500
Epoch 84/88
----------
train Loss: 2.2766 Acc: 0.6661
val Loss: 2.4959 Acc: 0.6406
Epoch 85/88
----------
train Loss: 2.2890 Acc: 0.6828
val Loss: 3.8939 Acc: 0.6328
Epoch 86/88
----------
train Loss: 2.3063 Acc: 0.6778
val Loss: 2.3265 Acc: 0.7031
Epoch 87/88
----------
train Loss: 2.3085 Acc: 0.6477
val Loss: 2.6218 Acc: 0.7188
Epoch 88/88
----------
train Loss: 2.3486 Acc: 0.6461
[I 2024-10-15 13:55:26,713] Trial 49 finished with value: 0.71875 and parameters: {'batch_size': 57, 'lr': 0.0013351449660986522, 'num_epochs': 88, 'weight_decay': 0.11791336110250375, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 9 with value: 0.875.
val Loss: 3.2967 Acc: 0.6328
Best val Acc: 0.718750
Model weights saved at ./model_weights/ResNet34_bs_57_lr_0.0013351449660986522_epoch_88_wd_0.11791336110250375_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/47
----------
train Loss: 0.9386 Acc: 0.6194
val Loss: 0.5266 Acc: 0.8516
Epoch 2/47
----------
train Loss: 0.2929 Acc: 0.9332
val Loss: 0.4619 Acc: 0.8438
Epoch 3/47
----------
train Loss: 0.1081 Acc: 0.9850
val Loss: 0.4113 Acc: 0.8750
Epoch 4/47
----------
train Loss: 0.0712 Acc: 0.9917
val Loss: 0.4726 Acc: 0.8203
Epoch 5/47
----------
train Loss: 0.0632 Acc: 0.9883
val Loss: 0.3947 Acc: 0.8516
Epoch 6/47
----------
train Loss: 0.0460 Acc: 0.9917
val Loss: 0.5065 Acc: 0.8516
Epoch 7/47
----------
train Loss: 0.0499 Acc: 0.9900
val Loss: 0.4418 Acc: 0.8516
Epoch 8/47
----------
train Loss: 0.0703 Acc: 0.9850
val Loss: 0.4457 Acc: 0.8672
Epoch 9/47
----------
train Loss: 0.0529 Acc: 0.9850
val Loss: 0.4168 Acc: 0.8516
Epoch 10/47
----------
train Loss: 0.0578 Acc: 0.9833
val Loss: 0.5368 Acc: 0.8438
Epoch 11/47
----------
train Loss: 0.1010 Acc: 0.9683
val Loss: 0.6655 Acc: 0.7891
Epoch 12/47
----------
train Loss: 0.1805 Acc: 0.9416
val Loss: 0.7323 Acc: 0.8203
Epoch 13/47
----------
train Loss: 0.2540 Acc: 0.9048
val Loss: 0.6395 Acc: 0.8828
Epoch 14/47
----------
train Loss: 0.1412 Acc: 0.9516
val Loss: 0.4388 Acc: 0.8672
Epoch 15/47
----------
train Loss: 0.0878 Acc: 0.9733
val Loss: 0.5778 Acc: 0.8672
Epoch 16/47
----------
train Loss: 0.0715 Acc: 0.9783
val Loss: 0.4952 Acc: 0.8516
Epoch 17/47
----------
train Loss: 0.0627 Acc: 0.9766
val Loss: 0.4711 Acc: 0.8594
Epoch 18/47
----------
train Loss: 0.1153 Acc: 0.9649
val Loss: 0.3604 Acc: 0.8984
Epoch 19/47
----------
train Loss: 0.0335 Acc: 0.9917
val Loss: 0.3507 Acc: 0.8906
Epoch 20/47
----------
train Loss: 0.0225 Acc: 0.9917
val Loss: 0.4614 Acc: 0.8828
Epoch 21/47
----------
train Loss: 0.0235 Acc: 0.9917
val Loss: 0.4223 Acc: 0.8594
Epoch 22/47
----------
train Loss: 0.0420 Acc: 0.9866
val Loss: 0.4092 Acc: 0.8750
Epoch 23/47
----------
train Loss: 0.0822 Acc: 0.9783
val Loss: 0.6619 Acc: 0.7812
Epoch 24/47
----------
train Loss: 0.1858 Acc: 0.9416
val Loss: 0.7126 Acc: 0.8125
Epoch 25/47
----------
train Loss: 0.2549 Acc: 0.9132
val Loss: 0.7201 Acc: 0.7422
Epoch 26/47
----------
train Loss: 0.1296 Acc: 0.9583
val Loss: 0.5308 Acc: 0.8516
Epoch 27/47
----------
train Loss: 0.0734 Acc: 0.9783
val Loss: 0.4580 Acc: 0.8750
Epoch 28/47
----------
train Loss: 0.0386 Acc: 0.9816
val Loss: 0.3957 Acc: 0.9141
Epoch 29/47
----------
train Loss: 0.0260 Acc: 0.9900
val Loss: 0.4699 Acc: 0.8672
Epoch 30/47
----------
train Loss: 0.0245 Acc: 0.9850
val Loss: 0.3678 Acc: 0.8906
Epoch 31/47
----------
train Loss: 0.0340 Acc: 0.9850
val Loss: 0.7509 Acc: 0.8516
Epoch 32/47
----------
train Loss: 0.1160 Acc: 0.9549
val Loss: 0.6434 Acc: 0.8516
Epoch 33/47
----------
train Loss: 0.1570 Acc: 0.9533
val Loss: 0.6299 Acc: 0.8047
Epoch 34/47
----------
train Loss: 0.1236 Acc: 0.9566
val Loss: 0.4070 Acc: 0.9062
Epoch 35/47
----------
train Loss: 0.1069 Acc: 0.9666
val Loss: 0.4381 Acc: 0.8516
Epoch 36/47
----------
train Loss: 0.1167 Acc: 0.9566
val Loss: 0.5108 Acc: 0.8516
Epoch 37/47
----------
train Loss: 0.0979 Acc: 0.9699
val Loss: 0.4761 Acc: 0.8359
Epoch 38/47
----------
train Loss: 0.0725 Acc: 0.9766
val Loss: 0.4343 Acc: 0.8750
Epoch 39/47
----------
train Loss: 0.1421 Acc: 0.9649
val Loss: 0.5416 Acc: 0.8281
Epoch 40/47
----------
train Loss: 0.0777 Acc: 0.9800
val Loss: 0.4879 Acc: 0.8438
Epoch 41/47
----------
train Loss: 0.0732 Acc: 0.9750
val Loss: 0.4718 Acc: 0.8594
Epoch 42/47
----------
train Loss: 0.0702 Acc: 0.9733
val Loss: 0.6611 Acc: 0.8672
Epoch 43/47
----------
train Loss: 0.1399 Acc: 0.9633
val Loss: 1.1992 Acc: 0.6484
Epoch 44/47
----------
train Loss: 0.0850 Acc: 0.9750
val Loss: 0.4762 Acc: 0.8438
Epoch 45/47
----------
train Loss: 0.0543 Acc: 0.9800
val Loss: 0.4574 Acc: 0.8672
Epoch 46/47
----------
train Loss: 0.0358 Acc: 0.9850
val Loss: 0.3988 Acc: 0.9062
Epoch 47/47
----------
train Loss: 0.0904 Acc: 0.9649
[I 2024-10-15 13:58:58,657] Trial 50 finished with value: 0.90625 and parameters: {'batch_size': 79, 'lr': 6.608347193011818e-05, 'num_epochs': 47, 'weight_decay': 0.05822831098237232, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 0.7011 Acc: 0.8281
Best val Acc: 0.906250
Model weights saved at ./model_weights/ResNet34_bs_79_lr_6.608347193011818e-05_epoch_47_wd_0.05822831098237232_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/47
----------
train Loss: 1.0447 Acc: 0.5943
val Loss: 0.7000 Acc: 0.7500
Epoch 2/47
----------
train Loss: 0.3046 Acc: 0.9316
val Loss: 0.6193 Acc: 0.7969
Epoch 3/47
----------
train Loss: 0.1303 Acc: 0.9800
val Loss: 0.6101 Acc: 0.8125
Epoch 4/47
----------
train Loss: 0.0615 Acc: 0.9967
val Loss: 0.6330 Acc: 0.8281
Epoch 5/47
----------
train Loss: 0.0424 Acc: 0.9967
val Loss: 0.6504 Acc: 0.7969
Epoch 6/47
----------
train Loss: 0.0580 Acc: 0.9933
val Loss: 0.7162 Acc: 0.7891
Epoch 7/47
----------
train Loss: 0.0791 Acc: 0.9816
val Loss: 0.7469 Acc: 0.7812
Epoch 8/47
----------
train Loss: 0.1321 Acc: 0.9699
val Loss: 0.7681 Acc: 0.7656
Epoch 9/47
----------
train Loss: 0.0827 Acc: 0.9833
val Loss: 0.8045 Acc: 0.7656
Epoch 10/47
----------
train Loss: 0.0576 Acc: 0.9816
val Loss: 0.8941 Acc: 0.8047
Epoch 11/47
----------
train Loss: 0.0388 Acc: 0.9917
val Loss: 0.7818 Acc: 0.7812
Epoch 12/47
----------
train Loss: 0.0309 Acc: 0.9933
val Loss: 0.7556 Acc: 0.7812
Epoch 13/47
----------
train Loss: 0.0445 Acc: 0.9900
val Loss: 0.8120 Acc: 0.7656
Epoch 14/47
----------
train Loss: 0.0543 Acc: 0.9866
val Loss: 0.9480 Acc: 0.7812
Epoch 15/47
----------
train Loss: 0.1312 Acc: 0.9599
val Loss: 0.8272 Acc: 0.7656
Epoch 16/47
----------
train Loss: 0.1731 Acc: 0.9466
val Loss: 1.4601 Acc: 0.7422
Epoch 17/47
----------
train Loss: 0.2238 Acc: 0.9299
val Loss: 0.9453 Acc: 0.7734
Epoch 18/47
----------
train Loss: 0.1502 Acc: 0.9449
val Loss: 0.7553 Acc: 0.7812
Epoch 19/47
----------
train Loss: 0.1197 Acc: 0.9649
val Loss: 0.8947 Acc: 0.7734
Epoch 20/47
----------
train Loss: 0.0955 Acc: 0.9683
val Loss: 0.9443 Acc: 0.7500
Epoch 21/47
----------
train Loss: 0.0782 Acc: 0.9816
val Loss: 0.9001 Acc: 0.7812
Epoch 22/47
----------
train Loss: 0.0364 Acc: 0.9917
val Loss: 0.7372 Acc: 0.8203
Epoch 23/47
----------
train Loss: 0.0287 Acc: 0.9933
val Loss: 0.8775 Acc: 0.7812
Epoch 24/47
----------
train Loss: 0.0231 Acc: 0.9917
val Loss: 0.8426 Acc: 0.7891
Epoch 25/47
----------
train Loss: 0.0193 Acc: 0.9917
val Loss: 0.8885 Acc: 0.7969
Epoch 26/47
----------
train Loss: 0.0213 Acc: 0.9900
val Loss: 1.1326 Acc: 0.7734
Epoch 27/47
----------
train Loss: 0.0466 Acc: 0.9917
val Loss: 0.8068 Acc: 0.8281
Epoch 28/47
----------
train Loss: 0.0214 Acc: 0.9933
val Loss: 0.8329 Acc: 0.8281
Epoch 29/47
----------
train Loss: 0.0201 Acc: 0.9933
val Loss: 0.8712 Acc: 0.8047
Epoch 30/47
----------
train Loss: 0.0177 Acc: 0.9933
val Loss: 0.9674 Acc: 0.7891
Epoch 31/47
----------
train Loss: 0.0144 Acc: 0.9950
val Loss: 0.9293 Acc: 0.7969
Epoch 32/47
----------
train Loss: 0.0179 Acc: 0.9933
val Loss: 0.8291 Acc: 0.7891
Epoch 33/47
----------
train Loss: 0.0143 Acc: 0.9933
val Loss: 0.9241 Acc: 0.7422
Epoch 34/47
----------
train Loss: 0.0187 Acc: 0.9933
val Loss: 0.9819 Acc: 0.8203
Epoch 35/47
----------
train Loss: 0.1467 Acc: 0.9566
val Loss: 2.5541 Acc: 0.7422
Epoch 36/47
----------
train Loss: 0.3889 Acc: 0.8915
val Loss: 1.2049 Acc: 0.7344
Epoch 37/47
----------
train Loss: 0.2075 Acc: 0.9382
val Loss: 0.7661 Acc: 0.7656
Epoch 38/47
----------
train Loss: 0.1938 Acc: 0.9349
val Loss: 0.9386 Acc: 0.7812
Epoch 39/47
----------
train Loss: 0.1516 Acc: 0.9616
val Loss: 0.8907 Acc: 0.7422
Epoch 40/47
----------
train Loss: 0.0972 Acc: 0.9666
val Loss: 0.9117 Acc: 0.7500
Epoch 41/47
----------
train Loss: 0.0457 Acc: 0.9833
val Loss: 0.9460 Acc: 0.7891
Epoch 42/47
----------
train Loss: 0.0508 Acc: 0.9816
val Loss: 0.9930 Acc: 0.7578
Epoch 43/47
----------
train Loss: 0.0930 Acc: 0.9766
val Loss: 0.9726 Acc: 0.7812
Epoch 44/47
----------
train Loss: 0.0943 Acc: 0.9733
val Loss: 0.8854 Acc: 0.7734
Epoch 45/47
----------
train Loss: 0.0580 Acc: 0.9833
val Loss: 0.9372 Acc: 0.8125
Epoch 46/47
----------
train Loss: 0.0610 Acc: 0.9783
val Loss: 0.8948 Acc: 0.8125
Epoch 47/47
----------
train Loss: 0.0588 Acc: 0.9850
[I 2024-10-15 14:02:31,252] Trial 51 finished with value: 0.8125 and parameters: {'batch_size': 76, 'lr': 5.9074853953921164e-05, 'num_epochs': 47, 'weight_decay': 0.05679696035926462, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 0.8719 Acc: 0.8125
Best val Acc: 0.812500
Model weights saved at ./model_weights/ResNet34_bs_76_lr_5.9074853953921164e-05_epoch_47_wd_0.05679696035926462_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/50
----------
train Loss: 0.7441 Acc: 0.7546
val Loss: 0.5272 Acc: 0.8203
Epoch 2/50
----------
train Loss: 0.5034 Acc: 0.8197
val Loss: 0.8658 Acc: 0.7500
Epoch 3/50
----------
train Loss: 0.6743 Acc: 0.7763
val Loss: 0.9176 Acc: 0.6875
Epoch 4/50
----------
train Loss: 0.6839 Acc: 0.7646
val Loss: 0.7112 Acc: 0.7500
Epoch 5/50
----------
train Loss: 0.6647 Acc: 0.7696
val Loss: 0.9061 Acc: 0.7188
Epoch 6/50
----------
train Loss: 0.7131 Acc: 0.7596
val Loss: 0.7492 Acc: 0.7969
Epoch 7/50
----------
train Loss: 0.6969 Acc: 0.7579
val Loss: 0.8025 Acc: 0.7422
Epoch 8/50
----------
train Loss: 0.6267 Acc: 0.7830
val Loss: 1.2891 Acc: 0.4062
Epoch 9/50
----------
train Loss: 0.7289 Acc: 0.7496
val Loss: 0.7798 Acc: 0.7500
Epoch 10/50
----------
train Loss: 0.7064 Acc: 0.7429
val Loss: 1.0011 Acc: 0.7266
Epoch 11/50
----------
train Loss: 0.6932 Acc: 0.7529
val Loss: 0.9433 Acc: 0.7500
Epoch 12/50
----------
train Loss: 0.7210 Acc: 0.7513
val Loss: 0.8849 Acc: 0.7422
Epoch 13/50
----------
train Loss: 0.7780 Acc: 0.7429
val Loss: 0.8475 Acc: 0.7109
Epoch 14/50
----------
train Loss: 0.7310 Acc: 0.7446
val Loss: 1.0575 Acc: 0.6484
Epoch 15/50
----------
train Loss: 0.7511 Acc: 0.7362
val Loss: 1.3181 Acc: 0.6641
Epoch 16/50
----------
train Loss: 0.6982 Acc: 0.7696
val Loss: 0.8375 Acc: 0.6719
Epoch 17/50
----------
train Loss: 0.7873 Acc: 0.7229
val Loss: 0.9083 Acc: 0.7109
Epoch 18/50
----------
train Loss: 0.7515 Acc: 0.7429
val Loss: 0.8236 Acc: 0.7266
Epoch 19/50
----------
train Loss: 0.7386 Acc: 0.7513
val Loss: 0.9111 Acc: 0.6719
Epoch 20/50
----------
train Loss: 0.7749 Acc: 0.7329
val Loss: 481.7751 Acc: 0.1406
Epoch 21/50
----------
train Loss: 0.8759 Acc: 0.6711
val Loss: 2.2601 Acc: 0.6562
Epoch 22/50
----------
train Loss: 0.7834 Acc: 0.7346
val Loss: 4.5184 Acc: 0.2188
Epoch 23/50
----------
train Loss: 0.7960 Acc: 0.7212
[I 2024-10-15 14:04:14,547] Trial 52 finished with value: 0.7265625 and parameters: {'batch_size': 62, 'lr': 0.0004205429132828109, 'num_epochs': 50, 'weight_decay': 0.22887177574216847, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 0.8616 Acc: 0.6719
Early stopping at epoch 23 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.726562
Model weights saved at ./model_weights/ResNet34_bs_62_lr_0.0004205429132828109_epoch_50_wd_0.22887177574216847_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/53
----------
train Loss: 0.6980 Acc: 0.7563
val Loss: 0.7413 Acc: 0.7422
Epoch 2/53
----------
train Loss: 0.2241 Acc: 0.9282
val Loss: 0.7732 Acc: 0.7656
Epoch 3/53
----------
train Loss: 0.1182 Acc: 0.9666
val Loss: 0.8453 Acc: 0.7734
Epoch 4/53
----------
train Loss: 0.0785 Acc: 0.9733
val Loss: 0.9738 Acc: 0.7812
Epoch 5/53
----------
train Loss: 0.1002 Acc: 0.9683
val Loss: 1.0971 Acc: 0.7891
Epoch 6/53
----------
train Loss: 0.2003 Acc: 0.9265
val Loss: 1.9520 Acc: 0.6016
Epoch 7/53
----------
train Loss: 0.1333 Acc: 0.9599
val Loss: 0.9032 Acc: 0.6797
Epoch 8/53
----------
train Loss: 0.1219 Acc: 0.9566
val Loss: 1.0341 Acc: 0.7578
Epoch 9/53
----------
train Loss: 0.0948 Acc: 0.9616
val Loss: 1.1625 Acc: 0.7891
Epoch 10/53
----------
train Loss: 0.0958 Acc: 0.9733
val Loss: 0.8869 Acc: 0.8125
Epoch 11/53
----------
train Loss: 0.0915 Acc: 0.9699
val Loss: 1.3515 Acc: 0.7422
Epoch 12/53
----------
train Loss: 0.1561 Acc: 0.9482
val Loss: 1.9708 Acc: 0.6953
Epoch 13/53
----------
train Loss: 0.1278 Acc: 0.9683
val Loss: 0.9623 Acc: 0.7031
Epoch 14/53
----------
train Loss: 0.1551 Acc: 0.9549
val Loss: 1.1398 Acc: 0.7734
Epoch 15/53
----------
train Loss: 0.1085 Acc: 0.9599
val Loss: 1.0693 Acc: 0.7578
Epoch 16/53
----------
train Loss: 0.0773 Acc: 0.9783
val Loss: 0.8025 Acc: 0.7812
Epoch 17/53
----------
train Loss: 0.0581 Acc: 0.9800
val Loss: 1.1302 Acc: 0.7578
Epoch 18/53
----------
train Loss: 0.0773 Acc: 0.9699
val Loss: 1.3472 Acc: 0.7812
Epoch 19/53
----------
train Loss: 0.1842 Acc: 0.9416
val Loss: 0.9148 Acc: 0.7500
Epoch 20/53
----------
train Loss: 0.1307 Acc: 0.9583
val Loss: 1.7596 Acc: 0.7109
Epoch 21/53
----------
train Loss: 0.1393 Acc: 0.9666
val Loss: 1.0036 Acc: 0.7734
Epoch 22/53
----------
train Loss: 0.0810 Acc: 0.9783
val Loss: 0.8899 Acc: 0.8047
Epoch 23/53
----------
train Loss: 0.0834 Acc: 0.9750
val Loss: 0.9912 Acc: 0.7188
Epoch 24/53
----------
train Loss: 0.0471 Acc: 0.9883
val Loss: 0.7844 Acc: 0.7891
Epoch 25/53
----------
train Loss: 0.0831 Acc: 0.9699
val Loss: 1.1920 Acc: 0.8125
Epoch 26/53
----------
train Loss: 0.0726 Acc: 0.9750
val Loss: 0.7612 Acc: 0.8047
Epoch 27/53
----------
train Loss: 0.0562 Acc: 0.9816
val Loss: 0.8603 Acc: 0.7656
Epoch 28/53
----------
train Loss: 0.1351 Acc: 0.9599
val Loss: 1.0027 Acc: 0.6953
Epoch 29/53
----------
train Loss: 0.1334 Acc: 0.9499
val Loss: 1.8192 Acc: 0.6875
Epoch 30/53
----------
train Loss: 0.1156 Acc: 0.9566
val Loss: 1.0180 Acc: 0.7188
Epoch 31/53
----------
train Loss: 0.0747 Acc: 0.9783
val Loss: 0.9506 Acc: 0.7422
Epoch 32/53
----------
train Loss: 0.1269 Acc: 0.9533
val Loss: 1.0464 Acc: 0.7266
Epoch 33/53
----------
train Loss: 0.1776 Acc: 0.9533
val Loss: 1.1004 Acc: 0.7188
Epoch 34/53
----------
train Loss: 0.2123 Acc: 0.9249
val Loss: 1.0732 Acc: 0.6953
Epoch 35/53
----------
train Loss: 0.0876 Acc: 0.9716
val Loss: 0.7164 Acc: 0.7656
Epoch 36/53
----------
train Loss: 0.0591 Acc: 0.9800
val Loss: 1.1180 Acc: 0.7266
Epoch 37/53
----------
train Loss: 0.0478 Acc: 0.9850
val Loss: 1.3461 Acc: 0.7031
Epoch 38/53
----------
train Loss: 0.0460 Acc: 0.9866
val Loss: 0.7680 Acc: 0.7891
Epoch 39/53
----------
train Loss: 0.0237 Acc: 0.9900
val Loss: 0.7914 Acc: 0.7891
Epoch 40/53
----------
train Loss: 0.0636 Acc: 0.9783
val Loss: 1.1583 Acc: 0.7734
Epoch 41/53
----------
train Loss: 0.1018 Acc: 0.9633
val Loss: 1.3719 Acc: 0.7344
Epoch 42/53
----------
train Loss: 0.1250 Acc: 0.9666
val Loss: 2.6494 Acc: 0.6016
Epoch 43/53
----------
train Loss: 0.1270 Acc: 0.9583
val Loss: 0.6569 Acc: 0.8047
Epoch 44/53
----------
train Loss: 0.0736 Acc: 0.9783
val Loss: 1.0816 Acc: 0.7422
Epoch 45/53
----------
train Loss: 0.1627 Acc: 0.9583
val Loss: 1.7027 Acc: 0.7031
Epoch 46/53
----------
train Loss: 0.1281 Acc: 0.9633
val Loss: 0.9981 Acc: 0.7578
Epoch 47/53
----------
train Loss: 0.0513 Acc: 0.9833
val Loss: 0.8606 Acc: 0.7891
Epoch 48/53
----------
train Loss: 0.0493 Acc: 0.9800
val Loss: 1.1715 Acc: 0.7578
Epoch 49/53
----------
train Loss: 0.0964 Acc: 0.9733
val Loss: 1.3640 Acc: 0.6719
Epoch 50/53
----------
train Loss: 0.0532 Acc: 0.9850
val Loss: 1.9470 Acc: 0.7188
Epoch 51/53
----------
train Loss: 0.1075 Acc: 0.9583
val Loss: 0.9762 Acc: 0.7656
Epoch 52/53
----------
train Loss: 0.1671 Acc: 0.9349
val Loss: 1.9596 Acc: 0.4766
Epoch 53/53
----------
train Loss: 0.1492 Acc: 0.9432
[I 2024-10-15 14:08:11,904] Trial 53 finished with value: 0.765625 and parameters: {'batch_size': 80, 'lr': 0.0001575060500057663, 'num_epochs': 53, 'weight_decay': 0.017448780569142782, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 1.0620 Acc: 0.7656
Best val Acc: 0.765625
Model weights saved at ./model_weights/ResNet34_bs_80_lr_0.0001575060500057663_epoch_53_wd_0.017448780569142782_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/46
----------
train Loss: 0.9617 Acc: 0.5893
val Loss: 0.7665 Acc: 0.7188
Epoch 2/46
----------
train Loss: 0.3309 Acc: 0.9098
val Loss: 0.6598 Acc: 0.7578
Epoch 3/46
----------
train Loss: 0.1399 Acc: 0.9833
val Loss: 0.5971 Acc: 0.7812
Epoch 4/46
----------
train Loss: 0.0836 Acc: 0.9900
val Loss: 0.6079 Acc: 0.7891
Epoch 5/46
----------
train Loss: 0.0528 Acc: 0.9900
val Loss: 0.5948 Acc: 0.8047
Epoch 6/46
----------
train Loss: 0.0482 Acc: 0.9900
val Loss: 0.6207 Acc: 0.8047
Epoch 7/46
----------
train Loss: 0.0383 Acc: 0.9883
val Loss: 0.6352 Acc: 0.7969
Epoch 8/46
----------
train Loss: 0.0499 Acc: 0.9850
val Loss: 0.6623 Acc: 0.7812
Epoch 9/46
----------
train Loss: 0.0317 Acc: 0.9933
val Loss: 0.6245 Acc: 0.7969
Epoch 10/46
----------
train Loss: 0.0292 Acc: 0.9950
val Loss: 0.6190 Acc: 0.8047
Epoch 11/46
----------
train Loss: 0.0249 Acc: 0.9917
val Loss: 0.6485 Acc: 0.7969
Epoch 12/46
----------
train Loss: 0.0217 Acc: 0.9933
val Loss: 0.6754 Acc: 0.7969
Epoch 13/46
----------
train Loss: 0.0191 Acc: 0.9883
val Loss: 0.6756 Acc: 0.8047
Epoch 14/46
----------
train Loss: 0.0204 Acc: 0.9917
val Loss: 0.6706 Acc: 0.8047
Epoch 15/46
----------
train Loss: 0.0165 Acc: 0.9933
val Loss: 0.6710 Acc: 0.8047
Epoch 16/46
----------
train Loss: 0.0162 Acc: 0.9917
val Loss: 0.6818 Acc: 0.7969
Epoch 17/46
----------
train Loss: 0.0182 Acc: 0.9900
val Loss: 0.7400 Acc: 0.7891
Epoch 18/46
----------
train Loss: 0.0184 Acc: 0.9900
val Loss: 0.8025 Acc: 0.7969
Epoch 19/46
----------
train Loss: 0.0165 Acc: 0.9917
val Loss: 0.7799 Acc: 0.7969
Epoch 20/46
----------
train Loss: 0.0148 Acc: 0.9900
val Loss: 0.7421 Acc: 0.8125
Epoch 21/46
----------
train Loss: 0.0155 Acc: 0.9933
val Loss: 0.7453 Acc: 0.7969
Epoch 22/46
----------
train Loss: 0.0140 Acc: 0.9917
val Loss: 0.7484 Acc: 0.7969
Epoch 23/46
----------
train Loss: 0.0155 Acc: 0.9917
val Loss: 0.7400 Acc: 0.8047
Epoch 24/46
----------
train Loss: 0.0135 Acc: 0.9917
val Loss: 0.7580 Acc: 0.7891
Epoch 25/46
----------
train Loss: 0.0135 Acc: 0.9883
val Loss: 0.7620 Acc: 0.7891
Epoch 26/46
----------
train Loss: 0.0146 Acc: 0.9883
val Loss: 0.7601 Acc: 0.8047
Epoch 27/46
----------
train Loss: 0.0145 Acc: 0.9900
val Loss: 0.7515 Acc: 0.8125
Epoch 28/46
----------
train Loss: 0.0142 Acc: 0.9900
val Loss: 0.7642 Acc: 0.8125
Epoch 29/46
----------
train Loss: 0.0126 Acc: 0.9933
val Loss: 0.7817 Acc: 0.7969
Epoch 30/46
----------
train Loss: 0.0134 Acc: 0.9900
val Loss: 0.7842 Acc: 0.7969
Epoch 31/46
----------
train Loss: 0.0119 Acc: 0.9917
val Loss: 0.7858 Acc: 0.8125
Epoch 32/46
----------
train Loss: 0.0127 Acc: 0.9933
val Loss: 0.8011 Acc: 0.8047
Epoch 33/46
----------
train Loss: 0.0153 Acc: 0.9900
val Loss: 0.7876 Acc: 0.8125
Epoch 34/46
----------
train Loss: 0.0131 Acc: 0.9900
val Loss: 0.7843 Acc: 0.7969
Epoch 35/46
----------
train Loss: 0.0126 Acc: 0.9917
val Loss: 0.7937 Acc: 0.8203
Epoch 36/46
----------
train Loss: 0.0121 Acc: 0.9900
val Loss: 0.7941 Acc: 0.8203
Epoch 37/46
----------
train Loss: 0.0128 Acc: 0.9917
val Loss: 0.7642 Acc: 0.8203
Epoch 38/46
----------
train Loss: 0.0231 Acc: 0.9883
val Loss: 0.8953 Acc: 0.8125
Epoch 39/46
----------
train Loss: 0.0474 Acc: 0.9850
val Loss: 1.4006 Acc: 0.6953
Epoch 40/46
----------
train Loss: 0.1869 Acc: 0.9332
val Loss: 0.9484 Acc: 0.7500
Epoch 41/46
----------
train Loss: 0.2279 Acc: 0.9349
val Loss: 0.8482 Acc: 0.8047
Epoch 42/46
----------
train Loss: 0.1457 Acc: 0.9482
val Loss: 0.7583 Acc: 0.7812
Epoch 43/46
----------
train Loss: 0.0731 Acc: 0.9766
val Loss: 0.6120 Acc: 0.8203
Epoch 44/46
----------
train Loss: 0.0379 Acc: 0.9816
val Loss: 0.6950 Acc: 0.8125
Epoch 45/46
----------
train Loss: 0.0345 Acc: 0.9866
val Loss: 0.7390 Acc: 0.8047
Epoch 46/46
----------
train Loss: 0.0285 Acc: 0.9850
[I 2024-10-15 14:11:38,433] Trial 54 finished with value: 0.8203125 and parameters: {'batch_size': 66, 'lr': 3.828182207834657e-05, 'num_epochs': 46, 'weight_decay': 0.005523469058670853, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 0.7117 Acc: 0.8203
Best val Acc: 0.820312
Model weights saved at ./model_weights/ResNet34_bs_66_lr_3.828182207834657e-05_epoch_46_wd_0.005523469058670853_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/38
----------
train Loss: 0.7437 Acc: 0.5576
val Loss: 0.6552 Acc: 0.7188
Epoch 2/38
----------
train Loss: 0.6504 Acc: 0.6678
val Loss: 0.5648 Acc: 0.7109
Epoch 3/38
----------
train Loss: 0.5863 Acc: 0.6861
val Loss: 0.5004 Acc: 0.7578
Epoch 4/38
----------
train Loss: 0.5301 Acc: 0.7045
val Loss: 0.4714 Acc: 0.7578
Epoch 5/38
----------
train Loss: 0.4673 Acc: 0.7596
val Loss: 0.4344 Acc: 0.7578
Epoch 6/38
----------
train Loss: 0.4304 Acc: 0.7813
val Loss: 0.4021 Acc: 0.7812
Epoch 7/38
----------
train Loss: 0.4266 Acc: 0.7563
val Loss: 0.3716 Acc: 0.7891
Epoch 8/38
----------
train Loss: 0.3885 Acc: 0.8047
val Loss: 0.3542 Acc: 0.7891
Epoch 9/38
----------
train Loss: 0.3853 Acc: 0.7846
val Loss: 0.3403 Acc: 0.7891
Epoch 10/38
----------
train Loss: 0.3738 Acc: 0.8013
val Loss: 0.3290 Acc: 0.7969
Epoch 11/38
----------
train Loss: 0.3404 Acc: 0.8347
val Loss: 0.3189 Acc: 0.8047
Epoch 12/38
----------
train Loss: 0.3430 Acc: 0.7713
val Loss: 0.3152 Acc: 0.7656
Epoch 13/38
----------
train Loss: 0.2974 Acc: 0.8664
val Loss: 0.2981 Acc: 0.7969
Epoch 14/38
----------
train Loss: 0.2980 Acc: 0.8548
val Loss: 0.2893 Acc: 0.8203
Epoch 15/38
----------
train Loss: 0.3021 Acc: 0.8431
val Loss: 0.2856 Acc: 0.8047
Epoch 16/38
----------
train Loss: 0.2836 Acc: 0.8932
val Loss: 0.2799 Acc: 0.8047
Epoch 17/38
----------
train Loss: 0.2571 Acc: 0.8831
val Loss: 0.2738 Acc: 0.7891
Epoch 18/38
----------
train Loss: 0.2704 Acc: 0.8715
val Loss: 0.2687 Acc: 0.7734
Epoch 19/38
----------
train Loss: 0.2587 Acc: 0.8748
val Loss: 0.2641 Acc: 0.8047
Epoch 20/38
----------
train Loss: 0.2778 Acc: 0.8831
val Loss: 0.2641 Acc: 0.7812
Epoch 21/38
----------
train Loss: 0.2332 Acc: 0.9098
val Loss: 0.2572 Acc: 0.7812
Epoch 22/38
----------
train Loss: 0.2244 Acc: 0.8982
val Loss: 0.2517 Acc: 0.7969
Epoch 23/38
----------
train Loss: 0.2460 Acc: 0.8848
val Loss: 0.2514 Acc: 0.7891
Epoch 24/38
----------
train Loss: 0.2746 Acc: 0.8731
val Loss: 0.2531 Acc: 0.8047
Epoch 25/38
----------
train Loss: 0.2575 Acc: 0.9032
val Loss: 0.2529 Acc: 0.8203
Epoch 26/38
----------
train Loss: 0.2280 Acc: 0.8815
val Loss: 0.2503 Acc: 0.8203
Epoch 27/38
----------
train Loss: 0.2412 Acc: 0.8932
val Loss: 0.2512 Acc: 0.7969
Epoch 28/38
----------
train Loss: 0.2251 Acc: 0.9316
val Loss: 0.2456 Acc: 0.8125
Epoch 29/38
----------
train Loss: 0.2570 Acc: 0.8915
val Loss: 0.2440 Acc: 0.8047
Epoch 30/38
----------
train Loss: 0.2469 Acc: 0.8982
val Loss: 0.2530 Acc: 0.7891
Epoch 31/38
----------
train Loss: 0.2393 Acc: 0.8998
val Loss: 0.2455 Acc: 0.7969
Epoch 32/38
----------
train Loss: 0.2435 Acc: 0.9032
val Loss: 0.2445 Acc: 0.8047
Epoch 33/38
----------
train Loss: 0.2188 Acc: 0.9199
val Loss: 0.2420 Acc: 0.8047
Epoch 34/38
----------
train Loss: 0.2378 Acc: 0.8765
val Loss: 0.2394 Acc: 0.8203
Epoch 35/38
----------
train Loss: 0.2392 Acc: 0.8798
val Loss: 0.2367 Acc: 0.8203
Epoch 36/38
----------
train Loss: 0.2244 Acc: 0.9449
val Loss: 0.2331 Acc: 0.8125
Epoch 37/38
----------
train Loss: 0.2237 Acc: 0.9482
val Loss: 0.2299 Acc: 0.8203
Epoch 38/38
----------
train Loss: 0.2313 Acc: 0.9399
[I 2024-10-15 14:14:29,408] Trial 55 finished with value: 0.8203125 and parameters: {'batch_size': 104, 'lr': 9.250835667837702e-06, 'num_epochs': 38, 'weight_decay': 0.001953472489651063, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 0.2309 Acc: 0.8203
Best val Acc: 0.820312
Model weights saved at ./model_weights/ResNet34_bs_104_lr_9.250835667837702e-06_epoch_38_wd_0.001953472489651063_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/44
----------
train Loss: 0.9203 Acc: 0.6661
val Loss: 0.6214 Acc: 0.8281
Epoch 2/44
----------
train Loss: 0.2940 Acc: 0.8982
val Loss: 1.0221 Acc: 0.7578
Epoch 3/44
----------
train Loss: 0.2613 Acc: 0.9098
val Loss: 1.3688 Acc: 0.6641
Epoch 4/44
----------
train Loss: 0.2013 Acc: 0.9249
val Loss: 0.5863 Acc: 0.8594
Epoch 5/44
----------
train Loss: 0.1669 Acc: 0.9432
val Loss: 0.6862 Acc: 0.8359
Epoch 6/44
----------
train Loss: 0.2070 Acc: 0.9382
val Loss: 0.5365 Acc: 0.8438
Epoch 7/44
----------
train Loss: 0.1750 Acc: 0.9466
val Loss: 0.4786 Acc: 0.8594
Epoch 8/44
----------
train Loss: 0.1825 Acc: 0.9382
val Loss: 1.1112 Acc: 0.7500
Epoch 9/44
----------
train Loss: 0.3307 Acc: 0.8781
val Loss: 0.8795 Acc: 0.6953
Epoch 10/44
----------
train Loss: 0.2516 Acc: 0.9082
val Loss: 0.6942 Acc: 0.7812
Epoch 11/44
----------
train Loss: 0.1338 Acc: 0.9499
val Loss: 0.7526 Acc: 0.7422
Epoch 12/44
----------
train Loss: 0.1646 Acc: 0.9399
val Loss: 0.6571 Acc: 0.8438
Epoch 13/44
----------
train Loss: 0.1500 Acc: 0.9549
val Loss: 0.5464 Acc: 0.8281
Epoch 14/44
----------
train Loss: 0.1443 Acc: 0.9566
val Loss: 0.6430 Acc: 0.8047
Epoch 15/44
----------
train Loss: 0.4699 Acc: 0.8581
val Loss: 6.5118 Acc: 0.4219
Epoch 16/44
----------
train Loss: 0.3752 Acc: 0.8681
val Loss: 0.9998 Acc: 0.7266
Epoch 17/44
----------
train Loss: 0.2471 Acc: 0.9215
val Loss: 0.5449 Acc: 0.8359
Epoch 18/44
----------
train Loss: 0.1839 Acc: 0.9482
val Loss: 1.1542 Acc: 0.7344
Epoch 19/44
----------
train Loss: 0.1800 Acc: 0.9533
val Loss: 0.4881 Acc: 0.8438
Epoch 20/44
----------
train Loss: 0.1325 Acc: 0.9516
val Loss: 0.5420 Acc: 0.8594
Epoch 21/44
----------
train Loss: 0.1116 Acc: 0.9683
val Loss: 0.4368 Acc: 0.8594
Epoch 22/44
----------
train Loss: 0.1052 Acc: 0.9683
val Loss: 1.0367 Acc: 0.8281
Epoch 23/44
----------
train Loss: 0.1942 Acc: 0.9265
val Loss: 0.4879 Acc: 0.8438
Epoch 24/44
----------
train Loss: 0.1483 Acc: 0.9499
val Loss: 0.6696 Acc: 0.8125
Epoch 25/44
----------
train Loss: 0.2303 Acc: 0.9182
val Loss: 1.1760 Acc: 0.5781
Epoch 26/44
----------
train Loss: 0.1579 Acc: 0.9516
val Loss: 0.7509 Acc: 0.7500
Epoch 27/44
----------
train Loss: 0.1723 Acc: 0.9499
val Loss: 1.0500 Acc: 0.7734
Epoch 28/44
----------
train Loss: 0.1960 Acc: 0.9416
val Loss: 0.5797 Acc: 0.8359
Epoch 29/44
----------
train Loss: 0.1403 Acc: 0.9633
val Loss: 1.1547 Acc: 0.7812
Epoch 30/44
----------
train Loss: 0.1407 Acc: 0.9516
val Loss: 0.5744 Acc: 0.8203
Epoch 31/44
----------
train Loss: 0.1637 Acc: 0.9533
val Loss: 0.8532 Acc: 0.7031
Epoch 32/44
----------
train Loss: 0.1084 Acc: 0.9649
val Loss: 0.7566 Acc: 0.8516
Epoch 33/44
----------
train Loss: 0.0737 Acc: 0.9816
val Loss: 0.6391 Acc: 0.8203
Epoch 34/44
----------
train Loss: 0.1018 Acc: 0.9649
val Loss: 0.8753 Acc: 0.8125
Epoch 35/44
----------
train Loss: 0.1808 Acc: 0.9416
val Loss: 0.6350 Acc: 0.8438
Epoch 36/44
----------
train Loss: 0.1112 Acc: 0.9549
val Loss: 0.5982 Acc: 0.8125
Epoch 37/44
----------
train Loss: 0.1281 Acc: 0.9616
val Loss: 1.2628 Acc: 0.6562
Epoch 38/44
----------
train Loss: 0.1838 Acc: 0.9299
val Loss: 1.1593 Acc: 0.7812
Epoch 39/44
----------
train Loss: 0.1900 Acc: 0.9432
val Loss: 0.5439 Acc: 0.8438
Epoch 40/44
----------
train Loss: 0.1942 Acc: 0.9282
val Loss: 0.6974 Acc: 0.8125
Epoch 41/44
----------
train Loss: 0.1036 Acc: 0.9649
val Loss: 0.6464 Acc: 0.8281
Epoch 42/44
----------
train Loss: 0.1225 Acc: 0.9616
val Loss: 0.6234 Acc: 0.8047
Epoch 43/44
----------
train Loss: 0.0868 Acc: 0.9683
val Loss: 0.6581 Acc: 0.7812
Epoch 44/44
----------
train Loss: 0.0515 Acc: 0.9850
[I 2024-10-15 14:17:48,209] Trial 56 finished with value: 0.8203125 and parameters: {'batch_size': 71, 'lr': 0.00025201548791116315, 'num_epochs': 44, 'weight_decay': 0.026531827055121672, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 0.5503 Acc: 0.8203
Best val Acc: 0.820312
Model weights saved at ./model_weights/ResNet34_bs_71_lr_0.00025201548791116315_epoch_44_wd_0.026531827055121672_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/25
----------
train Loss: 0.5917 Acc: 0.5292
val Loss: 0.4218 Acc: 0.7188
Epoch 2/25
----------
train Loss: 0.3691 Acc: 0.7529
val Loss: 0.3054 Acc: 0.7266
Epoch 3/25
----------
train Loss: 0.2991 Acc: 0.8130
val Loss: 0.2684 Acc: 0.7891
Epoch 4/25
----------
train Loss: 0.3020 Acc: 0.7796
val Loss: 0.2648 Acc: 0.8125
Epoch 5/25
----------
train Loss: 0.2358 Acc: 0.9098
val Loss: 0.2411 Acc: 0.8047
Epoch 6/25
----------
train Loss: 0.2474 Acc: 0.8932
val Loss: 0.2641 Acc: 0.8125
Epoch 7/25
----------
train Loss: 0.2577 Acc: 0.8548
val Loss: 0.2414 Acc: 0.8047
Epoch 8/25
----------
train Loss: 0.2448 Acc: 0.8881
val Loss: 0.2554 Acc: 0.8281
Epoch 9/25
----------
train Loss: 0.2444 Acc: 0.9065
val Loss: 0.2440 Acc: 0.8125
Epoch 10/25
----------
train Loss: 0.2061 Acc: 0.9316
val Loss: 0.2157 Acc: 0.8438
Epoch 11/25
----------
train Loss: 0.2313 Acc: 0.8898
val Loss: 0.2580 Acc: 0.7734
Epoch 12/25
----------
train Loss: 0.2205 Acc: 0.9065
val Loss: 0.2509 Acc: 0.7891
Epoch 13/25
----------
train Loss: 0.2174 Acc: 0.9332
val Loss: 0.2308 Acc: 0.8359
Epoch 14/25
----------
train Loss: 0.2541 Acc: 0.9098
val Loss: 0.2512 Acc: 0.7891
Epoch 15/25
----------
train Loss: 0.2296 Acc: 0.9299
val Loss: 0.2531 Acc: 0.8125
Epoch 16/25
----------
train Loss: 0.2323 Acc: 0.8965
val Loss: 0.2523 Acc: 0.8125
Epoch 17/25
----------
train Loss: 0.2071 Acc: 0.9132
val Loss: 0.2483 Acc: 0.7812
Epoch 18/25
----------
train Loss: 0.2245 Acc: 0.9098
val Loss: 0.2599 Acc: 0.8281
Epoch 19/25
----------
train Loss: 0.2209 Acc: 0.9215
val Loss: 0.3071 Acc: 0.7266
Epoch 20/25
----------
train Loss: 0.2049 Acc: 0.9165
val Loss: 0.2580 Acc: 0.7500
Epoch 21/25
----------
train Loss: 0.2311 Acc: 0.9199
val Loss: 0.2610 Acc: 0.7656
Epoch 22/25
----------
train Loss: 0.2358 Acc: 0.8965
val Loss: 0.2578 Acc: 0.8438
Epoch 23/25
----------
train Loss: 0.2346 Acc: 0.9032
val Loss: 0.2700 Acc: 0.7969
Epoch 24/25
----------
train Loss: 0.2076 Acc: 0.9449
val Loss: 0.2471 Acc: 0.8125
Epoch 25/25
----------
train Loss: 0.2219 Acc: 0.9098
[I 2024-10-15 14:19:42,135] Trial 57 finished with value: 0.7734375 and parameters: {'batch_size': 123, 'lr': 7.27502878034166e-05, 'num_epochs': 25, 'weight_decay': 0.007734454852194827, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 0.2648 Acc: 0.7734
Best val Acc: 0.773438
Model weights saved at ./model_weights/ResNet34_bs_123_lr_7.27502878034166e-05_epoch_25_wd_0.007734454852194827_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/64
----------
train Loss: 5.6547 Acc: 0.2922
val Loss: 4.9014 Acc: 0.4922
Epoch 2/64
----------
train Loss: 4.3184 Acc: 0.6260
val Loss: 3.7022 Acc: 0.6719
Epoch 3/64
----------
train Loss: 3.3679 Acc: 0.7312
val Loss: 2.8764 Acc: 0.7266
Epoch 4/64
----------
train Loss: 2.7586 Acc: 0.7329
val Loss: 2.4422 Acc: 0.7422
Epoch 5/64
----------
train Loss: 2.3730 Acc: 0.7596
val Loss: 2.1212 Acc: 0.7500
Epoch 6/64
----------
train Loss: 2.1547 Acc: 0.7646
val Loss: 1.9524 Acc: 0.7422
Epoch 7/64
----------
train Loss: 2.0798 Acc: 0.7730
val Loss: 1.7831 Acc: 0.7500
Epoch 8/64
----------
train Loss: 2.0060 Acc: 0.7713
val Loss: 1.6889 Acc: 0.7656
Epoch 9/64
----------
train Loss: 1.6906 Acc: 0.8598
val Loss: 1.5712 Acc: 0.7734
Epoch 10/64
----------
train Loss: 1.8576 Acc: 0.7963
val Loss: 1.5610 Acc: 0.7812
Epoch 11/64
----------
train Loss: 1.6556 Acc: 0.8531
val Loss: 1.4865 Acc: 0.7812
Epoch 12/64
----------
train Loss: 1.6746 Acc: 0.8331
val Loss: 1.4928 Acc: 0.7656
Epoch 13/64
----------
train Loss: 1.7227 Acc: 0.8230
val Loss: 1.4185 Acc: 0.7812
Epoch 14/64
----------
train Loss: 1.5621 Acc: 0.8414
val Loss: 1.4090 Acc: 0.7969
Epoch 15/64
----------
train Loss: 1.4229 Acc: 0.8798
val Loss: 1.3463 Acc: 0.8125
Epoch 16/64
----------
train Loss: 1.4730 Acc: 0.8681
val Loss: 1.4080 Acc: 0.7734
Epoch 17/64
----------
train Loss: 1.3675 Acc: 0.8765
val Loss: 1.3526 Acc: 0.8047
Epoch 18/64
----------
train Loss: 1.3825 Acc: 0.9082
val Loss: 1.3260 Acc: 0.7734
Epoch 19/64
----------
train Loss: 1.5183 Acc: 0.8881
val Loss: 1.3154 Acc: 0.7891
Epoch 20/64
----------
train Loss: 1.4947 Acc: 0.8831
val Loss: 1.4173 Acc: 0.8047
Epoch 21/64
----------
train Loss: 1.4518 Acc: 0.8531
val Loss: 1.2664 Acc: 0.8047
Epoch 22/64
----------
train Loss: 1.3103 Acc: 0.8982
val Loss: 1.3151 Acc: 0.7969
Epoch 23/64
----------
train Loss: 1.4857 Acc: 0.8614
val Loss: 1.4246 Acc: 0.7891
Epoch 24/64
----------
train Loss: 1.3054 Acc: 0.9199
val Loss: 1.3328 Acc: 0.7969
Epoch 25/64
----------
train Loss: 1.3701 Acc: 0.8881
val Loss: 1.3344 Acc: 0.8125
Epoch 26/64
----------
train Loss: 1.4528 Acc: 0.8564
val Loss: 1.3088 Acc: 0.7969
Epoch 27/64
----------
train Loss: 1.4155 Acc: 0.8715
val Loss: 1.3517 Acc: 0.7891
Epoch 28/64
----------
train Loss: 1.3132 Acc: 0.9132
val Loss: 1.2402 Acc: 0.8125
Epoch 29/64
----------
train Loss: 1.4457 Acc: 0.8948
val Loss: 1.2534 Acc: 0.8047
Epoch 30/64
----------
train Loss: 1.3967 Acc: 0.8881
val Loss: 1.3187 Acc: 0.8125
Epoch 31/64
----------
train Loss: 1.2336 Acc: 0.9082
val Loss: 1.2830 Acc: 0.8203
Epoch 32/64
----------
train Loss: 1.3437 Acc: 0.8397
val Loss: 1.3316 Acc: 0.8203
Epoch 33/64
----------
train Loss: 1.2980 Acc: 0.8932
val Loss: 1.3974 Acc: 0.7891
Epoch 34/64
----------
train Loss: 1.1923 Acc: 0.9282
val Loss: 1.2866 Acc: 0.8203
Epoch 35/64
----------
train Loss: 1.4003 Acc: 0.9015
val Loss: 1.3610 Acc: 0.7891
Epoch 36/64
----------
train Loss: 1.1932 Acc: 0.9416
val Loss: 1.3015 Acc: 0.8125
Epoch 37/64
----------
train Loss: 1.0790 Acc: 0.9683
val Loss: 1.2969 Acc: 0.8125
Epoch 38/64
----------
train Loss: 1.1756 Acc: 0.9316
val Loss: 1.3508 Acc: 0.7734
Epoch 39/64
----------
train Loss: 1.3371 Acc: 0.9082
val Loss: 1.2460 Acc: 0.8203
Epoch 40/64
----------
train Loss: 1.1691 Acc: 0.9265
val Loss: 1.2957 Acc: 0.8203
Epoch 41/64
----------
train Loss: 1.2698 Acc: 0.9048
val Loss: 1.3211 Acc: 0.8125
Epoch 42/64
----------
train Loss: 1.1851 Acc: 0.9399
val Loss: 1.2706 Acc: 0.8203
Epoch 43/64
----------
train Loss: 1.2349 Acc: 0.9115
val Loss: 1.2710 Acc: 0.7969
Epoch 44/64
----------
train Loss: 1.1224 Acc: 0.9466
val Loss: 1.2574 Acc: 0.8281
Epoch 45/64
----------
train Loss: 1.1322 Acc: 0.9182
val Loss: 1.2617 Acc: 0.8281
Epoch 46/64
----------
train Loss: 1.1582 Acc: 0.9449
val Loss: 1.1900 Acc: 0.8203
Epoch 47/64
----------
train Loss: 1.2361 Acc: 0.8848
val Loss: 1.2170 Acc: 0.8125
Epoch 48/64
----------
train Loss: 1.2392 Acc: 0.9132
val Loss: 1.3089 Acc: 0.8047
Epoch 49/64
----------
train Loss: 1.1597 Acc: 0.9416
val Loss: 1.2344 Acc: 0.8125
Epoch 50/64
----------
train Loss: 1.1855 Acc: 0.9349
val Loss: 1.2206 Acc: 0.7969
Epoch 51/64
----------
train Loss: 1.3251 Acc: 0.8581
val Loss: 1.2571 Acc: 0.8125
Epoch 52/64
----------
train Loss: 1.2198 Acc: 0.9199
val Loss: 1.1683 Acc: 0.8359
Epoch 53/64
----------
train Loss: 1.2814 Acc: 0.8865
val Loss: 1.2218 Acc: 0.8125
Epoch 54/64
----------
train Loss: 1.3343 Acc: 0.8715
val Loss: 1.3167 Acc: 0.8047
Epoch 55/64
----------
train Loss: 1.0838 Acc: 0.9466
val Loss: 1.1475 Acc: 0.8359
Epoch 56/64
----------
train Loss: 1.0403 Acc: 0.9149
val Loss: 1.3141 Acc: 0.7969
Epoch 57/64
----------
train Loss: 1.1643 Acc: 0.9098
val Loss: 1.4049 Acc: 0.7656
Epoch 58/64
----------
train Loss: 1.1820 Acc: 0.9149
val Loss: 1.2967 Acc: 0.8281
Epoch 59/64
----------
train Loss: 1.1060 Acc: 0.9449
val Loss: 1.2086 Acc: 0.8047
Epoch 60/64
----------
train Loss: 1.2420 Acc: 0.8881
val Loss: 1.2538 Acc: 0.8281
Epoch 61/64
----------
train Loss: 1.1685 Acc: 0.9249
val Loss: 1.2460 Acc: 0.7656
Epoch 62/64
----------
train Loss: 1.2271 Acc: 0.9299
val Loss: 1.1940 Acc: 0.8047
Epoch 63/64
----------
train Loss: 1.1811 Acc: 0.9265
val Loss: 1.1846 Acc: 0.8281
Epoch 64/64
----------
train Loss: 1.0571 Acc: 0.9199
[I 2024-10-15 14:24:28,392] Trial 58 finished with value: 0.8125 and parameters: {'batch_size': 113, 'lr': 1.880715019452513e-05, 'num_epochs': 64, 'weight_decay': 0.10914236764870996, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.2112 Acc: 0.8125
Best val Acc: 0.812500
Model weights saved at ./model_weights/ResNet34_bs_113_lr_1.880715019452513e-05_epoch_64_wd_0.10914236764870996_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/52
----------
train Loss: 0.8827 Acc: 0.6344
val Loss: 0.6988 Acc: 0.7578
Epoch 2/52
----------
train Loss: 0.2120 Acc: 0.9466
val Loss: 0.6478 Acc: 0.7969
Epoch 3/52
----------
train Loss: 0.0939 Acc: 0.9766
val Loss: 0.5870 Acc: 0.8047
Epoch 4/52
----------
train Loss: 0.0961 Acc: 0.9750
val Loss: 0.7149 Acc: 0.7969
Epoch 5/52
----------
train Loss: 0.1130 Acc: 0.9683
val Loss: 0.7623 Acc: 0.7891
Epoch 6/52
----------
train Loss: 0.2529 Acc: 0.9065
val Loss: 0.9039 Acc: 0.7812
Epoch 7/52
----------
train Loss: 0.3613 Acc: 0.8865
val Loss: 0.8924 Acc: 0.8125
Epoch 8/52
----------
train Loss: 0.3326 Acc: 0.8982
val Loss: 1.2957 Acc: 0.6797
Epoch 9/52
----------
train Loss: 0.1985 Acc: 0.9316
val Loss: 0.5630 Acc: 0.8047
Epoch 10/52
----------
train Loss: 0.1274 Acc: 0.9633
val Loss: 0.5326 Acc: 0.8359
Epoch 11/52
----------
train Loss: 0.0792 Acc: 0.9800
val Loss: 0.7648 Acc: 0.7891
Epoch 12/52
----------
train Loss: 0.1139 Acc: 0.9599
val Loss: 0.7244 Acc: 0.8281
Epoch 13/52
----------
train Loss: 0.1502 Acc: 0.9416
val Loss: 0.7388 Acc: 0.7891
Epoch 14/52
----------
train Loss: 0.1832 Acc: 0.9466
val Loss: 1.0599 Acc: 0.8047
Epoch 15/52
----------
train Loss: 0.2527 Acc: 0.9299
val Loss: 2.8033 Acc: 0.6719
Epoch 16/52
----------
train Loss: 0.2405 Acc: 0.9249
val Loss: 0.7890 Acc: 0.7578
Epoch 17/52
----------
train Loss: 0.2126 Acc: 0.9382
val Loss: 0.8497 Acc: 0.7812
Epoch 18/52
----------
train Loss: 0.1482 Acc: 0.9482
val Loss: 0.8707 Acc: 0.7734
Epoch 19/52
----------
train Loss: 0.1075 Acc: 0.9616
val Loss: 0.5328 Acc: 0.7969
Epoch 20/52
----------
train Loss: 0.1310 Acc: 0.9533
val Loss: 0.6919 Acc: 0.7969
Epoch 21/52
----------
train Loss: 0.1005 Acc: 0.9750
val Loss: 0.8349 Acc: 0.8281
Epoch 22/52
----------
train Loss: 0.0971 Acc: 0.9733
val Loss: 0.6940 Acc: 0.7734
Epoch 23/52
----------
train Loss: 0.1754 Acc: 0.9399
val Loss: 1.1587 Acc: 0.7812
Epoch 24/52
----------
train Loss: 0.1966 Acc: 0.9249
val Loss: 1.3982 Acc: 0.7422
Epoch 25/52
----------
train Loss: 0.1629 Acc: 0.9499
val Loss: 0.6881 Acc: 0.7969
Epoch 26/52
----------
train Loss: 0.1562 Acc: 0.9533
val Loss: 0.8196 Acc: 0.7578
Epoch 27/52
----------
train Loss: 0.1769 Acc: 0.9416
val Loss: 0.6478 Acc: 0.8125
Epoch 28/52
----------
train Loss: 0.2504 Acc: 0.9215
val Loss: 1.4067 Acc: 0.6328
Epoch 29/52
----------
train Loss: 0.2745 Acc: 0.9199
val Loss: 1.2074 Acc: 0.7422
Epoch 30/52
----------
train Loss: 0.1266 Acc: 0.9616
val Loss: 0.8878 Acc: 0.7656
Epoch 31/52
----------
train Loss: 0.1179 Acc: 0.9649
val Loss: 0.5714 Acc: 0.8047
Epoch 32/52
----------
train Loss: 0.1032 Acc: 0.9683
val Loss: 0.6234 Acc: 0.8203
Epoch 33/52
----------
train Loss: 0.1368 Acc: 0.9633
val Loss: 0.7470 Acc: 0.7656
Epoch 34/52
----------
train Loss: 0.1953 Acc: 0.9366
val Loss: 0.7106 Acc: 0.7812
Epoch 35/52
----------
train Loss: 0.2126 Acc: 0.9332
val Loss: 0.6475 Acc: 0.7891
Epoch 36/52
----------
train Loss: 0.1110 Acc: 0.9716
val Loss: 0.8856 Acc: 0.7656
Epoch 37/52
----------
train Loss: 0.1574 Acc: 0.9449
val Loss: 0.7558 Acc: 0.8047
Epoch 38/52
----------
train Loss: 0.1237 Acc: 0.9683
val Loss: 0.9233 Acc: 0.7656
Epoch 39/52
----------
train Loss: 0.1481 Acc: 0.9566
val Loss: 1.0452 Acc: 0.7578
Epoch 40/52
----------
train Loss: 0.1790 Acc: 0.9549
val Loss: 0.8584 Acc: 0.7422
Epoch 41/52
----------
train Loss: 0.1266 Acc: 0.9616
val Loss: 0.9761 Acc: 0.7578
Epoch 42/52
----------
train Loss: 0.1268 Acc: 0.9633
val Loss: 1.0723 Acc: 0.7109
Epoch 43/52
----------
train Loss: 0.1156 Acc: 0.9649
val Loss: 1.5108 Acc: 0.4922
Epoch 44/52
----------
train Loss: 0.2001 Acc: 0.9432
val Loss: 1.1892 Acc: 0.6875
Epoch 45/52
----------
train Loss: 0.1265 Acc: 0.9699
val Loss: 0.6171 Acc: 0.7969
Epoch 46/52
----------
train Loss: 0.1672 Acc: 0.9416
val Loss: 0.7595 Acc: 0.8047
Epoch 47/52
----------
train Loss: 0.1549 Acc: 0.9516
val Loss: 0.8569 Acc: 0.7422
Epoch 48/52
----------
train Loss: 0.1843 Acc: 0.9382
val Loss: 1.0778 Acc: 0.7344
Epoch 49/52
----------
train Loss: 0.1574 Acc: 0.9566
val Loss: 0.9671 Acc: 0.7188
Epoch 50/52
----------
train Loss: 0.1086 Acc: 0.9716
val Loss: 0.6144 Acc: 0.8047
Epoch 51/52
----------
train Loss: 0.0755 Acc: 0.9816
val Loss: 0.8434 Acc: 0.7812
Epoch 52/52
----------
train Loss: 0.1006 Acc: 0.9699
[I 2024-10-15 14:28:19,522] Trial 59 finished with value: 0.765625 and parameters: {'batch_size': 42, 'lr': 0.00012557798211824085, 'num_epochs': 52, 'weight_decay': 0.0642536275339397, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 0.6777 Acc: 0.7656
Best val Acc: 0.765625
Model weights saved at ./model_weights/ResNet34_bs_42_lr_0.00012557798211824085_epoch_52_wd_0.0642536275339397_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/59
----------
train Loss: 4.9460 Acc: 0.4875
val Loss: 4.3663 Acc: 0.5078
Epoch 2/59
----------
train Loss: 4.2393 Acc: 0.5977
val Loss: 3.6404 Acc: 0.6562
Epoch 3/59
----------
train Loss: 3.6552 Acc: 0.6811
val Loss: 3.1499 Acc: 0.6719
Epoch 4/59
----------
train Loss: 3.1807 Acc: 0.7062
val Loss: 2.7918 Acc: 0.7266
Epoch 5/59
----------
train Loss: 2.7537 Acc: 0.7262
val Loss: 2.4754 Acc: 0.7656
Epoch 6/59
----------
train Loss: 2.5805 Acc: 0.7362
val Loss: 2.2695 Acc: 0.7734
Epoch 7/59
----------
train Loss: 2.3076 Acc: 0.7579
val Loss: 2.0126 Acc: 0.8047
Epoch 8/59
----------
train Loss: 2.1555 Acc: 0.7880
val Loss: 1.8870 Acc: 0.8203
Epoch 9/59
----------
train Loss: 1.9266 Acc: 0.8130
val Loss: 1.7550 Acc: 0.8047
Epoch 10/59
----------
train Loss: 1.9927 Acc: 0.7513
val Loss: 1.6448 Acc: 0.7969
Epoch 11/59
----------
train Loss: 1.8788 Acc: 0.7997
val Loss: 1.5563 Acc: 0.8281
Epoch 12/59
----------
train Loss: 1.9356 Acc: 0.7846
val Loss: 1.5314 Acc: 0.8203
Epoch 13/59
----------
train Loss: 1.8398 Acc: 0.8030
val Loss: 1.4604 Acc: 0.8359
Epoch 14/59
----------
train Loss: 1.8247 Acc: 0.8030
val Loss: 1.4217 Acc: 0.8281
Epoch 15/59
----------
train Loss: 1.5870 Acc: 0.8932
val Loss: 1.3721 Acc: 0.8281
Epoch 16/59
----------
train Loss: 1.4982 Acc: 0.8815
val Loss: 1.3412 Acc: 0.8281
Epoch 17/59
----------
train Loss: 1.6626 Acc: 0.8548
val Loss: 1.3262 Acc: 0.8125
Epoch 18/59
----------
train Loss: 1.4771 Acc: 0.8664
val Loss: 1.3232 Acc: 0.8203
Epoch 19/59
----------
train Loss: 1.4306 Acc: 0.8982
val Loss: 1.2839 Acc: 0.8438
Epoch 20/59
----------
train Loss: 1.3999 Acc: 0.8815
val Loss: 1.2482 Acc: 0.8516
Epoch 21/59
----------
train Loss: 1.6906 Acc: 0.8180
val Loss: 1.2818 Acc: 0.8359
Epoch 22/59
----------
train Loss: 1.6396 Acc: 0.8280
val Loss: 1.2728 Acc: 0.8516
Epoch 23/59
----------
train Loss: 1.5188 Acc: 0.8715
val Loss: 1.2386 Acc: 0.8594
Epoch 24/59
----------
train Loss: 1.4757 Acc: 0.8664
val Loss: 1.2260 Acc: 0.8750
Epoch 25/59
----------
train Loss: 1.4084 Acc: 0.8614
val Loss: 1.2222 Acc: 0.8750
Epoch 26/59
----------
train Loss: 1.3362 Acc: 0.9265
val Loss: 1.1863 Acc: 0.8750
Epoch 27/59
----------
train Loss: 1.5504 Acc: 0.8297
val Loss: 1.1925 Acc: 0.8750
Epoch 28/59
----------
train Loss: 1.3483 Acc: 0.9299
val Loss: 1.2397 Acc: 0.8750
Epoch 29/59
----------
train Loss: 1.2263 Acc: 0.9533
val Loss: 1.1949 Acc: 0.8672
Epoch 30/59
----------
train Loss: 1.3152 Acc: 0.8798
val Loss: 1.2094 Acc: 0.8672
Epoch 31/59
----------
train Loss: 1.3786 Acc: 0.8798
val Loss: 1.1670 Acc: 0.8594
Epoch 32/59
----------
train Loss: 1.2404 Acc: 0.8865
val Loss: 1.0989 Acc: 0.8672
Epoch 33/59
----------
train Loss: 1.1631 Acc: 0.9149
val Loss: 1.1251 Acc: 0.8828
Epoch 34/59
----------
train Loss: 1.4624 Acc: 0.8798
val Loss: 1.1501 Acc: 0.8594
Epoch 35/59
----------
train Loss: 1.5380 Acc: 0.8898
val Loss: 1.2324 Acc: 0.8594
Epoch 36/59
----------
train Loss: 1.5300 Acc: 0.8748
val Loss: 1.1873 Acc: 0.8516
Epoch 37/59
----------
train Loss: 1.1870 Acc: 0.8982
val Loss: 1.1236 Acc: 0.8672
Epoch 38/59
----------
train Loss: 1.2423 Acc: 0.8998
val Loss: 1.1412 Acc: 0.8672
Epoch 39/59
----------
train Loss: 1.3464 Acc: 0.8982
val Loss: 1.1351 Acc: 0.8750
Epoch 40/59
----------
train Loss: 1.2558 Acc: 0.9048
val Loss: 1.1629 Acc: 0.8594
Epoch 41/59
----------
train Loss: 1.2637 Acc: 0.8848
val Loss: 1.1273 Acc: 0.8750
Epoch 42/59
----------
train Loss: 1.2964 Acc: 0.8848
val Loss: 1.1236 Acc: 0.8594
Epoch 43/59
----------
train Loss: 1.1403 Acc: 0.9549
val Loss: 1.1256 Acc: 0.8594
Epoch 44/59
----------
train Loss: 1.1073 Acc: 0.9599
val Loss: 1.1366 Acc: 0.8359
Epoch 45/59
----------
train Loss: 1.2226 Acc: 0.9349
val Loss: 1.1946 Acc: 0.8516
Epoch 46/59
----------
train Loss: 1.0928 Acc: 0.9399
val Loss: 1.1405 Acc: 0.8438
Epoch 47/59
----------
train Loss: 1.1305 Acc: 0.9149
val Loss: 1.1197 Acc: 0.8750
Epoch 48/59
----------
train Loss: 1.2763 Acc: 0.9115
val Loss: 1.0807 Acc: 0.8594
Epoch 49/59
----------
train Loss: 1.1903 Acc: 0.9516
val Loss: 1.1278 Acc: 0.8750
Epoch 50/59
----------
train Loss: 1.2872 Acc: 0.8881
val Loss: 1.1083 Acc: 0.8672
Epoch 51/59
----------
train Loss: 1.0699 Acc: 0.9533
val Loss: 1.1026 Acc: 0.8516
Epoch 52/59
----------
train Loss: 1.2944 Acc: 0.9032
val Loss: 1.1126 Acc: 0.8672
Epoch 53/59
----------
train Loss: 1.2029 Acc: 0.8881
val Loss: 1.1387 Acc: 0.8516
Epoch 54/59
----------
train Loss: 1.3040 Acc: 0.8998
val Loss: 1.1576 Acc: 0.8750
Epoch 55/59
----------
train Loss: 1.2818 Acc: 0.9098
val Loss: 1.1438 Acc: 0.8750
Epoch 56/59
----------
train Loss: 1.1586 Acc: 0.9232
val Loss: 1.1175 Acc: 0.8594
Epoch 57/59
----------
train Loss: 1.1354 Acc: 0.9265
val Loss: 1.1206 Acc: 0.8438
Epoch 58/59
----------
train Loss: 1.2575 Acc: 0.9416
val Loss: 1.1397 Acc: 0.8516
Epoch 59/59
----------
train Loss: 1.1687 Acc: 0.9382
[I 2024-10-15 14:32:42,066] Trial 60 finished with value: 0.859375 and parameters: {'batch_size': 81, 'lr': 1.0922125142837338e-05, 'num_epochs': 59, 'weight_decay': 0.04037851204068431, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.1163 Acc: 0.8594
Best val Acc: 0.859375
Model weights saved at ./model_weights/ResNet34_bs_81_lr_1.0922125142837338e-05_epoch_59_wd_0.04037851204068431_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/59
----------
train Loss: 4.3545 Acc: 0.3840
val Loss: 3.6490 Acc: 0.6406
Epoch 2/59
----------
train Loss: 3.6997 Acc: 0.6244
val Loss: 3.2330 Acc: 0.7188
Epoch 3/59
----------
train Loss: 3.3006 Acc: 0.6895
val Loss: 2.8655 Acc: 0.7578
Epoch 4/59
----------
train Loss: 2.8760 Acc: 0.7813
val Loss: 2.4866 Acc: 0.7969
Epoch 5/59
----------
train Loss: 2.6336 Acc: 0.7396
val Loss: 2.2553 Acc: 0.8047
Epoch 6/59
----------
train Loss: 2.5034 Acc: 0.7596
val Loss: 2.0280 Acc: 0.8281
Epoch 7/59
----------
train Loss: 2.2907 Acc: 0.7746
val Loss: 1.8944 Acc: 0.8594
Epoch 8/59
----------
train Loss: 2.2078 Acc: 0.7629
val Loss: 1.7676 Acc: 0.8594
Epoch 9/59
----------
train Loss: 2.0677 Acc: 0.7980
val Loss: 1.6493 Acc: 0.8594
Epoch 10/59
----------
train Loss: 1.9197 Acc: 0.8230
val Loss: 1.5355 Acc: 0.8516
Epoch 11/59
----------
train Loss: 1.8402 Acc: 0.8013
val Loss: 1.4425 Acc: 0.8594
Epoch 12/59
----------
train Loss: 1.8422 Acc: 0.8147
val Loss: 1.3968 Acc: 0.8516
Epoch 13/59
----------
train Loss: 1.8058 Acc: 0.8214
val Loss: 1.3523 Acc: 0.8438
Epoch 14/59
----------
train Loss: 1.7529 Acc: 0.8097
val Loss: 1.3362 Acc: 0.8672
Epoch 15/59
----------
train Loss: 1.7769 Acc: 0.8347
val Loss: 1.3086 Acc: 0.8672
Epoch 16/59
----------
train Loss: 1.5802 Acc: 0.8381
val Loss: 1.2857 Acc: 0.8672
Epoch 17/59
----------
train Loss: 1.4934 Acc: 0.8631
val Loss: 1.2468 Acc: 0.8594
Epoch 18/59
----------
train Loss: 1.5946 Acc: 0.8664
val Loss: 1.2377 Acc: 0.8672
Epoch 19/59
----------
train Loss: 1.3880 Acc: 0.8781
val Loss: 1.2268 Acc: 0.8672
Epoch 20/59
----------
train Loss: 1.5288 Acc: 0.8381
val Loss: 1.1778 Acc: 0.8750
Epoch 21/59
----------
train Loss: 1.4928 Acc: 0.8631
val Loss: 1.1860 Acc: 0.8672
Epoch 22/59
----------
train Loss: 1.3937 Acc: 0.8965
val Loss: 1.1812 Acc: 0.8750
Epoch 23/59
----------
train Loss: 1.4517 Acc: 0.8915
val Loss: 1.1710 Acc: 0.8750
Epoch 24/59
----------
train Loss: 1.2364 Acc: 0.9015
val Loss: 1.1701 Acc: 0.8750
Epoch 25/59
----------
train Loss: 1.6379 Acc: 0.8364
val Loss: 1.1459 Acc: 0.8828
Epoch 26/59
----------
train Loss: 1.3103 Acc: 0.9132
val Loss: 1.1319 Acc: 0.8750
Epoch 27/59
----------
train Loss: 1.4117 Acc: 0.8648
val Loss: 1.1289 Acc: 0.8750
Epoch 28/59
----------
train Loss: 1.3777 Acc: 0.9098
val Loss: 1.1284 Acc: 0.8672
Epoch 29/59
----------
train Loss: 1.2868 Acc: 0.8915
val Loss: 1.1248 Acc: 0.8750
Epoch 30/59
----------
train Loss: 1.3155 Acc: 0.8681
val Loss: 1.1003 Acc: 0.8828
Epoch 31/59
----------
train Loss: 1.4665 Acc: 0.8197
val Loss: 1.0777 Acc: 0.8828
Epoch 32/59
----------
train Loss: 1.4041 Acc: 0.9015
val Loss: 1.1052 Acc: 0.8594
Epoch 33/59
----------
train Loss: 1.3850 Acc: 0.8748
val Loss: 1.1503 Acc: 0.8750
Epoch 34/59
----------
train Loss: 1.3324 Acc: 0.9115
val Loss: 1.0931 Acc: 0.8750
Epoch 35/59
----------
train Loss: 1.4150 Acc: 0.8698
val Loss: 1.1147 Acc: 0.8828
Epoch 36/59
----------
train Loss: 1.2038 Acc: 0.9482
val Loss: 1.0879 Acc: 0.8750
Epoch 37/59
----------
train Loss: 1.0680 Acc: 0.9566
val Loss: 1.0850 Acc: 0.8828
Epoch 38/59
----------
train Loss: 1.2597 Acc: 0.9382
val Loss: 1.1304 Acc: 0.8672
Epoch 39/59
----------
train Loss: 1.1104 Acc: 0.9466
val Loss: 1.1070 Acc: 0.8750
Epoch 40/59
----------
train Loss: 1.2476 Acc: 0.9332
val Loss: 1.1437 Acc: 0.8750
Epoch 41/59
----------
train Loss: 1.4122 Acc: 0.8781
val Loss: 1.1210 Acc: 0.8750
Epoch 42/59
----------
train Loss: 1.2662 Acc: 0.9032
val Loss: 1.1108 Acc: 0.8672
Epoch 43/59
----------
train Loss: 1.2561 Acc: 0.9032
val Loss: 1.0753 Acc: 0.8750
Epoch 44/59
----------
train Loss: 1.2958 Acc: 0.8982
val Loss: 1.0968 Acc: 0.8750
Epoch 45/59
----------
train Loss: 1.1392 Acc: 0.9366
val Loss: 1.1330 Acc: 0.8594
Epoch 46/59
----------
train Loss: 1.3715 Acc: 0.9032
val Loss: 1.1271 Acc: 0.8516
Epoch 47/59
----------
train Loss: 1.4556 Acc: 0.8648
val Loss: 1.0852 Acc: 0.8594
Epoch 48/59
----------
train Loss: 1.1258 Acc: 0.9549
val Loss: 1.0455 Acc: 0.8594
Epoch 49/59
----------
train Loss: 1.1701 Acc: 0.9382
val Loss: 1.0423 Acc: 0.8750
Epoch 50/59
----------
train Loss: 1.2902 Acc: 0.8581
val Loss: 1.0108 Acc: 0.8750
Epoch 51/59
----------
train Loss: 1.2020 Acc: 0.8715
val Loss: 1.0208 Acc: 0.8828
Epoch 52/59
----------
train Loss: 1.1741 Acc: 0.9032
val Loss: 1.0412 Acc: 0.8750
Epoch 53/59
----------
train Loss: 1.2131 Acc: 0.9232
val Loss: 1.1027 Acc: 0.8672
Epoch 54/59
----------
train Loss: 1.3299 Acc: 0.8664
val Loss: 1.0978 Acc: 0.8672
Epoch 55/59
----------
train Loss: 1.3529 Acc: 0.9215
val Loss: 1.0686 Acc: 0.8672
Epoch 56/59
----------
train Loss: 1.1102 Acc: 0.9666
val Loss: 1.1023 Acc: 0.8828
Epoch 57/59
----------
train Loss: 1.1648 Acc: 0.9316
val Loss: 1.0630 Acc: 0.8750
Epoch 58/59
----------
train Loss: 1.1268 Acc: 0.9533
val Loss: 1.0293 Acc: 0.8750
Epoch 59/59
----------
train Loss: 1.1089 Acc: 0.9566
[I 2024-10-15 14:37:06,845] Trial 61 finished with value: 0.875 and parameters: {'batch_size': 81, 'lr': 1.1086635299685438e-05, 'num_epochs': 59, 'weight_decay': 0.04581497619514744, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.0358 Acc: 0.8750
Best val Acc: 0.875000
Model weights saved at ./model_weights/ResNet34_bs_81_lr_1.1086635299685438e-05_epoch_59_wd_0.04581497619514744_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/69
----------
train Loss: 4.4929 Acc: 0.3389
val Loss: 4.1665 Acc: 0.5391
Epoch 2/69
----------
train Loss: 4.2424 Acc: 0.4274
val Loss: 3.9961 Acc: 0.5625
Epoch 3/69
----------
train Loss: 4.0037 Acc: 0.4741
val Loss: 3.7759 Acc: 0.6172
Epoch 4/69
----------
train Loss: 3.8344 Acc: 0.5075
val Loss: 3.6221 Acc: 0.6016
Epoch 5/69
----------
train Loss: 3.6170 Acc: 0.5776
val Loss: 3.4658 Acc: 0.6250
Epoch 6/69
----------
train Loss: 3.4441 Acc: 0.6060
val Loss: 3.3013 Acc: 0.6406
Epoch 7/69
----------
train Loss: 3.2952 Acc: 0.6561
val Loss: 3.1749 Acc: 0.6484
Epoch 8/69
----------
train Loss: 3.1448 Acc: 0.6778
val Loss: 3.0573 Acc: 0.6484
Epoch 9/69
----------
train Loss: 3.0628 Acc: 0.6878
val Loss: 2.9191 Acc: 0.6484
Epoch 10/69
----------
train Loss: 2.9287 Acc: 0.7095
val Loss: 2.8528 Acc: 0.6719
Epoch 11/69
----------
train Loss: 2.8376 Acc: 0.7062
val Loss: 2.7631 Acc: 0.6641
Epoch 12/69
----------
train Loss: 2.6726 Acc: 0.7396
val Loss: 2.6674 Acc: 0.6641
Epoch 13/69
----------
train Loss: 2.6232 Acc: 0.7479
val Loss: 2.6382 Acc: 0.6641
Epoch 14/69
----------
train Loss: 2.4994 Acc: 0.7679
val Loss: 2.5432 Acc: 0.6641
Epoch 15/69
----------
train Loss: 2.4385 Acc: 0.7730
val Loss: 2.4384 Acc: 0.6797
Epoch 16/69
----------
train Loss: 2.3845 Acc: 0.7262
val Loss: 2.3863 Acc: 0.6953
Epoch 17/69
----------
train Loss: 2.3012 Acc: 0.7813
val Loss: 2.3527 Acc: 0.7031
Epoch 18/69
----------
train Loss: 2.2537 Acc: 0.7696
val Loss: 2.2874 Acc: 0.7031
Epoch 19/69
----------
train Loss: 2.1737 Acc: 0.7763
val Loss: 2.2449 Acc: 0.7109
Epoch 20/69
----------
train Loss: 1.9113 Acc: 0.8381
val Loss: 2.1632 Acc: 0.7266
Epoch 21/69
----------
train Loss: 2.0597 Acc: 0.7863
val Loss: 2.1209 Acc: 0.7266
Epoch 22/69
----------
train Loss: 2.0556 Acc: 0.7913
val Loss: 2.1033 Acc: 0.7109
Epoch 23/69
----------
train Loss: 1.9875 Acc: 0.8013
val Loss: 2.0732 Acc: 0.7188
Epoch 24/69
----------
train Loss: 2.0229 Acc: 0.7613
val Loss: 2.0379 Acc: 0.7266
Epoch 25/69
----------
train Loss: 1.9161 Acc: 0.8197
val Loss: 2.0043 Acc: 0.7266
Epoch 26/69
----------
train Loss: 1.8442 Acc: 0.8097
val Loss: 1.9647 Acc: 0.7266
Epoch 27/69
----------
train Loss: 1.8681 Acc: 0.8114
val Loss: 1.9530 Acc: 0.7422
Epoch 28/69
----------
train Loss: 1.8029 Acc: 0.8314
val Loss: 1.9223 Acc: 0.7578
Epoch 29/69
----------
train Loss: 1.9046 Acc: 0.8047
val Loss: 1.9248 Acc: 0.7422
Epoch 30/69
----------
train Loss: 1.6964 Acc: 0.8681
val Loss: 1.9047 Acc: 0.7500
Epoch 31/69
----------
train Loss: 1.6551 Acc: 0.8431
val Loss: 1.8858 Acc: 0.7422
Epoch 32/69
----------
train Loss: 1.7869 Acc: 0.8314
val Loss: 1.8458 Acc: 0.7500
Epoch 33/69
----------
train Loss: 1.8479 Acc: 0.8297
val Loss: 1.8613 Acc: 0.7422
Epoch 34/69
----------
train Loss: 1.7514 Acc: 0.8247
val Loss: 1.8466 Acc: 0.7500
Epoch 35/69
----------
train Loss: 1.7535 Acc: 0.7997
val Loss: 1.8305 Acc: 0.7500
Epoch 36/69
----------
train Loss: 1.6713 Acc: 0.8497
val Loss: 1.8166 Acc: 0.7500
Epoch 37/69
----------
train Loss: 1.6281 Acc: 0.8431
val Loss: 1.7999 Acc: 0.7500
Epoch 38/69
----------
train Loss: 1.6478 Acc: 0.8715
val Loss: 1.7921 Acc: 0.7500
Epoch 39/69
----------
train Loss: 1.6180 Acc: 0.8631
val Loss: 1.7850 Acc: 0.7578
Epoch 40/69
----------
train Loss: 1.5987 Acc: 0.8347
val Loss: 1.7713 Acc: 0.7578
Epoch 41/69
----------
train Loss: 1.5938 Acc: 0.8531
val Loss: 1.7714 Acc: 0.7500
Epoch 42/69
----------
train Loss: 1.6495 Acc: 0.8331
val Loss: 1.7669 Acc: 0.7656
Epoch 43/69
----------
train Loss: 1.5862 Acc: 0.8414
val Loss: 1.7448 Acc: 0.7578
Epoch 44/69
----------
train Loss: 1.6629 Acc: 0.8381
val Loss: 1.7388 Acc: 0.7578
Epoch 45/69
----------
train Loss: 1.5215 Acc: 0.8447
val Loss: 1.7496 Acc: 0.7578
Epoch 46/69
----------
train Loss: 1.5021 Acc: 0.8564
val Loss: 1.7327 Acc: 0.7656
Epoch 47/69
----------
train Loss: 1.6041 Acc: 0.8447
val Loss: 1.7347 Acc: 0.7656
Epoch 48/69
----------
train Loss: 1.3824 Acc: 0.9182
val Loss: 1.7324 Acc: 0.7812
Epoch 49/69
----------
train Loss: 1.5563 Acc: 0.8531
val Loss: 1.7154 Acc: 0.7656
Epoch 50/69
----------
train Loss: 1.4043 Acc: 0.8982
val Loss: 1.7180 Acc: 0.7656
Epoch 51/69
----------
train Loss: 1.5373 Acc: 0.8664
val Loss: 1.7261 Acc: 0.7656
Epoch 52/69
----------
train Loss: 1.3716 Acc: 0.8731
val Loss: 1.7167 Acc: 0.7656
Epoch 53/69
----------
train Loss: 1.3258 Acc: 0.9182
val Loss: 1.7040 Acc: 0.7578
Epoch 54/69
----------
train Loss: 1.5100 Acc: 0.8531
val Loss: 1.6826 Acc: 0.7656
Epoch 55/69
----------
train Loss: 1.3636 Acc: 0.8831
val Loss: 1.6825 Acc: 0.7656
Epoch 56/69
----------
train Loss: 1.4550 Acc: 0.8414
val Loss: 1.6953 Acc: 0.7656
Epoch 57/69
----------
train Loss: 1.3895 Acc: 0.8765
val Loss: 1.6869 Acc: 0.7578
Epoch 58/69
----------
train Loss: 1.3657 Acc: 0.9015
val Loss: 1.6805 Acc: 0.7734
Epoch 59/69
----------
train Loss: 1.4445 Acc: 0.8865
val Loss: 1.6435 Acc: 0.7734
Epoch 60/69
----------
train Loss: 1.4547 Acc: 0.8748
val Loss: 1.6287 Acc: 0.7734
Epoch 61/69
----------
train Loss: 1.5556 Acc: 0.8497
val Loss: 1.6320 Acc: 0.7969
Epoch 62/69
----------
train Loss: 1.4933 Acc: 0.8548
val Loss: 1.6373 Acc: 0.7734
Epoch 63/69
----------
train Loss: 1.3203 Acc: 0.8932
val Loss: 1.6649 Acc: 0.7734
Epoch 64/69
----------
train Loss: 1.2581 Acc: 0.9316
val Loss: 1.6568 Acc: 0.7656
Epoch 65/69
----------
train Loss: 1.4623 Acc: 0.8414
val Loss: 1.6357 Acc: 0.7656
Epoch 66/69
----------
train Loss: 1.3769 Acc: 0.8481
val Loss: 1.6159 Acc: 0.7812
Epoch 67/69
----------
train Loss: 1.3700 Acc: 0.8881
val Loss: 1.6646 Acc: 0.7734
Epoch 68/69
----------
train Loss: 1.4619 Acc: 0.8831
val Loss: 1.6407 Acc: 0.7656
Epoch 69/69
----------
train Loss: 1.2973 Acc: 0.9098
[I 2024-10-15 14:42:17,818] Trial 62 finished with value: 0.765625 and parameters: {'batch_size': 74, 'lr': 5.061911586978766e-06, 'num_epochs': 69, 'weight_decay': 0.14923058957574178, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.6347 Acc: 0.7656
Best val Acc: 0.765625
Model weights saved at ./model_weights/ResNet34_bs_74_lr_5.061911586978766e-06_epoch_69_wd_0.14923058957574178_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/43
----------
train Loss: 3.2855 Acc: 0.4491
val Loss: 2.6165 Acc: 0.7031
Epoch 2/43
----------
train Loss: 2.5775 Acc: 0.6895
val Loss: 2.1858 Acc: 0.7266
Epoch 3/43
----------
train Loss: 2.1407 Acc: 0.7479
val Loss: 1.9099 Acc: 0.7500
Epoch 4/43
----------
train Loss: 1.9955 Acc: 0.7262
val Loss: 1.6952 Acc: 0.7891
Epoch 5/43
----------
train Loss: 1.7515 Acc: 0.7947
val Loss: 1.5634 Acc: 0.8125
Epoch 6/43
----------
train Loss: 1.7945 Acc: 0.7546
val Loss: 1.4857 Acc: 0.7891
Epoch 7/43
----------
train Loss: 1.5248 Acc: 0.8414
val Loss: 1.4184 Acc: 0.7969
Epoch 8/43
----------
train Loss: 1.4798 Acc: 0.8715
val Loss: 1.3313 Acc: 0.8125
Epoch 9/43
----------
train Loss: 1.4555 Acc: 0.8648
val Loss: 1.3280 Acc: 0.8203
Epoch 10/43
----------
train Loss: 1.5463 Acc: 0.8715
val Loss: 1.3394 Acc: 0.8047
Epoch 11/43
----------
train Loss: 1.4563 Acc: 0.8731
val Loss: 1.3514 Acc: 0.8203
Epoch 12/43
----------
train Loss: 1.3638 Acc: 0.8898
val Loss: 1.2344 Acc: 0.8672
Epoch 13/43
----------
train Loss: 1.4684 Acc: 0.8280
val Loss: 1.3266 Acc: 0.8203
Epoch 14/43
----------
train Loss: 1.4446 Acc: 0.8414
val Loss: 1.3741 Acc: 0.8359
Epoch 15/43
----------
train Loss: 1.3890 Acc: 0.8731
val Loss: 1.3616 Acc: 0.8047
Epoch 16/43
----------
train Loss: 1.3156 Acc: 0.9082
val Loss: 1.3896 Acc: 0.7891
Epoch 17/43
----------
train Loss: 1.3142 Acc: 0.9098
val Loss: 1.3927 Acc: 0.8125
Epoch 18/43
----------
train Loss: 1.2459 Acc: 0.8831
val Loss: 1.3335 Acc: 0.7969
Epoch 19/43
----------
train Loss: 1.1618 Acc: 0.9065
val Loss: 1.2674 Acc: 0.8125
Epoch 20/43
----------
train Loss: 1.3437 Acc: 0.8781
val Loss: 1.2968 Acc: 0.8516
Epoch 21/43
----------
train Loss: 1.2584 Acc: 0.8915
val Loss: 1.2691 Acc: 0.8281
Epoch 22/43
----------
train Loss: 1.1848 Acc: 0.9165
val Loss: 1.2022 Acc: 0.8047
Epoch 23/43
----------
train Loss: 1.4351 Acc: 0.8564
val Loss: 1.3301 Acc: 0.7891
Epoch 24/43
----------
train Loss: 1.3397 Acc: 0.8865
val Loss: 1.2219 Acc: 0.8125
Epoch 25/43
----------
train Loss: 1.1788 Acc: 0.9366
val Loss: 1.3080 Acc: 0.8125
Epoch 26/43
----------
train Loss: 1.2136 Acc: 0.9265
val Loss: 1.2900 Acc: 0.8672
Epoch 27/43
----------
train Loss: 1.2981 Acc: 0.9132
val Loss: 1.2749 Acc: 0.8047
Epoch 28/43
----------
train Loss: 1.2799 Acc: 0.9015
val Loss: 1.2478 Acc: 0.8281
Epoch 29/43
----------
train Loss: 1.1334 Acc: 0.9249
val Loss: 1.1714 Acc: 0.8516
Epoch 30/43
----------
train Loss: 1.2378 Acc: 0.8982
val Loss: 1.1795 Acc: 0.8438
Epoch 31/43
----------
train Loss: 1.0971 Acc: 0.9399
val Loss: 1.1853 Acc: 0.8203
Epoch 32/43
----------
train Loss: 1.1859 Acc: 0.9316
val Loss: 1.2518 Acc: 0.8203
Epoch 33/43
----------
train Loss: 1.2226 Acc: 0.9449
val Loss: 1.2797 Acc: 0.8281
Epoch 34/43
----------
train Loss: 1.1428 Acc: 0.9015
val Loss: 1.2876 Acc: 0.8125
Epoch 35/43
----------
train Loss: 1.3183 Acc: 0.9098
val Loss: 1.3423 Acc: 0.8203
Epoch 36/43
----------
train Loss: 1.2676 Acc: 0.9048
val Loss: 1.3334 Acc: 0.7891
Epoch 37/43
----------
train Loss: 1.0865 Acc: 0.9182
val Loss: 1.2578 Acc: 0.8047
Epoch 38/43
----------
train Loss: 1.1329 Acc: 0.9349
val Loss: 1.1650 Acc: 0.8281
Epoch 39/43
----------
train Loss: 1.2076 Acc: 0.9482
val Loss: 1.1998 Acc: 0.8047
Epoch 40/43
----------
train Loss: 0.8784 Acc: 0.9583
val Loss: 1.3237 Acc: 0.7969
Epoch 41/43
----------
train Loss: 1.1925 Acc: 0.9299
val Loss: 1.3790 Acc: 0.8125
Epoch 42/43
----------
train Loss: 1.0965 Acc: 0.9366
val Loss: 1.4242 Acc: 0.7891
Epoch 43/43
----------
train Loss: 1.3057 Acc: 0.8982
[I 2024-10-15 14:45:30,760] Trial 63 finished with value: 0.8515625 and parameters: {'batch_size': 86, 'lr': 3.2468449028493283e-05, 'num_epochs': 43, 'weight_decay': 0.07555535225967666, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.2341 Acc: 0.8516
Best val Acc: 0.851562
Model weights saved at ./model_weights/ResNet34_bs_86_lr_3.2468449028493283e-05_epoch_43_wd_0.07555535225967666_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/55
----------
train Loss: 4.9009 Acc: 0.4324
val Loss: 4.1025 Acc: 0.5703
Epoch 2/55
----------
train Loss: 4.0777 Acc: 0.6160
val Loss: 3.5032 Acc: 0.6172
Epoch 3/55
----------
train Loss: 3.4739 Acc: 0.6962
val Loss: 3.0562 Acc: 0.6406
Epoch 4/55
----------
train Loss: 2.9715 Acc: 0.7245
val Loss: 2.6679 Acc: 0.6875
Epoch 5/55
----------
train Loss: 2.5363 Acc: 0.7563
val Loss: 2.3756 Acc: 0.7188
Epoch 6/55
----------
train Loss: 2.4189 Acc: 0.7663
val Loss: 2.1760 Acc: 0.7422
Epoch 7/55
----------
train Loss: 2.1447 Acc: 0.7980
val Loss: 2.0168 Acc: 0.7656
Epoch 8/55
----------
train Loss: 2.0244 Acc: 0.7913
val Loss: 1.7904 Acc: 0.7656
Epoch 9/55
----------
train Loss: 1.9881 Acc: 0.7913
val Loss: 1.6796 Acc: 0.7812
Epoch 10/55
----------
train Loss: 1.7704 Acc: 0.8364
val Loss: 1.6228 Acc: 0.7891
Epoch 11/55
----------
train Loss: 1.7228 Acc: 0.8147
val Loss: 1.5116 Acc: 0.8047
Epoch 12/55
----------
train Loss: 1.7220 Acc: 0.8347
val Loss: 1.4787 Acc: 0.7969
Epoch 13/55
----------
train Loss: 1.6126 Acc: 0.8514
val Loss: 1.4285 Acc: 0.7891
Epoch 14/55
----------
train Loss: 1.7015 Acc: 0.8280
val Loss: 1.4258 Acc: 0.7891
Epoch 15/55
----------
train Loss: 1.6153 Acc: 0.8481
val Loss: 1.4101 Acc: 0.7734
Epoch 16/55
----------
train Loss: 1.7535 Acc: 0.7997
val Loss: 1.4025 Acc: 0.7656
Epoch 17/55
----------
train Loss: 1.4959 Acc: 0.8414
val Loss: 1.3732 Acc: 0.7656
Epoch 18/55
----------
train Loss: 1.3476 Acc: 0.8948
val Loss: 1.3205 Acc: 0.7969
Epoch 19/55
----------
train Loss: 1.4136 Acc: 0.8965
val Loss: 1.3194 Acc: 0.7812
Epoch 20/55
----------
train Loss: 1.4753 Acc: 0.8748
val Loss: 1.3363 Acc: 0.7812
Epoch 21/55
----------
train Loss: 1.4607 Acc: 0.8831
val Loss: 1.3354 Acc: 0.7812
Epoch 22/55
----------
train Loss: 1.4313 Acc: 0.8698
val Loss: 1.3158 Acc: 0.7578
Epoch 23/55
----------
train Loss: 1.3843 Acc: 0.9065
val Loss: 1.3184 Acc: 0.7656
Epoch 24/55
----------
train Loss: 1.3995 Acc: 0.8948
val Loss: 1.2892 Acc: 0.7891
Epoch 25/55
----------
train Loss: 1.3109 Acc: 0.9098
val Loss: 1.2937 Acc: 0.7812
Epoch 26/55
----------
train Loss: 1.4213 Acc: 0.8815
val Loss: 1.2598 Acc: 0.7891
Epoch 27/55
----------
train Loss: 1.3506 Acc: 0.8898
val Loss: 1.2556 Acc: 0.7734
Epoch 28/55
----------
train Loss: 1.3219 Acc: 0.9199
val Loss: 1.3236 Acc: 0.7578
Epoch 29/55
----------
train Loss: 1.3280 Acc: 0.8865
val Loss: 1.3433 Acc: 0.7344
Epoch 30/55
----------
train Loss: 1.4572 Acc: 0.8798
val Loss: 1.3615 Acc: 0.7656
Epoch 31/55
----------
train Loss: 1.3842 Acc: 0.8898
val Loss: 1.3453 Acc: 0.7734
Epoch 32/55
----------
train Loss: 1.2365 Acc: 0.8932
val Loss: 1.3218 Acc: 0.7578
Epoch 33/55
----------
train Loss: 1.0631 Acc: 0.9549
val Loss: 1.3171 Acc: 0.7734
Epoch 34/55
----------
train Loss: 1.1797 Acc: 0.9065
val Loss: 1.3284 Acc: 0.7656
Epoch 35/55
----------
train Loss: 1.2668 Acc: 0.9199
val Loss: 1.3271 Acc: 0.7891
Epoch 36/55
----------
train Loss: 1.3603 Acc: 0.8898
val Loss: 1.3270 Acc: 0.7734
Epoch 37/55
----------
train Loss: 1.0924 Acc: 0.9666
val Loss: 1.3661 Acc: 0.7656
Epoch 38/55
----------
train Loss: 1.3710 Acc: 0.8881
val Loss: 1.3097 Acc: 0.7656
Epoch 39/55
----------
train Loss: 1.2715 Acc: 0.9182
val Loss: 1.3877 Acc: 0.7891
Epoch 40/55
----------
train Loss: 1.2297 Acc: 0.8915
val Loss: 1.2966 Acc: 0.7891
Epoch 41/55
----------
train Loss: 1.2818 Acc: 0.9299
val Loss: 1.3972 Acc: 0.7656
Epoch 42/55
----------
train Loss: 1.2475 Acc: 0.9082
val Loss: 1.2831 Acc: 0.7656
Epoch 43/55
----------
train Loss: 1.1189 Acc: 0.9416
val Loss: 1.2567 Acc: 0.7891
Epoch 44/55
----------
train Loss: 1.2404 Acc: 0.8748
val Loss: 1.2766 Acc: 0.8047
Epoch 45/55
----------
train Loss: 1.2853 Acc: 0.9299
val Loss: 1.2849 Acc: 0.7891
Epoch 46/55
----------
train Loss: 1.2817 Acc: 0.9065
val Loss: 1.2578 Acc: 0.7734
Epoch 47/55
----------
train Loss: 1.1567 Acc: 0.9449
val Loss: 1.2455 Acc: 0.7891
Epoch 48/55
----------
train Loss: 1.2272 Acc: 0.9165
val Loss: 1.2809 Acc: 0.7812
Epoch 49/55
----------
train Loss: 1.2512 Acc: 0.9215
val Loss: 1.3364 Acc: 0.7578
Epoch 50/55
----------
train Loss: 1.1200 Acc: 0.9416
val Loss: 1.3622 Acc: 0.7500
Epoch 51/55
----------
train Loss: 1.2709 Acc: 0.9516
val Loss: 1.3417 Acc: 0.7734
Epoch 52/55
----------
train Loss: 1.2455 Acc: 0.9048
val Loss: 1.3527 Acc: 0.7734
Epoch 53/55
----------
train Loss: 1.2765 Acc: 0.8881
val Loss: 1.3390 Acc: 0.7812
Epoch 54/55
----------
train Loss: 1.1491 Acc: 0.9382
val Loss: 1.3187 Acc: 0.7812
Epoch 55/55
----------
train Loss: 1.1608 Acc: 0.9149
[I 2024-10-15 14:49:38,513] Trial 64 finished with value: 0.7890625 and parameters: {'batch_size': 128, 'lr': 1.20964575545112e-05, 'num_epochs': 55, 'weight_decay': 0.014404737743653388, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.2894 Acc: 0.7891
Best val Acc: 0.789062
Model weights saved at ./model_weights/ResNet34_bs_128_lr_1.20964575545112e-05_epoch_55_wd_0.014404737743653388_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/62
----------
train Loss: 4.2980 Acc: 0.2337
val Loss: 4.0746 Acc: 0.2812
Epoch 2/62
----------
train Loss: 3.8766 Acc: 0.3973
val Loss: 3.5722 Acc: 0.3750
Epoch 3/62
----------
train Loss: 3.5671 Acc: 0.5326
val Loss: 3.3359 Acc: 0.5312
Epoch 4/62
----------
train Loss: 3.3201 Acc: 0.6511
val Loss: 3.0383 Acc: 0.6797
Epoch 5/62
----------
train Loss: 3.0349 Acc: 0.7195
val Loss: 2.7897 Acc: 0.7578
Epoch 6/62
----------
train Loss: 2.9271 Acc: 0.7078
val Loss: 2.6111 Acc: 0.7578
Epoch 7/62
----------
train Loss: 2.6453 Acc: 0.7529
val Loss: 2.4505 Acc: 0.7656
Epoch 8/62
----------
train Loss: 2.4920 Acc: 0.7880
val Loss: 2.3274 Acc: 0.7500
Epoch 9/62
----------
train Loss: 2.3579 Acc: 0.7780
val Loss: 2.1507 Acc: 0.7734
Epoch 10/62
----------
train Loss: 2.2682 Acc: 0.7947
val Loss: 2.0688 Acc: 0.8203
Epoch 11/62
----------
train Loss: 2.0916 Acc: 0.8397
val Loss: 1.9362 Acc: 0.8203
Epoch 12/62
----------
train Loss: 2.0951 Acc: 0.8030
val Loss: 1.8467 Acc: 0.8281
Epoch 13/62
----------
train Loss: 1.9437 Acc: 0.8197
val Loss: 1.7708 Acc: 0.8281
Epoch 14/62
----------
train Loss: 1.8509 Acc: 0.8397
val Loss: 1.6740 Acc: 0.8281
Epoch 15/62
----------
train Loss: 1.8934 Acc: 0.8130
val Loss: 1.6034 Acc: 0.8516
Epoch 16/62
----------
train Loss: 1.8435 Acc: 0.7930
val Loss: 1.5693 Acc: 0.8516
Epoch 17/62
----------
train Loss: 1.7679 Acc: 0.8531
val Loss: 1.5303 Acc: 0.8438
Epoch 18/62
----------
train Loss: 1.6324 Acc: 0.8414
val Loss: 1.4769 Acc: 0.8438
Epoch 19/62
----------
train Loss: 1.7564 Acc: 0.8347
val Loss: 1.4325 Acc: 0.8516
Epoch 20/62
----------
train Loss: 1.5745 Acc: 0.8765
val Loss: 1.4113 Acc: 0.8438
Epoch 21/62
----------
train Loss: 1.7539 Acc: 0.8130
val Loss: 1.3846 Acc: 0.8594
Epoch 22/62
----------
train Loss: 1.7175 Acc: 0.8063
val Loss: 1.3656 Acc: 0.8672
Epoch 23/62
----------
train Loss: 1.5571 Acc: 0.8698
val Loss: 1.3390 Acc: 0.8516
Epoch 24/62
----------
train Loss: 1.7275 Acc: 0.7997
val Loss: 1.3207 Acc: 0.8672
Epoch 25/62
----------
train Loss: 1.5051 Acc: 0.8781
val Loss: 1.3170 Acc: 0.8594
Epoch 26/62
----------
train Loss: 1.5447 Acc: 0.8915
val Loss: 1.3067 Acc: 0.8516
Epoch 27/62
----------
train Loss: 1.4649 Acc: 0.8681
val Loss: 1.2711 Acc: 0.8672
Epoch 28/62
----------
train Loss: 1.4298 Acc: 0.9299
val Loss: 1.2679 Acc: 0.8594
Epoch 29/62
----------
train Loss: 1.4620 Acc: 0.8881
val Loss: 1.2399 Acc: 0.8594
Epoch 30/62
----------
train Loss: 1.4749 Acc: 0.8798
val Loss: 1.2507 Acc: 0.8516
Epoch 31/62
----------
train Loss: 1.5190 Acc: 0.8614
val Loss: 1.2442 Acc: 0.8516
Epoch 32/62
----------
train Loss: 1.4026 Acc: 0.8815
val Loss: 1.2300 Acc: 0.8594
Epoch 33/62
----------
train Loss: 1.3244 Acc: 0.8881
val Loss: 1.2143 Acc: 0.8594
Epoch 34/62
----------
train Loss: 1.5850 Acc: 0.8447
val Loss: 1.2005 Acc: 0.8594
Epoch 35/62
----------
train Loss: 1.2948 Acc: 0.9082
val Loss: 1.1950 Acc: 0.8516
Epoch 36/62
----------
train Loss: 1.4982 Acc: 0.8497
val Loss: 1.1946 Acc: 0.8516
Epoch 37/62
----------
train Loss: 1.4724 Acc: 0.8614
val Loss: 1.1931 Acc: 0.8516
Epoch 38/62
----------
train Loss: 1.2203 Acc: 0.8965
val Loss: 1.1784 Acc: 0.8516
Epoch 39/62
----------
train Loss: 1.3742 Acc: 0.8815
val Loss: 1.1973 Acc: 0.8516
Epoch 40/62
----------
train Loss: 1.4364 Acc: 0.8698
val Loss: 1.1840 Acc: 0.8516
Epoch 41/62
----------
train Loss: 1.3200 Acc: 0.9098
val Loss: 1.1818 Acc: 0.8516
Epoch 42/62
----------
train Loss: 1.4965 Acc: 0.8614
val Loss: 1.1856 Acc: 0.8516
Epoch 43/62
----------
train Loss: 1.1366 Acc: 0.9265
val Loss: 1.1580 Acc: 0.8594
Epoch 44/62
----------
train Loss: 1.3679 Acc: 0.9149
val Loss: 1.1430 Acc: 0.8594
Epoch 45/62
----------
train Loss: 1.4547 Acc: 0.8731
val Loss: 1.1683 Acc: 0.8516
Epoch 46/62
----------
train Loss: 1.1039 Acc: 0.9583
val Loss: 1.1634 Acc: 0.8672
Epoch 47/62
----------
train Loss: 1.2863 Acc: 0.9316
val Loss: 1.1677 Acc: 0.8516
Epoch 48/62
----------
train Loss: 1.3619 Acc: 0.8865
val Loss: 1.1612 Acc: 0.8516
Epoch 49/62
----------
train Loss: 1.1903 Acc: 0.8898
val Loss: 1.1447 Acc: 0.8672
Epoch 50/62
----------
train Loss: 1.3777 Acc: 0.9032
val Loss: 1.1234 Acc: 0.8750
Epoch 51/62
----------
train Loss: 1.2524 Acc: 0.9082
val Loss: 1.1310 Acc: 0.8672
Epoch 52/62
----------
train Loss: 1.4235 Acc: 0.8998
val Loss: 1.1300 Acc: 0.8594
Epoch 53/62
----------
train Loss: 1.1194 Acc: 0.9349
val Loss: 1.1282 Acc: 0.8672
Epoch 54/62
----------
train Loss: 1.2611 Acc: 0.8781
val Loss: 1.1415 Acc: 0.8750
Epoch 55/62
----------
train Loss: 1.1105 Acc: 0.9232
val Loss: 1.1298 Acc: 0.8594
Epoch 56/62
----------
train Loss: 1.2798 Acc: 0.8982
val Loss: 1.1095 Acc: 0.8750
Epoch 57/62
----------
train Loss: 1.2274 Acc: 0.9082
val Loss: 1.1041 Acc: 0.8672
Epoch 58/62
----------
train Loss: 1.3464 Acc: 0.8497
val Loss: 1.1238 Acc: 0.8672
Epoch 59/62
----------
train Loss: 1.3409 Acc: 0.8982
val Loss: 1.1326 Acc: 0.8672
Epoch 60/62
----------
train Loss: 1.4722 Acc: 0.8915
val Loss: 1.1020 Acc: 0.8594
Epoch 61/62
----------
train Loss: 1.4241 Acc: 0.8698
val Loss: 1.1005 Acc: 0.8594
Epoch 62/62
----------
train Loss: 1.0833 Acc: 0.9549
[I 2024-10-15 14:54:17,795] Trial 65 finished with value: 0.859375 and parameters: {'batch_size': 8, 'lr': 5.962726979178828e-06, 'num_epochs': 62, 'weight_decay': 0.0003843530764941012, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.1056 Acc: 0.8594
Best val Acc: 0.859375
Model weights saved at ./model_weights/ResNet34_bs_8_lr_5.962726979178828e-06_epoch_62_wd_0.0003843530764941012_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/57
----------
train Loss: 0.7652 Acc: 0.5058
val Loss: 0.7401 Acc: 0.3828
Epoch 2/57
----------
train Loss: 0.7409 Acc: 0.5409
val Loss: 0.7218 Acc: 0.5391
Epoch 3/57
----------
train Loss: 0.7129 Acc: 0.6060
val Loss: 0.7041 Acc: 0.5781
Epoch 4/57
----------
train Loss: 0.6901 Acc: 0.6210
val Loss: 0.6717 Acc: 0.6172
Epoch 5/57
----------
train Loss: 0.6707 Acc: 0.6511
val Loss: 0.6647 Acc: 0.6172
Epoch 6/57
----------
train Loss: 0.6569 Acc: 0.6694
val Loss: 0.6432 Acc: 0.6172
Epoch 7/57
----------
train Loss: 0.6357 Acc: 0.6912
val Loss: 0.6263 Acc: 0.6484
Epoch 8/57
----------
train Loss: 0.6162 Acc: 0.7045
val Loss: 0.6187 Acc: 0.6406
Epoch 9/57
----------
train Loss: 0.6036 Acc: 0.6962
val Loss: 0.6015 Acc: 0.6406
Epoch 10/57
----------
train Loss: 0.5836 Acc: 0.7262
val Loss: 0.5854 Acc: 0.6484
Epoch 11/57
----------
train Loss: 0.5710 Acc: 0.7429
val Loss: 0.5687 Acc: 0.6484
Epoch 12/57
----------
train Loss: 0.5555 Acc: 0.7095
val Loss: 0.5641 Acc: 0.6562
Epoch 13/57
----------
train Loss: 0.5493 Acc: 0.7028
val Loss: 0.5498 Acc: 0.6562
Epoch 14/57
----------
train Loss: 0.5180 Acc: 0.7629
val Loss: 0.5366 Acc: 0.6484
Epoch 15/57
----------
train Loss: 0.5195 Acc: 0.7462
val Loss: 0.5222 Acc: 0.6562
Epoch 16/57
----------
train Loss: 0.4991 Acc: 0.7629
val Loss: 0.5058 Acc: 0.6719
Epoch 17/57
----------
train Loss: 0.4845 Acc: 0.7746
val Loss: 0.4989 Acc: 0.6719
Epoch 18/57
----------
train Loss: 0.4848 Acc: 0.7646
val Loss: 0.4872 Acc: 0.6797
Epoch 19/57
----------
train Loss: 0.4770 Acc: 0.7479
val Loss: 0.4819 Acc: 0.6641
Epoch 20/57
----------
train Loss: 0.4686 Acc: 0.7763
val Loss: 0.4742 Acc: 0.6875
Epoch 21/57
----------
train Loss: 0.4565 Acc: 0.7596
val Loss: 0.4573 Acc: 0.6953
Epoch 22/57
----------
train Loss: 0.4425 Acc: 0.7846
val Loss: 0.4518 Acc: 0.7188
Epoch 23/57
----------
train Loss: 0.4361 Acc: 0.7696
val Loss: 0.4367 Acc: 0.7422
Epoch 24/57
----------
train Loss: 0.4285 Acc: 0.7930
val Loss: 0.4335 Acc: 0.7344
Epoch 25/57
----------
train Loss: 0.4037 Acc: 0.8331
val Loss: 0.4244 Acc: 0.7344
Epoch 26/57
----------
train Loss: 0.4168 Acc: 0.7963
val Loss: 0.4187 Acc: 0.7266
Epoch 27/57
----------
train Loss: 0.4146 Acc: 0.7730
val Loss: 0.4161 Acc: 0.7344
Epoch 28/57
----------
train Loss: 0.4150 Acc: 0.7863
val Loss: 0.4068 Acc: 0.7500
Epoch 29/57
----------
train Loss: 0.3865 Acc: 0.7913
val Loss: 0.4002 Acc: 0.7578
Epoch 30/57
----------
train Loss: 0.3847 Acc: 0.8247
val Loss: 0.3929 Acc: 0.7500
Epoch 31/57
----------
train Loss: 0.3913 Acc: 0.7997
val Loss: 0.3902 Acc: 0.7578
Epoch 32/57
----------
train Loss: 0.3866 Acc: 0.7863
val Loss: 0.3854 Acc: 0.7500
Epoch 33/57
----------
train Loss: 0.3798 Acc: 0.7913
val Loss: 0.3834 Acc: 0.7578
Epoch 34/57
----------
train Loss: 0.3611 Acc: 0.8214
val Loss: 0.3741 Acc: 0.7500
Epoch 35/57
----------
train Loss: 0.3600 Acc: 0.8147
val Loss: 0.3728 Acc: 0.7578
Epoch 36/57
----------
train Loss: 0.3514 Acc: 0.8214
val Loss: 0.3646 Acc: 0.7578
Epoch 37/57
----------
train Loss: 0.3744 Acc: 0.8230
val Loss: 0.3659 Acc: 0.7578
Epoch 38/57
----------
train Loss: 0.3536 Acc: 0.8347
val Loss: 0.3616 Acc: 0.7578
Epoch 39/57
----------
train Loss: 0.3471 Acc: 0.8397
val Loss: 0.3524 Acc: 0.7812
Epoch 40/57
----------
train Loss: 0.3334 Acc: 0.8414
val Loss: 0.3512 Acc: 0.7812
Epoch 41/57
----------
train Loss: 0.3434 Acc: 0.8314
val Loss: 0.3487 Acc: 0.7812
Epoch 42/57
----------
train Loss: 0.3340 Acc: 0.8230
val Loss: 0.3447 Acc: 0.7734
Epoch 43/57
----------
train Loss: 0.3506 Acc: 0.8164
val Loss: 0.3445 Acc: 0.7812
Epoch 44/57
----------
train Loss: 0.3432 Acc: 0.8331
val Loss: 0.3386 Acc: 0.7812
Epoch 45/57
----------
train Loss: 0.3304 Acc: 0.8264
val Loss: 0.3343 Acc: 0.7812
Epoch 46/57
----------
train Loss: 0.3240 Acc: 0.8414
val Loss: 0.3307 Acc: 0.7891
Epoch 47/57
----------
train Loss: 0.3230 Acc: 0.8431
val Loss: 0.3307 Acc: 0.7734
Epoch 48/57
----------
train Loss: 0.3314 Acc: 0.8280
val Loss: 0.3305 Acc: 0.7891
Epoch 49/57
----------
train Loss: 0.3279 Acc: 0.8164
val Loss: 0.3232 Acc: 0.7891
Epoch 50/57
----------
train Loss: 0.3414 Acc: 0.7880
val Loss: 0.3234 Acc: 0.7969
Epoch 51/57
----------
train Loss: 0.3054 Acc: 0.8915
val Loss: 0.3237 Acc: 0.7891
Epoch 52/57
----------
train Loss: 0.2996 Acc: 0.8831
val Loss: 0.3169 Acc: 0.7969
Epoch 53/57
----------
train Loss: 0.3174 Acc: 0.8564
val Loss: 0.3149 Acc: 0.8047
Epoch 54/57
----------
train Loss: 0.3035 Acc: 0.8614
val Loss: 0.3125 Acc: 0.7969
Epoch 55/57
----------
train Loss: 0.2983 Acc: 0.8614
val Loss: 0.3133 Acc: 0.7969
Epoch 56/57
----------
train Loss: 0.3013 Acc: 0.8514
val Loss: 0.3118 Acc: 0.7969
Epoch 57/57
----------
train Loss: 0.2583 Acc: 0.9265
[I 2024-10-15 14:58:38,157] Trial 66 finished with value: 0.796875 and parameters: {'batch_size': 63, 'lr': 2.2983846904361297e-06, 'num_epochs': 57, 'weight_decay': 0.0046452164074903685, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 0.3079 Acc: 0.7969
Best val Acc: 0.796875
Model weights saved at ./model_weights/ResNet34_bs_63_lr_2.2983846904361297e-06_epoch_57_wd_0.0046452164074903685_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/49
----------
train Loss: 5.5587 Acc: 0.2638
val Loss: 5.2755 Acc: 0.4062
Epoch 2/49
----------
train Loss: 5.2517 Acc: 0.3289
val Loss: 4.9649 Acc: 0.4766
Epoch 3/49
----------
train Loss: 4.9402 Acc: 0.4374
val Loss: 4.6961 Acc: 0.5547
Epoch 4/49
----------
train Loss: 4.6801 Acc: 0.4942
val Loss: 4.4205 Acc: 0.6406
Epoch 5/49
----------
train Loss: 4.4694 Acc: 0.5058
val Loss: 4.2209 Acc: 0.6562
Epoch 6/49
----------
train Loss: 4.2303 Acc: 0.5960
val Loss: 3.9791 Acc: 0.6797
Epoch 7/49
----------
train Loss: 3.9621 Acc: 0.6427
val Loss: 3.7886 Acc: 0.7266
Epoch 8/49
----------
train Loss: 3.7400 Acc: 0.6594
val Loss: 3.5437 Acc: 0.7656
Epoch 9/49
----------
train Loss: 3.5872 Acc: 0.6962
val Loss: 3.3760 Acc: 0.7422
Epoch 10/49
----------
train Loss: 3.3934 Acc: 0.7229
val Loss: 3.2362 Acc: 0.7812
Epoch 11/49
----------
train Loss: 3.2750 Acc: 0.7012
val Loss: 3.0568 Acc: 0.7969
Epoch 12/49
----------
train Loss: 3.2024 Acc: 0.7112
val Loss: 2.9610 Acc: 0.7891
Epoch 13/49
----------
train Loss: 3.0298 Acc: 0.7329
val Loss: 2.7734 Acc: 0.7969
Epoch 14/49
----------
train Loss: 2.8911 Acc: 0.7295
val Loss: 2.6915 Acc: 0.7969
Epoch 15/49
----------
train Loss: 2.7244 Acc: 0.7713
val Loss: 2.5674 Acc: 0.8125
Epoch 16/49
----------
train Loss: 2.6870 Acc: 0.7629
val Loss: 2.4454 Acc: 0.8125
Epoch 17/49
----------
train Loss: 2.5705 Acc: 0.7679
val Loss: 2.3883 Acc: 0.8359
Epoch 18/49
----------
train Loss: 2.4976 Acc: 0.7746
val Loss: 2.2776 Acc: 0.8203
Epoch 19/49
----------
train Loss: 2.5041 Acc: 0.7563
val Loss: 2.2114 Acc: 0.8203
Epoch 20/49
----------
train Loss: 2.3095 Acc: 0.7913
val Loss: 2.1330 Acc: 0.8281
Epoch 21/49
----------
train Loss: 2.3884 Acc: 0.7696
val Loss: 2.0684 Acc: 0.8281
Epoch 22/49
----------
train Loss: 2.3288 Acc: 0.7529
val Loss: 2.0341 Acc: 0.8438
Epoch 23/49
----------
train Loss: 2.0260 Acc: 0.8331
val Loss: 1.9576 Acc: 0.8359
Epoch 24/49
----------
train Loss: 2.2121 Acc: 0.7830
val Loss: 1.9363 Acc: 0.8281
Epoch 25/49
----------
train Loss: 2.2215 Acc: 0.7713
val Loss: 1.8801 Acc: 0.8359
Epoch 26/49
----------
train Loss: 2.2090 Acc: 0.7679
val Loss: 1.8336 Acc: 0.8359
Epoch 27/49
----------
train Loss: 2.1511 Acc: 0.7546
val Loss: 1.8316 Acc: 0.8438
Epoch 28/49
----------
train Loss: 2.0944 Acc: 0.7663
val Loss: 1.7745 Acc: 0.8438
Epoch 29/49
----------
train Loss: 1.8776 Acc: 0.8147
val Loss: 1.7214 Acc: 0.8516
Epoch 30/49
----------
train Loss: 1.9372 Acc: 0.8097
val Loss: 1.6940 Acc: 0.8438
Epoch 31/49
----------
train Loss: 1.9969 Acc: 0.7730
val Loss: 1.6803 Acc: 0.8438
Epoch 32/49
----------
train Loss: 1.9028 Acc: 0.8097
val Loss: 1.6474 Acc: 0.8438
Epoch 33/49
----------
train Loss: 1.8548 Acc: 0.8297
val Loss: 1.5908 Acc: 0.8438
Epoch 34/49
----------
train Loss: 1.8170 Acc: 0.8414
val Loss: 1.5618 Acc: 0.8359
Epoch 35/49
----------
train Loss: 1.8514 Acc: 0.8114
val Loss: 1.5667 Acc: 0.8516
Epoch 36/49
----------
train Loss: 1.7537 Acc: 0.8447
val Loss: 1.4987 Acc: 0.8516
Epoch 37/49
----------
train Loss: 1.9509 Acc: 0.7813
val Loss: 1.5136 Acc: 0.8594
Epoch 38/49
----------
train Loss: 1.8166 Acc: 0.8080
val Loss: 1.4882 Acc: 0.8516
Epoch 39/49
----------
train Loss: 1.7953 Acc: 0.8314
val Loss: 1.4891 Acc: 0.8516
Epoch 40/49
----------
train Loss: 1.8106 Acc: 0.8063
val Loss: 1.4650 Acc: 0.8594
Epoch 41/49
----------
train Loss: 1.7250 Acc: 0.8381
val Loss: 1.4333 Acc: 0.8594
Epoch 42/49
----------
train Loss: 1.6961 Acc: 0.8180
val Loss: 1.4078 Acc: 0.8516
Epoch 43/49
----------
train Loss: 1.7542 Acc: 0.8030
val Loss: 1.4027 Acc: 0.8672
Epoch 44/49
----------
train Loss: 1.7505 Acc: 0.8114
val Loss: 1.3779 Acc: 0.8594
Epoch 45/49
----------
train Loss: 1.6188 Acc: 0.8464
val Loss: 1.3539 Acc: 0.8516
Epoch 46/49
----------
train Loss: 1.6791 Acc: 0.8197
val Loss: 1.3415 Acc: 0.8516
Epoch 47/49
----------
train Loss: 1.6426 Acc: 0.8664
val Loss: 1.3407 Acc: 0.8672
Epoch 48/49
----------
train Loss: 1.5542 Acc: 0.8214
val Loss: 1.3127 Acc: 0.8672
Epoch 49/49
----------
train Loss: 1.7785 Acc: 0.8264
[I 2024-10-15 15:02:18,012] Trial 67 finished with value: 0.875 and parameters: {'batch_size': 93, 'lr': 3.530038113083543e-06, 'num_epochs': 49, 'weight_decay': 0.04871260543247668, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.3180 Acc: 0.8750
Best val Acc: 0.875000
Model weights saved at ./model_weights/ResNet34_bs_93_lr_3.530038113083543e-06_epoch_49_wd_0.04871260543247668_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/50
----------
train Loss: 0.6374 Acc: 0.5275
val Loss: 0.6265 Acc: 0.5938
Epoch 2/50
----------
train Loss: 0.6293 Acc: 0.5326
val Loss: 0.6136 Acc: 0.5703
Epoch 3/50
----------
train Loss: 0.6230 Acc: 0.5292
val Loss: 0.6059 Acc: 0.5859
Epoch 4/50
----------
train Loss: 0.6139 Acc: 0.5609
val Loss: 0.6033 Acc: 0.5859
Epoch 5/50
----------
train Loss: 0.6112 Acc: 0.5659
val Loss: 0.5966 Acc: 0.5781
Epoch 6/50
----------
train Loss: 0.5999 Acc: 0.5743
val Loss: 0.5881 Acc: 0.5859
Epoch 7/50
----------
train Loss: 0.5955 Acc: 0.5860
val Loss: 0.5858 Acc: 0.5859
Epoch 8/50
----------
train Loss: 0.5876 Acc: 0.5843
val Loss: 0.5793 Acc: 0.5859
Epoch 9/50
----------
train Loss: 0.5821 Acc: 0.5810
val Loss: 0.5703 Acc: 0.6016
Epoch 10/50
----------
train Loss: 0.5753 Acc: 0.6060
val Loss: 0.5659 Acc: 0.6250
Epoch 11/50
----------
train Loss: 0.5705 Acc: 0.5943
val Loss: 0.5595 Acc: 0.6016
Epoch 12/50
----------
train Loss: 0.5628 Acc: 0.5927
val Loss: 0.5562 Acc: 0.6250
Epoch 13/50
----------
train Loss: 0.5562 Acc: 0.6043
val Loss: 0.5500 Acc: 0.6094
Epoch 14/50
----------
train Loss: 0.5492 Acc: 0.6294
val Loss: 0.5443 Acc: 0.6094
Epoch 15/50
----------
train Loss: 0.5443 Acc: 0.6294
val Loss: 0.5376 Acc: 0.6172
Epoch 16/50
----------
train Loss: 0.5407 Acc: 0.6127
val Loss: 0.5326 Acc: 0.6172
Epoch 17/50
----------
train Loss: 0.5383 Acc: 0.6260
val Loss: 0.5278 Acc: 0.6172
Epoch 18/50
----------
train Loss: 0.5319 Acc: 0.6194
val Loss: 0.5250 Acc: 0.6328
Epoch 19/50
----------
train Loss: 0.5276 Acc: 0.6194
val Loss: 0.5214 Acc: 0.6250
Epoch 20/50
----------
train Loss: 0.5244 Acc: 0.6311
val Loss: 0.5179 Acc: 0.6250
Epoch 21/50
----------
train Loss: 0.5173 Acc: 0.6160
val Loss: 0.5130 Acc: 0.6172
Epoch 22/50
----------
train Loss: 0.5144 Acc: 0.6277
val Loss: 0.5075 Acc: 0.6250
Epoch 23/50
----------
train Loss: 0.5114 Acc: 0.6294
val Loss: 0.5053 Acc: 0.6172
Epoch 24/50
----------
train Loss: 0.5062 Acc: 0.6260
val Loss: 0.5069 Acc: 0.6172
Epoch 25/50
----------
train Loss: 0.5043 Acc: 0.6311
val Loss: 0.5001 Acc: 0.6250
Epoch 26/50
----------
train Loss: 0.4992 Acc: 0.6327
val Loss: 0.4960 Acc: 0.6250
Epoch 27/50
----------
train Loss: 0.4954 Acc: 0.6260
val Loss: 0.4929 Acc: 0.6250
Epoch 28/50
----------
train Loss: 0.4899 Acc: 0.6377
val Loss: 0.4842 Acc: 0.6250
Epoch 29/50
----------
train Loss: 0.4875 Acc: 0.6311
val Loss: 0.4798 Acc: 0.6250
Epoch 30/50
----------
train Loss: 0.4861 Acc: 0.6377
val Loss: 0.4814 Acc: 0.6250
Epoch 31/50
----------
train Loss: 0.4849 Acc: 0.6294
val Loss: 0.4780 Acc: 0.6250
Epoch 32/50
----------
train Loss: 0.4735 Acc: 0.6394
val Loss: 0.4717 Acc: 0.6172
Epoch 33/50
----------
train Loss: 0.4804 Acc: 0.6327
val Loss: 0.4735 Acc: 0.6328
Epoch 34/50
----------
train Loss: 0.4711 Acc: 0.6411
val Loss: 0.4697 Acc: 0.6250
Epoch 35/50
----------
train Loss: 0.4719 Acc: 0.6327
val Loss: 0.4681 Acc: 0.6328
Epoch 36/50
----------
train Loss: 0.4699 Acc: 0.6344
val Loss: 0.4676 Acc: 0.6328
Epoch 37/50
----------
train Loss: 0.4619 Acc: 0.6377
val Loss: 0.4586 Acc: 0.6328
Epoch 38/50
----------
train Loss: 0.4628 Acc: 0.6377
val Loss: 0.4573 Acc: 0.6250
Epoch 39/50
----------
train Loss: 0.4553 Acc: 0.6427
val Loss: 0.4552 Acc: 0.6328
Epoch 40/50
----------
train Loss: 0.4607 Acc: 0.6394
val Loss: 0.4540 Acc: 0.6328
Epoch 41/50
----------
train Loss: 0.4527 Acc: 0.6461
val Loss: 0.4515 Acc: 0.6328
Epoch 42/50
----------
train Loss: 0.4532 Acc: 0.6377
val Loss: 0.4505 Acc: 0.6328
Epoch 43/50
----------
train Loss: 0.4543 Acc: 0.6311
val Loss: 0.4511 Acc: 0.6328
Epoch 44/50
----------
train Loss: 0.4448 Acc: 0.6477
val Loss: 0.4409 Acc: 0.6328
Epoch 45/50
----------
train Loss: 0.4461 Acc: 0.6394
val Loss: 0.4435 Acc: 0.6328
Epoch 46/50
----------
train Loss: 0.4427 Acc: 0.6444
val Loss: 0.4403 Acc: 0.6328
Epoch 47/50
----------
train Loss: 0.4409 Acc: 0.6544
val Loss: 0.4367 Acc: 0.6328
Epoch 48/50
----------
train Loss: 0.4343 Acc: 0.6578
val Loss: 0.4371 Acc: 0.6328
Epoch 49/50
----------
train Loss: 0.4334 Acc: 0.6461
val Loss: 0.4324 Acc: 0.6406
Epoch 50/50
----------
train Loss: 0.4366 Acc: 0.6494
[I 2024-10-15 15:06:03,648] Trial 68 finished with value: 0.6328125 and parameters: {'batch_size': 96, 'lr': 3.230408760146664e-06, 'num_epochs': 50, 'weight_decay': 0.34809990739461044, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 0.4335 Acc: 0.6328
Best val Acc: 0.632812
Model weights saved at ./model_weights/ResNet34_bs_96_lr_3.230408760146664e-06_epoch_50_wd_0.34809990739461044_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/40
----------
train Loss: 4.6763 Acc: 0.4942
val Loss: 4.8946 Acc: 0.3281
Epoch 2/40
----------
train Loss: 4.5619 Acc: 0.5292
val Loss: 4.8099 Acc: 0.3906
Epoch 3/40
----------
train Loss: 4.4451 Acc: 0.5442
val Loss: 4.6632 Acc: 0.4453
Epoch 4/40
----------
train Loss: 4.3450 Acc: 0.5743
val Loss: 4.5884 Acc: 0.4141
Epoch 5/40
----------
train Loss: 4.2275 Acc: 0.5860
val Loss: 4.4260 Acc: 0.4766
Epoch 6/40
----------
train Loss: 4.1414 Acc: 0.6060
val Loss: 4.3736 Acc: 0.5078
Epoch 7/40
----------
train Loss: 4.0459 Acc: 0.6194
val Loss: 4.2729 Acc: 0.5156
Epoch 8/40
----------
train Loss: 3.9486 Acc: 0.6210
val Loss: 4.1653 Acc: 0.5469
Epoch 9/40
----------
train Loss: 3.8770 Acc: 0.6093
val Loss: 4.0988 Acc: 0.5625
Epoch 10/40
----------
train Loss: 3.7874 Acc: 0.6344
val Loss: 4.0271 Acc: 0.5469
Epoch 11/40
----------
train Loss: 3.7070 Acc: 0.6511
val Loss: 3.9167 Acc: 0.5781
Epoch 12/40
----------
train Loss: 3.6167 Acc: 0.6511
val Loss: 3.8090 Acc: 0.5781
Epoch 13/40
----------
train Loss: 3.5829 Acc: 0.6578
val Loss: 3.7781 Acc: 0.5859
Epoch 14/40
----------
train Loss: 3.4574 Acc: 0.6761
val Loss: 3.6848 Acc: 0.6094
Epoch 15/40
----------
train Loss: 3.4174 Acc: 0.6778
val Loss: 3.6389 Acc: 0.6172
Epoch 16/40
----------
train Loss: 3.3818 Acc: 0.6861
val Loss: 3.5308 Acc: 0.6328
Epoch 17/40
----------
train Loss: 3.3044 Acc: 0.6611
val Loss: 3.4900 Acc: 0.6406
Epoch 18/40
----------
train Loss: 3.2340 Acc: 0.6962
val Loss: 3.4024 Acc: 0.6719
Epoch 19/40
----------
train Loss: 3.1127 Acc: 0.6995
val Loss: 3.3444 Acc: 0.6797
Epoch 20/40
----------
train Loss: 3.0678 Acc: 0.7229
val Loss: 3.2755 Acc: 0.6797
Epoch 21/40
----------
train Loss: 3.0626 Acc: 0.7095
val Loss: 3.2170 Acc: 0.6797
Epoch 22/40
----------
train Loss: 2.9587 Acc: 0.7195
val Loss: 3.1627 Acc: 0.6641
Epoch 23/40
----------
train Loss: 2.9863 Acc: 0.6995
val Loss: 3.1122 Acc: 0.6797
Epoch 24/40
----------
train Loss: 2.9285 Acc: 0.7095
val Loss: 3.0804 Acc: 0.6797
Epoch 25/40
----------
train Loss: 2.8491 Acc: 0.7078
val Loss: 2.9890 Acc: 0.6875
Epoch 26/40
----------
train Loss: 2.7968 Acc: 0.7162
val Loss: 2.9823 Acc: 0.6797
Epoch 27/40
----------
train Loss: 2.7447 Acc: 0.7212
val Loss: 2.9220 Acc: 0.6953
Epoch 28/40
----------
train Loss: 2.7088 Acc: 0.7245
val Loss: 2.9116 Acc: 0.6953
Epoch 29/40
----------
train Loss: 2.6656 Acc: 0.7312
val Loss: 2.8583 Acc: 0.6875
Epoch 30/40
----------
train Loss: 2.5839 Acc: 0.7479
val Loss: 2.7549 Acc: 0.6953
Epoch 31/40
----------
train Loss: 2.5907 Acc: 0.7195
val Loss: 2.7095 Acc: 0.6953
Epoch 32/40
----------
train Loss: 2.4899 Acc: 0.7563
val Loss: 2.6715 Acc: 0.6953
Epoch 33/40
----------
train Loss: 2.4715 Acc: 0.7546
val Loss: 2.6527 Acc: 0.7109
Epoch 34/40
----------
train Loss: 2.5090 Acc: 0.7346
val Loss: 2.6339 Acc: 0.7109
Epoch 35/40
----------
train Loss: 2.3732 Acc: 0.7629
val Loss: 2.6024 Acc: 0.7188
Epoch 36/40
----------
train Loss: 2.4044 Acc: 0.7579
val Loss: 2.5723 Acc: 0.7188
Epoch 37/40
----------
train Loss: 2.3220 Acc: 0.7462
val Loss: 2.5096 Acc: 0.7266
Epoch 38/40
----------
train Loss: 2.3038 Acc: 0.7730
val Loss: 2.4923 Acc: 0.7266
Epoch 39/40
----------
train Loss: 2.3540 Acc: 0.7279
val Loss: 2.4793 Acc: 0.7188
Epoch 40/40
----------
train Loss: 2.2926 Acc: 0.7546
[I 2024-10-15 15:09:03,547] Trial 69 finished with value: 0.71875 and parameters: {'batch_size': 92, 'lr': 1.5344142782594528e-06, 'num_epochs': 40, 'weight_decay': 0.05277502302376916, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 2.4040 Acc: 0.7188
Best val Acc: 0.718750
Model weights saved at ./model_weights/ResNet34_bs_92_lr_1.5344142782594528e-06_epoch_40_wd_0.05277502302376916_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/53
----------
train Loss: 0.4111 Acc: 0.6427
val Loss: 0.5094 Acc: 0.5469
Epoch 2/53
----------
train Loss: 0.4043 Acc: 0.6511
val Loss: 0.4347 Acc: 0.5938
Epoch 3/53
----------
train Loss: 0.4071 Acc: 0.6461
val Loss: 0.4558 Acc: 0.5625
Epoch 4/53
----------
train Loss: 0.3979 Acc: 0.6962
val Loss: 0.4745 Acc: 0.5703
Epoch 5/53
----------
train Loss: 0.4113 Acc: 0.6678
val Loss: 0.4221 Acc: 0.6484
Epoch 6/53
----------
train Loss: 0.4083 Acc: 0.6561
val Loss: 0.4475 Acc: 0.5547
Epoch 7/53
----------
train Loss: 0.4076 Acc: 0.6711
val Loss: 0.7475 Acc: 0.5547
Epoch 8/53
----------
train Loss: 0.3845 Acc: 0.7028
val Loss: 0.4814 Acc: 0.5859
Epoch 9/53
----------
train Loss: 0.4350 Acc: 0.6294
val Loss: 0.5876 Acc: 0.5469
Epoch 10/53
----------
train Loss: 0.4342 Acc: 0.6394
[I 2024-10-15 15:09:49,404] Trial 70 finished with value: 0.6484375 and parameters: {'batch_size': 102, 'lr': 0.0008413984917624073, 'num_epochs': 53, 'weight_decay': 0.0458417138824471, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 2.8792 Acc: 0.1797
Early stopping at epoch 10 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.648438
Model weights saved at ./model_weights/ResNet34_bs_102_lr_0.0008413984917624073_epoch_53_wd_0.0458417138824471_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/47
----------
train Loss: 5.2524 Acc: 0.5426
val Loss: 4.7587 Acc: 0.5781
Epoch 2/47
----------
train Loss: 4.7115 Acc: 0.6444
val Loss: 4.2455 Acc: 0.6562
Epoch 3/47
----------
train Loss: 4.2180 Acc: 0.6845
val Loss: 3.8782 Acc: 0.6797
Epoch 4/47
----------
train Loss: 3.7868 Acc: 0.6845
val Loss: 3.4555 Acc: 0.7266
Epoch 5/47
----------
train Loss: 3.4415 Acc: 0.7112
val Loss: 3.2198 Acc: 0.7500
Epoch 6/47
----------
train Loss: 3.2176 Acc: 0.7295
val Loss: 2.8754 Acc: 0.7344
Epoch 7/47
----------
train Loss: 2.8889 Acc: 0.7078
val Loss: 2.6910 Acc: 0.7344
Epoch 8/47
----------
train Loss: 2.6727 Acc: 0.7629
val Loss: 2.5223 Acc: 0.7422
Epoch 9/47
----------
train Loss: 2.4089 Acc: 0.7679
val Loss: 2.3356 Acc: 0.7500
Epoch 10/47
----------
train Loss: 2.4273 Acc: 0.7295
val Loss: 2.1931 Acc: 0.7734
Epoch 11/47
----------
train Loss: 2.1564 Acc: 0.7880
val Loss: 2.0520 Acc: 0.7656
Epoch 12/47
----------
train Loss: 2.0084 Acc: 0.8331
val Loss: 1.9141 Acc: 0.8047
Epoch 13/47
----------
train Loss: 2.0358 Acc: 0.7930
val Loss: 1.8000 Acc: 0.7969
Epoch 14/47
----------
train Loss: 1.9358 Acc: 0.8030
val Loss: 1.7399 Acc: 0.7891
Epoch 15/47
----------
train Loss: 2.0325 Acc: 0.7896
val Loss: 1.6715 Acc: 0.8125
Epoch 16/47
----------
train Loss: 1.8083 Acc: 0.8264
val Loss: 1.6520 Acc: 0.8125
Epoch 17/47
----------
train Loss: 1.9209 Acc: 0.7963
val Loss: 1.5736 Acc: 0.8203
Epoch 18/47
----------
train Loss: 1.7578 Acc: 0.8314
val Loss: 1.5378 Acc: 0.8281
Epoch 19/47
----------
train Loss: 1.7224 Acc: 0.8614
val Loss: 1.4663 Acc: 0.8359
Epoch 20/47
----------
train Loss: 1.4567 Acc: 0.8998
val Loss: 1.4279 Acc: 0.8281
Epoch 21/47
----------
train Loss: 1.4951 Acc: 0.8898
val Loss: 1.4156 Acc: 0.8281
Epoch 22/47
----------
train Loss: 1.6794 Acc: 0.8464
val Loss: 1.3748 Acc: 0.8359
Epoch 23/47
----------
train Loss: 1.5729 Acc: 0.8715
val Loss: 1.3822 Acc: 0.8359
Epoch 24/47
----------
train Loss: 1.5456 Acc: 0.8598
val Loss: 1.3716 Acc: 0.8281
Epoch 25/47
----------
train Loss: 1.3235 Acc: 0.9199
val Loss: 1.3742 Acc: 0.8359
Epoch 26/47
----------
train Loss: 1.5346 Acc: 0.8898
val Loss: 1.3483 Acc: 0.8359
Epoch 27/47
----------
train Loss: 1.5724 Acc: 0.8781
val Loss: 1.3182 Acc: 0.8359
Epoch 28/47
----------
train Loss: 1.2905 Acc: 0.9399
val Loss: 1.3207 Acc: 0.8359
Epoch 29/47
----------
train Loss: 1.2493 Acc: 0.9165
val Loss: 1.3250 Acc: 0.8438
Epoch 30/47
----------
train Loss: 1.4763 Acc: 0.8664
val Loss: 1.3601 Acc: 0.8203
Epoch 31/47
----------
train Loss: 1.3184 Acc: 0.8915
val Loss: 1.3239 Acc: 0.8438
Epoch 32/47
----------
train Loss: 1.4953 Acc: 0.8481
val Loss: 1.3273 Acc: 0.8281
Epoch 33/47
----------
train Loss: 1.3156 Acc: 0.9115
val Loss: 1.2852 Acc: 0.8438
Epoch 34/47
----------
train Loss: 1.3569 Acc: 0.9065
val Loss: 1.2873 Acc: 0.8359
Epoch 35/47
----------
train Loss: 1.3474 Acc: 0.8881
val Loss: 1.3030 Acc: 0.8203
Epoch 36/47
----------
train Loss: 1.2619 Acc: 0.9115
val Loss: 1.3008 Acc: 0.8203
Epoch 37/47
----------
train Loss: 1.3312 Acc: 0.9182
val Loss: 1.2672 Acc: 0.8203
Epoch 38/47
----------
train Loss: 1.2534 Acc: 0.9149
val Loss: 1.3063 Acc: 0.8125
Epoch 39/47
----------
train Loss: 1.3686 Acc: 0.8965
val Loss: 1.2870 Acc: 0.8125
Epoch 40/47
----------
train Loss: 1.3422 Acc: 0.9265
val Loss: 1.2713 Acc: 0.8203
Epoch 41/47
----------
train Loss: 1.3858 Acc: 0.8731
val Loss: 1.3062 Acc: 0.8281
Epoch 42/47
----------
train Loss: 1.2912 Acc: 0.9215
val Loss: 1.2788 Acc: 0.8359
Epoch 43/47
----------
train Loss: 1.3318 Acc: 0.9015
val Loss: 1.2731 Acc: 0.8125
Epoch 44/47
----------
train Loss: 1.3973 Acc: 0.9048
val Loss: 1.2767 Acc: 0.8203
Epoch 45/47
----------
train Loss: 1.2459 Acc: 0.9316
val Loss: 1.2685 Acc: 0.8125
Epoch 46/47
----------
train Loss: 1.2806 Acc: 0.9032
val Loss: 1.2841 Acc: 0.8125
Epoch 47/47
----------
train Loss: 1.3238 Acc: 0.8898
[I 2024-10-15 15:13:19,662] Trial 71 finished with value: 0.8125 and parameters: {'batch_size': 79, 'lr': 8.070231020389529e-06, 'num_epochs': 47, 'weight_decay': 0.03246094584809766, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.3112 Acc: 0.8125
Best val Acc: 0.812500
Model weights saved at ./model_weights/ResNet34_bs_79_lr_8.070231020389529e-06_epoch_47_wd_0.03246094584809766_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/36
----------
train Loss: 4.6923 Acc: 0.3289
val Loss: 3.7967 Acc: 0.5625
Epoch 2/36
----------
train Loss: 3.6445 Acc: 0.6210
val Loss: 2.9683 Acc: 0.7500
Epoch 3/36
----------
train Loss: 2.9997 Acc: 0.7078
val Loss: 2.4776 Acc: 0.7578
Epoch 4/36
----------
train Loss: 2.4977 Acc: 0.7679
val Loss: 2.1952 Acc: 0.7500
Epoch 5/36
----------
train Loss: 2.1913 Acc: 0.7813
val Loss: 1.9563 Acc: 0.7734
Epoch 6/36
----------
train Loss: 2.0044 Acc: 0.7713
val Loss: 1.7902 Acc: 0.7656
Epoch 7/36
----------
train Loss: 1.8390 Acc: 0.8097
val Loss: 1.6923 Acc: 0.8047
Epoch 8/36
----------
train Loss: 1.8122 Acc: 0.8047
val Loss: 1.6304 Acc: 0.7891
Epoch 9/36
----------
train Loss: 1.6333 Acc: 0.8481
val Loss: 1.5384 Acc: 0.7969
Epoch 10/36
----------
train Loss: 1.5474 Acc: 0.8447
val Loss: 1.5170 Acc: 0.7891
Epoch 11/36
----------
train Loss: 1.5230 Acc: 0.8497
val Loss: 1.5148 Acc: 0.7891
Epoch 12/36
----------
train Loss: 1.4358 Acc: 0.8548
val Loss: 1.4944 Acc: 0.7734
Epoch 13/36
----------
train Loss: 1.4081 Acc: 0.8898
val Loss: 1.4462 Acc: 0.7969
Epoch 14/36
----------
train Loss: 1.5020 Acc: 0.8164
val Loss: 1.4520 Acc: 0.7969
Epoch 15/36
----------
train Loss: 1.1781 Acc: 0.9149
val Loss: 1.4155 Acc: 0.7969
Epoch 16/36
----------
train Loss: 1.4689 Acc: 0.8347
val Loss: 1.4606 Acc: 0.7969
Epoch 17/36
----------
train Loss: 1.3108 Acc: 0.9132
val Loss: 1.4311 Acc: 0.7891
Epoch 18/36
----------
train Loss: 1.3257 Acc: 0.9265
val Loss: 1.4249 Acc: 0.7969
Epoch 19/36
----------
train Loss: 1.1382 Acc: 0.9332
val Loss: 1.4125 Acc: 0.7891
Epoch 20/36
----------
train Loss: 1.4211 Acc: 0.8364
val Loss: 1.4101 Acc: 0.7891
Epoch 21/36
----------
train Loss: 1.1586 Acc: 0.9466
val Loss: 1.3778 Acc: 0.7969
Epoch 22/36
----------
train Loss: 1.4130 Acc: 0.8464
val Loss: 1.4164 Acc: 0.7812
Epoch 23/36
----------
train Loss: 1.1662 Acc: 0.9149
val Loss: 1.4279 Acc: 0.7891
Epoch 24/36
----------
train Loss: 1.2697 Acc: 0.9249
val Loss: 1.4528 Acc: 0.7891
Epoch 25/36
----------
train Loss: 1.2521 Acc: 0.9015
val Loss: 1.4846 Acc: 0.7734
Epoch 26/36
----------
train Loss: 1.2157 Acc: 0.9182
val Loss: 1.3901 Acc: 0.8125
Epoch 27/36
----------
train Loss: 1.2446 Acc: 0.9098
val Loss: 1.3790 Acc: 0.8047
Epoch 28/36
----------
train Loss: 1.2097 Acc: 0.8815
val Loss: 1.4480 Acc: 0.7812
Epoch 29/36
----------
train Loss: 1.2422 Acc: 0.9265
val Loss: 1.4131 Acc: 0.7969
Epoch 30/36
----------
train Loss: 1.2689 Acc: 0.9182
val Loss: 1.4059 Acc: 0.8125
Epoch 31/36
----------
train Loss: 1.1599 Acc: 0.8932
val Loss: 1.4100 Acc: 0.7969
Epoch 32/36
----------
train Loss: 1.2199 Acc: 0.9182
val Loss: 1.4119 Acc: 0.8125
Epoch 33/36
----------
train Loss: 1.1645 Acc: 0.9015
val Loss: 1.3783 Acc: 0.8203
Epoch 34/36
----------
train Loss: 1.1925 Acc: 0.9332
val Loss: 1.3622 Acc: 0.8203
Epoch 35/36
----------
train Loss: 1.1956 Acc: 0.9032
val Loss: 1.3422 Acc: 0.8125
Epoch 36/36
----------
train Loss: 1.0641 Acc: 0.9265
[I 2024-10-15 15:16:01,348] Trial 72 finished with value: 0.8046875 and parameters: {'batch_size': 88, 'lr': 1.6932533615366042e-05, 'num_epochs': 36, 'weight_decay': 0.025301631306372988, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.3762 Acc: 0.8047
Best val Acc: 0.804688
Model weights saved at ./model_weights/ResNet34_bs_88_lr_1.6932533615366042e-05_epoch_36_wd_0.025301631306372988_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/45
----------
train Loss: 4.1248 Acc: 0.5426
val Loss: 11.1095 Acc: 0.6328
Epoch 2/45
----------
train Loss: 2.2229 Acc: 0.7713
val Loss: 3.6483 Acc: 0.6484
Epoch 3/45
----------
train Loss: 1.3626 Acc: 0.8414
val Loss: 2.8043 Acc: 0.7500
Epoch 4/45
----------
train Loss: 0.6493 Acc: 0.9349
val Loss: 4.2876 Acc: 0.7656
Epoch 5/45
----------
train Loss: 0.4560 Acc: 0.9482
val Loss: 4.5584 Acc: 0.7422
Epoch 6/45
----------
train Loss: 1.2815 Acc: 0.8965
val Loss: 4.3182 Acc: 0.6797
Epoch 7/45
----------
train Loss: 0.7516 Acc: 0.8881
val Loss: 4.2346 Acc: 0.7266
Epoch 8/45
----------
train Loss: 0.8573 Acc: 0.9399
val Loss: 5.0743 Acc: 0.7812
Epoch 9/45
----------
train Loss: 0.4650 Acc: 0.9282
val Loss: 2.9620 Acc: 0.7422
Epoch 10/45
----------
train Loss: 0.2298 Acc: 0.9683
val Loss: 3.7428 Acc: 0.8359
Epoch 11/45
----------
train Loss: 0.3677 Acc: 0.9516
val Loss: 4.6619 Acc: 0.8125
Epoch 12/45
----------
train Loss: 0.4637 Acc: 0.9683
val Loss: 4.2716 Acc: 0.7734
Epoch 13/45
----------
train Loss: 0.6321 Acc: 0.9265
val Loss: 10.4519 Acc: 0.7500
Epoch 14/45
----------
train Loss: 0.7283 Acc: 0.9182
val Loss: 5.6624 Acc: 0.7734
Epoch 15/45
----------
train Loss: 0.6959 Acc: 0.9215
val Loss: 6.0409 Acc: 0.8047
Epoch 16/45
----------
train Loss: 0.7420 Acc: 0.9232
val Loss: 4.0208 Acc: 0.6953
Epoch 17/45
----------
train Loss: 0.6573 Acc: 0.9182
val Loss: 4.0899 Acc: 0.6797
Epoch 18/45
----------
train Loss: 0.3642 Acc: 0.9599
val Loss: 4.0877 Acc: 0.6172
Epoch 19/45
----------
train Loss: 0.4188 Acc: 0.9499
val Loss: 3.8598 Acc: 0.7422
Epoch 20/45
----------
train Loss: 0.4718 Acc: 0.9366
val Loss: 5.6142 Acc: 0.8203
Epoch 21/45
----------
train Loss: 0.2849 Acc: 0.9750
val Loss: 5.2661 Acc: 0.8281
Epoch 22/45
----------
train Loss: 0.1781 Acc: 0.9699
val Loss: 5.3336 Acc: 0.7734
Epoch 23/45
----------
train Loss: 0.0884 Acc: 0.9917
val Loss: 4.5404 Acc: 0.8359
Epoch 24/45
----------
train Loss: 0.0844 Acc: 0.9883
val Loss: 5.3005 Acc: 0.7812
Epoch 25/45
----------
train Loss: 0.0962 Acc: 0.9850
val Loss: 7.4110 Acc: 0.7969
Epoch 26/45
----------
train Loss: 0.1353 Acc: 0.9900
val Loss: 5.5081 Acc: 0.7891
Epoch 27/45
----------
train Loss: 0.2103 Acc: 0.9866
val Loss: 4.7743 Acc: 0.7891
Epoch 28/45
----------
train Loss: 0.4234 Acc: 0.9599
val Loss: 4.0795 Acc: 0.6328
Epoch 29/45
----------
train Loss: 0.7112 Acc: 0.9048
val Loss: 15.3092 Acc: 0.5234
Epoch 30/45
----------
train Loss: 0.9863 Acc: 0.9165
val Loss: 21.0178 Acc: 0.6016
Epoch 31/45
----------
train Loss: 0.9387 Acc: 0.8965
val Loss: 22.2519 Acc: 0.2891
Epoch 32/45
----------
train Loss: 0.9514 Acc: 0.9032
[I 2024-10-15 15:18:25,705] Trial 73 finished with value: 0.7890625 and parameters: {'batch_size': 98, 'lr': 0.0003553949844907646, 'num_epochs': 45, 'weight_decay': 0.008546091911428865, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 4.4677 Acc: 0.7188
Early stopping at epoch 32 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.789062
Model weights saved at ./model_weights/ResNet34_bs_98_lr_0.0003553949844907646_epoch_45_wd_0.008546091911428865_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/51
----------
train Loss: 2.7010 Acc: 0.6027
val Loss: 3.0592 Acc: 0.7188
Epoch 2/51
----------
train Loss: 2.2226 Acc: 0.6995
val Loss: 2.3483 Acc: 0.7266
Epoch 3/51
----------
train Loss: 1.9300 Acc: 0.7396
val Loss: 2.2902 Acc: 0.7031
Epoch 4/51
----------
train Loss: 1.8640 Acc: 0.7679
val Loss: 1.8866 Acc: 0.7266
Epoch 5/51
----------
train Loss: 1.9045 Acc: 0.7513
val Loss: 2.0767 Acc: 0.7031
Epoch 6/51
----------
train Loss: 1.8297 Acc: 0.7529
val Loss: 2.0978 Acc: 0.6797
Epoch 7/51
----------
train Loss: 1.8898 Acc: 0.7579
val Loss: 1.7247 Acc: 0.7344
Epoch 8/51
----------
train Loss: 1.6480 Acc: 0.8047
val Loss: 1.9036 Acc: 0.7578
Epoch 9/51
----------
train Loss: 1.7316 Acc: 0.7830
val Loss: 1.8933 Acc: 0.7422
Epoch 10/51
----------
train Loss: 1.7675 Acc: 0.7930
val Loss: 1.7677 Acc: 0.7812
Epoch 11/51
----------
train Loss: 1.6008 Acc: 0.7947
val Loss: 1.7318 Acc: 0.7344
Epoch 12/51
----------
train Loss: 1.5754 Acc: 0.8147
val Loss: 2.4974 Acc: 0.6328
Epoch 13/51
----------
train Loss: 1.7312 Acc: 0.8030
val Loss: 1.6234 Acc: 0.8047
Epoch 14/51
----------
train Loss: 1.5553 Acc: 0.8197
val Loss: 2.2027 Acc: 0.6719
Epoch 15/51
----------
train Loss: 1.6671 Acc: 0.8114
val Loss: 1.9880 Acc: 0.7188
Epoch 16/51
----------
train Loss: 1.6912 Acc: 0.8114
val Loss: 2.1583 Acc: 0.6953
Epoch 17/51
----------
train Loss: 1.6054 Acc: 0.8297
val Loss: 1.9593 Acc: 0.7031
Epoch 18/51
----------
train Loss: 1.5841 Acc: 0.8564
[I 2024-10-15 15:19:46,591] Trial 74 finished with value: 0.8046875 and parameters: {'batch_size': 108, 'lr': 0.0005514532667007844, 'num_epochs': 51, 'weight_decay': 0.011533242678627636, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 2.0958 Acc: 0.7422
Early stopping at epoch 18 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.804688
Model weights saved at ./model_weights/ResNet34_bs_108_lr_0.0005514532667007844_epoch_51_wd_0.011533242678627636_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/59
----------
train Loss: 4.9571 Acc: 0.2838
val Loss: 4.0475 Acc: 0.5469
Epoch 2/59
----------
train Loss: 3.4275 Acc: 0.6644
val Loss: 2.9781 Acc: 0.6797
Epoch 3/59
----------
train Loss: 2.6000 Acc: 0.7596
val Loss: 2.5253 Acc: 0.7031
Epoch 4/59
----------
train Loss: 2.0969 Acc: 0.8147
val Loss: 2.2502 Acc: 0.6875
Epoch 5/59
----------
train Loss: 1.9806 Acc: 0.7696
val Loss: 2.1339 Acc: 0.7109
Epoch 6/59
----------
train Loss: 1.7429 Acc: 0.8230
val Loss: 1.9933 Acc: 0.7422
Epoch 7/59
----------
train Loss: 1.7697 Acc: 0.8013
val Loss: 1.9260 Acc: 0.7734
Epoch 8/59
----------
train Loss: 1.3148 Acc: 0.8798
val Loss: 1.8488 Acc: 0.7500
Epoch 9/59
----------
train Loss: 1.4206 Acc: 0.8614
val Loss: 1.8754 Acc: 0.7812
Epoch 10/59
----------
train Loss: 1.3591 Acc: 0.8698
val Loss: 1.7577 Acc: 0.7734
Epoch 11/59
----------
train Loss: 1.4278 Acc: 0.8013
val Loss: 1.7456 Acc: 0.7656
Epoch 12/59
----------
train Loss: 1.3994 Acc: 0.9015
val Loss: 1.8096 Acc: 0.7578
Epoch 13/59
----------
train Loss: 1.3076 Acc: 0.8831
val Loss: 1.8052 Acc: 0.7656
Epoch 14/59
----------
train Loss: 1.5383 Acc: 0.7896
val Loss: 1.8448 Acc: 0.7500
Epoch 15/59
----------
train Loss: 1.3661 Acc: 0.8982
val Loss: 1.7966 Acc: 0.7422
Epoch 16/59
----------
train Loss: 1.0753 Acc: 0.9416
val Loss: 1.7675 Acc: 0.7500
Epoch 17/59
----------
train Loss: 1.2091 Acc: 0.9249
val Loss: 1.7601 Acc: 0.7578
Epoch 18/59
----------
train Loss: 1.2945 Acc: 0.9132
val Loss: 1.8008 Acc: 0.7422
Epoch 19/59
----------
train Loss: 1.1887 Acc: 0.9199
val Loss: 1.8200 Acc: 0.7500
Epoch 20/59
----------
train Loss: 1.1848 Acc: 0.9149
val Loss: 1.8607 Acc: 0.7422
Epoch 21/59
----------
train Loss: 1.2333 Acc: 0.9015
val Loss: 1.8243 Acc: 0.7422
Epoch 22/59
----------
train Loss: 1.2680 Acc: 0.8831
val Loss: 1.8373 Acc: 0.7266
Epoch 23/59
----------
train Loss: 1.2052 Acc: 0.9015
val Loss: 1.8139 Acc: 0.7344
Epoch 24/59
----------
train Loss: 1.1232 Acc: 0.9416
val Loss: 1.8187 Acc: 0.7578
Epoch 25/59
----------
train Loss: 1.2757 Acc: 0.8781
val Loss: 1.8898 Acc: 0.7656
Epoch 26/59
----------
train Loss: 1.3287 Acc: 0.8748
val Loss: 1.8488 Acc: 0.7500
Epoch 27/59
----------
train Loss: 1.3199 Acc: 0.8881
val Loss: 1.8278 Acc: 0.7734
Epoch 28/59
----------
train Loss: 1.2289 Acc: 0.9098
val Loss: 1.8876 Acc: 0.7656
Epoch 29/59
----------
train Loss: 1.2238 Acc: 0.9249
val Loss: 1.8020 Acc: 0.7734
Epoch 30/59
----------
train Loss: 1.2143 Acc: 0.9149
val Loss: 1.8274 Acc: 0.7500
Epoch 31/59
----------
train Loss: 1.2167 Acc: 0.9199
val Loss: 1.8486 Acc: 0.7266
Epoch 32/59
----------
train Loss: 0.9669 Acc: 0.9466
val Loss: 1.8548 Acc: 0.7734
Epoch 33/59
----------
train Loss: 1.1327 Acc: 0.8932
val Loss: 1.8574 Acc: 0.7656
Epoch 34/59
----------
train Loss: 1.1260 Acc: 0.8965
val Loss: 1.8314 Acc: 0.7500
Epoch 35/59
----------
train Loss: 1.1173 Acc: 0.9115
val Loss: 1.8750 Acc: 0.7578
Epoch 36/59
----------
train Loss: 1.2428 Acc: 0.8731
val Loss: 1.9244 Acc: 0.7578
Epoch 37/59
----------
train Loss: 1.0513 Acc: 0.9165
val Loss: 1.8616 Acc: 0.7656
Epoch 38/59
----------
train Loss: 1.0898 Acc: 0.9466
val Loss: 1.8349 Acc: 0.7891
Epoch 39/59
----------
train Loss: 0.9668 Acc: 0.9766
val Loss: 1.8073 Acc: 0.7656
Epoch 40/59
----------
train Loss: 1.1830 Acc: 0.8965
val Loss: 1.8446 Acc: 0.7578
Epoch 41/59
----------
train Loss: 1.0878 Acc: 0.9199
val Loss: 1.8663 Acc: 0.7812
Epoch 42/59
----------
train Loss: 1.0700 Acc: 0.9115
val Loss: 1.8339 Acc: 0.7656
Epoch 43/59
----------
train Loss: 0.9470 Acc: 0.9215
val Loss: 1.8174 Acc: 0.7734
Epoch 44/59
----------
train Loss: 1.1619 Acc: 0.9332
val Loss: 1.8501 Acc: 0.7656
Epoch 45/59
----------
train Loss: 1.1192 Acc: 0.9282
val Loss: 1.7981 Acc: 0.7578
Epoch 46/59
----------
train Loss: 1.0747 Acc: 0.8932
val Loss: 1.8165 Acc: 0.7500
Epoch 47/59
----------
train Loss: 1.0835 Acc: 0.9449
val Loss: 1.7900 Acc: 0.7578
Epoch 48/59
----------
train Loss: 1.2093 Acc: 0.8831
val Loss: 1.7950 Acc: 0.7734
Epoch 49/59
----------
train Loss: 1.1915 Acc: 0.9115
val Loss: 1.8011 Acc: 0.7578
Epoch 50/59
----------
train Loss: 1.1585 Acc: 0.9265
val Loss: 1.7963 Acc: 0.7578
Epoch 51/59
----------
train Loss: 1.1051 Acc: 0.9349
val Loss: 1.7741 Acc: 0.7656
Epoch 52/59
----------
train Loss: 1.1390 Acc: 0.9466
val Loss: 1.8780 Acc: 0.7500
Epoch 53/59
----------
train Loss: 1.1448 Acc: 0.9349
val Loss: 1.8102 Acc: 0.7578
Epoch 54/59
----------
train Loss: 1.0130 Acc: 0.9416
val Loss: 1.8383 Acc: 0.7656
Epoch 55/59
----------
train Loss: 1.0025 Acc: 0.9533
val Loss: 1.8204 Acc: 0.7578
Epoch 56/59
----------
train Loss: 1.2362 Acc: 0.9098
val Loss: 1.8735 Acc: 0.7812
Epoch 57/59
----------
train Loss: 1.1929 Acc: 0.9399
val Loss: 1.8828 Acc: 0.7656
Epoch 58/59
----------
train Loss: 1.1701 Acc: 0.9299
val Loss: 1.8383 Acc: 0.7500
Epoch 59/59
----------
train Loss: 1.0570 Acc: 0.9466
[I 2024-10-15 15:24:10,645] Trial 75 finished with value: 0.765625 and parameters: {'batch_size': 82, 'lr': 2.4061550841906355e-05, 'num_epochs': 59, 'weight_decay': 0.002965604630463414, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.8055 Acc: 0.7656
Best val Acc: 0.765625
Model weights saved at ./model_weights/ResNet34_bs_82_lr_2.4061550841906355e-05_epoch_59_wd_0.002965604630463414_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/67
----------
train Loss: 4.1531 Acc: 0.5376
val Loss: 3.4790 Acc: 0.7969
Epoch 2/67
----------
train Loss: 1.4459 Acc: 0.8331
val Loss: 2.4282 Acc: 0.7500
Epoch 3/67
----------
train Loss: 0.6791 Acc: 0.9366
val Loss: 2.8872 Acc: 0.7734
Epoch 4/67
----------
train Loss: 0.3686 Acc: 0.9382
val Loss: 2.4497 Acc: 0.8203
Epoch 5/67
----------
train Loss: 0.2634 Acc: 0.9750
val Loss: 2.9669 Acc: 0.8359
Epoch 6/67
----------
train Loss: 0.2689 Acc: 0.9649
val Loss: 3.5154 Acc: 0.7812
Epoch 7/67
----------
train Loss: 0.9810 Acc: 0.8915
val Loss: 3.1383 Acc: 0.8281
Epoch 8/67
----------
train Loss: 1.7513 Acc: 0.8648
val Loss: 5.4222 Acc: 0.3438
Epoch 9/67
----------
train Loss: 1.6475 Acc: 0.8030
val Loss: 4.8305 Acc: 0.5312
Epoch 10/67
----------
train Loss: 1.0250 Acc: 0.8865
val Loss: 2.4614 Acc: 0.7188
Epoch 11/67
----------
train Loss: 0.8452 Acc: 0.8798
val Loss: 3.3878 Acc: 0.6250
Epoch 12/67
----------
train Loss: 0.7241 Acc: 0.9199
val Loss: 4.8130 Acc: 0.8203
Epoch 13/67
----------
train Loss: 0.5188 Acc: 0.9349
val Loss: 3.7696 Acc: 0.7969
Epoch 14/67
----------
train Loss: 0.3220 Acc: 0.9699
val Loss: 2.9364 Acc: 0.8438
Epoch 15/67
----------
train Loss: 0.4428 Acc: 0.9633
val Loss: 3.6005 Acc: 0.7734
Epoch 16/67
----------
train Loss: 0.8644 Acc: 0.9399
val Loss: 3.0052 Acc: 0.8281
Epoch 17/67
----------
train Loss: 1.1985 Acc: 0.8998
val Loss: 4.0079 Acc: 0.6953
Epoch 18/67
----------
train Loss: 0.8554 Acc: 0.9098
val Loss: 3.5445 Acc: 0.7734
Epoch 19/67
----------
train Loss: 0.8570 Acc: 0.9048
val Loss: 2.4801 Acc: 0.7578
Epoch 20/67
----------
train Loss: 0.5151 Acc: 0.9533
val Loss: 3.0550 Acc: 0.7891
Epoch 21/67
----------
train Loss: 0.8285 Acc: 0.9282
val Loss: 10.0314 Acc: 0.4141
Epoch 22/67
----------
train Loss: 1.0856 Acc: 0.9082
val Loss: 3.8406 Acc: 0.7812
Epoch 23/67
----------
train Loss: 1.1159 Acc: 0.8781
val Loss: 2.7357 Acc: 0.7812
Epoch 24/67
----------
train Loss: 0.8153 Acc: 0.8965
val Loss: 3.8490 Acc: 0.7344
Epoch 25/67
----------
train Loss: 1.0828 Acc: 0.8915
val Loss: 2.8487 Acc: 0.7578
Epoch 26/67
----------
train Loss: 0.7845 Acc: 0.9265
val Loss: 2.0311 Acc: 0.7812
Epoch 27/67
----------
train Loss: 0.5569 Acc: 0.9349
val Loss: 2.6773 Acc: 0.8047
Epoch 28/67
----------
train Loss: 0.8140 Acc: 0.9282
val Loss: 3.8069 Acc: 0.7188
Epoch 29/67
----------
train Loss: 0.7381 Acc: 0.9182
val Loss: 3.1530 Acc: 0.7891
Epoch 30/67
----------
train Loss: 0.8534 Acc: 0.8998
val Loss: 2.8454 Acc: 0.7578
Epoch 31/67
----------
train Loss: 0.8937 Acc: 0.9098
val Loss: 4.8697 Acc: 0.7656
Epoch 32/67
----------
train Loss: 0.4373 Acc: 0.9699
val Loss: 4.6851 Acc: 0.8359
Epoch 33/67
----------
train Loss: 0.2661 Acc: 0.9750
val Loss: 2.9602 Acc: 0.8438
Epoch 34/67
----------
train Loss: 0.2472 Acc: 0.9633
val Loss: 1.8139 Acc: 0.8438
Epoch 35/67
----------
train Loss: 0.4254 Acc: 0.9516
val Loss: 3.1884 Acc: 0.8125
Epoch 36/67
----------
train Loss: 0.4302 Acc: 0.9533
val Loss: 4.1778 Acc: 0.7188
Epoch 37/67
----------
train Loss: 0.3075 Acc: 0.9633
val Loss: 4.3103 Acc: 0.8594
Epoch 38/67
----------
train Loss: 0.2082 Acc: 0.9816
val Loss: 3.3503 Acc: 0.8594
Epoch 39/67
----------
train Loss: 0.6252 Acc: 0.9366
val Loss: 8.2507 Acc: 0.3438
Epoch 40/67
----------
train Loss: 0.6889 Acc: 0.9316
val Loss: 4.6774 Acc: 0.7812
Epoch 41/67
----------
train Loss: 0.7625 Acc: 0.9149
val Loss: 14.1756 Acc: 0.4141
Epoch 42/67
----------
train Loss: 1.3085 Acc: 0.8631
val Loss: 4.0166 Acc: 0.7812
Epoch 43/67
----------
train Loss: 1.5960 Acc: 0.8698
[I 2024-10-15 15:27:24,044] Trial 76 finished with value: 0.859375 and parameters: {'batch_size': 73, 'lr': 0.00021354352442073577, 'num_epochs': 67, 'weight_decay': 0.08178644690437852, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 3.3552 Acc: 0.7578
Early stopping at epoch 43 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.859375
Model weights saved at ./model_weights/ResNet34_bs_73_lr_0.00021354352442073577_epoch_67_wd_0.08178644690437852_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/48
----------
train Loss: 5.2183 Acc: 0.1402
val Loss: 5.0675 Acc: 0.1797
Epoch 2/48
----------
train Loss: 4.9356 Acc: 0.1553
val Loss: 4.7493 Acc: 0.1797
Epoch 3/48
----------
train Loss: 4.6600 Acc: 0.1736
val Loss: 4.4489 Acc: 0.2109
Epoch 4/48
----------
train Loss: 4.4197 Acc: 0.2270
val Loss: 4.2155 Acc: 0.2500
Epoch 5/48
----------
train Loss: 4.1966 Acc: 0.2604
val Loss: 4.0457 Acc: 0.2812
Epoch 6/48
----------
train Loss: 3.9654 Acc: 0.3456
val Loss: 3.7773 Acc: 0.3828
Epoch 7/48
----------
train Loss: 3.7855 Acc: 0.4073
val Loss: 3.6697 Acc: 0.4062
Epoch 8/48
----------
train Loss: 3.5923 Acc: 0.4708
val Loss: 3.4630 Acc: 0.4922
Epoch 9/48
----------
train Loss: 3.4067 Acc: 0.5242
val Loss: 3.3263 Acc: 0.5391
Epoch 10/48
----------
train Loss: 3.2942 Acc: 0.5543
val Loss: 3.1668 Acc: 0.5938
Epoch 11/48
----------
train Loss: 3.1235 Acc: 0.6427
val Loss: 3.0440 Acc: 0.6016
Epoch 12/48
----------
train Loss: 3.0270 Acc: 0.6461
val Loss: 2.9261 Acc: 0.6641
Epoch 13/48
----------
train Loss: 2.8761 Acc: 0.6928
val Loss: 2.8042 Acc: 0.7109
Epoch 14/48
----------
train Loss: 2.7188 Acc: 0.7563
val Loss: 2.7003 Acc: 0.7266
Epoch 15/48
----------
train Loss: 2.6683 Acc: 0.7195
val Loss: 2.6102 Acc: 0.7344
Epoch 16/48
----------
train Loss: 2.4844 Acc: 0.7963
val Loss: 2.5214 Acc: 0.7422
Epoch 17/48
----------
train Loss: 2.3910 Acc: 0.8030
val Loss: 2.4426 Acc: 0.7500
Epoch 18/48
----------
train Loss: 2.3607 Acc: 0.8013
val Loss: 2.3660 Acc: 0.7344
Epoch 19/48
----------
train Loss: 2.3635 Acc: 0.7663
val Loss: 2.2882 Acc: 0.7266
Epoch 20/48
----------
train Loss: 2.2603 Acc: 0.7563
val Loss: 2.2322 Acc: 0.7500
Epoch 21/48
----------
train Loss: 2.1169 Acc: 0.8514
val Loss: 2.1703 Acc: 0.7578
Epoch 22/48
----------
train Loss: 2.1797 Acc: 0.7796
val Loss: 2.1240 Acc: 0.7500
Epoch 23/48
----------
train Loss: 2.1411 Acc: 0.8280
val Loss: 2.0831 Acc: 0.7500
Epoch 24/48
----------
train Loss: 1.9739 Acc: 0.8397
val Loss: 2.0297 Acc: 0.7578
Epoch 25/48
----------
train Loss: 2.0957 Acc: 0.8030
val Loss: 1.9972 Acc: 0.7578
Epoch 26/48
----------
train Loss: 1.9079 Acc: 0.8564
val Loss: 1.9519 Acc: 0.7734
Epoch 27/48
----------
train Loss: 1.8885 Acc: 0.8414
val Loss: 1.9161 Acc: 0.7734
Epoch 28/48
----------
train Loss: 1.8820 Acc: 0.8264
val Loss: 1.8827 Acc: 0.7734
Epoch 29/48
----------
train Loss: 1.8514 Acc: 0.8397
val Loss: 1.8438 Acc: 0.7891
Epoch 30/48
----------
train Loss: 2.0069 Acc: 0.7930
val Loss: 1.8288 Acc: 0.7812
Epoch 31/48
----------
train Loss: 1.8864 Acc: 0.8063
val Loss: 1.8189 Acc: 0.7891
Epoch 32/48
----------
train Loss: 1.8833 Acc: 0.8314
val Loss: 1.8099 Acc: 0.7812
Epoch 33/48
----------
train Loss: 1.8718 Acc: 0.7980
val Loss: 1.7737 Acc: 0.7812
Epoch 34/48
----------
train Loss: 1.8607 Acc: 0.8164
val Loss: 1.7522 Acc: 0.7891
Epoch 35/48
----------
train Loss: 1.8087 Acc: 0.8080
val Loss: 1.7408 Acc: 0.7969
Epoch 36/48
----------
train Loss: 1.6867 Acc: 0.8497
val Loss: 1.7255 Acc: 0.7812
Epoch 37/48
----------
train Loss: 1.6971 Acc: 0.8247
val Loss: 1.6955 Acc: 0.7969
Epoch 38/48
----------
train Loss: 1.7161 Acc: 0.8631
val Loss: 1.6818 Acc: 0.7891
Epoch 39/48
----------
train Loss: 1.6883 Acc: 0.8431
val Loss: 1.6739 Acc: 0.7969
Epoch 40/48
----------
train Loss: 1.7964 Acc: 0.8114
val Loss: 1.6576 Acc: 0.8047
Epoch 41/48
----------
train Loss: 1.5919 Acc: 0.8447
val Loss: 1.6487 Acc: 0.8125
Epoch 42/48
----------
train Loss: 1.7142 Acc: 0.8097
val Loss: 1.6478 Acc: 0.7969
Epoch 43/48
----------
train Loss: 1.7734 Acc: 0.8080
val Loss: 1.6356 Acc: 0.7891
Epoch 44/48
----------
train Loss: 1.5706 Acc: 0.8514
val Loss: 1.6251 Acc: 0.8047
Epoch 45/48
----------
train Loss: 1.4599 Acc: 0.8848
val Loss: 1.6134 Acc: 0.7969
Epoch 46/48
----------
train Loss: 1.5441 Acc: 0.8865
val Loss: 1.6096 Acc: 0.7969
Epoch 47/48
----------
train Loss: 1.6030 Acc: 0.8414
val Loss: 1.6047 Acc: 0.7969
Epoch 48/48
----------
train Loss: 1.5390 Acc: 0.8731
[I 2024-10-15 15:31:02,194] Trial 77 finished with value: 0.8046875 and parameters: {'batch_size': 77, 'lr': 3.3913304190905575e-06, 'num_epochs': 48, 'weight_decay': 0.019849408230653873, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.6017 Acc: 0.8047
Best val Acc: 0.804688
Model weights saved at ./model_weights/ResNet34_bs_77_lr_3.3913304190905575e-06_epoch_48_wd_0.019849408230653873_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/56
----------
train Loss: 5.8231 Acc: 0.1803
val Loss: 5.3201 Acc: 0.3125
Epoch 2/56
----------
train Loss: 3.9877 Acc: 0.3489
val Loss: 4.5357 Acc: 0.3594
Epoch 3/56
----------
train Loss: 2.9362 Acc: 0.4825
val Loss: 4.0872 Acc: 0.4922
Epoch 4/56
----------
train Loss: 2.2419 Acc: 0.6394
val Loss: 3.7625 Acc: 0.5938
Epoch 5/56
----------
train Loss: 1.7859 Acc: 0.7412
val Loss: 3.5049 Acc: 0.6250
Epoch 6/56
----------
train Loss: 1.3582 Acc: 0.8247
val Loss: 3.3432 Acc: 0.6719
Epoch 7/56
----------
train Loss: 1.0678 Acc: 0.8815
val Loss: 3.2093 Acc: 0.7109
Epoch 8/56
----------
train Loss: 0.8205 Acc: 0.9182
val Loss: 3.1082 Acc: 0.7266
Epoch 9/56
----------
train Loss: 0.6662 Acc: 0.9516
val Loss: 3.0929 Acc: 0.7500
Epoch 10/56
----------
train Loss: 0.5268 Acc: 0.9683
val Loss: 3.0560 Acc: 0.7656
Epoch 11/56
----------
train Loss: 0.3819 Acc: 0.9783
val Loss: 3.0977 Acc: 0.7812
Epoch 12/56
----------
train Loss: 0.3470 Acc: 0.9917
val Loss: 3.1518 Acc: 0.8125
Epoch 13/56
----------
train Loss: 0.2582 Acc: 0.9917
val Loss: 3.1730 Acc: 0.7812
Epoch 14/56
----------
train Loss: 0.1962 Acc: 0.9950
val Loss: 3.1206 Acc: 0.7812
Epoch 15/56
----------
train Loss: 0.2115 Acc: 0.9950
val Loss: 3.2358 Acc: 0.8125
Epoch 16/56
----------
train Loss: 0.2000 Acc: 0.9967
val Loss: 3.2719 Acc: 0.7734
Epoch 17/56
----------
train Loss: 0.1617 Acc: 0.9950
val Loss: 3.2288 Acc: 0.7812
Epoch 18/56
----------
train Loss: 0.1183 Acc: 0.9950
val Loss: 3.3535 Acc: 0.8047
Epoch 19/56
----------
train Loss: 0.1219 Acc: 0.9967
val Loss: 3.4251 Acc: 0.8203
Epoch 20/56
----------
train Loss: 0.1334 Acc: 0.9950
val Loss: 3.4808 Acc: 0.7969
Epoch 21/56
----------
train Loss: 0.1113 Acc: 0.9967
val Loss: 3.4824 Acc: 0.8047
Epoch 22/56
----------
train Loss: 0.1117 Acc: 0.9967
val Loss: 3.4856 Acc: 0.8203
Epoch 23/56
----------
train Loss: 0.0769 Acc: 0.9967
val Loss: 3.5281 Acc: 0.8281
Epoch 24/56
----------
train Loss: 0.0916 Acc: 0.9967
val Loss: 3.6242 Acc: 0.8047
Epoch 25/56
----------
train Loss: 0.0984 Acc: 0.9933
val Loss: 3.4580 Acc: 0.7891
Epoch 26/56
----------
train Loss: 0.0715 Acc: 0.9967
val Loss: 3.6567 Acc: 0.8203
Epoch 27/56
----------
train Loss: 0.0707 Acc: 0.9950
val Loss: 3.8211 Acc: 0.7969
Epoch 28/56
----------
train Loss: 0.0791 Acc: 0.9967
val Loss: 3.8049 Acc: 0.8047
Epoch 29/56
----------
train Loss: 0.0799 Acc: 0.9967
val Loss: 3.6399 Acc: 0.7812
Epoch 30/56
----------
train Loss: 0.0659 Acc: 0.9967
val Loss: 3.7617 Acc: 0.8203
Epoch 31/56
----------
train Loss: 0.0420 Acc: 0.9983
val Loss: 3.8939 Acc: 0.8047
Epoch 32/56
----------
train Loss: 0.0688 Acc: 0.9967
val Loss: 3.8722 Acc: 0.7969
Epoch 33/56
----------
train Loss: 0.0506 Acc: 0.9967
val Loss: 3.8690 Acc: 0.7969
Epoch 34/56
----------
train Loss: 0.0609 Acc: 0.9950
val Loss: 3.9118 Acc: 0.7969
Epoch 35/56
----------
train Loss: 0.0538 Acc: 0.9967
val Loss: 3.8252 Acc: 0.8047
Epoch 36/56
----------
train Loss: 0.0550 Acc: 0.9950
val Loss: 4.0048 Acc: 0.8203
Epoch 37/56
----------
train Loss: 0.0509 Acc: 0.9967
val Loss: 4.0417 Acc: 0.8047
Epoch 38/56
----------
train Loss: 0.0532 Acc: 0.9950
val Loss: 3.9888 Acc: 0.8281
Epoch 39/56
----------
train Loss: 0.0448 Acc: 0.9967
val Loss: 4.0067 Acc: 0.8047
Epoch 40/56
----------
train Loss: 0.0461 Acc: 0.9967
val Loss: 3.9960 Acc: 0.8203
Epoch 41/56
----------
train Loss: 0.0684 Acc: 0.9967
val Loss: 3.9584 Acc: 0.8047
Epoch 42/56
----------
train Loss: 0.0459 Acc: 0.9967
val Loss: 4.1397 Acc: 0.8125
Epoch 43/56
----------
train Loss: 0.0420 Acc: 0.9967
val Loss: 4.0968 Acc: 0.8125
Epoch 44/56
----------
train Loss: 0.0481 Acc: 0.9967
val Loss: 4.0743 Acc: 0.8047
Epoch 45/56
----------
train Loss: 0.0440 Acc: 0.9967
val Loss: 4.1320 Acc: 0.8047
Epoch 46/56
----------
train Loss: 0.0357 Acc: 0.9967
val Loss: 3.9818 Acc: 0.8125
Epoch 47/56
----------
train Loss: 0.0505 Acc: 0.9967
val Loss: 4.1990 Acc: 0.8125
Epoch 48/56
----------
train Loss: 0.0336 Acc: 0.9967
val Loss: 3.9910 Acc: 0.8047
Epoch 49/56
----------
train Loss: 0.0422 Acc: 0.9967
val Loss: 4.1462 Acc: 0.8203
Epoch 50/56
----------
train Loss: 0.0364 Acc: 0.9967
val Loss: 4.1322 Acc: 0.7969
Epoch 51/56
----------
train Loss: 0.0387 Acc: 0.9967
val Loss: 4.1736 Acc: 0.8125
Epoch 52/56
----------
train Loss: 0.0338 Acc: 0.9967
val Loss: 4.2356 Acc: 0.8047
Epoch 53/56
----------
train Loss: 0.0367 Acc: 0.9967
val Loss: 4.1270 Acc: 0.8047
Epoch 54/56
----------
train Loss: 0.0296 Acc: 0.9967
val Loss: 4.1749 Acc: 0.8125
Epoch 55/56
----------
train Loss: 0.0342 Acc: 0.9967
val Loss: 4.2825 Acc: 0.8203
Epoch 56/56
----------
train Loss: 0.0329 Acc: 0.9967
[I 2024-10-15 15:35:12,449] Trial 78 finished with value: 0.8203125 and parameters: {'batch_size': 67, 'lr': 1.0228625015399424e-05, 'num_epochs': 56, 'weight_decay': 0.013539064499744896, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 4.3412 Acc: 0.8203
Best val Acc: 0.820312
Model weights saved at ./model_weights/ResNet34_bs_67_lr_1.0228625015399424e-05_epoch_56_wd_0.013539064499744896_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/42
----------
train Loss: 0.7049 Acc: 0.4007
val Loss: 0.6755 Acc: 0.4688
Epoch 2/42
----------
train Loss: 0.6796 Acc: 0.4758
val Loss: 0.6703 Acc: 0.4297
Epoch 3/42
----------
train Loss: 0.6627 Acc: 0.4741
val Loss: 0.6530 Acc: 0.4375
Epoch 4/42
----------
train Loss: 0.6408 Acc: 0.5125
val Loss: 0.6336 Acc: 0.4688
Epoch 5/42
----------
train Loss: 0.6237 Acc: 0.5376
val Loss: 0.6185 Acc: 0.5078
Epoch 6/42
----------
train Loss: 0.6081 Acc: 0.5593
val Loss: 0.5995 Acc: 0.5391
Epoch 7/42
----------
train Loss: 0.5867 Acc: 0.5977
val Loss: 0.5830 Acc: 0.6016
Epoch 8/42
----------
train Loss: 0.5766 Acc: 0.5876
val Loss: 0.5701 Acc: 0.6250
Epoch 9/42
----------
train Loss: 0.5628 Acc: 0.6244
val Loss: 0.5498 Acc: 0.6406
Epoch 10/42
----------
train Loss: 0.5432 Acc: 0.6394
val Loss: 0.5338 Acc: 0.6562
Epoch 11/42
----------
train Loss: 0.5351 Acc: 0.6511
val Loss: 0.5288 Acc: 0.7031
Epoch 12/42
----------
train Loss: 0.5211 Acc: 0.6745
val Loss: 0.5101 Acc: 0.7109
Epoch 13/42
----------
train Loss: 0.5109 Acc: 0.6494
val Loss: 0.4974 Acc: 0.7109
Epoch 14/42
----------
train Loss: 0.4995 Acc: 0.6544
val Loss: 0.4884 Acc: 0.7344
Epoch 15/42
----------
train Loss: 0.4912 Acc: 0.6945
val Loss: 0.4747 Acc: 0.7344
Epoch 16/42
----------
train Loss: 0.4738 Acc: 0.6828
val Loss: 0.4671 Acc: 0.7422
Epoch 17/42
----------
train Loss: 0.4811 Acc: 0.6694
val Loss: 0.4589 Acc: 0.7422
Epoch 18/42
----------
train Loss: 0.4692 Acc: 0.6845
val Loss: 0.4532 Acc: 0.7344
Epoch 19/42
----------
train Loss: 0.4613 Acc: 0.6811
val Loss: 0.4417 Acc: 0.7422
Epoch 20/42
----------
train Loss: 0.4530 Acc: 0.6928
val Loss: 0.4358 Acc: 0.7500
Epoch 21/42
----------
train Loss: 0.4466 Acc: 0.6895
val Loss: 0.4255 Acc: 0.7422
Epoch 22/42
----------
train Loss: 0.4414 Acc: 0.6795
val Loss: 0.4190 Acc: 0.7422
Epoch 23/42
----------
train Loss: 0.4409 Acc: 0.7078
val Loss: 0.4179 Acc: 0.7422
Epoch 24/42
----------
train Loss: 0.4276 Acc: 0.7012
val Loss: 0.4099 Acc: 0.7578
Epoch 25/42
----------
train Loss: 0.4180 Acc: 0.7245
val Loss: 0.4036 Acc: 0.7578
Epoch 26/42
----------
train Loss: 0.4151 Acc: 0.7045
val Loss: 0.3941 Acc: 0.7500
Epoch 27/42
----------
train Loss: 0.4070 Acc: 0.7396
val Loss: 0.3857 Acc: 0.7500
Epoch 28/42
----------
train Loss: 0.4050 Acc: 0.7229
val Loss: 0.3824 Acc: 0.7578
Epoch 29/42
----------
train Loss: 0.4001 Acc: 0.7145
val Loss: 0.3752 Acc: 0.7656
Epoch 30/42
----------
train Loss: 0.4057 Acc: 0.7179
val Loss: 0.3728 Acc: 0.7656
Epoch 31/42
----------
train Loss: 0.3911 Acc: 0.7262
val Loss: 0.3671 Acc: 0.7734
Epoch 32/42
----------
train Loss: 0.3957 Acc: 0.7045
val Loss: 0.3649 Acc: 0.7734
Epoch 33/42
----------
train Loss: 0.3935 Acc: 0.7145
val Loss: 0.3643 Acc: 0.7734
Epoch 34/42
----------
train Loss: 0.3712 Acc: 0.7513
val Loss: 0.3538 Acc: 0.7891
Epoch 35/42
----------
train Loss: 0.3850 Acc: 0.7212
val Loss: 0.3537 Acc: 0.7812
Epoch 36/42
----------
train Loss: 0.3732 Acc: 0.7462
val Loss: 0.3474 Acc: 0.7812
Epoch 37/42
----------
train Loss: 0.3736 Acc: 0.7396
val Loss: 0.3417 Acc: 0.7969
Epoch 38/42
----------
train Loss: 0.3786 Acc: 0.7379
val Loss: 0.3372 Acc: 0.7969
Epoch 39/42
----------
train Loss: 0.3731 Acc: 0.7295
val Loss: 0.3357 Acc: 0.7891
Epoch 40/42
----------
train Loss: 0.3499 Acc: 0.7529
val Loss: 0.3318 Acc: 0.7812
Epoch 41/42
----------
train Loss: 0.3602 Acc: 0.7429
val Loss: 0.3279 Acc: 0.7812
Epoch 42/42
----------
train Loss: 0.3486 Acc: 0.7646
[I 2024-10-15 15:38:21,160] Trial 79 finished with value: 0.796875 and parameters: {'batch_size': 83, 'lr': 6.435496493602748e-06, 'num_epochs': 42, 'weight_decay': 0.15963729838232404, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 0.3253 Acc: 0.7969
Best val Acc: 0.796875
Model weights saved at ./model_weights/ResNet34_bs_83_lr_6.435496493602748e-06_epoch_42_wd_0.15963729838232404_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/76
----------
train Loss: 4.4972 Acc: 0.5726
val Loss: 3.6298 Acc: 0.7188
Epoch 2/76
----------
train Loss: 1.5972 Acc: 0.8164
val Loss: 2.9722 Acc: 0.7812
Epoch 3/76
----------
train Loss: 0.7974 Acc: 0.9499
val Loss: 2.8343 Acc: 0.7812
Epoch 4/76
----------
train Loss: 0.4237 Acc: 0.9816
val Loss: 2.9840 Acc: 0.7578
Epoch 5/76
----------
train Loss: 0.2508 Acc: 0.9933
val Loss: 3.2215 Acc: 0.7969
Epoch 6/76
----------
train Loss: 0.2340 Acc: 0.9900
val Loss: 3.3667 Acc: 0.8047
Epoch 7/76
----------
train Loss: 0.1658 Acc: 0.9917
val Loss: 3.3493 Acc: 0.7969
Epoch 8/76
----------
train Loss: 0.1393 Acc: 0.9917
val Loss: 3.5494 Acc: 0.7891
Epoch 9/76
----------
train Loss: 0.1195 Acc: 0.9917
val Loss: 3.7085 Acc: 0.7891
Epoch 10/76
----------
train Loss: 0.1082 Acc: 0.9933
val Loss: 3.5863 Acc: 0.7969
Epoch 11/76
----------
train Loss: 0.0828 Acc: 0.9950
val Loss: 4.0119 Acc: 0.7812
Epoch 12/76
----------
train Loss: 0.1092 Acc: 0.9917
val Loss: 3.6954 Acc: 0.8047
Epoch 13/76
----------
train Loss: 0.1097 Acc: 0.9933
val Loss: 4.3122 Acc: 0.8203
Epoch 14/76
----------
train Loss: 0.1209 Acc: 0.9917
val Loss: 4.3798 Acc: 0.7734
Epoch 15/76
----------
train Loss: 0.0794 Acc: 0.9950
val Loss: 4.0860 Acc: 0.8047
Epoch 16/76
----------
train Loss: 0.0806 Acc: 0.9933
val Loss: 4.3358 Acc: 0.7969
Epoch 17/76
----------
train Loss: 0.0769 Acc: 0.9950
val Loss: 4.7310 Acc: 0.7969
Epoch 18/76
----------
train Loss: 0.1194 Acc: 0.9917
val Loss: 4.6920 Acc: 0.7891
Epoch 19/76
----------
train Loss: 0.2591 Acc: 0.9800
val Loss: 5.0207 Acc: 0.7734
Epoch 20/76
----------
train Loss: 0.4628 Acc: 0.9699
val Loss: 4.0288 Acc: 0.8047
Epoch 21/76
----------
train Loss: 0.4530 Acc: 0.9549
val Loss: 5.4214 Acc: 0.7812
Epoch 22/76
----------
train Loss: 0.6954 Acc: 0.9482
val Loss: 4.9288 Acc: 0.7969
Epoch 23/76
----------
train Loss: 0.4888 Acc: 0.9516
val Loss: 4.2373 Acc: 0.7500
Epoch 24/76
----------
train Loss: 0.4325 Acc: 0.9499
val Loss: 6.1945 Acc: 0.7734
Epoch 25/76
----------
train Loss: 0.2319 Acc: 0.9649
val Loss: 4.9656 Acc: 0.7578
Epoch 26/76
----------
train Loss: 0.1269 Acc: 0.9883
val Loss: 4.5985 Acc: 0.7969
Epoch 27/76
----------
train Loss: 0.1497 Acc: 0.9866
val Loss: 4.5731 Acc: 0.8047
Epoch 28/76
----------
train Loss: 0.1777 Acc: 0.9800
val Loss: 4.0915 Acc: 0.8125
Epoch 29/76
----------
train Loss: 0.1147 Acc: 0.9900
val Loss: 4.5922 Acc: 0.8125
Epoch 30/76
----------
train Loss: 0.1042 Acc: 0.9866
val Loss: 4.7068 Acc: 0.8203
Epoch 31/76
----------
train Loss: 0.1912 Acc: 0.9866
val Loss: 4.9160 Acc: 0.8047
Epoch 32/76
----------
train Loss: 0.2168 Acc: 0.9783
val Loss: 4.2644 Acc: 0.8203
Epoch 33/76
----------
train Loss: 0.3874 Acc: 0.9633
val Loss: 4.8755 Acc: 0.7500
Epoch 34/76
----------
train Loss: 0.4177 Acc: 0.9499
val Loss: 4.9229 Acc: 0.8125
Epoch 35/76
----------
train Loss: 0.1613 Acc: 0.9866
val Loss: 4.5634 Acc: 0.8125
Epoch 36/76
----------
train Loss: 0.0727 Acc: 0.9917
val Loss: 3.9590 Acc: 0.8281
Epoch 37/76
----------
train Loss: 0.0803 Acc: 0.9866
val Loss: 4.1360 Acc: 0.8047
Epoch 38/76
----------
train Loss: 0.0924 Acc: 0.9900
val Loss: 4.7049 Acc: 0.8281
Epoch 39/76
----------
train Loss: 0.1268 Acc: 0.9900
val Loss: 4.3794 Acc: 0.8359
Epoch 40/76
----------
train Loss: 0.0634 Acc: 0.9917
val Loss: 4.7811 Acc: 0.8125
Epoch 41/76
----------
train Loss: 0.1252 Acc: 0.9816
val Loss: 5.2074 Acc: 0.7891
Epoch 42/76
----------
train Loss: 0.1101 Acc: 0.9900
val Loss: 5.6021 Acc: 0.7969
Epoch 43/76
----------
train Loss: 0.0650 Acc: 0.9933
val Loss: 4.8074 Acc: 0.7969
Epoch 44/76
----------
train Loss: 0.0597 Acc: 0.9950
val Loss: 4.8607 Acc: 0.8125
Epoch 45/76
----------
train Loss: 0.0572 Acc: 0.9933
val Loss: 4.7472 Acc: 0.8281
Epoch 46/76
----------
train Loss: 0.0573 Acc: 0.9933
val Loss: 5.2362 Acc: 0.8203
Epoch 47/76
----------
train Loss: 0.0739 Acc: 0.9917
val Loss: 5.4995 Acc: 0.8125
Epoch 48/76
----------
train Loss: 0.0791 Acc: 0.9850
val Loss: 4.9272 Acc: 0.8281
Epoch 49/76
----------
train Loss: 0.0603 Acc: 0.9933
val Loss: 4.9581 Acc: 0.8125
Epoch 50/76
----------
train Loss: 0.0579 Acc: 0.9933
val Loss: 4.8130 Acc: 0.8281
Epoch 51/76
----------
train Loss: 0.0688 Acc: 0.9900
val Loss: 4.5716 Acc: 0.7891
Epoch 52/76
----------
train Loss: 0.0538 Acc: 0.9917
val Loss: 4.6373 Acc: 0.7969
Epoch 53/76
----------
train Loss: 0.0652 Acc: 0.9883
val Loss: 5.2185 Acc: 0.7969
Epoch 54/76
----------
train Loss: 0.0588 Acc: 0.9950
val Loss: 4.7182 Acc: 0.8438
Epoch 55/76
----------
train Loss: 0.0442 Acc: 0.9950
val Loss: 4.9597 Acc: 0.8281
Epoch 56/76
----------
train Loss: 0.0809 Acc: 0.9933
val Loss: 5.1238 Acc: 0.8203
Epoch 57/76
----------
train Loss: 0.0421 Acc: 0.9950
val Loss: 5.2730 Acc: 0.8281
Epoch 58/76
----------
train Loss: 0.0475 Acc: 0.9950
val Loss: 5.0768 Acc: 0.8281
Epoch 59/76
----------
train Loss: 0.0453 Acc: 0.9950
val Loss: 4.7771 Acc: 0.8203
Epoch 60/76
----------
train Loss: 0.0473 Acc: 0.9950
val Loss: 4.4269 Acc: 0.8203
Epoch 61/76
----------
train Loss: 0.0446 Acc: 0.9933
val Loss: 5.1595 Acc: 0.8203
Epoch 62/76
----------
train Loss: 0.0396 Acc: 0.9950
val Loss: 5.2081 Acc: 0.8281
Epoch 63/76
----------
train Loss: 0.0441 Acc: 0.9950
val Loss: 5.2731 Acc: 0.8359
Epoch 64/76
----------
train Loss: 0.0455 Acc: 0.9933
val Loss: 5.8759 Acc: 0.8203
Epoch 65/76
----------
train Loss: 0.0379 Acc: 0.9950
val Loss: 4.8974 Acc: 0.8281
Epoch 66/76
----------
train Loss: 0.0349 Acc: 0.9950
val Loss: 5.1649 Acc: 0.8203
Epoch 67/76
----------
train Loss: 0.0414 Acc: 0.9933
val Loss: 5.2623 Acc: 0.8359
Epoch 68/76
----------
train Loss: 0.0505 Acc: 0.9950
val Loss: 4.8524 Acc: 0.8203
Epoch 69/76
----------
train Loss: 0.0511 Acc: 0.9917
val Loss: 4.2424 Acc: 0.8203
Epoch 70/76
----------
train Loss: 0.0419 Acc: 0.9933
val Loss: 5.5159 Acc: 0.8203
Epoch 71/76
----------
train Loss: 0.2159 Acc: 0.9733
val Loss: 6.7717 Acc: 0.8125
Epoch 72/76
----------
train Loss: 0.7789 Acc: 0.9249
val Loss: 7.1163 Acc: 0.6094
Epoch 73/76
----------
train Loss: 2.2538 Acc: 0.8197
val Loss: 6.1427 Acc: 0.6016
Epoch 74/76
----------
train Loss: 1.6223 Acc: 0.8531
val Loss: 3.8933 Acc: 0.7812
Epoch 75/76
----------
train Loss: 0.6418 Acc: 0.9265
val Loss: 4.3503 Acc: 0.8203
Epoch 76/76
----------
train Loss: 0.3140 Acc: 0.9633
[I 2024-10-15 15:44:00,581] Trial 80 finished with value: 0.8046875 and parameters: {'batch_size': 89, 'lr': 3.989043536156766e-05, 'num_epochs': 76, 'weight_decay': 0.102468307205012, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 3.1785 Acc: 0.8047
Best val Acc: 0.804688
Model weights saved at ./model_weights/ResNet34_bs_89_lr_3.989043536156766e-05_epoch_76_wd_0.102468307205012_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/59
----------
train Loss: 4.5993 Acc: 0.2287
val Loss: 4.2326 Acc: 0.3125
Epoch 2/59
----------
train Loss: 3.8790 Acc: 0.4942
val Loss: 3.5275 Acc: 0.5234
Epoch 3/59
----------
train Loss: 3.3721 Acc: 0.6528
val Loss: 3.0444 Acc: 0.6641
Epoch 4/59
----------
train Loss: 2.8956 Acc: 0.7429
val Loss: 2.7139 Acc: 0.7109
Epoch 5/59
----------
train Loss: 2.6611 Acc: 0.7479
val Loss: 2.4509 Acc: 0.7656
Epoch 6/59
----------
train Loss: 2.4469 Acc: 0.7596
val Loss: 2.2666 Acc: 0.7656
Epoch 7/59
----------
train Loss: 2.1332 Acc: 0.7997
val Loss: 2.1137 Acc: 0.7734
Epoch 8/59
----------
train Loss: 1.9995 Acc: 0.8264
val Loss: 2.0121 Acc: 0.7812
Epoch 9/59
----------
train Loss: 1.8785 Acc: 0.8230
val Loss: 1.8784 Acc: 0.7891
Epoch 10/59
----------
train Loss: 1.7142 Acc: 0.8648
val Loss: 1.7819 Acc: 0.7969
Epoch 11/59
----------
train Loss: 1.8147 Acc: 0.8230
val Loss: 1.7202 Acc: 0.7969
Epoch 12/59
----------
train Loss: 1.7376 Acc: 0.7997
val Loss: 1.6948 Acc: 0.8047
Epoch 13/59
----------
train Loss: 1.5978 Acc: 0.8648
val Loss: 1.6561 Acc: 0.8047
Epoch 14/59
----------
train Loss: 1.6172 Acc: 0.8247
val Loss: 1.6059 Acc: 0.8125
Epoch 15/59
----------
train Loss: 1.5437 Acc: 0.8765
val Loss: 1.5684 Acc: 0.8125
Epoch 16/59
----------
train Loss: 1.5215 Acc: 0.8815
val Loss: 1.5814 Acc: 0.8125
Epoch 17/59
----------
train Loss: 1.5532 Acc: 0.8431
val Loss: 1.5393 Acc: 0.8125
Epoch 18/59
----------
train Loss: 1.4661 Acc: 0.8548
val Loss: 1.5212 Acc: 0.8047
Epoch 19/59
----------
train Loss: 1.3474 Acc: 0.8531
val Loss: 1.5153 Acc: 0.8125
Epoch 20/59
----------
train Loss: 1.6126 Acc: 0.8130
val Loss: 1.5117 Acc: 0.7891
Epoch 21/59
----------
train Loss: 1.4204 Acc: 0.8748
val Loss: 1.5398 Acc: 0.7969
Epoch 22/59
----------
train Loss: 1.6058 Acc: 0.7846
val Loss: 1.5827 Acc: 0.7812
Epoch 23/59
----------
train Loss: 1.3767 Acc: 0.8698
val Loss: 1.5449 Acc: 0.7891
Epoch 24/59
----------
train Loss: 1.2901 Acc: 0.8932
val Loss: 1.5378 Acc: 0.7969
Epoch 25/59
----------
train Loss: 1.5008 Acc: 0.8331
val Loss: 1.5264 Acc: 0.7812
Epoch 26/59
----------
train Loss: 1.2509 Acc: 0.9149
val Loss: 1.5489 Acc: 0.7734
Epoch 27/59
----------
train Loss: 1.4381 Acc: 0.9098
val Loss: 1.5266 Acc: 0.7812
Epoch 28/59
----------
train Loss: 1.3840 Acc: 0.8564
val Loss: 1.5247 Acc: 0.7891
Epoch 29/59
----------
train Loss: 1.3535 Acc: 0.8648
val Loss: 1.5584 Acc: 0.7891
Epoch 30/59
----------
train Loss: 1.3975 Acc: 0.8865
val Loss: 1.5657 Acc: 0.7812
Epoch 31/59
----------
train Loss: 1.0797 Acc: 0.9232
val Loss: 1.5610 Acc: 0.7812
Epoch 32/59
----------
train Loss: 1.1416 Acc: 0.9399
val Loss: 1.5291 Acc: 0.7891
Epoch 33/59
----------
train Loss: 1.1063 Acc: 0.9316
val Loss: 1.5083 Acc: 0.7812
Epoch 34/59
----------
train Loss: 1.3565 Acc: 0.8815
val Loss: 1.5293 Acc: 0.7891
Epoch 35/59
----------
train Loss: 1.3823 Acc: 0.8831
val Loss: 1.5469 Acc: 0.7812
Epoch 36/59
----------
train Loss: 1.3451 Acc: 0.9182
val Loss: 1.5519 Acc: 0.7734
Epoch 37/59
----------
train Loss: 1.2185 Acc: 0.9115
val Loss: 1.5792 Acc: 0.7969
Epoch 38/59
----------
train Loss: 1.1778 Acc: 0.9015
val Loss: 1.5979 Acc: 0.7891
Epoch 39/59
----------
train Loss: 1.2617 Acc: 0.9149
val Loss: 1.6030 Acc: 0.7656
Epoch 40/59
----------
train Loss: 1.1864 Acc: 0.9165
val Loss: 1.5623 Acc: 0.7891
Epoch 41/59
----------
train Loss: 1.2014 Acc: 0.9332
val Loss: 1.5303 Acc: 0.7734
Epoch 42/59
----------
train Loss: 1.0498 Acc: 0.9750
val Loss: 1.5494 Acc: 0.8047
Epoch 43/59
----------
train Loss: 1.2387 Acc: 0.8731
val Loss: 1.5412 Acc: 0.7891
Epoch 44/59
----------
train Loss: 1.3063 Acc: 0.8948
val Loss: 1.5267 Acc: 0.7891
Epoch 45/59
----------
train Loss: 1.2299 Acc: 0.9149
val Loss: 1.5581 Acc: 0.8047
Epoch 46/59
----------
train Loss: 1.1310 Acc: 0.9349
val Loss: 1.5693 Acc: 0.8047
Epoch 47/59
----------
train Loss: 1.2414 Acc: 0.9032
val Loss: 1.5964 Acc: 0.7969
Epoch 48/59
----------
train Loss: 1.2538 Acc: 0.9048
val Loss: 1.5719 Acc: 0.7812
Epoch 49/59
----------
train Loss: 1.1782 Acc: 0.9332
val Loss: 1.5722 Acc: 0.7812
Epoch 50/59
----------
train Loss: 1.3460 Acc: 0.8648
val Loss: 1.5724 Acc: 0.7891
Epoch 51/59
----------
train Loss: 1.1770 Acc: 0.9082
val Loss: 1.5697 Acc: 0.7891
Epoch 52/59
----------
train Loss: 1.2343 Acc: 0.9132
val Loss: 1.5981 Acc: 0.7891
Epoch 53/59
----------
train Loss: 1.2022 Acc: 0.9098
val Loss: 1.6176 Acc: 0.7812
Epoch 54/59
----------
train Loss: 1.1278 Acc: 0.9182
val Loss: 1.6036 Acc: 0.7891
Epoch 55/59
----------
train Loss: 1.1177 Acc: 0.9449
val Loss: 1.5838 Acc: 0.7969
Epoch 56/59
----------
train Loss: 1.1391 Acc: 0.9349
val Loss: 1.6039 Acc: 0.7891
Epoch 57/59
----------
train Loss: 1.1062 Acc: 0.9516
val Loss: 1.6100 Acc: 0.7969
Epoch 58/59
----------
train Loss: 1.1557 Acc: 0.9232
val Loss: 1.6229 Acc: 0.7891
Epoch 59/59
----------
train Loss: 1.0159 Acc: 0.9533
[I 2024-10-15 15:48:26,372] Trial 81 finished with value: 0.796875 and parameters: {'batch_size': 94, 'lr': 1.0970461078756406e-05, 'num_epochs': 59, 'weight_decay': 0.039871160652693756, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.6159 Acc: 0.7969
Best val Acc: 0.796875
Model weights saved at ./model_weights/ResNet34_bs_94_lr_1.0970461078756406e-05_epoch_59_wd_0.039871160652693756_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/54
----------
train Loss: 6.0474 Acc: 0.3372
val Loss: 5.7176 Acc: 0.3984
Epoch 2/54
----------
train Loss: 5.5760 Acc: 0.4624
val Loss: 5.3241 Acc: 0.5625
Epoch 3/54
----------
train Loss: 5.2029 Acc: 0.5492
val Loss: 4.8893 Acc: 0.6094
Epoch 4/54
----------
train Loss: 4.8400 Acc: 0.6277
val Loss: 4.5995 Acc: 0.6719
Epoch 5/54
----------
train Loss: 4.5353 Acc: 0.6511
val Loss: 4.2486 Acc: 0.7422
Epoch 6/54
----------
train Loss: 4.2415 Acc: 0.6811
val Loss: 4.0243 Acc: 0.7578
Epoch 7/54
----------
train Loss: 3.9141 Acc: 0.7362
val Loss: 3.6913 Acc: 0.7734
Epoch 8/54
----------
train Loss: 3.6424 Acc: 0.7229
val Loss: 3.5696 Acc: 0.7812
Epoch 9/54
----------
train Loss: 3.4743 Acc: 0.7028
val Loss: 3.3365 Acc: 0.7969
Epoch 10/54
----------
train Loss: 3.2754 Acc: 0.7329
val Loss: 3.1131 Acc: 0.8047
Epoch 11/54
----------
train Loss: 3.0888 Acc: 0.7329
val Loss: 2.9390 Acc: 0.7891
Epoch 12/54
----------
train Loss: 2.8649 Acc: 0.7863
val Loss: 2.7654 Acc: 0.7891
Epoch 13/54
----------
train Loss: 2.8821 Acc: 0.7179
val Loss: 2.6084 Acc: 0.7812
Epoch 14/54
----------
train Loss: 2.6464 Acc: 0.7730
val Loss: 2.5427 Acc: 0.7734
Epoch 15/54
----------
train Loss: 2.5499 Acc: 0.7796
val Loss: 2.4312 Acc: 0.7734
Epoch 16/54
----------
train Loss: 2.4644 Acc: 0.7830
val Loss: 2.2989 Acc: 0.7656
Epoch 17/54
----------
train Loss: 2.4263 Acc: 0.7646
val Loss: 2.2618 Acc: 0.7812
Epoch 18/54
----------
train Loss: 2.3948 Acc: 0.7529
val Loss: 2.1954 Acc: 0.7656
Epoch 19/54
----------
train Loss: 2.2756 Acc: 0.7629
val Loss: 2.1364 Acc: 0.7656
Epoch 20/54
----------
train Loss: 2.1954 Acc: 0.8030
val Loss: 2.0783 Acc: 0.7812
Epoch 21/54
----------
train Loss: 2.1058 Acc: 0.8080
val Loss: 1.9984 Acc: 0.7812
Epoch 22/54
----------
train Loss: 2.0771 Acc: 0.8197
val Loss: 1.9362 Acc: 0.7812
Epoch 23/54
----------
train Loss: 2.0653 Acc: 0.7813
val Loss: 1.8671 Acc: 0.7891
Epoch 24/54
----------
train Loss: 2.1051 Acc: 0.7930
val Loss: 1.7978 Acc: 0.7734
Epoch 25/54
----------
train Loss: 1.8913 Acc: 0.8381
val Loss: 1.8010 Acc: 0.7891
Epoch 26/54
----------
train Loss: 1.9951 Acc: 0.8063
val Loss: 1.7600 Acc: 0.7891
Epoch 27/54
----------
train Loss: 1.9974 Acc: 0.8080
val Loss: 1.7078 Acc: 0.7969
Epoch 28/54
----------
train Loss: 1.9517 Acc: 0.7713
val Loss: 1.7098 Acc: 0.7891
Epoch 29/54
----------
train Loss: 1.8101 Acc: 0.8130
val Loss: 1.6831 Acc: 0.7969
Epoch 30/54
----------
train Loss: 1.8239 Acc: 0.8548
val Loss: 1.6600 Acc: 0.7969
Epoch 31/54
----------
train Loss: 1.9021 Acc: 0.8264
val Loss: 1.6401 Acc: 0.7891
Epoch 32/54
----------
train Loss: 1.8847 Acc: 0.8063
val Loss: 1.5841 Acc: 0.7969
Epoch 33/54
----------
train Loss: 1.7980 Acc: 0.8364
val Loss: 1.5953 Acc: 0.7891
Epoch 34/54
----------
train Loss: 1.7870 Acc: 0.8230
val Loss: 1.5821 Acc: 0.7891
Epoch 35/54
----------
train Loss: 1.5958 Acc: 0.8715
val Loss: 1.5435 Acc: 0.7969
Epoch 36/54
----------
train Loss: 1.5657 Acc: 0.8982
val Loss: 1.5118 Acc: 0.7969
Epoch 37/54
----------
train Loss: 1.6499 Acc: 0.8748
val Loss: 1.4970 Acc: 0.8125
Epoch 38/54
----------
train Loss: 1.7305 Acc: 0.8514
val Loss: 1.4846 Acc: 0.8047
Epoch 39/54
----------
train Loss: 1.7156 Acc: 0.7913
val Loss: 1.4963 Acc: 0.7891
Epoch 40/54
----------
train Loss: 1.5896 Acc: 0.8581
val Loss: 1.4658 Acc: 0.7812
Epoch 41/54
----------
train Loss: 1.7463 Acc: 0.8197
val Loss: 1.4531 Acc: 0.7734
Epoch 42/54
----------
train Loss: 1.4910 Acc: 0.9032
val Loss: 1.4551 Acc: 0.7812
Epoch 43/54
----------
train Loss: 1.4239 Acc: 0.9098
val Loss: 1.4429 Acc: 0.7812
Epoch 44/54
----------
train Loss: 1.5149 Acc: 0.9199
val Loss: 1.4529 Acc: 0.7891
Epoch 45/54
----------
train Loss: 1.5449 Acc: 0.8631
val Loss: 1.4613 Acc: 0.7891
Epoch 46/54
----------
train Loss: 1.4729 Acc: 0.9032
val Loss: 1.4681 Acc: 0.7812
Epoch 47/54
----------
train Loss: 1.4510 Acc: 0.8748
val Loss: 1.4567 Acc: 0.7812
Epoch 48/54
----------
train Loss: 1.5995 Acc: 0.8447
val Loss: 1.4211 Acc: 0.7812
Epoch 49/54
----------
train Loss: 1.5648 Acc: 0.8631
val Loss: 1.4214 Acc: 0.7891
Epoch 50/54
----------
train Loss: 1.5098 Acc: 0.8548
val Loss: 1.4078 Acc: 0.7812
Epoch 51/54
----------
train Loss: 1.5263 Acc: 0.9165
val Loss: 1.4166 Acc: 0.7734
Epoch 52/54
----------
train Loss: 1.4151 Acc: 0.8698
val Loss: 1.4175 Acc: 0.7891
Epoch 53/54
----------
train Loss: 1.3329 Acc: 0.8998
val Loss: 1.4148 Acc: 0.7891
Epoch 54/54
----------
train Loss: 1.4152 Acc: 0.8731
[I 2024-10-15 15:52:29,946] Trial 82 finished with value: 0.7734375 and parameters: {'batch_size': 81, 'lr': 4.505628219934165e-06, 'num_epochs': 54, 'weight_decay': 0.04370090801513239, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.4477 Acc: 0.7734
Best val Acc: 0.773438
Model weights saved at ./model_weights/ResNet34_bs_81_lr_4.505628219934165e-06_epoch_54_wd_0.04370090801513239_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/61
----------
train Loss: 3.0483 Acc: 0.5943
val Loss: 1.9818 Acc: 0.7188
Epoch 2/61
----------
train Loss: 1.9241 Acc: 0.7629
val Loss: 1.5643 Acc: 0.7656
Epoch 3/61
----------
train Loss: 1.5204 Acc: 0.8447
val Loss: 1.4229 Acc: 0.8203
Epoch 4/61
----------
train Loss: 1.2927 Acc: 0.8664
val Loss: 1.3613 Acc: 0.8125
Epoch 5/61
----------
train Loss: 1.0510 Acc: 0.9098
val Loss: 1.3390 Acc: 0.8047
Epoch 6/61
----------
train Loss: 1.1848 Acc: 0.8982
val Loss: 1.3804 Acc: 0.7969
Epoch 7/61
----------
train Loss: 1.2734 Acc: 0.9065
val Loss: 1.3757 Acc: 0.8047
Epoch 8/61
----------
train Loss: 1.3402 Acc: 0.9098
val Loss: 1.2032 Acc: 0.8438
Epoch 9/61
----------
train Loss: 1.3920 Acc: 0.8664
val Loss: 1.3044 Acc: 0.8125
Epoch 10/61
----------
train Loss: 1.2355 Acc: 0.9098
val Loss: 1.1939 Acc: 0.8516
Epoch 11/61
----------
train Loss: 1.3347 Acc: 0.8648
val Loss: 1.1907 Acc: 0.7969
Epoch 12/61
----------
train Loss: 1.1734 Acc: 0.9015
val Loss: 1.3395 Acc: 0.8047
Epoch 13/61
----------
train Loss: 1.0612 Acc: 0.9399
val Loss: 1.4291 Acc: 0.8203
Epoch 14/61
----------
train Loss: 1.2151 Acc: 0.8982
val Loss: 1.2408 Acc: 0.7969
Epoch 15/61
----------
train Loss: 1.1184 Acc: 0.9299
val Loss: 1.4801 Acc: 0.7891
Epoch 16/61
----------
train Loss: 1.2380 Acc: 0.9065
val Loss: 1.3254 Acc: 0.8203
Epoch 17/61
----------
train Loss: 1.1224 Acc: 0.9382
val Loss: 1.2642 Acc: 0.8125
Epoch 18/61
----------
train Loss: 1.1475 Acc: 0.9199
val Loss: 1.3909 Acc: 0.7891
Epoch 19/61
----------
train Loss: 1.1513 Acc: 0.9215
val Loss: 1.4707 Acc: 0.7891
Epoch 20/61
----------
train Loss: 1.2612 Acc: 0.9149
val Loss: 1.3994 Acc: 0.7969
Epoch 21/61
----------
train Loss: 1.0702 Acc: 0.9065
val Loss: 1.6855 Acc: 0.7812
Epoch 22/61
----------
train Loss: 1.2680 Acc: 0.9416
val Loss: 1.3150 Acc: 0.8203
Epoch 23/61
----------
train Loss: 1.1139 Acc: 0.9432
val Loss: 1.3787 Acc: 0.8203
Epoch 24/61
----------
train Loss: 1.1570 Acc: 0.8898
val Loss: 1.2137 Acc: 0.8125
Epoch 25/61
----------
train Loss: 1.2608 Acc: 0.8965
val Loss: 1.2539 Acc: 0.8125
Epoch 26/61
----------
train Loss: 1.2547 Acc: 0.9082
val Loss: 1.2143 Acc: 0.7969
Epoch 27/61
----------
train Loss: 1.2359 Acc: 0.9082
val Loss: 1.2820 Acc: 0.8125
Epoch 28/61
----------
train Loss: 0.8777 Acc: 0.9833
val Loss: 1.4039 Acc: 0.8125
Epoch 29/61
----------
train Loss: 1.1997 Acc: 0.9149
val Loss: 1.2912 Acc: 0.8203
Epoch 30/61
----------
train Loss: 1.1442 Acc: 0.9449
val Loss: 1.3600 Acc: 0.8125
Epoch 31/61
----------
train Loss: 1.1096 Acc: 0.9065
val Loss: 1.4046 Acc: 0.7891
Epoch 32/61
----------
train Loss: 1.1946 Acc: 0.9182
val Loss: 1.3411 Acc: 0.8047
Epoch 33/61
----------
train Loss: 1.2487 Acc: 0.8881
val Loss: 1.2724 Acc: 0.8438
Epoch 34/61
----------
train Loss: 1.0288 Acc: 0.9232
val Loss: 1.6075 Acc: 0.7969
Epoch 35/61
----------
train Loss: 1.1235 Acc: 0.9249
val Loss: 1.4467 Acc: 0.7734
Epoch 36/61
----------
train Loss: 1.0510 Acc: 0.9349
val Loss: 1.4613 Acc: 0.7891
Epoch 37/61
----------
train Loss: 1.1184 Acc: 0.9432
val Loss: 1.3035 Acc: 0.7969
Epoch 38/61
----------
train Loss: 1.1201 Acc: 0.9182
val Loss: 1.2716 Acc: 0.8047
Epoch 39/61
----------
train Loss: 1.0024 Acc: 0.9149
val Loss: 1.4206 Acc: 0.7656
Epoch 40/61
----------
train Loss: 1.0983 Acc: 0.9098
val Loss: 1.5263 Acc: 0.7812
Epoch 41/61
----------
train Loss: 1.1428 Acc: 0.9299
val Loss: 1.5283 Acc: 0.7734
Epoch 42/61
----------
train Loss: 1.0361 Acc: 0.8798
val Loss: 1.5543 Acc: 0.7812
Epoch 43/61
----------
train Loss: 1.1655 Acc: 0.8998
val Loss: 1.3066 Acc: 0.8359
Epoch 44/61
----------
train Loss: 1.0831 Acc: 0.9499
val Loss: 1.2094 Acc: 0.8047
Epoch 45/61
----------
train Loss: 1.1314 Acc: 0.9199
val Loss: 1.2109 Acc: 0.8203
Epoch 46/61
----------
train Loss: 1.1524 Acc: 0.9149
val Loss: 1.2850 Acc: 0.7812
Epoch 47/61
----------
train Loss: 1.0372 Acc: 0.9533
val Loss: 1.5487 Acc: 0.7344
Epoch 48/61
----------
train Loss: 1.0158 Acc: 0.9699
val Loss: 1.2658 Acc: 0.7812
Epoch 49/61
----------
train Loss: 0.9945 Acc: 0.9332
val Loss: 1.5302 Acc: 0.7578
Epoch 50/61
----------
train Loss: 1.0639 Acc: 0.9499
val Loss: 1.5030 Acc: 0.7656
Epoch 51/61
----------
train Loss: 0.9613 Acc: 0.9666
val Loss: 1.3561 Acc: 0.8125
Epoch 52/61
----------
train Loss: 0.9255 Acc: 0.9499
val Loss: 1.2527 Acc: 0.7891
Epoch 53/61
----------
train Loss: 1.1030 Acc: 0.8915
val Loss: 1.2770 Acc: 0.7891
Epoch 54/61
----------
train Loss: 1.0483 Acc: 0.9683
val Loss: 1.3814 Acc: 0.7969
Epoch 55/61
----------
train Loss: 1.0828 Acc: 0.9382
val Loss: 1.2492 Acc: 0.8047
Epoch 56/61
----------
train Loss: 1.0072 Acc: 0.9149
val Loss: 1.4003 Acc: 0.7734
Epoch 57/61
----------
train Loss: 1.0062 Acc: 0.9098
val Loss: 1.3709 Acc: 0.8125
Epoch 58/61
----------
train Loss: 1.0695 Acc: 0.9332
val Loss: 1.6510 Acc: 0.7109
Epoch 59/61
----------
train Loss: 0.9885 Acc: 0.9533
val Loss: 1.3929 Acc: 0.8047
Epoch 60/61
----------
train Loss: 1.0252 Acc: 0.9750
val Loss: 1.3890 Acc: 0.7969
Epoch 61/61
----------
train Loss: 1.0961 Acc: 0.9299
[I 2024-10-15 15:57:03,382] Trial 83 finished with value: 0.859375 and parameters: {'batch_size': 78, 'lr': 7.376216530376737e-05, 'num_epochs': 61, 'weight_decay': 0.006245791970417597, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.3150 Acc: 0.8594
Best val Acc: 0.859375
Model weights saved at ./model_weights/ResNet34_bs_78_lr_7.376216530376737e-05_epoch_61_wd_0.006245791970417597_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/58
----------
train Loss: 5.1084 Acc: 0.2771
val Loss: 4.0228 Acc: 0.5469
Epoch 2/58
----------
train Loss: 3.8030 Acc: 0.6110
val Loss: 3.1323 Acc: 0.7344
Epoch 3/58
----------
train Loss: 3.0001 Acc: 0.7195
val Loss: 2.4743 Acc: 0.7578
Epoch 4/58
----------
train Loss: 2.5428 Acc: 0.7446
val Loss: 2.1806 Acc: 0.7500
Epoch 5/58
----------
train Loss: 2.2337 Acc: 0.7730
val Loss: 1.9635 Acc: 0.7734
Epoch 6/58
----------
train Loss: 2.0098 Acc: 0.8047
val Loss: 1.7394 Acc: 0.7422
Epoch 7/58
----------
train Loss: 1.9055 Acc: 0.8180
val Loss: 1.6483 Acc: 0.7656
Epoch 8/58
----------
train Loss: 1.8400 Acc: 0.8197
val Loss: 1.6044 Acc: 0.7656
Epoch 9/58
----------
train Loss: 1.7488 Acc: 0.8197
val Loss: 1.5027 Acc: 0.7891
Epoch 10/58
----------
train Loss: 1.8011 Acc: 0.7947
val Loss: 1.4619 Acc: 0.7891
Epoch 11/58
----------
train Loss: 1.6490 Acc: 0.8581
val Loss: 1.5039 Acc: 0.7812
Epoch 12/58
----------
train Loss: 1.5377 Acc: 0.8765
val Loss: 1.4915 Acc: 0.7734
Epoch 13/58
----------
train Loss: 1.4373 Acc: 0.9182
val Loss: 1.4792 Acc: 0.7891
Epoch 14/58
----------
train Loss: 1.5509 Acc: 0.8180
val Loss: 1.4730 Acc: 0.7656
Epoch 15/58
----------
train Loss: 1.6129 Acc: 0.8681
val Loss: 1.4961 Acc: 0.7891
Epoch 16/58
----------
train Loss: 1.5582 Acc: 0.8581
val Loss: 1.5067 Acc: 0.7734
Epoch 17/58
----------
train Loss: 1.5143 Acc: 0.8598
val Loss: 1.4624 Acc: 0.7891
Epoch 18/58
----------
train Loss: 1.4612 Acc: 0.8831
val Loss: 1.3607 Acc: 0.8203
Epoch 19/58
----------
train Loss: 1.4770 Acc: 0.8881
val Loss: 1.3347 Acc: 0.8125
Epoch 20/58
----------
train Loss: 1.5089 Acc: 0.8865
val Loss: 1.3411 Acc: 0.7969
Epoch 21/58
----------
train Loss: 1.4291 Acc: 0.9115
val Loss: 1.3705 Acc: 0.7969
Epoch 22/58
----------
train Loss: 1.3872 Acc: 0.8664
val Loss: 1.4425 Acc: 0.8047
Epoch 23/58
----------
train Loss: 1.2997 Acc: 0.8998
val Loss: 1.3864 Acc: 0.7969
Epoch 24/58
----------
train Loss: 1.2623 Acc: 0.8965
val Loss: 1.3446 Acc: 0.8281
Epoch 25/58
----------
train Loss: 1.4469 Acc: 0.8915
val Loss: 1.3111 Acc: 0.8125
Epoch 26/58
----------
train Loss: 1.3588 Acc: 0.8965
val Loss: 1.3254 Acc: 0.8125
Epoch 27/58
----------
train Loss: 1.3298 Acc: 0.9199
val Loss: 1.3865 Acc: 0.7969
Epoch 28/58
----------
train Loss: 1.2167 Acc: 0.9249
val Loss: 1.3327 Acc: 0.8047
Epoch 29/58
----------
train Loss: 1.3179 Acc: 0.8881
val Loss: 1.2779 Acc: 0.8281
Epoch 30/58
----------
train Loss: 1.3049 Acc: 0.9265
val Loss: 1.2396 Acc: 0.8281
Epoch 31/58
----------
train Loss: 1.2619 Acc: 0.9032
val Loss: 1.3196 Acc: 0.8047
Epoch 32/58
----------
train Loss: 1.5577 Acc: 0.8130
val Loss: 1.3093 Acc: 0.8281
Epoch 33/58
----------
train Loss: 1.1521 Acc: 0.9132
val Loss: 1.2908 Acc: 0.8281
Epoch 34/58
----------
train Loss: 1.2571 Acc: 0.8982
val Loss: 1.3121 Acc: 0.8281
Epoch 35/58
----------
train Loss: 1.3803 Acc: 0.8982
val Loss: 1.2843 Acc: 0.8281
Epoch 36/58
----------
train Loss: 1.2908 Acc: 0.9115
val Loss: 1.3287 Acc: 0.8047
Epoch 37/58
----------
train Loss: 1.3175 Acc: 0.8614
val Loss: 1.2712 Acc: 0.8438
Epoch 38/58
----------
train Loss: 1.2476 Acc: 0.9349
val Loss: 1.2518 Acc: 0.8594
Epoch 39/58
----------
train Loss: 1.1553 Acc: 0.9199
val Loss: 1.2138 Acc: 0.8281
Epoch 40/58
----------
train Loss: 1.0649 Acc: 0.9816
val Loss: 1.2529 Acc: 0.8438
Epoch 41/58
----------
train Loss: 1.3087 Acc: 0.9215
val Loss: 1.3866 Acc: 0.8438
Epoch 42/58
----------
train Loss: 1.3133 Acc: 0.8965
val Loss: 1.3860 Acc: 0.8125
Epoch 43/58
----------
train Loss: 1.2059 Acc: 0.9098
val Loss: 1.2536 Acc: 0.8359
Epoch 44/58
----------
train Loss: 1.1607 Acc: 0.9482
val Loss: 1.3064 Acc: 0.8125
Epoch 45/58
----------
train Loss: 1.1659 Acc: 0.9265
val Loss: 1.2581 Acc: 0.8438
Epoch 46/58
----------
train Loss: 1.0504 Acc: 0.9466
val Loss: 1.3334 Acc: 0.8047
Epoch 47/58
----------
train Loss: 1.1812 Acc: 0.9299
val Loss: 1.2959 Acc: 0.8047
Epoch 48/58
----------
train Loss: 1.2934 Acc: 0.9032
val Loss: 1.3110 Acc: 0.8047
Epoch 49/58
----------
train Loss: 1.1857 Acc: 0.9032
val Loss: 1.3148 Acc: 0.8125
Epoch 50/58
----------
train Loss: 1.0060 Acc: 0.9716
val Loss: 1.3320 Acc: 0.8281
Epoch 51/58
----------
train Loss: 1.3997 Acc: 0.8915
val Loss: 1.2656 Acc: 0.8359
Epoch 52/58
----------
train Loss: 1.0855 Acc: 0.9132
val Loss: 1.1470 Acc: 0.8281
Epoch 53/58
----------
train Loss: 1.0761 Acc: 0.9683
val Loss: 1.2465 Acc: 0.8203
Epoch 54/58
----------
train Loss: 1.1724 Acc: 0.9098
val Loss: 1.3444 Acc: 0.8047
Epoch 55/58
----------
train Loss: 1.2811 Acc: 0.8815
val Loss: 1.2847 Acc: 0.8203
Epoch 56/58
----------
train Loss: 1.0599 Acc: 0.9299
val Loss: 1.2827 Acc: 0.8125
Epoch 57/58
----------
train Loss: 1.1219 Acc: 0.9249
val Loss: 1.3129 Acc: 0.7812
Epoch 58/58
----------
train Loss: 1.0718 Acc: 0.9366
[I 2024-10-15 16:01:22,759] Trial 84 finished with value: 0.828125 and parameters: {'batch_size': 71, 'lr': 2.349064164413384e-05, 'num_epochs': 58, 'weight_decay': 0.06755197949961256, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.3261 Acc: 0.8281
Best val Acc: 0.828125
Model weights saved at ./model_weights/ResNet34_bs_71_lr_2.349064164413384e-05_epoch_58_wd_0.06755197949961256_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/49
----------
train Loss: 4.5117 Acc: 0.5960
val Loss: 4.0238 Acc: 0.6797
Epoch 2/49
----------
train Loss: 3.6767 Acc: 0.6828
val Loss: 3.1849 Acc: 0.7109
Epoch 3/49
----------
train Loss: 3.0982 Acc: 0.7045
val Loss: 2.7184 Acc: 0.7266
Epoch 4/49
----------
train Loss: 2.6803 Acc: 0.7346
val Loss: 2.3757 Acc: 0.7266
Epoch 5/49
----------
train Loss: 2.4261 Acc: 0.7145
val Loss: 2.0863 Acc: 0.7656
Epoch 6/49
----------
train Loss: 2.2536 Acc: 0.7529
val Loss: 1.9008 Acc: 0.7969
Epoch 7/49
----------
train Loss: 2.0173 Acc: 0.7796
val Loss: 1.7609 Acc: 0.7969
Epoch 8/49
----------
train Loss: 1.9609 Acc: 0.7730
val Loss: 1.6095 Acc: 0.8047
Epoch 9/49
----------
train Loss: 1.9047 Acc: 0.8197
val Loss: 1.5360 Acc: 0.8125
Epoch 10/49
----------
train Loss: 1.7408 Acc: 0.8214
val Loss: 1.4573 Acc: 0.7812
Epoch 11/49
----------
train Loss: 1.6989 Acc: 0.8397
val Loss: 1.3968 Acc: 0.7891
Epoch 12/49
----------
train Loss: 1.6506 Acc: 0.8097
val Loss: 1.3377 Acc: 0.8203
Epoch 13/49
----------
train Loss: 1.5140 Acc: 0.8548
val Loss: 1.2707 Acc: 0.8359
Epoch 14/49
----------
train Loss: 1.5428 Acc: 0.8364
val Loss: 1.2321 Acc: 0.8359
Epoch 15/49
----------
train Loss: 1.4580 Acc: 0.8631
val Loss: 1.2436 Acc: 0.8203
Epoch 16/49
----------
train Loss: 1.4423 Acc: 0.8898
val Loss: 1.2670 Acc: 0.8047
Epoch 17/49
----------
train Loss: 1.2492 Acc: 0.9399
val Loss: 1.2264 Acc: 0.8047
Epoch 18/49
----------
train Loss: 1.3822 Acc: 0.8781
val Loss: 1.2092 Acc: 0.8203
Epoch 19/49
----------
train Loss: 1.1781 Acc: 0.9533
val Loss: 1.1881 Acc: 0.8438
Epoch 20/49
----------
train Loss: 1.3047 Acc: 0.8881
val Loss: 1.1511 Acc: 0.8516
Epoch 21/49
----------
train Loss: 1.2571 Acc: 0.9265
val Loss: 1.1883 Acc: 0.8203
Epoch 22/49
----------
train Loss: 1.4836 Acc: 0.8598
val Loss: 1.2058 Acc: 0.8359
Epoch 23/49
----------
train Loss: 1.4575 Acc: 0.8464
val Loss: 1.1703 Acc: 0.8281
Epoch 24/49
----------
train Loss: 1.3946 Acc: 0.8915
val Loss: 1.1936 Acc: 0.8438
Epoch 25/49
----------
train Loss: 1.2427 Acc: 0.9182
val Loss: 1.1745 Acc: 0.8281
Epoch 26/49
----------
train Loss: 1.2066 Acc: 0.9098
val Loss: 1.1417 Acc: 0.8359
Epoch 27/49
----------
train Loss: 1.3352 Acc: 0.9416
val Loss: 1.1984 Acc: 0.8281
Epoch 28/49
----------
train Loss: 1.3792 Acc: 0.9316
val Loss: 1.1451 Acc: 0.8359
Epoch 29/49
----------
train Loss: 1.2195 Acc: 0.9232
val Loss: 1.1604 Acc: 0.8516
Epoch 30/49
----------
train Loss: 1.2805 Acc: 0.9065
val Loss: 1.1688 Acc: 0.8672
Epoch 31/49
----------
train Loss: 1.4497 Acc: 0.8681
val Loss: 1.2158 Acc: 0.8359
Epoch 32/49
----------
train Loss: 1.3890 Acc: 0.8881
val Loss: 1.1494 Acc: 0.8594
Epoch 33/49
----------
train Loss: 1.2071 Acc: 0.9249
val Loss: 1.1746 Acc: 0.8594
Epoch 34/49
----------
train Loss: 1.2610 Acc: 0.8948
val Loss: 1.1225 Acc: 0.8438
Epoch 35/49
----------
train Loss: 1.1543 Acc: 0.8998
val Loss: 1.1750 Acc: 0.8281
Epoch 36/49
----------
train Loss: 1.3094 Acc: 0.9349
val Loss: 1.1944 Acc: 0.8281
Epoch 37/49
----------
train Loss: 1.4116 Acc: 0.8698
val Loss: 1.1882 Acc: 0.8359
Epoch 38/49
----------
train Loss: 1.3428 Acc: 0.9115
val Loss: 1.1654 Acc: 0.8438
Epoch 39/49
----------
train Loss: 1.2527 Acc: 0.9015
val Loss: 1.1785 Acc: 0.8281
Epoch 40/49
----------
train Loss: 1.2185 Acc: 0.9449
val Loss: 1.1860 Acc: 0.8438
Epoch 41/49
----------
train Loss: 1.4239 Acc: 0.8497
val Loss: 1.1269 Acc: 0.8438
Epoch 42/49
----------
train Loss: 1.2403 Acc: 0.9098
val Loss: 1.1466 Acc: 0.8438
Epoch 43/49
----------
train Loss: 1.1549 Acc: 0.9399
val Loss: 1.1302 Acc: 0.8281
Epoch 44/49
----------
train Loss: 1.1337 Acc: 0.9366
val Loss: 1.1150 Acc: 0.8438
Epoch 45/49
----------
train Loss: 1.0496 Acc: 0.9466
val Loss: 1.1359 Acc: 0.8281
Epoch 46/49
----------
train Loss: 1.1842 Acc: 0.9299
val Loss: 1.1457 Acc: 0.8281
Epoch 47/49
----------
train Loss: 1.1782 Acc: 0.9282
val Loss: 1.0894 Acc: 0.8516
Epoch 48/49
----------
train Loss: 1.1079 Acc: 0.9282
val Loss: 1.1607 Acc: 0.8359
Epoch 49/49
----------
train Loss: 1.0685 Acc: 0.9316
[I 2024-10-15 16:05:06,202] Trial 85 finished with value: 0.859375 and parameters: {'batch_size': 119, 'lr': 1.3580410121589815e-05, 'num_epochs': 49, 'weight_decay': 0.01621908530485859, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.0999 Acc: 0.8594
Best val Acc: 0.859375
Model weights saved at ./model_weights/ResNet34_bs_119_lr_1.3580410121589815e-05_epoch_49_wd_0.01621908530485859_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/52
----------
train Loss: 0.6750 Acc: 0.5743
val Loss: 0.6330 Acc: 0.5781
Epoch 2/52
----------
train Loss: 0.6006 Acc: 0.6828
val Loss: 0.5656 Acc: 0.6328
Epoch 3/52
----------
train Loss: 0.5448 Acc: 0.6845
val Loss: 0.5165 Acc: 0.6797
Epoch 4/52
----------
train Loss: 0.4996 Acc: 0.7062
val Loss: 0.4777 Acc: 0.6953
Epoch 5/52
----------
train Loss: 0.4528 Acc: 0.7379
val Loss: 0.4411 Acc: 0.7031
Epoch 6/52
----------
train Loss: 0.4250 Acc: 0.7396
val Loss: 0.4067 Acc: 0.6953
Epoch 7/52
----------
train Loss: 0.4068 Acc: 0.7629
val Loss: 0.3824 Acc: 0.7109
Epoch 8/52
----------
train Loss: 0.3781 Acc: 0.7646
val Loss: 0.3630 Acc: 0.6953
Epoch 9/52
----------
train Loss: 0.3615 Acc: 0.7763
val Loss: 0.3421 Acc: 0.7109
Epoch 10/52
----------
train Loss: 0.3398 Acc: 0.8080
val Loss: 0.3253 Acc: 0.7344
Epoch 11/52
----------
train Loss: 0.3119 Acc: 0.8297
val Loss: 0.3079 Acc: 0.7656
Epoch 12/52
----------
train Loss: 0.3088 Acc: 0.8364
val Loss: 0.3024 Acc: 0.8047
Epoch 13/52
----------
train Loss: 0.3111 Acc: 0.8598
val Loss: 0.2873 Acc: 0.8047
Epoch 14/52
----------
train Loss: 0.3096 Acc: 0.8397
val Loss: 0.2875 Acc: 0.7812
Epoch 15/52
----------
train Loss: 0.2977 Acc: 0.8331
val Loss: 0.2772 Acc: 0.8047
Epoch 16/52
----------
train Loss: 0.2686 Acc: 0.8715
val Loss: 0.2623 Acc: 0.8281
Epoch 17/52
----------
train Loss: 0.2896 Acc: 0.8247
val Loss: 0.2577 Acc: 0.8125
Epoch 18/52
----------
train Loss: 0.2568 Acc: 0.8731
val Loss: 0.2640 Acc: 0.8359
Epoch 19/52
----------
train Loss: 0.2488 Acc: 0.8898
val Loss: 0.2413 Acc: 0.8359
Epoch 20/52
----------
train Loss: 0.2326 Acc: 0.9215
val Loss: 0.2444 Acc: 0.8125
Epoch 21/52
----------
train Loss: 0.2638 Acc: 0.9182
val Loss: 0.2530 Acc: 0.8125
Epoch 22/52
----------
train Loss: 0.2473 Acc: 0.8915
val Loss: 0.2471 Acc: 0.8359
Epoch 23/52
----------
train Loss: 0.2620 Acc: 0.8698
val Loss: 0.2391 Acc: 0.8203
Epoch 24/52
----------
train Loss: 0.2320 Acc: 0.8932
val Loss: 0.2405 Acc: 0.8047
Epoch 25/52
----------
train Loss: 0.2233 Acc: 0.9382
val Loss: 0.2400 Acc: 0.8281
Epoch 26/52
----------
train Loss: 0.2653 Acc: 0.8765
val Loss: 0.2438 Acc: 0.8203
Epoch 27/52
----------
train Loss: 0.2069 Acc: 0.9199
val Loss: 0.2347 Acc: 0.8125
Epoch 28/52
----------
train Loss: 0.2328 Acc: 0.9299
val Loss: 0.2376 Acc: 0.8125
Epoch 29/52
----------
train Loss: 0.2129 Acc: 0.9015
val Loss: 0.2451 Acc: 0.7891
Epoch 30/52
----------
train Loss: 0.2520 Acc: 0.8631
val Loss: 0.2400 Acc: 0.8125
Epoch 31/52
----------
train Loss: 0.2317 Acc: 0.9115
val Loss: 0.2358 Acc: 0.8125
Epoch 32/52
----------
train Loss: 0.2151 Acc: 0.9048
val Loss: 0.2483 Acc: 0.7891
Epoch 33/52
----------
train Loss: 0.2235 Acc: 0.9149
val Loss: 0.2283 Acc: 0.8281
Epoch 34/52
----------
train Loss: 0.2036 Acc: 0.9432
val Loss: 0.2441 Acc: 0.8047
Epoch 35/52
----------
train Loss: 0.2254 Acc: 0.9149
val Loss: 0.2271 Acc: 0.8203
Epoch 36/52
----------
train Loss: 0.2052 Acc: 0.9366
val Loss: 0.2452 Acc: 0.7969
Epoch 37/52
----------
train Loss: 0.2423 Acc: 0.8932
val Loss: 0.2529 Acc: 0.7812
Epoch 38/52
----------
train Loss: 0.2155 Acc: 0.9282
val Loss: 0.2479 Acc: 0.7969
Epoch 39/52
----------
train Loss: 0.2193 Acc: 0.9416
val Loss: 0.2469 Acc: 0.7734
Epoch 40/52
----------
train Loss: 0.2021 Acc: 0.9182
val Loss: 0.2394 Acc: 0.8047
Epoch 41/52
----------
train Loss: 0.2277 Acc: 0.8648
val Loss: 0.2437 Acc: 0.8047
Epoch 42/52
----------
train Loss: 0.2040 Acc: 0.9165
val Loss: 0.2510 Acc: 0.7969
Epoch 43/52
----------
train Loss: 0.2212 Acc: 0.8898
val Loss: 0.2345 Acc: 0.7969
Epoch 44/52
----------
train Loss: 0.2498 Acc: 0.8831
val Loss: 0.2395 Acc: 0.7734
Epoch 45/52
----------
train Loss: 0.2261 Acc: 0.9065
val Loss: 0.2582 Acc: 0.7891
Epoch 46/52
----------
train Loss: 0.2494 Acc: 0.8681
val Loss: 0.2411 Acc: 0.7891
Epoch 47/52
----------
train Loss: 0.2350 Acc: 0.9015
val Loss: 0.2536 Acc: 0.7656
Epoch 48/52
----------
train Loss: 0.2301 Acc: 0.8982
val Loss: 0.2506 Acc: 0.8125
Epoch 49/52
----------
train Loss: 0.2332 Acc: 0.8998
val Loss: 0.2467 Acc: 0.7969
Epoch 50/52
----------
train Loss: 0.1921 Acc: 0.9432
val Loss: 0.2373 Acc: 0.8047
Epoch 51/52
----------
train Loss: 0.2089 Acc: 0.9416
val Loss: 0.2528 Acc: 0.7812
Epoch 52/52
----------
train Loss: 0.2137 Acc: 0.8881
[I 2024-10-15 16:09:00,278] Trial 86 finished with value: 0.8046875 and parameters: {'batch_size': 60, 'lr': 1.6549247871156286e-05, 'num_epochs': 52, 'weight_decay': 0.0324737641816028, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 0.2438 Acc: 0.8047
Best val Acc: 0.804688
Model weights saved at ./model_weights/ResNet34_bs_60_lr_1.6549247871156286e-05_epoch_52_wd_0.0324737641816028_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/63
----------
train Loss: 5.4465 Acc: 0.2705
val Loss: 5.2139 Acc: 0.3047
Epoch 2/63
----------
train Loss: 5.1003 Acc: 0.3306
val Loss: 5.1092 Acc: 0.3047
Epoch 3/63
----------
train Loss: 4.8465 Acc: 0.3890
val Loss: 4.9638 Acc: 0.3359
Epoch 4/63
----------
train Loss: 4.5181 Acc: 0.4524
val Loss: 4.8430 Acc: 0.3359
Epoch 5/63
----------
train Loss: 4.3280 Acc: 0.4741
val Loss: 4.7262 Acc: 0.3594
Epoch 6/63
----------
train Loss: 4.0788 Acc: 0.5075
val Loss: 4.6108 Acc: 0.3984
Epoch 7/63
----------
train Loss: 3.8677 Acc: 0.5509
val Loss: 4.4880 Acc: 0.3984
Epoch 8/63
----------
train Loss: 3.6708 Acc: 0.5893
val Loss: 4.3766 Acc: 0.4141
Epoch 9/63
----------
train Loss: 3.5204 Acc: 0.6244
val Loss: 4.2899 Acc: 0.4141
Epoch 10/63
----------
train Loss: 3.3221 Acc: 0.6394
val Loss: 4.1835 Acc: 0.4531
Epoch 11/63
----------
train Loss: 3.1601 Acc: 0.6511
val Loss: 4.1003 Acc: 0.4609
Epoch 12/63
----------
train Loss: 3.0171 Acc: 0.6912
val Loss: 3.9994 Acc: 0.4844
Epoch 13/63
----------
train Loss: 2.8467 Acc: 0.6878
val Loss: 3.9584 Acc: 0.4922
Epoch 14/63
----------
train Loss: 2.7631 Acc: 0.7212
val Loss: 3.8533 Acc: 0.5391
Epoch 15/63
----------
train Loss: 2.6714 Acc: 0.7179
val Loss: 3.8085 Acc: 0.5391
Epoch 16/63
----------
train Loss: 2.4672 Acc: 0.7579
val Loss: 3.7126 Acc: 0.6172
Epoch 17/63
----------
train Loss: 2.3618 Acc: 0.7679
val Loss: 3.6568 Acc: 0.6328
Epoch 18/63
----------
train Loss: 2.2537 Acc: 0.7880
val Loss: 3.5961 Acc: 0.6484
Epoch 19/63
----------
train Loss: 2.1762 Acc: 0.8180
val Loss: 3.5251 Acc: 0.6484
Epoch 20/63
----------
train Loss: 2.0427 Acc: 0.7980
val Loss: 3.4844 Acc: 0.6562
Epoch 21/63
----------
train Loss: 1.9938 Acc: 0.8114
val Loss: 3.4419 Acc: 0.6641
Epoch 22/63
----------
train Loss: 1.8678 Acc: 0.8297
val Loss: 3.3735 Acc: 0.6562
Epoch 23/63
----------
train Loss: 1.8927 Acc: 0.8214
val Loss: 3.3315 Acc: 0.6719
Epoch 24/63
----------
train Loss: 1.7289 Acc: 0.8431
val Loss: 3.2945 Acc: 0.6875
Epoch 25/63
----------
train Loss: 1.6888 Acc: 0.8397
val Loss: 3.2335 Acc: 0.7031
Epoch 26/63
----------
train Loss: 1.6014 Acc: 0.8564
val Loss: 3.1941 Acc: 0.7031
Epoch 27/63
----------
train Loss: 1.5555 Acc: 0.8681
val Loss: 3.1679 Acc: 0.7031
Epoch 28/63
----------
train Loss: 1.4252 Acc: 0.8765
val Loss: 3.1279 Acc: 0.7109
Epoch 29/63
----------
train Loss: 1.4770 Acc: 0.8798
val Loss: 3.0845 Acc: 0.7109
Epoch 30/63
----------
train Loss: 1.3671 Acc: 0.8848
val Loss: 3.0628 Acc: 0.7109
Epoch 31/63
----------
train Loss: 1.3612 Acc: 0.9048
val Loss: 3.0423 Acc: 0.7266
Epoch 32/63
----------
train Loss: 1.2675 Acc: 0.8915
val Loss: 3.0006 Acc: 0.7266
Epoch 33/63
----------
train Loss: 1.2491 Acc: 0.9032
val Loss: 2.9813 Acc: 0.7344
Epoch 34/63
----------
train Loss: 1.1966 Acc: 0.8965
val Loss: 2.9573 Acc: 0.7266
Epoch 35/63
----------
train Loss: 1.0990 Acc: 0.9115
val Loss: 2.9416 Acc: 0.7266
Epoch 36/63
----------
train Loss: 1.0892 Acc: 0.9332
val Loss: 2.9178 Acc: 0.7266
Epoch 37/63
----------
train Loss: 1.0386 Acc: 0.9282
val Loss: 2.8919 Acc: 0.7344
Epoch 38/63
----------
train Loss: 0.9943 Acc: 0.9165
val Loss: 2.8743 Acc: 0.7344
Epoch 39/63
----------
train Loss: 0.9372 Acc: 0.9316
val Loss: 2.8444 Acc: 0.7344
Epoch 40/63
----------
train Loss: 0.9365 Acc: 0.9332
val Loss: 2.8377 Acc: 0.7344
Epoch 41/63
----------
train Loss: 0.8505 Acc: 0.9466
val Loss: 2.8209 Acc: 0.7344
Epoch 42/63
----------
train Loss: 0.8595 Acc: 0.9382
val Loss: 2.7947 Acc: 0.7344
Epoch 43/63
----------
train Loss: 0.8526 Acc: 0.9399
val Loss: 2.7908 Acc: 0.7344
Epoch 44/63
----------
train Loss: 0.7721 Acc: 0.9533
val Loss: 2.8188 Acc: 0.7812
Epoch 45/63
----------
train Loss: 0.8036 Acc: 0.9466
val Loss: 2.7705 Acc: 0.7422
Epoch 46/63
----------
train Loss: 0.7594 Acc: 0.9449
val Loss: 2.7546 Acc: 0.7500
Epoch 47/63
----------
train Loss: 0.6906 Acc: 0.9499
val Loss: 2.7630 Acc: 0.7500
Epoch 48/63
----------
train Loss: 0.6755 Acc: 0.9616
val Loss: 2.7667 Acc: 0.7734
Epoch 49/63
----------
train Loss: 0.6706 Acc: 0.9649
val Loss: 2.7661 Acc: 0.7578
Epoch 50/63
----------
train Loss: 0.6429 Acc: 0.9599
val Loss: 2.7225 Acc: 0.7578
Epoch 51/63
----------
train Loss: 0.6518 Acc: 0.9549
val Loss: 2.7117 Acc: 0.7422
Epoch 52/63
----------
train Loss: 0.5920 Acc: 0.9616
val Loss: 2.7100 Acc: 0.7656
Epoch 53/63
----------
train Loss: 0.5987 Acc: 0.9649
val Loss: 2.7085 Acc: 0.7500
Epoch 54/63
----------
train Loss: 0.6174 Acc: 0.9716
val Loss: 2.6988 Acc: 0.7812
Epoch 55/63
----------
train Loss: 0.4914 Acc: 0.9733
val Loss: 2.7220 Acc: 0.7891
Epoch 56/63
----------
train Loss: 0.5006 Acc: 0.9783
val Loss: 2.7138 Acc: 0.7891
Epoch 57/63
----------
train Loss: 0.5320 Acc: 0.9750
val Loss: 2.7108 Acc: 0.7891
Epoch 58/63
----------
train Loss: 0.4762 Acc: 0.9800
val Loss: 2.7049 Acc: 0.7891
Epoch 59/63
----------
train Loss: 0.4710 Acc: 0.9816
val Loss: 2.7006 Acc: 0.7812
Epoch 60/63
----------
train Loss: 0.4592 Acc: 0.9783
val Loss: 2.7120 Acc: 0.7656
Epoch 61/63
----------
train Loss: 0.4284 Acc: 0.9816
val Loss: 2.7335 Acc: 0.7812
Epoch 62/63
----------
train Loss: 0.4365 Acc: 0.9833
val Loss: 2.7324 Acc: 0.7891
Epoch 63/63
----------
train Loss: 0.4187 Acc: 0.9816
[I 2024-10-15 16:13:44,271] Trial 87 finished with value: 0.7890625 and parameters: {'batch_size': 87, 'lr': 1.4315915255197397e-06, 'num_epochs': 63, 'weight_decay': 0.023374247273287938, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 2.7626 Acc: 0.7891
Best val Acc: 0.789062
Model weights saved at ./model_weights/ResNet34_bs_87_lr_1.4315915255197397e-06_epoch_63_wd_0.023374247273287938_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/45
----------
train Loss: 0.9214 Acc: 0.1586
val Loss: 0.8770 Acc: 0.1172
Epoch 2/45
----------
train Loss: 0.8517 Acc: 0.1736
val Loss: 0.8007 Acc: 0.1484
Epoch 3/45
----------
train Loss: 0.7913 Acc: 0.2003
val Loss: 0.7496 Acc: 0.2031
Epoch 4/45
----------
train Loss: 0.7333 Acc: 0.2922
val Loss: 0.7020 Acc: 0.2656
Epoch 5/45
----------
train Loss: 0.6843 Acc: 0.3790
val Loss: 0.6469 Acc: 0.4531
Epoch 6/45
----------
train Loss: 0.6357 Acc: 0.5025
val Loss: 0.5987 Acc: 0.5547
Epoch 7/45
----------
train Loss: 0.5895 Acc: 0.6311
val Loss: 0.5604 Acc: 0.6172
Epoch 8/45
----------
train Loss: 0.5576 Acc: 0.6361
val Loss: 0.5215 Acc: 0.6875
Epoch 9/45
----------
train Loss: 0.5242 Acc: 0.6995
val Loss: 0.4865 Acc: 0.6484
Epoch 10/45
----------
train Loss: 0.5046 Acc: 0.7312
val Loss: 0.4573 Acc: 0.7031
Epoch 11/45
----------
train Loss: 0.4666 Acc: 0.7479
val Loss: 0.4337 Acc: 0.7266
Epoch 12/45
----------
train Loss: 0.4484 Acc: 0.7780
val Loss: 0.4111 Acc: 0.7500
Epoch 13/45
----------
train Loss: 0.4383 Acc: 0.7730
val Loss: 0.3947 Acc: 0.7578
Epoch 14/45
----------
train Loss: 0.4117 Acc: 0.7880
val Loss: 0.3771 Acc: 0.7734
Epoch 15/45
----------
train Loss: 0.4210 Acc: 0.7730
val Loss: 0.3641 Acc: 0.7734
Epoch 16/45
----------
train Loss: 0.3877 Acc: 0.8264
val Loss: 0.3588 Acc: 0.7891
Epoch 17/45
----------
train Loss: 0.3805 Acc: 0.8097
val Loss: 0.3450 Acc: 0.7812
Epoch 18/45
----------
train Loss: 0.3683 Acc: 0.8214
val Loss: 0.3369 Acc: 0.7969
Epoch 19/45
----------
train Loss: 0.3787 Acc: 0.7846
val Loss: 0.3273 Acc: 0.8047
Epoch 20/45
----------
train Loss: 0.3434 Acc: 0.8564
val Loss: 0.3198 Acc: 0.7969
Epoch 21/45
----------
train Loss: 0.3663 Acc: 0.7863
val Loss: 0.3102 Acc: 0.8125
Epoch 22/45
----------
train Loss: 0.3555 Acc: 0.7963
val Loss: 0.3034 Acc: 0.8281
Epoch 23/45
----------
train Loss: 0.3290 Acc: 0.8264
val Loss: 0.3019 Acc: 0.8047
Epoch 24/45
----------
train Loss: 0.3323 Acc: 0.8481
val Loss: 0.2954 Acc: 0.8047
Epoch 25/45
----------
train Loss: 0.3217 Acc: 0.8381
val Loss: 0.2952 Acc: 0.8438
Epoch 26/45
----------
train Loss: 0.3210 Acc: 0.8197
val Loss: 0.2900 Acc: 0.8281
Epoch 27/45
----------
train Loss: 0.3366 Acc: 0.8114
val Loss: 0.2797 Acc: 0.8359
Epoch 28/45
----------
train Loss: 0.3027 Acc: 0.8381
val Loss: 0.2753 Acc: 0.8281
Epoch 29/45
----------
train Loss: 0.3273 Acc: 0.7830
val Loss: 0.2769 Acc: 0.8281
Epoch 30/45
----------
train Loss: 0.3207 Acc: 0.8164
val Loss: 0.2754 Acc: 0.8203
Epoch 31/45
----------
train Loss: 0.3062 Acc: 0.8798
val Loss: 0.2687 Acc: 0.8281
Epoch 32/45
----------
train Loss: 0.2848 Acc: 0.8681
val Loss: 0.2674 Acc: 0.8125
Epoch 33/45
----------
train Loss: 0.3023 Acc: 0.8598
val Loss: 0.2659 Acc: 0.8281
Epoch 34/45
----------
train Loss: 0.2768 Acc: 0.8948
val Loss: 0.2602 Acc: 0.8203
Epoch 35/45
----------
train Loss: 0.2961 Acc: 0.8781
val Loss: 0.2583 Acc: 0.8516
Epoch 36/45
----------
train Loss: 0.2929 Acc: 0.8514
val Loss: 0.2548 Acc: 0.8438
Epoch 37/45
----------
train Loss: 0.2756 Acc: 0.8765
val Loss: 0.2518 Acc: 0.8281
Epoch 38/45
----------
train Loss: 0.2484 Acc: 0.9232
val Loss: 0.2437 Acc: 0.8281
Epoch 39/45
----------
train Loss: 0.2925 Acc: 0.8514
val Loss: 0.2460 Acc: 0.8438
Epoch 40/45
----------
train Loss: 0.2812 Acc: 0.8514
val Loss: 0.2439 Acc: 0.8359
Epoch 41/45
----------
train Loss: 0.2364 Acc: 0.9482
val Loss: 0.2471 Acc: 0.8438
Epoch 42/45
----------
train Loss: 0.2931 Acc: 0.8447
val Loss: 0.2484 Acc: 0.8359
Epoch 43/45
----------
train Loss: 0.2792 Acc: 0.8581
val Loss: 0.2450 Acc: 0.8516
Epoch 44/45
----------
train Loss: 0.2846 Acc: 0.8831
val Loss: 0.2424 Acc: 0.8438
Epoch 45/45
----------
train Loss: 0.2697 Acc: 0.8614
[I 2024-10-15 16:17:06,985] Trial 88 finished with value: 0.8359375 and parameters: {'batch_size': 69, 'lr': 9.20828279464914e-06, 'num_epochs': 45, 'weight_decay': 0.05650768959998915, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 0.2390 Acc: 0.8359
Best val Acc: 0.835938
Model weights saved at ./model_weights/ResNet34_bs_69_lr_9.20828279464914e-06_epoch_45_wd_0.05650768959998915_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/39
----------
train Loss: 4.2681 Acc: 0.5309
val Loss: 6.9473 Acc: 0.7422
Epoch 2/39
----------
train Loss: 2.3004 Acc: 0.7513
val Loss: 2.4333 Acc: 0.7031
Epoch 3/39
----------
train Loss: 1.1185 Acc: 0.8698
val Loss: 3.1138 Acc: 0.8125
Epoch 4/39
----------
train Loss: 0.4734 Acc: 0.9416
val Loss: 2.8501 Acc: 0.8203
Epoch 5/39
----------
train Loss: 0.4764 Acc: 0.9399
val Loss: 5.7094 Acc: 0.5312
Epoch 6/39
----------
train Loss: 0.7563 Acc: 0.8965
val Loss: 5.7671 Acc: 0.7266
Epoch 7/39
----------
train Loss: 0.5557 Acc: 0.9466
val Loss: 3.8718 Acc: 0.8125
Epoch 8/39
----------
train Loss: 0.7408 Acc: 0.9232
val Loss: 3.0440 Acc: 0.7656
Epoch 9/39
----------
train Loss: 0.4166 Acc: 0.9482
val Loss: 4.6258 Acc: 0.7812
Epoch 10/39
----------
train Loss: 0.3643 Acc: 0.9583
val Loss: 2.7804 Acc: 0.7656
Epoch 11/39
----------
train Loss: 0.3701 Acc: 0.9633
val Loss: 4.4336 Acc: 0.8203
Epoch 12/39
----------
train Loss: 0.4638 Acc: 0.9466
val Loss: 4.5675 Acc: 0.7734
Epoch 13/39
----------
train Loss: 0.4222 Acc: 0.9516
val Loss: 4.6722 Acc: 0.7578
Epoch 14/39
----------
train Loss: 0.7102 Acc: 0.9299
val Loss: 3.9775 Acc: 0.8047
Epoch 15/39
----------
train Loss: 0.4345 Acc: 0.9549
val Loss: 3.5852 Acc: 0.7344
Epoch 16/39
----------
train Loss: 0.4763 Acc: 0.9416
val Loss: 4.5141 Acc: 0.7266
Epoch 17/39
----------
train Loss: 0.4030 Acc: 0.9416
val Loss: 4.3872 Acc: 0.7812
Epoch 18/39
----------
train Loss: 0.1948 Acc: 0.9866
val Loss: 4.2951 Acc: 0.8047
Epoch 19/39
----------
train Loss: 0.1394 Acc: 0.9833
val Loss: 3.9952 Acc: 0.8203
Epoch 20/39
----------
train Loss: 0.1001 Acc: 0.9883
val Loss: 4.3833 Acc: 0.8359
Epoch 21/39
----------
train Loss: 0.0820 Acc: 0.9900
val Loss: 4.4573 Acc: 0.8359
Epoch 22/39
----------
train Loss: 0.0719 Acc: 0.9917
val Loss: 4.1686 Acc: 0.8359
Epoch 23/39
----------
train Loss: 0.0460 Acc: 0.9950
val Loss: 4.0494 Acc: 0.8438
Epoch 24/39
----------
train Loss: 0.0454 Acc: 0.9933
val Loss: 3.7611 Acc: 0.8516
Epoch 25/39
----------
train Loss: 0.0411 Acc: 0.9950
val Loss: 3.9098 Acc: 0.8438
Epoch 26/39
----------
train Loss: 0.0362 Acc: 0.9950
val Loss: 3.8951 Acc: 0.8516
Epoch 27/39
----------
train Loss: 0.0369 Acc: 0.9950
val Loss: 3.9646 Acc: 0.8438
Epoch 28/39
----------
train Loss: 0.0404 Acc: 0.9950
val Loss: 3.7578 Acc: 0.8359
Epoch 29/39
----------
train Loss: 0.0422 Acc: 0.9950
val Loss: 3.7295 Acc: 0.8438
Epoch 30/39
----------
train Loss: 0.0494 Acc: 0.9933
val Loss: 3.5317 Acc: 0.8516
Epoch 31/39
----------
train Loss: 0.0484 Acc: 0.9950
val Loss: 3.6973 Acc: 0.8438
Epoch 32/39
----------
train Loss: 0.0440 Acc: 0.9950
val Loss: 3.5638 Acc: 0.8438
Epoch 33/39
----------
train Loss: 0.0600 Acc: 0.9950
val Loss: 3.2560 Acc: 0.8438
Epoch 34/39
----------
train Loss: 0.0423 Acc: 0.9950
val Loss: 3.6159 Acc: 0.8516
Epoch 35/39
----------
train Loss: 0.0409 Acc: 0.9933
val Loss: 3.6391 Acc: 0.8438
Epoch 36/39
----------
train Loss: 0.0390 Acc: 0.9950
val Loss: 3.5476 Acc: 0.8516
Epoch 37/39
----------
train Loss: 0.0425 Acc: 0.9950
val Loss: 3.4680 Acc: 0.8516
Epoch 38/39
----------
train Loss: 0.0393 Acc: 0.9933
val Loss: 3.6208 Acc: 0.8516
Epoch 39/39
----------
train Loss: 0.0428 Acc: 0.9933
[I 2024-10-15 16:20:02,550] Trial 89 finished with value: 0.84375 and parameters: {'batch_size': 75, 'lr': 0.00029655944223585856, 'num_epochs': 39, 'weight_decay': 0.0013288725237804485, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 3.5850 Acc: 0.8438
Best val Acc: 0.843750
Model weights saved at ./model_weights/ResNet34_bs_75_lr_0.00029655944223585856_epoch_39_wd_0.0013288725237804485_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/55
----------
train Loss: 2.7545 Acc: 0.6628
val Loss: 1.7826 Acc: 0.7344
Epoch 2/55
----------
train Loss: 1.7000 Acc: 0.8180
val Loss: 1.7031 Acc: 0.7734
Epoch 3/55
----------
train Loss: 1.5038 Acc: 0.8013
val Loss: 1.5114 Acc: 0.7812
Epoch 4/55
----------
train Loss: 1.4637 Acc: 0.8364
val Loss: 1.5164 Acc: 0.7891
Epoch 5/55
----------
train Loss: 1.4667 Acc: 0.8564
val Loss: 1.5990 Acc: 0.7734
Epoch 6/55
----------
train Loss: 1.4127 Acc: 0.8431
val Loss: 1.8131 Acc: 0.7812
Epoch 7/55
----------
train Loss: 1.4458 Acc: 0.8397
val Loss: 1.6215 Acc: 0.7891
Epoch 8/55
----------
train Loss: 1.2896 Acc: 0.8681
val Loss: 1.7487 Acc: 0.7891
Epoch 9/55
----------
train Loss: 1.1598 Acc: 0.9232
val Loss: 1.5022 Acc: 0.7969
Epoch 10/55
----------
train Loss: 1.2890 Acc: 0.9165
val Loss: 1.6163 Acc: 0.8047
Epoch 11/55
----------
train Loss: 1.3679 Acc: 0.8731
val Loss: 1.3613 Acc: 0.8281
Epoch 12/55
----------
train Loss: 1.2978 Acc: 0.9149
val Loss: 1.5042 Acc: 0.7891
Epoch 13/55
----------
train Loss: 1.2227 Acc: 0.8932
val Loss: 1.5733 Acc: 0.8125
Epoch 14/55
----------
train Loss: 1.3253 Acc: 0.8731
val Loss: 1.7985 Acc: 0.7891
Epoch 15/55
----------
train Loss: 1.1861 Acc: 0.9082
val Loss: 1.7366 Acc: 0.7734
Epoch 16/55
----------
train Loss: 1.3027 Acc: 0.9065
val Loss: 1.6706 Acc: 0.8047
Epoch 17/55
----------
train Loss: 1.1566 Acc: 0.9215
val Loss: 1.5141 Acc: 0.8125
Epoch 18/55
----------
train Loss: 1.1303 Acc: 0.9082
val Loss: 1.7275 Acc: 0.7656
Epoch 19/55
----------
train Loss: 1.3748 Acc: 0.8881
val Loss: 1.5548 Acc: 0.8516
Epoch 20/55
----------
train Loss: 1.3666 Acc: 0.8598
val Loss: 1.7082 Acc: 0.7656
Epoch 21/55
----------
train Loss: 1.3451 Acc: 0.8264
val Loss: 1.7616 Acc: 0.7734
Epoch 22/55
----------
train Loss: 1.2344 Acc: 0.9165
val Loss: 1.6947 Acc: 0.8047
Epoch 23/55
----------
train Loss: 1.1676 Acc: 0.9232
val Loss: 1.6772 Acc: 0.7969
Epoch 24/55
----------
train Loss: 1.2792 Acc: 0.9199
val Loss: 1.4812 Acc: 0.8281
Epoch 25/55
----------
train Loss: 1.1813 Acc: 0.8798
val Loss: 1.6296 Acc: 0.8047
Epoch 26/55
----------
train Loss: 1.2076 Acc: 0.9149
val Loss: 1.6309 Acc: 0.8281
Epoch 27/55
----------
train Loss: 1.2416 Acc: 0.9282
val Loss: 1.4222 Acc: 0.8359
Epoch 28/55
----------
train Loss: 1.0833 Acc: 0.9366
val Loss: 1.5125 Acc: 0.8125
Epoch 29/55
----------
train Loss: 1.4370 Acc: 0.9098
val Loss: 1.6772 Acc: 0.7891
Epoch 30/55
----------
train Loss: 1.1790 Acc: 0.9199
val Loss: 1.4748 Acc: 0.7891
Epoch 31/55
----------
train Loss: 1.2490 Acc: 0.9032
val Loss: 1.5027 Acc: 0.8281
Epoch 32/55
----------
train Loss: 1.2288 Acc: 0.9065
val Loss: 1.5700 Acc: 0.8047
Epoch 33/55
----------
train Loss: 1.1769 Acc: 0.8898
val Loss: 1.6331 Acc: 0.7969
Epoch 34/55
----------
train Loss: 1.3587 Acc: 0.8297
val Loss: 1.6314 Acc: 0.8047
Epoch 35/55
----------
train Loss: 1.2573 Acc: 0.9115
val Loss: 1.6159 Acc: 0.8203
Epoch 36/55
----------
train Loss: 1.3623 Acc: 0.8664
val Loss: 1.4086 Acc: 0.8203
Epoch 37/55
----------
train Loss: 1.2279 Acc: 0.9065
val Loss: 1.4266 Acc: 0.8281
Epoch 38/55
----------
train Loss: 1.0796 Acc: 0.9282
val Loss: 1.5727 Acc: 0.8203
Epoch 39/55
----------
train Loss: 1.2089 Acc: 0.9149
val Loss: 1.6483 Acc: 0.7812
Epoch 40/55
----------
train Loss: 1.1601 Acc: 0.8748
val Loss: 1.9486 Acc: 0.7266
Epoch 41/55
----------
train Loss: 1.2054 Acc: 0.9032
val Loss: 1.7502 Acc: 0.7969
Epoch 42/55
----------
train Loss: 1.1192 Acc: 0.9299
val Loss: 1.6668 Acc: 0.7891
Epoch 43/55
----------
train Loss: 1.2251 Acc: 0.9182
val Loss: 1.7547 Acc: 0.7969
Epoch 44/55
----------
train Loss: 1.2840 Acc: 0.8731
val Loss: 1.8184 Acc: 0.7812
Epoch 45/55
----------
train Loss: 1.0673 Acc: 0.9232
val Loss: 1.5794 Acc: 0.8281
Epoch 46/55
----------
train Loss: 1.3861 Acc: 0.8965
val Loss: 1.7271 Acc: 0.7969
Epoch 47/55
----------
train Loss: 1.3871 Acc: 0.8681
val Loss: 1.4562 Acc: 0.8125
Epoch 48/55
----------
train Loss: 1.0653 Acc: 0.9482
val Loss: 1.6593 Acc: 0.7734
Epoch 49/55
----------
train Loss: 1.1218 Acc: 0.9249
val Loss: 1.4949 Acc: 0.8359
Epoch 50/55
----------
train Loss: 1.2884 Acc: 0.8848
val Loss: 1.6600 Acc: 0.7891
Epoch 51/55
----------
train Loss: 1.1535 Acc: 0.9332
val Loss: 1.7109 Acc: 0.7969
Epoch 52/55
----------
train Loss: 1.1173 Acc: 0.9316
val Loss: 1.5218 Acc: 0.8125
Epoch 53/55
----------
train Loss: 1.0848 Acc: 0.9149
val Loss: 1.6020 Acc: 0.8047
Epoch 54/55
----------
train Loss: 1.2037 Acc: 0.8831
val Loss: 1.6202 Acc: 0.7734
Epoch 55/55
----------
train Loss: 0.9319 Acc: 0.9599
[I 2024-10-15 16:24:09,106] Trial 90 finished with value: 0.7890625 and parameters: {'batch_size': 113, 'lr': 0.00015749690704983845, 'num_epochs': 55, 'weight_decay': 0.00963673125777421, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.7022 Acc: 0.7891
Best val Acc: 0.789062
Model weights saved at ./model_weights/ResNet34_bs_113_lr_0.00015749690704983845_epoch_55_wd_0.00963673125777421_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/61
----------
train Loss: 4.7815 Acc: 0.2087
val Loss: 4.2291 Acc: 0.3359
Epoch 2/61
----------
train Loss: 4.3123 Acc: 0.3689
val Loss: 3.7695 Acc: 0.5547
Epoch 3/61
----------
train Loss: 3.9244 Acc: 0.5526
val Loss: 3.4414 Acc: 0.6250
Epoch 4/61
----------
train Loss: 3.6221 Acc: 0.6260
val Loss: 3.1986 Acc: 0.6875
Epoch 5/61
----------
train Loss: 3.3442 Acc: 0.6644
val Loss: 2.9742 Acc: 0.7109
Epoch 6/61
----------
train Loss: 3.0256 Acc: 0.7179
val Loss: 2.8155 Acc: 0.7266
Epoch 7/61
----------
train Loss: 2.8356 Acc: 0.7379
val Loss: 2.6260 Acc: 0.7500
Epoch 8/61
----------
train Loss: 2.7488 Acc: 0.6945
val Loss: 2.4652 Acc: 0.7500
Epoch 9/61
----------
train Loss: 2.5594 Acc: 0.7112
val Loss: 2.3721 Acc: 0.7422
Epoch 10/61
----------
train Loss: 2.4935 Acc: 0.7245
val Loss: 2.2707 Acc: 0.7812
Epoch 11/61
----------
train Loss: 2.4065 Acc: 0.7279
val Loss: 2.1672 Acc: 0.7812
Epoch 12/61
----------
train Loss: 2.1922 Acc: 0.7613
val Loss: 2.0565 Acc: 0.7891
Epoch 13/61
----------
train Loss: 2.1050 Acc: 0.7763
val Loss: 1.9766 Acc: 0.7734
Epoch 14/61
----------
train Loss: 2.0741 Acc: 0.7696
val Loss: 1.9187 Acc: 0.7812
Epoch 15/61
----------
train Loss: 2.0103 Acc: 0.7746
val Loss: 1.8491 Acc: 0.7812
Epoch 16/61
----------
train Loss: 1.9762 Acc: 0.7913
val Loss: 1.7993 Acc: 0.7891
Epoch 17/61
----------
train Loss: 1.9806 Acc: 0.7780
val Loss: 1.7495 Acc: 0.7969
Epoch 18/61
----------
train Loss: 1.9002 Acc: 0.7730
val Loss: 1.7128 Acc: 0.7812
Epoch 19/61
----------
train Loss: 1.7726 Acc: 0.8063
val Loss: 1.6510 Acc: 0.8125
Epoch 20/61
----------
train Loss: 1.7746 Acc: 0.8180
val Loss: 1.6195 Acc: 0.8281
Epoch 21/61
----------
train Loss: 1.8189 Acc: 0.8097
val Loss: 1.5890 Acc: 0.8281
Epoch 22/61
----------
train Loss: 1.7821 Acc: 0.7863
val Loss: 1.5555 Acc: 0.8281
Epoch 23/61
----------
train Loss: 1.6701 Acc: 0.8347
val Loss: 1.5245 Acc: 0.8281
Epoch 24/61
----------
train Loss: 1.5441 Acc: 0.8681
val Loss: 1.5126 Acc: 0.8281
Epoch 25/61
----------
train Loss: 1.6189 Acc: 0.8431
val Loss: 1.4883 Acc: 0.8281
Epoch 26/61
----------
train Loss: 1.6399 Acc: 0.8397
val Loss: 1.4765 Acc: 0.8281
Epoch 27/61
----------
train Loss: 1.4149 Acc: 0.9048
val Loss: 1.4398 Acc: 0.8359
Epoch 28/61
----------
train Loss: 1.6002 Acc: 0.8431
val Loss: 1.4458 Acc: 0.8359
Epoch 29/61
----------
train Loss: 1.5613 Acc: 0.8765
val Loss: 1.4218 Acc: 0.8438
Epoch 30/61
----------
train Loss: 1.3787 Acc: 0.8531
val Loss: 1.4059 Acc: 0.8359
Epoch 31/61
----------
train Loss: 1.5971 Acc: 0.8297
val Loss: 1.4021 Acc: 0.8359
Epoch 32/61
----------
train Loss: 1.4631 Acc: 0.8932
val Loss: 1.3840 Acc: 0.8438
Epoch 33/61
----------
train Loss: 1.4771 Acc: 0.8715
val Loss: 1.3946 Acc: 0.8359
Epoch 34/61
----------
train Loss: 1.4617 Acc: 0.8731
val Loss: 1.3562 Acc: 0.8438
Epoch 35/61
----------
train Loss: 1.4247 Acc: 0.8831
val Loss: 1.3350 Acc: 0.8594
Epoch 36/61
----------
train Loss: 1.4173 Acc: 0.8664
val Loss: 1.3475 Acc: 0.8359
Epoch 37/61
----------
train Loss: 1.4031 Acc: 0.8915
val Loss: 1.3604 Acc: 0.8359
Epoch 38/61
----------
train Loss: 1.3495 Acc: 0.8848
val Loss: 1.3434 Acc: 0.8281
Epoch 39/61
----------
train Loss: 1.3849 Acc: 0.8564
val Loss: 1.3312 Acc: 0.8516
Epoch 40/61
----------
train Loss: 1.4411 Acc: 0.8598
val Loss: 1.3236 Acc: 0.8516
Epoch 41/61
----------
train Loss: 1.3701 Acc: 0.8798
val Loss: 1.3281 Acc: 0.8516
Epoch 42/61
----------
train Loss: 1.4665 Acc: 0.8731
val Loss: 1.3232 Acc: 0.8594
Epoch 43/61
----------
train Loss: 1.2668 Acc: 0.9032
val Loss: 1.3112 Acc: 0.8516
Epoch 44/61
----------
train Loss: 1.5549 Acc: 0.7980
val Loss: 1.3014 Acc: 0.8516
Epoch 45/61
----------
train Loss: 1.4158 Acc: 0.8364
val Loss: 1.3009 Acc: 0.8516
Epoch 46/61
----------
train Loss: 1.3589 Acc: 0.8781
val Loss: 1.2504 Acc: 0.8516
Epoch 47/61
----------
train Loss: 1.3770 Acc: 0.8297
val Loss: 1.2683 Acc: 0.8359
Epoch 48/61
----------
train Loss: 1.1956 Acc: 0.9516
val Loss: 1.2943 Acc: 0.8438
Epoch 49/61
----------
train Loss: 1.4971 Acc: 0.8698
val Loss: 1.3232 Acc: 0.8281
Epoch 50/61
----------
train Loss: 1.2520 Acc: 0.8848
val Loss: 1.3387 Acc: 0.8359
Epoch 51/61
----------
train Loss: 1.3007 Acc: 0.9048
val Loss: 1.3014 Acc: 0.8516
Epoch 52/61
----------
train Loss: 1.2471 Acc: 0.9332
val Loss: 1.2673 Acc: 0.8516
Epoch 53/61
----------
train Loss: 1.3829 Acc: 0.8915
val Loss: 1.2837 Acc: 0.8438
Epoch 54/61
----------
train Loss: 1.4625 Acc: 0.8698
val Loss: 1.2677 Acc: 0.8516
Epoch 55/61
----------
train Loss: 1.3072 Acc: 0.8715
val Loss: 1.2905 Acc: 0.8438
Epoch 56/61
----------
train Loss: 1.0604 Acc: 0.9182
val Loss: 1.2858 Acc: 0.8438
Epoch 57/61
----------
train Loss: 1.1993 Acc: 0.9282
val Loss: 1.2677 Acc: 0.8359
Epoch 58/61
----------
train Loss: 1.5274 Acc: 0.8381
val Loss: 1.2584 Acc: 0.8359
Epoch 59/61
----------
train Loss: 1.3041 Acc: 0.8948
val Loss: 1.2678 Acc: 0.8516
Epoch 60/61
----------
train Loss: 1.1767 Acc: 0.9316
val Loss: 1.2559 Acc: 0.8516
Epoch 61/61
----------
train Loss: 1.2924 Acc: 0.8815
[I 2024-10-15 16:28:45,091] Trial 91 finished with value: 0.84375 and parameters: {'batch_size': 17, 'lr': 5.73608703766456e-06, 'num_epochs': 61, 'weight_decay': 0.0004113533521205432, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.2554 Acc: 0.8438
Best val Acc: 0.843750
Model weights saved at ./model_weights/ResNet34_bs_17_lr_5.73608703766456e-06_epoch_61_wd_0.0004113533521205432_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/66
----------
train Loss: 6.0435 Acc: 0.1586
val Loss: 5.8514 Acc: 0.1484
Epoch 2/66
----------
train Loss: 5.4030 Acc: 0.2337
val Loss: 4.8821 Acc: 0.3203
Epoch 3/66
----------
train Loss: 4.8408 Acc: 0.3506
val Loss: 4.4040 Acc: 0.4297
Epoch 4/66
----------
train Loss: 4.4316 Acc: 0.4741
val Loss: 3.9732 Acc: 0.4766
Epoch 5/66
----------
train Loss: 3.9178 Acc: 0.6210
val Loss: 3.5191 Acc: 0.6797
Epoch 6/66
----------
train Loss: 3.5453 Acc: 0.6995
val Loss: 3.1857 Acc: 0.7266
Epoch 7/66
----------
train Loss: 3.2129 Acc: 0.7412
val Loss: 2.9123 Acc: 0.7734
Epoch 8/66
----------
train Loss: 3.0416 Acc: 0.7396
val Loss: 2.6923 Acc: 0.7734
Epoch 9/66
----------
train Loss: 2.8544 Acc: 0.7763
val Loss: 2.4829 Acc: 0.8047
Epoch 10/66
----------
train Loss: 2.7172 Acc: 0.7496
val Loss: 2.3042 Acc: 0.8125
Epoch 11/66
----------
train Loss: 2.5581 Acc: 0.7396
val Loss: 2.1838 Acc: 0.8125
Epoch 12/66
----------
train Loss: 2.3606 Acc: 0.7896
val Loss: 2.0731 Acc: 0.8203
Epoch 13/66
----------
train Loss: 2.3794 Acc: 0.7496
val Loss: 1.9939 Acc: 0.8281
Epoch 14/66
----------
train Loss: 2.2438 Acc: 0.7746
val Loss: 1.8679 Acc: 0.8203
Epoch 15/66
----------
train Loss: 2.0566 Acc: 0.8114
val Loss: 1.7966 Acc: 0.8359
Epoch 16/66
----------
train Loss: 1.9614 Acc: 0.8063
val Loss: 1.7535 Acc: 0.8438
Epoch 17/66
----------
train Loss: 1.8886 Acc: 0.8431
val Loss: 1.6752 Acc: 0.8438
Epoch 18/66
----------
train Loss: 1.8185 Acc: 0.8280
val Loss: 1.6156 Acc: 0.8516
Epoch 19/66
----------
train Loss: 1.8640 Acc: 0.8247
val Loss: 1.5561 Acc: 0.8359
Epoch 20/66
----------
train Loss: 1.6552 Acc: 0.8581
val Loss: 1.5194 Acc: 0.8438
Epoch 21/66
----------
train Loss: 1.8198 Acc: 0.8230
val Loss: 1.4626 Acc: 0.8516
Epoch 22/66
----------
train Loss: 1.5745 Acc: 0.8664
val Loss: 1.4498 Acc: 0.8516
Epoch 23/66
----------
train Loss: 1.7469 Acc: 0.8364
val Loss: 1.4385 Acc: 0.8516
Epoch 24/66
----------
train Loss: 1.7127 Acc: 0.8364
val Loss: 1.3930 Acc: 0.8438
Epoch 25/66
----------
train Loss: 1.7498 Acc: 0.7846
val Loss: 1.3716 Acc: 0.8438
Epoch 26/66
----------
train Loss: 1.7320 Acc: 0.8431
val Loss: 1.3712 Acc: 0.8516
Epoch 27/66
----------
train Loss: 1.5843 Acc: 0.8314
val Loss: 1.3614 Acc: 0.8359
Epoch 28/66
----------
train Loss: 1.7425 Acc: 0.8047
val Loss: 1.3286 Acc: 0.8594
Epoch 29/66
----------
train Loss: 1.6598 Acc: 0.8347
val Loss: 1.3272 Acc: 0.8438
Epoch 30/66
----------
train Loss: 1.5106 Acc: 0.8731
val Loss: 1.3063 Acc: 0.8281
Epoch 31/66
----------
train Loss: 1.5833 Acc: 0.8364
val Loss: 1.2960 Acc: 0.8359
Epoch 32/66
----------
train Loss: 1.6870 Acc: 0.8080
val Loss: 1.2715 Acc: 0.8516
Epoch 33/66
----------
train Loss: 1.4856 Acc: 0.8798
val Loss: 1.2532 Acc: 0.8438
Epoch 34/66
----------
train Loss: 1.4387 Acc: 0.8648
val Loss: 1.2408 Acc: 0.8359
Epoch 35/66
----------
train Loss: 1.4737 Acc: 0.8965
val Loss: 1.2720 Acc: 0.8516
Epoch 36/66
----------
train Loss: 1.4624 Acc: 0.8848
val Loss: 1.2627 Acc: 0.8594
Epoch 37/66
----------
train Loss: 1.5288 Acc: 0.8798
val Loss: 1.2372 Acc: 0.8438
Epoch 38/66
----------
train Loss: 1.4638 Acc: 0.8631
val Loss: 1.2372 Acc: 0.8359
Epoch 39/66
----------
train Loss: 1.4247 Acc: 0.8631
val Loss: 1.2131 Acc: 0.8594
Epoch 40/66
----------
train Loss: 1.3629 Acc: 0.8648
val Loss: 1.2098 Acc: 0.8594
Epoch 41/66
----------
train Loss: 1.4115 Acc: 0.8998
val Loss: 1.2102 Acc: 0.8516
Epoch 42/66
----------
train Loss: 1.4426 Acc: 0.8598
val Loss: 1.1955 Acc: 0.8281
Epoch 43/66
----------
train Loss: 1.5769 Acc: 0.8397
val Loss: 1.2173 Acc: 0.8203
Epoch 44/66
----------
train Loss: 1.2280 Acc: 0.9165
val Loss: 1.2072 Acc: 0.8203
Epoch 45/66
----------
train Loss: 1.2592 Acc: 0.9182
val Loss: 1.1746 Acc: 0.8359
Epoch 46/66
----------
train Loss: 1.2597 Acc: 0.9399
val Loss: 1.1802 Acc: 0.8438
Epoch 47/66
----------
train Loss: 1.4690 Acc: 0.8531
val Loss: 1.1931 Acc: 0.8594
Epoch 48/66
----------
train Loss: 1.5398 Acc: 0.8898
val Loss: 1.2110 Acc: 0.8281
Epoch 49/66
----------
train Loss: 1.2886 Acc: 0.9199
val Loss: 1.1948 Acc: 0.8359
Epoch 50/66
----------
train Loss: 1.0937 Acc: 0.9165
val Loss: 1.1717 Acc: 0.8281
Epoch 51/66
----------
train Loss: 1.3944 Acc: 0.8731
val Loss: 1.1944 Acc: 0.8359
Epoch 52/66
----------
train Loss: 1.3490 Acc: 0.9115
val Loss: 1.1999 Acc: 0.8281
Epoch 53/66
----------
train Loss: 1.3820 Acc: 0.9015
val Loss: 1.1712 Acc: 0.8594
Epoch 54/66
----------
train Loss: 1.3111 Acc: 0.8865
val Loss: 1.1470 Acc: 0.8594
Epoch 55/66
----------
train Loss: 1.5184 Acc: 0.7963
val Loss: 1.1548 Acc: 0.8359
Epoch 56/66
----------
train Loss: 1.1776 Acc: 0.9516
val Loss: 1.1791 Acc: 0.8281
Epoch 57/66
----------
train Loss: 1.2860 Acc: 0.9416
val Loss: 1.1801 Acc: 0.8438
Epoch 58/66
----------
train Loss: 1.3514 Acc: 0.9015
val Loss: 1.1929 Acc: 0.8203
Epoch 59/66
----------
train Loss: 1.2701 Acc: 0.8848
val Loss: 1.2084 Acc: 0.8359
Epoch 60/66
----------
train Loss: 1.4399 Acc: 0.8548
val Loss: 1.1999 Acc: 0.8281
Epoch 61/66
----------
train Loss: 1.3918 Acc: 0.8998
val Loss: 1.2082 Acc: 0.8438
Epoch 62/66
----------
train Loss: 1.2282 Acc: 0.9098
val Loss: 1.1886 Acc: 0.8516
Epoch 63/66
----------
train Loss: 1.3721 Acc: 0.8765
val Loss: 1.1783 Acc: 0.8438
Epoch 64/66
----------
train Loss: 1.3556 Acc: 0.8948
val Loss: 1.1564 Acc: 0.8438
Epoch 65/66
----------
train Loss: 1.3397 Acc: 0.8915
val Loss: 1.1586 Acc: 0.8438
Epoch 66/66
----------
train Loss: 1.3296 Acc: 0.8698
[I 2024-10-15 16:33:43,118] Trial 92 finished with value: 0.84375 and parameters: {'batch_size': 84, 'lr': 6.7212741888710145e-06, 'num_epochs': 66, 'weight_decay': 0.0006001225755555863, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.1666 Acc: 0.8438
Best val Acc: 0.843750
Model weights saved at ./model_weights/ResNet34_bs_84_lr_6.7212741888710145e-06_epoch_66_wd_0.0006001225755555863_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/69
----------
train Loss: 4.7650 Acc: 0.2187
val Loss: 4.6565 Acc: 0.1953
Epoch 2/69
----------
train Loss: 4.2134 Acc: 0.3539
val Loss: 3.9645 Acc: 0.3828
Epoch 3/69
----------
train Loss: 3.7337 Acc: 0.5275
val Loss: 3.5000 Acc: 0.5469
Epoch 4/69
----------
train Loss: 3.3972 Acc: 0.6060
val Loss: 3.2212 Acc: 0.6328
Epoch 5/69
----------
train Loss: 3.0816 Acc: 0.6978
val Loss: 2.9652 Acc: 0.6797
Epoch 6/69
----------
train Loss: 2.8569 Acc: 0.7312
val Loss: 2.7098 Acc: 0.7109
Epoch 7/69
----------
train Loss: 2.6480 Acc: 0.7346
val Loss: 2.5222 Acc: 0.7344
Epoch 8/69
----------
train Loss: 2.4667 Acc: 0.7830
val Loss: 2.3766 Acc: 0.7578
Epoch 9/69
----------
train Loss: 2.3079 Acc: 0.7730
val Loss: 2.2700 Acc: 0.7500
Epoch 10/69
----------
train Loss: 2.1856 Acc: 0.7780
val Loss: 2.1754 Acc: 0.7500
Epoch 11/69
----------
train Loss: 2.0445 Acc: 0.8264
val Loss: 2.0508 Acc: 0.7734
Epoch 12/69
----------
train Loss: 1.9986 Acc: 0.7963
val Loss: 1.9513 Acc: 0.7578
Epoch 13/69
----------
train Loss: 1.9873 Acc: 0.8180
val Loss: 1.8625 Acc: 0.7578
Epoch 14/69
----------
train Loss: 1.7993 Acc: 0.8397
val Loss: 1.8090 Acc: 0.7656
Epoch 15/69
----------
train Loss: 1.8255 Acc: 0.8464
val Loss: 1.7509 Acc: 0.7734
Epoch 16/69
----------
train Loss: 1.8568 Acc: 0.8013
val Loss: 1.7484 Acc: 0.7656
Epoch 17/69
----------
train Loss: 1.5232 Acc: 0.8865
val Loss: 1.6982 Acc: 0.7656
Epoch 18/69
----------
train Loss: 1.6539 Acc: 0.8314
val Loss: 1.6581 Acc: 0.7656
Epoch 19/69
----------
train Loss: 1.6358 Acc: 0.8414
val Loss: 1.6217 Acc: 0.7656
Epoch 20/69
----------
train Loss: 1.7106 Acc: 0.8147
val Loss: 1.5901 Acc: 0.7578
Epoch 21/69
----------
train Loss: 1.6269 Acc: 0.8598
val Loss: 1.5831 Acc: 0.7656
Epoch 22/69
----------
train Loss: 1.5871 Acc: 0.8431
val Loss: 1.5739 Acc: 0.7656
Epoch 23/69
----------
train Loss: 1.5025 Acc: 0.8548
val Loss: 1.5754 Acc: 0.7422
Epoch 24/69
----------
train Loss: 1.5598 Acc: 0.8331
val Loss: 1.5510 Acc: 0.7422
Epoch 25/69
----------
train Loss: 1.5667 Acc: 0.8481
val Loss: 1.5100 Acc: 0.7578
Epoch 26/69
----------
train Loss: 1.4149 Acc: 0.9032
val Loss: 1.5051 Acc: 0.7578
Epoch 27/69
----------
train Loss: 1.5166 Acc: 0.8698
val Loss: 1.5016 Acc: 0.7656
Epoch 28/69
----------
train Loss: 1.3707 Acc: 0.8698
val Loss: 1.4922 Acc: 0.7578
Epoch 29/69
----------
train Loss: 1.4594 Acc: 0.8631
val Loss: 1.4918 Acc: 0.7500
Epoch 30/69
----------
train Loss: 1.5111 Acc: 0.8531
val Loss: 1.4651 Acc: 0.7656
Epoch 31/69
----------
train Loss: 1.3569 Acc: 0.8998
val Loss: 1.4589 Acc: 0.7734
Epoch 32/69
----------
train Loss: 1.4582 Acc: 0.8948
val Loss: 1.4537 Acc: 0.7812
Epoch 33/69
----------
train Loss: 1.4543 Acc: 0.8414
val Loss: 1.4310 Acc: 0.7656
Epoch 34/69
----------
train Loss: 1.4478 Acc: 0.8130
val Loss: 1.4341 Acc: 0.7734
Epoch 35/69
----------
train Loss: 1.2940 Acc: 0.9015
val Loss: 1.4372 Acc: 0.7656
Epoch 36/69
----------
train Loss: 1.2367 Acc: 0.8998
val Loss: 1.4398 Acc: 0.7656
Epoch 37/69
----------
train Loss: 1.1534 Acc: 0.9349
val Loss: 1.4439 Acc: 0.7734
Epoch 38/69
----------
train Loss: 1.3196 Acc: 0.8114
val Loss: 1.4562 Acc: 0.7812
Epoch 39/69
----------
train Loss: 1.3948 Acc: 0.9015
val Loss: 1.4465 Acc: 0.7812
Epoch 40/69
----------
train Loss: 1.2433 Acc: 0.9265
val Loss: 1.4477 Acc: 0.7578
Epoch 41/69
----------
train Loss: 1.5273 Acc: 0.8715
val Loss: 1.4255 Acc: 0.7734
Epoch 42/69
----------
train Loss: 1.2077 Acc: 0.9132
val Loss: 1.4063 Acc: 0.7656
Epoch 43/69
----------
train Loss: 1.2415 Acc: 0.9098
val Loss: 1.4207 Acc: 0.7812
Epoch 44/69
----------
train Loss: 1.1796 Acc: 0.9282
val Loss: 1.4189 Acc: 0.7656
Epoch 45/69
----------
train Loss: 1.3326 Acc: 0.9215
val Loss: 1.4186 Acc: 0.7812
Epoch 46/69
----------
train Loss: 1.2599 Acc: 0.9282
val Loss: 1.4188 Acc: 0.7812
Epoch 47/69
----------
train Loss: 1.2350 Acc: 0.9165
val Loss: 1.4138 Acc: 0.7656
Epoch 48/69
----------
train Loss: 1.3977 Acc: 0.8798
val Loss: 1.4138 Acc: 0.7656
Epoch 49/69
----------
train Loss: 1.3330 Acc: 0.8982
val Loss: 1.4441 Acc: 0.7734
Epoch 50/69
----------
train Loss: 1.1790 Acc: 0.9015
val Loss: 1.4320 Acc: 0.7891
Epoch 51/69
----------
train Loss: 1.2707 Acc: 0.9299
val Loss: 1.4356 Acc: 0.7812
Epoch 52/69
----------
train Loss: 1.2792 Acc: 0.9132
val Loss: 1.4168 Acc: 0.7891
Epoch 53/69
----------
train Loss: 1.2126 Acc: 0.9149
val Loss: 1.4205 Acc: 0.7812
Epoch 54/69
----------
train Loss: 1.3724 Acc: 0.8664
val Loss: 1.4145 Acc: 0.7969
Epoch 55/69
----------
train Loss: 1.3212 Acc: 0.9032
val Loss: 1.4148 Acc: 0.7812
Epoch 56/69
----------
train Loss: 1.2868 Acc: 0.9149
val Loss: 1.4128 Acc: 0.7734
Epoch 57/69
----------
train Loss: 1.3689 Acc: 0.8748
val Loss: 1.4123 Acc: 0.7891
Epoch 58/69
----------
train Loss: 1.3372 Acc: 0.8614
val Loss: 1.4094 Acc: 0.7891
Epoch 59/69
----------
train Loss: 1.1164 Acc: 0.9215
val Loss: 1.4295 Acc: 0.7734
Epoch 60/69
----------
train Loss: 1.1844 Acc: 0.9616
val Loss: 1.4396 Acc: 0.7734
Epoch 61/69
----------
train Loss: 1.1901 Acc: 0.9182
val Loss: 1.4410 Acc: 0.7891
Epoch 62/69
----------
train Loss: 1.1735 Acc: 0.9382
val Loss: 1.4389 Acc: 0.7812
Epoch 63/69
----------
train Loss: 1.2483 Acc: 0.9265
val Loss: 1.4550 Acc: 0.7656
Epoch 64/69
----------
train Loss: 1.2844 Acc: 0.9182
val Loss: 1.4417 Acc: 0.7812
Epoch 65/69
----------
train Loss: 1.2419 Acc: 0.9432
val Loss: 1.4410 Acc: 0.7812
Epoch 66/69
----------
train Loss: 1.1469 Acc: 0.9449
val Loss: 1.4397 Acc: 0.7734
Epoch 67/69
----------
train Loss: 1.1065 Acc: 0.9082
val Loss: 1.4319 Acc: 0.7969
Epoch 68/69
----------
train Loss: 1.1241 Acc: 0.9549
val Loss: 1.4150 Acc: 0.7969
Epoch 69/69
----------
train Loss: 1.4085 Acc: 0.8965
[I 2024-10-15 16:38:52,846] Trial 93 finished with value: 0.7890625 and parameters: {'batch_size': 29, 'lr': 7.720646610742477e-06, 'num_epochs': 69, 'weight_decay': 0.0002934302878358356, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.4321 Acc: 0.7891
Best val Acc: 0.789062
Model weights saved at ./model_weights/ResNet34_bs_29_lr_7.720646610742477e-06_epoch_69_wd_0.0002934302878358356_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/62
----------
train Loss: 5.7474 Acc: 0.1235
val Loss: 5.3581 Acc: 0.1406
Epoch 2/62
----------
train Loss: 5.2485 Acc: 0.1636
val Loss: 4.9053 Acc: 0.1875
Epoch 3/62
----------
train Loss: 4.8412 Acc: 0.2154
val Loss: 4.4782 Acc: 0.3125
Epoch 4/62
----------
train Loss: 4.4424 Acc: 0.2905
val Loss: 4.0896 Acc: 0.4062
Epoch 5/62
----------
train Loss: 4.1343 Acc: 0.4190
val Loss: 3.7780 Acc: 0.5078
Epoch 6/62
----------
train Loss: 3.7358 Acc: 0.5710
val Loss: 3.5366 Acc: 0.5234
Epoch 7/62
----------
train Loss: 3.4939 Acc: 0.6327
val Loss: 3.2589 Acc: 0.6094
Epoch 8/62
----------
train Loss: 3.2801 Acc: 0.6895
val Loss: 3.0314 Acc: 0.6797
Epoch 9/62
----------
train Loss: 3.0088 Acc: 0.7262
val Loss: 2.8870 Acc: 0.7031
Epoch 10/62
----------
train Loss: 2.8667 Acc: 0.7462
val Loss: 2.6406 Acc: 0.7422
Epoch 11/62
----------
train Loss: 2.6933 Acc: 0.8047
val Loss: 2.5147 Acc: 0.7812
Epoch 12/62
----------
train Loss: 2.6240 Acc: 0.7813
val Loss: 2.4149 Acc: 0.7891
Epoch 13/62
----------
train Loss: 2.4841 Acc: 0.7763
val Loss: 2.3108 Acc: 0.7969
Epoch 14/62
----------
train Loss: 2.4789 Acc: 0.7529
val Loss: 2.2009 Acc: 0.7812
Epoch 15/62
----------
train Loss: 2.4069 Acc: 0.7696
val Loss: 2.1051 Acc: 0.7734
Epoch 16/62
----------
train Loss: 2.1781 Acc: 0.8314
val Loss: 2.0855 Acc: 0.7891
Epoch 17/62
----------
train Loss: 2.1037 Acc: 0.8264
val Loss: 1.9987 Acc: 0.8047
Epoch 18/62
----------
train Loss: 2.0080 Acc: 0.8230
val Loss: 1.9282 Acc: 0.7969
Epoch 19/62
----------
train Loss: 2.0588 Acc: 0.7880
val Loss: 1.8688 Acc: 0.8047
Epoch 20/62
----------
train Loss: 1.8793 Acc: 0.8331
val Loss: 1.8126 Acc: 0.8047
Epoch 21/62
----------
train Loss: 1.9592 Acc: 0.7863
val Loss: 1.7904 Acc: 0.7891
Epoch 22/62
----------
train Loss: 1.9071 Acc: 0.8180
val Loss: 1.7188 Acc: 0.8125
Epoch 23/62
----------
train Loss: 1.8361 Acc: 0.8347
val Loss: 1.6701 Acc: 0.8125
Epoch 24/62
----------
train Loss: 1.7429 Acc: 0.8648
val Loss: 1.6346 Acc: 0.8203
Epoch 25/62
----------
train Loss: 1.8444 Acc: 0.7863
val Loss: 1.6164 Acc: 0.8125
Epoch 26/62
----------
train Loss: 1.7066 Acc: 0.8564
val Loss: 1.5813 Acc: 0.8125
Epoch 27/62
----------
train Loss: 1.8483 Acc: 0.7679
val Loss: 1.5638 Acc: 0.8047
Epoch 28/62
----------
train Loss: 1.7886 Acc: 0.8097
val Loss: 1.5522 Acc: 0.8125
Epoch 29/62
----------
train Loss: 1.8228 Acc: 0.7980
val Loss: 1.5328 Acc: 0.7969
Epoch 30/62
----------
train Loss: 1.6564 Acc: 0.8264
val Loss: 1.4929 Acc: 0.8125
Epoch 31/62
----------
train Loss: 1.6823 Acc: 0.8230
val Loss: 1.4841 Acc: 0.7891
Epoch 32/62
----------
train Loss: 1.7155 Acc: 0.8063
val Loss: 1.4324 Acc: 0.8203
Epoch 33/62
----------
train Loss: 1.6141 Acc: 0.8230
val Loss: 1.4349 Acc: 0.8047
Epoch 34/62
----------
train Loss: 1.5805 Acc: 0.8414
val Loss: 1.3961 Acc: 0.8125
Epoch 35/62
----------
train Loss: 1.6570 Acc: 0.8447
val Loss: 1.4193 Acc: 0.8281
Epoch 36/62
----------
train Loss: 1.7126 Acc: 0.8280
val Loss: 1.4347 Acc: 0.8281
Epoch 37/62
----------
train Loss: 1.7386 Acc: 0.8164
val Loss: 1.4118 Acc: 0.8203
Epoch 38/62
----------
train Loss: 1.5258 Acc: 0.8481
val Loss: 1.4172 Acc: 0.8203
Epoch 39/62
----------
train Loss: 1.5346 Acc: 0.8765
val Loss: 1.4132 Acc: 0.7969
Epoch 40/62
----------
train Loss: 1.5571 Acc: 0.8631
val Loss: 1.3946 Acc: 0.8281
Epoch 41/62
----------
train Loss: 1.6444 Acc: 0.8381
val Loss: 1.3953 Acc: 0.8125
Epoch 42/62
----------
train Loss: 1.4197 Acc: 0.8798
val Loss: 1.3933 Acc: 0.8125
Epoch 43/62
----------
train Loss: 1.4399 Acc: 0.9048
val Loss: 1.3814 Acc: 0.8047
Epoch 44/62
----------
train Loss: 1.5785 Acc: 0.8464
val Loss: 1.3487 Acc: 0.8281
Epoch 45/62
----------
train Loss: 1.2611 Acc: 0.9249
val Loss: 1.3413 Acc: 0.8281
Epoch 46/62
----------
train Loss: 1.5090 Acc: 0.8247
val Loss: 1.3265 Acc: 0.8125
Epoch 47/62
----------
train Loss: 1.4279 Acc: 0.8598
val Loss: 1.3444 Acc: 0.8125
Epoch 48/62
----------
train Loss: 1.5630 Acc: 0.8164
val Loss: 1.3340 Acc: 0.8047
Epoch 49/62
----------
train Loss: 1.4685 Acc: 0.8514
val Loss: 1.3344 Acc: 0.8125
Epoch 50/62
----------
train Loss: 1.5391 Acc: 0.8664
val Loss: 1.3315 Acc: 0.8047
Epoch 51/62
----------
train Loss: 1.1816 Acc: 0.9399
val Loss: 1.3141 Acc: 0.8359
Epoch 52/62
----------
train Loss: 1.6112 Acc: 0.8815
val Loss: 1.3181 Acc: 0.8359
Epoch 53/62
----------
train Loss: 1.5657 Acc: 0.8280
val Loss: 1.3174 Acc: 0.8281
Epoch 54/62
----------
train Loss: 1.5077 Acc: 0.8397
val Loss: 1.2985 Acc: 0.8516
Epoch 55/62
----------
train Loss: 1.4226 Acc: 0.8865
val Loss: 1.3053 Acc: 0.8281
Epoch 56/62
----------
train Loss: 1.3469 Acc: 0.8898
val Loss: 1.3159 Acc: 0.8516
Epoch 57/62
----------
train Loss: 1.4441 Acc: 0.8097
val Loss: 1.3113 Acc: 0.8438
Epoch 58/62
----------
train Loss: 1.2808 Acc: 0.8998
val Loss: 1.2808 Acc: 0.8516
Epoch 59/62
----------
train Loss: 1.2505 Acc: 0.8915
val Loss: 1.2904 Acc: 0.8516
Epoch 60/62
----------
train Loss: 1.3676 Acc: 0.8948
val Loss: 1.2766 Acc: 0.8594
Epoch 61/62
----------
train Loss: 1.2359 Acc: 0.8932
val Loss: 1.3009 Acc: 0.8359
Epoch 62/62
----------
train Loss: 1.3683 Acc: 0.8598
[I 2024-10-15 16:43:31,058] Trial 94 finished with value: 0.828125 and parameters: {'batch_size': 10, 'lr': 4.566821229449798e-06, 'num_epochs': 62, 'weight_decay': 0.00019792409074017336, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.3123 Acc: 0.8281
Best val Acc: 0.828125
Model weights saved at ./model_weights/ResNet34_bs_10_lr_4.566821229449798e-06_epoch_62_wd_0.00019792409074017336_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/57
----------
train Loss: 5.7324 Acc: 0.1619
val Loss: 5.0135 Acc: 0.3359
Epoch 2/57
----------
train Loss: 4.7148 Acc: 0.3790
val Loss: 4.2356 Acc: 0.5078
Epoch 3/57
----------
train Loss: 4.0001 Acc: 0.6077
val Loss: 3.5782 Acc: 0.6719
Epoch 4/57
----------
train Loss: 3.4035 Acc: 0.7162
val Loss: 3.0449 Acc: 0.7266
Epoch 5/57
----------
train Loss: 3.0058 Acc: 0.7312
val Loss: 2.6667 Acc: 0.7656
Epoch 6/57
----------
train Loss: 2.6359 Acc: 0.7513
val Loss: 2.3730 Acc: 0.7891
Epoch 7/57
----------
train Loss: 2.4427 Acc: 0.7462
val Loss: 2.1653 Acc: 0.7812
Epoch 8/57
----------
train Loss: 2.2680 Acc: 0.7696
val Loss: 2.0421 Acc: 0.8047
Epoch 9/57
----------
train Loss: 2.0713 Acc: 0.7947
val Loss: 1.8316 Acc: 0.7969
Epoch 10/57
----------
train Loss: 1.9451 Acc: 0.8180
val Loss: 1.7442 Acc: 0.8125
Epoch 11/57
----------
train Loss: 1.8155 Acc: 0.8264
val Loss: 1.6681 Acc: 0.8203
Epoch 12/57
----------
train Loss: 1.9146 Acc: 0.7997
val Loss: 1.5636 Acc: 0.8125
Epoch 13/57
----------
train Loss: 1.9092 Acc: 0.7746
val Loss: 1.5464 Acc: 0.8125
Epoch 14/57
----------
train Loss: 1.7130 Acc: 0.8698
val Loss: 1.4820 Acc: 0.8203
Epoch 15/57
----------
train Loss: 1.6612 Acc: 0.8297
val Loss: 1.4366 Acc: 0.8359
Epoch 16/57
----------
train Loss: 1.6779 Acc: 0.8130
val Loss: 1.4012 Acc: 0.8281
Epoch 17/57
----------
train Loss: 1.6262 Acc: 0.8481
val Loss: 1.4039 Acc: 0.8359
Epoch 18/57
----------
train Loss: 1.5185 Acc: 0.8748
val Loss: 1.3364 Acc: 0.8438
Epoch 19/57
----------
train Loss: 1.6758 Acc: 0.8280
val Loss: 1.3480 Acc: 0.8438
Epoch 20/57
----------
train Loss: 1.5745 Acc: 0.8681
val Loss: 1.3549 Acc: 0.8281
Epoch 21/57
----------
train Loss: 1.4559 Acc: 0.8848
val Loss: 1.3359 Acc: 0.8359
Epoch 22/57
----------
train Loss: 1.3612 Acc: 0.9065
val Loss: 1.2819 Acc: 0.8281
Epoch 23/57
----------
train Loss: 1.5507 Acc: 0.8598
val Loss: 1.2814 Acc: 0.8359
Epoch 24/57
----------
train Loss: 1.4995 Acc: 0.8447
val Loss: 1.2703 Acc: 0.8281
Epoch 25/57
----------
train Loss: 1.5367 Acc: 0.8715
val Loss: 1.2688 Acc: 0.8438
Epoch 26/57
----------
train Loss: 1.4761 Acc: 0.8731
val Loss: 1.2534 Acc: 0.8359
Epoch 27/57
----------
train Loss: 1.3516 Acc: 0.9199
val Loss: 1.2630 Acc: 0.8359
Epoch 28/57
----------
train Loss: 1.5601 Acc: 0.8230
val Loss: 1.2667 Acc: 0.8359
Epoch 29/57
----------
train Loss: 1.5616 Acc: 0.8598
val Loss: 1.2380 Acc: 0.8281
Epoch 30/57
----------
train Loss: 1.1671 Acc: 0.9382
val Loss: 1.2012 Acc: 0.8438
Epoch 31/57
----------
train Loss: 1.3595 Acc: 0.8765
val Loss: 1.2120 Acc: 0.8359
Epoch 32/57
----------
train Loss: 1.3088 Acc: 0.8998
val Loss: 1.2294 Acc: 0.8281
Epoch 33/57
----------
train Loss: 1.2076 Acc: 0.9299
val Loss: 1.2234 Acc: 0.8281
Epoch 34/57
----------
train Loss: 1.4197 Acc: 0.8581
val Loss: 1.2501 Acc: 0.8203
Epoch 35/57
----------
train Loss: 1.1960 Acc: 0.9065
val Loss: 1.2257 Acc: 0.8203
Epoch 36/57
----------
train Loss: 1.3724 Acc: 0.9149
val Loss: 1.2007 Acc: 0.8281
Epoch 37/57
----------
train Loss: 1.0800 Acc: 0.9416
val Loss: 1.2235 Acc: 0.8203
Epoch 38/57
----------
train Loss: 1.1751 Acc: 0.9366
val Loss: 1.2016 Acc: 0.8203
Epoch 39/57
----------
train Loss: 1.3777 Acc: 0.8998
val Loss: 1.1981 Acc: 0.8047
Epoch 40/57
----------
train Loss: 1.3261 Acc: 0.9265
val Loss: 1.1950 Acc: 0.8203
Epoch 41/57
----------
train Loss: 1.1097 Acc: 0.9566
val Loss: 1.1856 Acc: 0.8516
Epoch 42/57
----------
train Loss: 1.2480 Acc: 0.9165
val Loss: 1.2140 Acc: 0.8203
Epoch 43/57
----------
train Loss: 1.3164 Acc: 0.8948
val Loss: 1.2135 Acc: 0.8125
Epoch 44/57
----------
train Loss: 1.2596 Acc: 0.9182
val Loss: 1.2202 Acc: 0.8359
Epoch 45/57
----------
train Loss: 1.2388 Acc: 0.9032
val Loss: 1.1981 Acc: 0.8203
Epoch 46/57
----------
train Loss: 1.2738 Acc: 0.8932
val Loss: 1.2276 Acc: 0.8125
Epoch 47/57
----------
train Loss: 1.2314 Acc: 0.9265
val Loss: 1.2131 Acc: 0.8203
Epoch 48/57
----------
train Loss: 1.0470 Acc: 0.9449
val Loss: 1.2041 Acc: 0.8203
Epoch 49/57
----------
train Loss: 1.2426 Acc: 0.9432
val Loss: 1.2118 Acc: 0.7891
Epoch 50/57
----------
train Loss: 1.2233 Acc: 0.9282
val Loss: 1.1921 Acc: 0.8125
Epoch 51/57
----------
train Loss: 1.2534 Acc: 0.9082
val Loss: 1.2000 Acc: 0.8359
Epoch 52/57
----------
train Loss: 1.2887 Acc: 0.8998
val Loss: 1.1995 Acc: 0.8281
Epoch 53/57
----------
train Loss: 1.3963 Acc: 0.8915
val Loss: 1.2675 Acc: 0.8047
Epoch 54/57
----------
train Loss: 1.2142 Acc: 0.8948
val Loss: 1.2278 Acc: 0.8125
Epoch 55/57
----------
train Loss: 1.3810 Acc: 0.8715
val Loss: 1.2149 Acc: 0.8203
Epoch 56/57
----------
train Loss: 1.1612 Acc: 0.9633
val Loss: 1.2121 Acc: 0.8203
Epoch 57/57
----------
train Loss: 1.1811 Acc: 0.9432
[I 2024-10-15 16:47:49,545] Trial 95 finished with value: 0.8046875 and parameters: {'batch_size': 93, 'lr': 1.112638715180919e-05, 'num_epochs': 57, 'weight_decay': 0.0044260788769253994, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.2063 Acc: 0.8047
Best val Acc: 0.804688
Model weights saved at ./model_weights/ResNet34_bs_93_lr_1.112638715180919e-05_epoch_57_wd_0.0044260788769253994_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/48
----------
train Loss: 0.8547 Acc: 0.6761
val Loss: 1.1451 Acc: 0.6953
Epoch 2/48
----------
train Loss: 0.5367 Acc: 0.8230
val Loss: 0.7643 Acc: 0.7422
Epoch 3/48
----------
train Loss: 0.3679 Acc: 0.8681
val Loss: 0.9345 Acc: 0.7109
Epoch 4/48
----------
train Loss: 0.2737 Acc: 0.8982
val Loss: 0.7090 Acc: 0.7578
Epoch 5/48
----------
train Loss: 0.2274 Acc: 0.9265
val Loss: 0.9791 Acc: 0.7031
Epoch 6/48
----------
train Loss: 0.1732 Acc: 0.9416
val Loss: 0.4764 Acc: 0.8203
Epoch 7/48
----------
train Loss: 0.1087 Acc: 0.9683
val Loss: 0.7311 Acc: 0.8047
Epoch 8/48
----------
train Loss: 0.1596 Acc: 0.9432
val Loss: 0.9674 Acc: 0.7578
Epoch 9/48
----------
train Loss: 0.1524 Acc: 0.9416
val Loss: 0.6427 Acc: 0.7812
Epoch 10/48
----------
train Loss: 0.1007 Acc: 0.9649
val Loss: 0.6483 Acc: 0.7812
Epoch 11/48
----------
train Loss: 0.0867 Acc: 0.9716
val Loss: 0.8953 Acc: 0.7578
Epoch 12/48
----------
train Loss: 0.0749 Acc: 0.9783
val Loss: 0.7248 Acc: 0.8047
Epoch 13/48
----------
train Loss: 0.1267 Acc: 0.9616
val Loss: 1.6957 Acc: 0.6875
Epoch 14/48
----------
train Loss: 0.1950 Acc: 0.9366
val Loss: 1.4553 Acc: 0.7656
Epoch 15/48
----------
train Loss: 0.0984 Acc: 0.9616
val Loss: 1.2026 Acc: 0.7031
Epoch 16/48
----------
train Loss: 0.1074 Acc: 0.9699
val Loss: 0.7106 Acc: 0.7891
Epoch 17/48
----------
train Loss: 0.0881 Acc: 0.9733
val Loss: 0.6224 Acc: 0.8047
Epoch 18/48
----------
train Loss: 0.0554 Acc: 0.9833
val Loss: 0.9415 Acc: 0.7969
Epoch 19/48
----------
train Loss: 0.0280 Acc: 0.9883
val Loss: 0.9170 Acc: 0.7656
Epoch 20/48
----------
train Loss: 0.0215 Acc: 0.9967
val Loss: 0.7891 Acc: 0.8047
Epoch 21/48
----------
train Loss: 0.0234 Acc: 0.9917
val Loss: 0.9706 Acc: 0.7734
Epoch 22/48
----------
train Loss: 0.0129 Acc: 0.9950
val Loss: 0.7590 Acc: 0.8125
Epoch 23/48
----------
train Loss: 0.0172 Acc: 0.9933
val Loss: 0.8995 Acc: 0.7969
Epoch 24/48
----------
train Loss: 0.0113 Acc: 0.9950
val Loss: 0.6987 Acc: 0.7891
Epoch 25/48
----------
train Loss: 0.0129 Acc: 0.9950
val Loss: 1.0381 Acc: 0.7891
Epoch 26/48
----------
train Loss: 0.0189 Acc: 0.9933
val Loss: 0.8330 Acc: 0.8203
Epoch 27/48
----------
train Loss: 0.1174 Acc: 0.9616
val Loss: 1.2470 Acc: 0.7188
Epoch 28/48
----------
train Loss: 0.0392 Acc: 0.9833
val Loss: 0.9537 Acc: 0.8203
Epoch 29/48
----------
train Loss: 0.0331 Acc: 0.9866
val Loss: 0.7395 Acc: 0.8359
Epoch 30/48
----------
train Loss: 0.0354 Acc: 0.9917
val Loss: 0.9515 Acc: 0.7969
Epoch 31/48
----------
train Loss: 0.0859 Acc: 0.9683
val Loss: 1.3225 Acc: 0.7344
Epoch 32/48
----------
train Loss: 0.0988 Acc: 0.9699
val Loss: 1.8679 Acc: 0.6484
Epoch 33/48
----------
train Loss: 0.1411 Acc: 0.9583
val Loss: 0.9060 Acc: 0.7812
Epoch 34/48
----------
train Loss: 0.0831 Acc: 0.9750
val Loss: 0.7084 Acc: 0.8125
Epoch 35/48
----------
train Loss: 0.0658 Acc: 0.9750
val Loss: 0.8175 Acc: 0.7969
Epoch 36/48
----------
train Loss: 0.0524 Acc: 0.9766
val Loss: 0.8656 Acc: 0.7969
Epoch 37/48
----------
train Loss: 0.0465 Acc: 0.9833
val Loss: 0.6813 Acc: 0.8281
Epoch 38/48
----------
train Loss: 0.0236 Acc: 0.9917
val Loss: 0.6492 Acc: 0.8125
Epoch 39/48
----------
train Loss: 0.0285 Acc: 0.9883
val Loss: 0.8894 Acc: 0.7969
Epoch 40/48
----------
train Loss: 0.0163 Acc: 0.9950
val Loss: 0.8023 Acc: 0.8281
Epoch 41/48
----------
train Loss: 0.0104 Acc: 0.9950
val Loss: 0.9024 Acc: 0.7969
Epoch 42/48
----------
train Loss: 0.0126 Acc: 0.9967
val Loss: 0.7475 Acc: 0.8359
Epoch 43/48
----------
train Loss: 0.0130 Acc: 0.9950
val Loss: 0.6270 Acc: 0.8359
Epoch 44/48
----------
train Loss: 0.0565 Acc: 0.9866
val Loss: 1.0221 Acc: 0.7891
Epoch 45/48
----------
train Loss: 0.0457 Acc: 0.9833
val Loss: 0.7451 Acc: 0.7344
Epoch 46/48
----------
train Loss: 0.0285 Acc: 0.9883
val Loss: 1.0209 Acc: 0.7734
Epoch 47/48
----------
train Loss: 0.0166 Acc: 0.9917
val Loss: 1.2132 Acc: 0.7109
Epoch 48/48
----------
train Loss: 0.0397 Acc: 0.9850
[I 2024-10-15 16:51:27,881] Trial 96 finished with value: 0.8046875 and parameters: {'batch_size': 52, 'lr': 0.00048775592389196216, 'num_epochs': 48, 'weight_decay': 0.00010415018764907694, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 1.1131 Acc: 0.8047
Best val Acc: 0.804688
Model weights saved at ./model_weights/ResNet34_bs_52_lr_0.00048775592389196216_epoch_48_wd_0.00010415018764907694_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/60
----------
train Loss: 4.7632 Acc: 0.3489
val Loss: 3.5431 Acc: 0.6484
Epoch 2/60
----------
train Loss: 3.1344 Acc: 0.6761
val Loss: 2.3522 Acc: 0.7344
Epoch 3/60
----------
train Loss: 2.3291 Acc: 0.7646
val Loss: 1.9073 Acc: 0.7812
Epoch 4/60
----------
train Loss: 2.0815 Acc: 0.7629
val Loss: 1.6430 Acc: 0.7812
Epoch 5/60
----------
train Loss: 1.7819 Acc: 0.7963
val Loss: 1.4826 Acc: 0.8047
Epoch 6/60
----------
train Loss: 1.6847 Acc: 0.8147
val Loss: 1.3972 Acc: 0.7734
Epoch 7/60
----------
train Loss: 1.5265 Acc: 0.8681
val Loss: 1.3918 Acc: 0.7656
Epoch 8/60
----------
train Loss: 1.4851 Acc: 0.8765
val Loss: 1.3520 Acc: 0.7734
Epoch 9/60
----------
train Loss: 1.5267 Acc: 0.8681
val Loss: 1.3901 Acc: 0.7734
Epoch 10/60
----------
train Loss: 1.4297 Acc: 0.8681
val Loss: 1.3019 Acc: 0.7969
Epoch 11/60
----------
train Loss: 1.1909 Acc: 0.9182
val Loss: 1.3047 Acc: 0.7969
Epoch 12/60
----------
train Loss: 1.4617 Acc: 0.8164
val Loss: 1.2701 Acc: 0.8047
Epoch 13/60
----------
train Loss: 1.2617 Acc: 0.8948
val Loss: 1.2890 Acc: 0.7969
Epoch 14/60
----------
train Loss: 1.4606 Acc: 0.8731
val Loss: 1.2910 Acc: 0.8047
Epoch 15/60
----------
train Loss: 1.1600 Acc: 0.9282
val Loss: 1.2773 Acc: 0.7969
Epoch 16/60
----------
train Loss: 1.4165 Acc: 0.8214
val Loss: 1.2837 Acc: 0.7891
Epoch 17/60
----------
train Loss: 1.3827 Acc: 0.8464
val Loss: 1.3423 Acc: 0.7812
Epoch 18/60
----------
train Loss: 1.3284 Acc: 0.8948
val Loss: 1.2973 Acc: 0.7891
Epoch 19/60
----------
train Loss: 1.2755 Acc: 0.8998
val Loss: 1.2278 Acc: 0.7969
Epoch 20/60
----------
train Loss: 1.2571 Acc: 0.8614
val Loss: 1.1792 Acc: 0.8125
Epoch 21/60
----------
train Loss: 1.4361 Acc: 0.8548
val Loss: 1.2665 Acc: 0.7812
Epoch 22/60
----------
train Loss: 1.1261 Acc: 0.9199
val Loss: 1.2406 Acc: 0.8047
Epoch 23/60
----------
train Loss: 1.1202 Acc: 0.9215
val Loss: 1.2093 Acc: 0.7969
Epoch 24/60
----------
train Loss: 1.2924 Acc: 0.9082
val Loss: 1.1592 Acc: 0.7969
Epoch 25/60
----------
train Loss: 1.0777 Acc: 0.9432
val Loss: 1.1424 Acc: 0.7969
Epoch 26/60
----------
train Loss: 1.2579 Acc: 0.9182
val Loss: 1.1326 Acc: 0.8203
Epoch 27/60
----------
train Loss: 1.1667 Acc: 0.9349
val Loss: 1.1115 Acc: 0.8203
Epoch 28/60
----------
train Loss: 1.3019 Acc: 0.9032
val Loss: 1.0902 Acc: 0.8359
Epoch 29/60
----------
train Loss: 1.1547 Acc: 0.9182
val Loss: 1.0382 Acc: 0.7969
Epoch 30/60
----------
train Loss: 1.1334 Acc: 0.9482
val Loss: 1.1360 Acc: 0.8281
Epoch 31/60
----------
train Loss: 1.2671 Acc: 0.9032
val Loss: 1.1593 Acc: 0.8125
Epoch 32/60
----------
train Loss: 1.2697 Acc: 0.8831
val Loss: 1.1807 Acc: 0.7969
Epoch 33/60
----------
train Loss: 1.1916 Acc: 0.9098
val Loss: 1.0980 Acc: 0.8047
Epoch 34/60
----------
train Loss: 1.0809 Acc: 0.9282
val Loss: 1.1393 Acc: 0.7891
Epoch 35/60
----------
train Loss: 1.2867 Acc: 0.8798
val Loss: 1.1670 Acc: 0.8047
Epoch 36/60
----------
train Loss: 1.0895 Acc: 0.9599
val Loss: 1.2260 Acc: 0.7891
Epoch 37/60
----------
train Loss: 1.1385 Acc: 0.9399
val Loss: 1.2295 Acc: 0.8047
Epoch 38/60
----------
train Loss: 1.0970 Acc: 0.9316
val Loss: 1.1620 Acc: 0.8047
Epoch 39/60
----------
train Loss: 1.2691 Acc: 0.9048
val Loss: 1.1881 Acc: 0.7891
Epoch 40/60
----------
train Loss: 1.0809 Acc: 0.9533
val Loss: 1.1798 Acc: 0.8125
Epoch 41/60
----------
train Loss: 1.1101 Acc: 0.9733
val Loss: 1.1189 Acc: 0.7969
Epoch 42/60
----------
train Loss: 1.0147 Acc: 0.9533
val Loss: 1.1550 Acc: 0.8047
Epoch 43/60
----------
train Loss: 1.1961 Acc: 0.9282
val Loss: 1.2304 Acc: 0.8125
Epoch 44/60
----------
train Loss: 1.1266 Acc: 0.9583
val Loss: 1.2298 Acc: 0.7969
Epoch 45/60
----------
train Loss: 1.1353 Acc: 0.9399
val Loss: 1.1952 Acc: 0.7969
Epoch 46/60
----------
train Loss: 1.1668 Acc: 0.8965
val Loss: 1.1846 Acc: 0.8047
Epoch 47/60
----------
train Loss: 1.0944 Acc: 0.9115
val Loss: 1.1494 Acc: 0.7969
Epoch 48/60
----------
train Loss: 1.1252 Acc: 0.9132
val Loss: 1.1280 Acc: 0.8203
Epoch 49/60
----------
train Loss: 1.1212 Acc: 0.9249
val Loss: 1.1311 Acc: 0.8047
Epoch 50/60
----------
train Loss: 1.1452 Acc: 0.9115
val Loss: 1.0876 Acc: 0.8125
Epoch 51/60
----------
train Loss: 0.9468 Acc: 0.9633
val Loss: 1.0546 Acc: 0.8203
Epoch 52/60
----------
train Loss: 1.1770 Acc: 0.9232
val Loss: 1.1150 Acc: 0.8359
Epoch 53/60
----------
train Loss: 0.9782 Acc: 0.9282
val Loss: 1.1336 Acc: 0.8203
Epoch 54/60
----------
train Loss: 1.2092 Acc: 0.9199
val Loss: 1.1625 Acc: 0.8125
Epoch 55/60
----------
train Loss: 1.0785 Acc: 0.9249
val Loss: 1.1129 Acc: 0.8125
Epoch 56/60
----------
train Loss: 1.1110 Acc: 0.9282
val Loss: 1.0279 Acc: 0.8125
Epoch 57/60
----------
train Loss: 1.0985 Acc: 0.9499
val Loss: 1.1069 Acc: 0.8047
Epoch 58/60
----------
train Loss: 1.1654 Acc: 0.8681
val Loss: 1.0576 Acc: 0.8203
Epoch 59/60
----------
train Loss: 1.0299 Acc: 0.9098
val Loss: 1.0092 Acc: 0.8281
Epoch 60/60
----------
train Loss: 1.1059 Acc: 0.8965
[I 2024-10-15 16:55:54,347] Trial 97 finished with value: 0.8203125 and parameters: {'batch_size': 116, 'lr': 2.8323036852568326e-05, 'num_epochs': 60, 'weight_decay': 0.00042426109156607693, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.1461 Acc: 0.8203
Best val Acc: 0.820312
Model weights saved at ./model_weights/ResNet34_bs_116_lr_2.8323036852568326e-05_epoch_60_wd_0.00042426109156607693_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/51
----------
train Loss: 0.7409 Acc: 0.1770
val Loss: 0.7533 Acc: 0.1641
Epoch 2/51
----------
train Loss: 0.7073 Acc: 0.2204
val Loss: 0.6945 Acc: 0.1875
Epoch 3/51
----------
train Loss: 0.6765 Acc: 0.3088
val Loss: 0.6631 Acc: 0.2812
Epoch 4/51
----------
train Loss: 0.6493 Acc: 0.4224
val Loss: 0.6327 Acc: 0.3750
Epoch 5/51
----------
train Loss: 0.6243 Acc: 0.4958
val Loss: 0.6057 Acc: 0.4766
Epoch 6/51
----------
train Loss: 0.6023 Acc: 0.5593
val Loss: 0.5746 Acc: 0.5781
Epoch 7/51
----------
train Loss: 0.5710 Acc: 0.6260
val Loss: 0.5548 Acc: 0.6328
Epoch 8/51
----------
train Loss: 0.5565 Acc: 0.6361
val Loss: 0.5344 Acc: 0.6562
Epoch 9/51
----------
train Loss: 0.5411 Acc: 0.6978
val Loss: 0.5100 Acc: 0.6797
Epoch 10/51
----------
train Loss: 0.5201 Acc: 0.7162
val Loss: 0.4913 Acc: 0.6953
Epoch 11/51
----------
train Loss: 0.4949 Acc: 0.7663
val Loss: 0.4752 Acc: 0.7266
Epoch 12/51
----------
train Loss: 0.4937 Acc: 0.7312
val Loss: 0.4597 Acc: 0.7344
Epoch 13/51
----------
train Loss: 0.4698 Acc: 0.7980
val Loss: 0.4462 Acc: 0.7500
Epoch 14/51
----------
train Loss: 0.4459 Acc: 0.7930
val Loss: 0.4238 Acc: 0.7734
Epoch 15/51
----------
train Loss: 0.4494 Acc: 0.7913
val Loss: 0.4167 Acc: 0.7656
Epoch 16/51
----------
train Loss: 0.4323 Acc: 0.7963
val Loss: 0.3987 Acc: 0.7500
Epoch 17/51
----------
train Loss: 0.4128 Acc: 0.8097
val Loss: 0.3863 Acc: 0.7812
Epoch 18/51
----------
train Loss: 0.4140 Acc: 0.7896
val Loss: 0.3704 Acc: 0.7969
Epoch 19/51
----------
train Loss: 0.4097 Acc: 0.7780
val Loss: 0.3677 Acc: 0.8047
Epoch 20/51
----------
train Loss: 0.3804 Acc: 0.7930
val Loss: 0.3592 Acc: 0.7969
Epoch 21/51
----------
train Loss: 0.3735 Acc: 0.8331
val Loss: 0.3560 Acc: 0.7891
Epoch 22/51
----------
train Loss: 0.3912 Acc: 0.7880
val Loss: 0.3404 Acc: 0.8047
Epoch 23/51
----------
train Loss: 0.3700 Acc: 0.8097
val Loss: 0.3348 Acc: 0.8281
Epoch 24/51
----------
train Loss: 0.3643 Acc: 0.8197
val Loss: 0.3313 Acc: 0.8125
Epoch 25/51
----------
train Loss: 0.3630 Acc: 0.7880
val Loss: 0.3220 Acc: 0.8438
Epoch 26/51
----------
train Loss: 0.3627 Acc: 0.8247
val Loss: 0.3164 Acc: 0.8281
Epoch 27/51
----------
train Loss: 0.3443 Acc: 0.8715
val Loss: 0.3114 Acc: 0.8438
Epoch 28/51
----------
train Loss: 0.3377 Acc: 0.8464
val Loss: 0.3090 Acc: 0.8203
Epoch 29/51
----------
train Loss: 0.3345 Acc: 0.8314
val Loss: 0.2985 Acc: 0.8516
Epoch 30/51
----------
train Loss: 0.3297 Acc: 0.8214
val Loss: 0.2925 Acc: 0.8438
Epoch 31/51
----------
train Loss: 0.3001 Acc: 0.8781
val Loss: 0.2912 Acc: 0.8438
Epoch 32/51
----------
train Loss: 0.3054 Acc: 0.8698
val Loss: 0.2873 Acc: 0.8359
Epoch 33/51
----------
train Loss: 0.3032 Acc: 0.8631
val Loss: 0.2788 Acc: 0.8438
Epoch 34/51
----------
train Loss: 0.3151 Acc: 0.8447
val Loss: 0.2762 Acc: 0.8516
Epoch 35/51
----------
train Loss: 0.3179 Acc: 0.8130
val Loss: 0.2745 Acc: 0.8516
Epoch 36/51
----------
train Loss: 0.2765 Acc: 0.9065
val Loss: 0.2681 Acc: 0.8594
Epoch 37/51
----------
train Loss: 0.3094 Acc: 0.8514
val Loss: 0.2695 Acc: 0.8438
Epoch 38/51
----------
train Loss: 0.3010 Acc: 0.8548
val Loss: 0.2627 Acc: 0.8516
Epoch 39/51
----------
train Loss: 0.2996 Acc: 0.8548
val Loss: 0.2623 Acc: 0.8672
Epoch 40/51
----------
train Loss: 0.2934 Acc: 0.8698
val Loss: 0.2602 Acc: 0.8672
Epoch 41/51
----------
train Loss: 0.2751 Acc: 0.8815
val Loss: 0.2572 Acc: 0.8594
Epoch 42/51
----------
train Loss: 0.2986 Acc: 0.8531
val Loss: 0.2546 Acc: 0.8672
Epoch 43/51
----------
train Loss: 0.2846 Acc: 0.8581
val Loss: 0.2528 Acc: 0.8672
Epoch 44/51
----------
train Loss: 0.2968 Acc: 0.8815
val Loss: 0.2492 Acc: 0.8672
Epoch 45/51
----------
train Loss: 0.2858 Acc: 0.8614
val Loss: 0.2498 Acc: 0.8672
Epoch 46/51
----------
train Loss: 0.2658 Acc: 0.9032
val Loss: 0.2475 Acc: 0.8672
Epoch 47/51
----------
train Loss: 0.2680 Acc: 0.8664
val Loss: 0.2446 Acc: 0.8672
Epoch 48/51
----------
train Loss: 0.2599 Acc: 0.9098
val Loss: 0.2412 Acc: 0.8672
Epoch 49/51
----------
train Loss: 0.2613 Acc: 0.9015
val Loss: 0.2394 Acc: 0.8672
Epoch 50/51
----------
train Loss: 0.2798 Acc: 0.8848
val Loss: 0.2405 Acc: 0.8672
Epoch 51/51
----------
train Loss: 0.2658 Acc: 0.8915
[I 2024-10-15 16:59:42,393] Trial 98 finished with value: 0.859375 and parameters: {'batch_size': 79, 'lr': 3.034549111587444e-06, 'num_epochs': 51, 'weight_decay': 0.0022160670745750947, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 0.2396 Acc: 0.8594
Best val Acc: 0.859375
Model weights saved at ./model_weights/ResNet34_bs_79_lr_3.034549111587444e-06_epoch_51_wd_0.0022160670745750947_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/63
----------
train Loss: 4.9160 Acc: 0.3689
val Loss: 4.5555 Acc: 0.4609
Epoch 2/63
----------
train Loss: 2.8567 Acc: 0.6811
val Loss: 3.9620 Acc: 0.5781
Epoch 3/63
----------
train Loss: 1.8575 Acc: 0.7780
val Loss: 3.6414 Acc: 0.6250
Epoch 4/63
----------
train Loss: 1.2870 Acc: 0.8631
val Loss: 3.3794 Acc: 0.6719
Epoch 5/63
----------
train Loss: 0.9602 Acc: 0.9232
val Loss: 3.3297 Acc: 0.7109
Epoch 6/63
----------
train Loss: 0.7032 Acc: 0.9549
val Loss: 3.2125 Acc: 0.7422
Epoch 7/63
----------
train Loss: 0.4918 Acc: 0.9733
val Loss: 3.2364 Acc: 0.7656
Epoch 8/63
----------
train Loss: 0.3915 Acc: 0.9850
val Loss: 3.2086 Acc: 0.7734
Epoch 9/63
----------
train Loss: 0.3014 Acc: 0.9900
val Loss: 3.1949 Acc: 0.7812
Epoch 10/63
----------
train Loss: 0.2273 Acc: 0.9933
val Loss: 3.3803 Acc: 0.7656
Epoch 11/63
----------
train Loss: 0.1965 Acc: 0.9933
val Loss: 3.4043 Acc: 0.7656
Epoch 12/63
----------
train Loss: 0.1975 Acc: 0.9917
val Loss: 3.4067 Acc: 0.7812
Epoch 13/63
----------
train Loss: 0.1553 Acc: 0.9950
val Loss: 3.4410 Acc: 0.7656
Epoch 14/63
----------
train Loss: 0.1418 Acc: 0.9983
val Loss: 3.3289 Acc: 0.7656
Epoch 15/63
----------
train Loss: 0.1373 Acc: 0.9967
val Loss: 3.3604 Acc: 0.7656
Epoch 16/63
----------
train Loss: 0.1101 Acc: 0.9967
val Loss: 3.4716 Acc: 0.7578
Epoch 17/63
----------
train Loss: 0.1140 Acc: 0.9933
val Loss: 3.6036 Acc: 0.7812
Epoch 18/63
----------
train Loss: 0.0992 Acc: 0.9967
val Loss: 3.5947 Acc: 0.7656
Epoch 19/63
----------
train Loss: 0.0942 Acc: 0.9950
val Loss: 3.5007 Acc: 0.7734
Epoch 20/63
----------
train Loss: 0.0919 Acc: 0.9950
val Loss: 3.6195 Acc: 0.7812
Epoch 21/63
----------
train Loss: 0.0907 Acc: 0.9950
val Loss: 3.5317 Acc: 0.8047
Epoch 22/63
----------
train Loss: 0.0902 Acc: 0.9933
val Loss: 3.6066 Acc: 0.7812
Epoch 23/63
----------
train Loss: 0.0821 Acc: 0.9950
val Loss: 3.6337 Acc: 0.7812
Epoch 24/63
----------
train Loss: 0.0714 Acc: 0.9967
val Loss: 3.6970 Acc: 0.8047
Epoch 25/63
----------
train Loss: 0.0682 Acc: 0.9950
val Loss: 3.7897 Acc: 0.8047
Epoch 26/63
----------
train Loss: 0.0790 Acc: 0.9967
val Loss: 3.7842 Acc: 0.7969
Epoch 27/63
----------
train Loss: 0.0792 Acc: 0.9933
val Loss: 3.5388 Acc: 0.7812
Epoch 28/63
----------
train Loss: 0.0685 Acc: 0.9950
val Loss: 3.8416 Acc: 0.7969
Epoch 29/63
----------
train Loss: 0.0484 Acc: 0.9983
val Loss: 3.7222 Acc: 0.8047
Epoch 30/63
----------
train Loss: 0.0551 Acc: 0.9950
val Loss: 3.6773 Acc: 0.7969
Epoch 31/63
----------
train Loss: 0.0750 Acc: 0.9933
val Loss: 4.0079 Acc: 0.7891
Epoch 32/63
----------
train Loss: 0.0708 Acc: 0.9950
val Loss: 3.7335 Acc: 0.7969
Epoch 33/63
----------
train Loss: 0.0475 Acc: 0.9967
val Loss: 3.7375 Acc: 0.8047
Epoch 34/63
----------
train Loss: 0.0553 Acc: 0.9950
val Loss: 3.5852 Acc: 0.7969
Epoch 35/63
----------
train Loss: 0.0480 Acc: 0.9967
val Loss: 3.7959 Acc: 0.7969
Epoch 36/63
----------
train Loss: 0.0709 Acc: 0.9950
val Loss: 4.0181 Acc: 0.7969
Epoch 37/63
----------
train Loss: 0.0589 Acc: 0.9967
val Loss: 3.8643 Acc: 0.7734
Epoch 38/63
----------
train Loss: 0.0543 Acc: 0.9967
val Loss: 3.9147 Acc: 0.7812
Epoch 39/63
----------
train Loss: 0.0590 Acc: 0.9967
val Loss: 3.9207 Acc: 0.7969
Epoch 40/63
----------
train Loss: 0.0574 Acc: 0.9950
val Loss: 3.8717 Acc: 0.7969
Epoch 41/63
----------
train Loss: 0.0410 Acc: 0.9967
val Loss: 3.8745 Acc: 0.8047
Epoch 42/63
----------
train Loss: 0.0449 Acc: 0.9950
val Loss: 3.7261 Acc: 0.7969
Epoch 43/63
----------
train Loss: 0.0402 Acc: 0.9967
val Loss: 3.9342 Acc: 0.8047
Epoch 44/63
----------
train Loss: 0.0372 Acc: 0.9950
val Loss: 3.9168 Acc: 0.8125
Epoch 45/63
----------
train Loss: 0.0425 Acc: 0.9967
val Loss: 4.1000 Acc: 0.8125
Epoch 46/63
----------
train Loss: 0.0431 Acc: 0.9967
val Loss: 4.0565 Acc: 0.8281
Epoch 47/63
----------
train Loss: 0.0416 Acc: 0.9950
val Loss: 4.1186 Acc: 0.8125
Epoch 48/63
----------
train Loss: 0.0408 Acc: 0.9967
val Loss: 3.8937 Acc: 0.7969
Epoch 49/63
----------
train Loss: 0.0401 Acc: 0.9950
val Loss: 4.1299 Acc: 0.8125
Epoch 50/63
----------
train Loss: 0.0395 Acc: 0.9967
val Loss: 4.3168 Acc: 0.8047
Epoch 51/63
----------
train Loss: 0.0340 Acc: 0.9967
val Loss: 3.9295 Acc: 0.7969
Epoch 52/63
----------
train Loss: 0.0390 Acc: 0.9967
val Loss: 3.9584 Acc: 0.7969
Epoch 53/63
----------
train Loss: 0.0441 Acc: 0.9950
val Loss: 4.2942 Acc: 0.7969
Epoch 54/63
----------
train Loss: 0.0332 Acc: 0.9967
val Loss: 4.2963 Acc: 0.8203
Epoch 55/63
----------
train Loss: 0.0310 Acc: 0.9967
val Loss: 4.0893 Acc: 0.7969
Epoch 56/63
----------
train Loss: 0.0410 Acc: 0.9950
val Loss: 4.0936 Acc: 0.7969
Epoch 57/63
----------
train Loss: 0.0373 Acc: 0.9967
val Loss: 3.9400 Acc: 0.7969
Epoch 58/63
----------
train Loss: 0.0399 Acc: 0.9983
val Loss: 4.0520 Acc: 0.8125
Epoch 59/63
----------
train Loss: 0.0367 Acc: 0.9950
val Loss: 4.3162 Acc: 0.8203
Epoch 60/63
----------
train Loss: 0.0365 Acc: 0.9967
val Loss: 4.0205 Acc: 0.7969
Epoch 61/63
----------
train Loss: 0.0339 Acc: 0.9950
val Loss: 4.1245 Acc: 0.8125
Epoch 62/63
----------
train Loss: 0.0418 Acc: 0.9967
val Loss: 4.1338 Acc: 0.7969
Epoch 63/63
----------
train Loss: 0.0331 Acc: 0.9967
[I 2024-10-15 17:04:25,867] Trial 99 finished with value: 0.8046875 and parameters: {'batch_size': 73, 'lr': 1.4017284132780344e-05, 'num_epochs': 63, 'weight_decay': 0.0008349936620391639, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 4.1420 Acc: 0.8047
Best val Acc: 0.804688
Model weights saved at ./model_weights/ResNet34_bs_73_lr_1.4017284132780344e-05_epoch_63_wd_0.0008349936620391639_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/54
----------
train Loss: 0.4273 Acc: 0.6227
val Loss: 1.5398 Acc: 0.6797
Epoch 2/54
----------
train Loss: 0.3593 Acc: 0.7062
val Loss: 0.4727 Acc: 0.6328
Epoch 3/54
----------
train Loss: 0.3444 Acc: 0.7479
val Loss: 0.3131 Acc: 0.7578
Epoch 4/54
----------
train Loss: 0.3388 Acc: 0.7496
val Loss: 0.3282 Acc: 0.7266
Epoch 5/54
----------
train Loss: 0.3357 Acc: 0.7245
val Loss: 0.3363 Acc: 0.7422
Epoch 6/54
----------
train Loss: 0.3123 Acc: 0.7780
val Loss: 0.4435 Acc: 0.7031
Epoch 7/54
----------
train Loss: 0.3353 Acc: 0.7529
val Loss: 0.3406 Acc: 0.7578
Epoch 8/54
----------
train Loss: 0.3137 Acc: 0.7896
val Loss: 0.3209 Acc: 0.7422
Epoch 9/54
----------
train Loss: 0.3295 Acc: 0.7730
val Loss: 0.3318 Acc: 0.7422
Epoch 10/54
----------
train Loss: 0.2836 Acc: 0.8180
val Loss: 0.3414 Acc: 0.7188
Epoch 11/54
----------
train Loss: 0.2833 Acc: 0.8180
val Loss: 0.2875 Acc: 0.7734
Epoch 12/54
----------
train Loss: 0.2973 Acc: 0.7796
val Loss: 0.3224 Acc: 0.7266
Epoch 13/54
----------
train Loss: 0.3215 Acc: 0.7796
val Loss: 0.4902 Acc: 0.5391
Epoch 14/54
----------
train Loss: 0.3181 Acc: 0.7596
val Loss: 0.2983 Acc: 0.7656
Epoch 15/54
----------
train Loss: 0.3059 Acc: 0.7696
val Loss: 0.3067 Acc: 0.7422
Epoch 16/54
----------
train Loss: 0.2950 Acc: 0.7863
val Loss: 0.2837 Acc: 0.7578
Epoch 17/54
----------
train Loss: 0.3078 Acc: 0.7896
val Loss: 0.3737 Acc: 0.6406
Epoch 18/54
----------
train Loss: 0.2758 Acc: 0.8197
val Loss: 0.3449 Acc: 0.7578
Epoch 19/54
----------
train Loss: 0.2714 Acc: 0.8331
val Loss: 0.4087 Acc: 0.7344
Epoch 20/54
----------
train Loss: 0.2608 Acc: 0.8464
val Loss: 0.3006 Acc: 0.7266
Epoch 21/54
----------
train Loss: 0.2567 Acc: 0.8447
val Loss: 0.3139 Acc: 0.7891
Epoch 22/54
----------
train Loss: 0.2582 Acc: 0.8397
val Loss: 0.3937 Acc: 0.7109
Epoch 23/54
----------
train Loss: 0.2522 Acc: 0.8497
val Loss: 0.2968 Acc: 0.7891
Epoch 24/54
----------
train Loss: 0.2649 Acc: 0.8598
val Loss: 0.3066 Acc: 0.7812
Epoch 25/54
----------
train Loss: 0.2635 Acc: 0.8631
val Loss: 0.3534 Acc: 0.7266
Epoch 26/54
----------
train Loss: 0.2939 Acc: 0.7846
val Loss: 0.3248 Acc: 0.7500
Epoch 27/54
----------
train Loss: 0.2577 Acc: 0.8497
val Loss: 0.3396 Acc: 0.7188
Epoch 28/54
----------
train Loss: 0.2550 Acc: 0.8765
val Loss: 0.3317 Acc: 0.7500
Epoch 29/54
----------
train Loss: 0.2730 Acc: 0.8314
val Loss: 0.3273 Acc: 0.7578
Epoch 30/54
----------
train Loss: 0.1945 Acc: 0.9382
val Loss: 0.3276 Acc: 0.7500
Epoch 31/54
----------
train Loss: 0.2486 Acc: 0.8915
val Loss: 0.3243 Acc: 0.7344
Epoch 32/54
----------
train Loss: 0.2498 Acc: 0.8715
val Loss: 0.3168 Acc: 0.7500
Epoch 33/54
----------
train Loss: 0.2200 Acc: 0.8631
val Loss: 0.3642 Acc: 0.6875
Epoch 34/54
----------
train Loss: 0.2475 Acc: 0.8631
val Loss: 0.3036 Acc: 0.7266
Epoch 35/54
----------
train Loss: 0.2262 Acc: 0.9065
val Loss: 0.3509 Acc: 0.7500
Epoch 36/54
----------
train Loss: 0.2059 Acc: 0.8998
val Loss: 0.3272 Acc: 0.7578
Epoch 37/54
----------
train Loss: 0.2287 Acc: 0.8998
val Loss: 0.3996 Acc: 0.6250
Epoch 38/54
----------
train Loss: 0.2451 Acc: 0.8815
val Loss: 0.2958 Acc: 0.7969
Epoch 39/54
----------
train Loss: 0.2506 Acc: 0.8481
val Loss: 0.3513 Acc: 0.6328
Epoch 40/54
----------
train Loss: 0.2551 Acc: 0.8748
val Loss: 0.3125 Acc: 0.7344
Epoch 41/54
----------
train Loss: 0.2264 Acc: 0.8731
val Loss: 0.3028 Acc: 0.7734
Epoch 42/54
----------
train Loss: 0.2462 Acc: 0.8414
val Loss: 0.3453 Acc: 0.7344
Epoch 43/54
----------
train Loss: 0.2226 Acc: 0.9165
val Loss: 0.3140 Acc: 0.7734
Epoch 44/54
----------
train Loss: 0.2355 Acc: 0.8915
val Loss: 0.3590 Acc: 0.6875
Epoch 45/54
----------
train Loss: 0.2355 Acc: 0.8748
val Loss: 0.3121 Acc: 0.7578
Epoch 46/54
----------
train Loss: 0.2526 Acc: 0.8347
val Loss: 0.3784 Acc: 0.7031
Epoch 47/54
----------
train Loss: 0.2139 Acc: 0.9232
val Loss: 0.3092 Acc: 0.7578
Epoch 48/54
----------
train Loss: 0.2211 Acc: 0.8915
val Loss: 0.3448 Acc: 0.7031
Epoch 49/54
----------
train Loss: 0.2133 Acc: 0.9032
val Loss: 0.3129 Acc: 0.7812
Epoch 50/54
----------
train Loss: 0.2198 Acc: 0.9316
val Loss: 0.3136 Acc: 0.7656
Epoch 51/54
----------
train Loss: 0.2222 Acc: 0.9098
val Loss: 0.5453 Acc: 0.5078
Epoch 52/54
----------
train Loss: 0.2388 Acc: 0.8798
val Loss: 0.3408 Acc: 0.7500
Epoch 53/54
----------
train Loss: 0.2186 Acc: 0.8915
val Loss: 0.3711 Acc: 0.7344
Epoch 54/54
----------
train Loss: 0.2306 Acc: 0.8564
[I 2024-10-15 17:08:26,796] Trial 100 finished with value: 0.765625 and parameters: {'batch_size': 103, 'lr': 0.0008738046402429851, 'num_epochs': 54, 'weight_decay': 0.00014954364355653624, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 0.3309 Acc: 0.7656
Best val Acc: 0.765625
Model weights saved at ./model_weights/ResNet34_bs_103_lr_0.0008738046402429851_epoch_54_wd_0.00014954364355653624_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/65
----------
train Loss: 4.2869 Acc: 0.5359
val Loss: 3.1916 Acc: 0.8438
Epoch 2/65
----------
train Loss: 1.2352 Acc: 0.8681
val Loss: 1.5429 Acc: 0.8281
Epoch 3/65
----------
train Loss: 0.6175 Acc: 0.9299
val Loss: 2.3397 Acc: 0.8750
Epoch 4/65
----------
train Loss: 0.6350 Acc: 0.9299
val Loss: 1.9777 Acc: 0.8125
Epoch 5/65
----------
train Loss: 0.7928 Acc: 0.9416
val Loss: 3.8268 Acc: 0.8516
Epoch 6/65
----------
train Loss: 0.4621 Acc: 0.9482
val Loss: 2.9454 Acc: 0.7578
Epoch 7/65
----------
train Loss: 0.3466 Acc: 0.9516
val Loss: 3.1670 Acc: 0.8516
Epoch 8/65
----------
train Loss: 0.2862 Acc: 0.9666
val Loss: 2.6990 Acc: 0.8672
Epoch 9/65
----------
train Loss: 0.6566 Acc: 0.9165
val Loss: 4.3308 Acc: 0.5547
Epoch 10/65
----------
train Loss: 1.5781 Acc: 0.8648
val Loss: 35.8868 Acc: 0.2734
Epoch 11/65
----------
train Loss: 1.5631 Acc: 0.8331
val Loss: 3.2493 Acc: 0.6328
Epoch 12/65
----------
train Loss: 1.2495 Acc: 0.8881
val Loss: 3.2269 Acc: 0.8438
Epoch 13/65
----------
train Loss: 0.7734 Acc: 0.9032
val Loss: 2.9378 Acc: 0.8359
Epoch 14/65
----------
train Loss: 0.6572 Acc: 0.9332
val Loss: 3.9951 Acc: 0.7969
Epoch 15/65
----------
train Loss: 0.8206 Acc: 0.9048
val Loss: 2.8140 Acc: 0.8281
Epoch 16/65
----------
train Loss: 0.7896 Acc: 0.9048
val Loss: 3.7462 Acc: 0.7969
Epoch 17/65
----------
train Loss: 0.3744 Acc: 0.9633
val Loss: 3.1134 Acc: 0.7578
Epoch 18/65
----------
train Loss: 0.3572 Acc: 0.9633
val Loss: 2.7245 Acc: 0.8984
Epoch 19/65
----------
train Loss: 0.3544 Acc: 0.9649
val Loss: 5.3162 Acc: 0.6797
Epoch 20/65
----------
train Loss: 0.9855 Acc: 0.9182
val Loss: 4.9505 Acc: 0.6875
Epoch 21/65
----------
train Loss: 1.7644 Acc: 0.8397
val Loss: 19.7102 Acc: 0.3281
Epoch 22/65
----------
train Loss: 1.6252 Acc: 0.8414
val Loss: 5.1713 Acc: 0.7734
Epoch 23/65
----------
train Loss: 1.0152 Acc: 0.8898
[I 2024-10-15 17:10:10,936] Trial 101 finished with value: 0.8984375 and parameters: {'batch_size': 65, 'lr': 0.00020540297662962863, 'num_epochs': 65, 'weight_decay': 0.09017367658806462, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 3.8093 Acc: 0.7734
Early stopping at epoch 23 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.898438
Model weights saved at ./model_weights/ResNet34_bs_65_lr_0.00020540297662962863_epoch_65_wd_0.09017367658806462_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/72
----------
train Loss: 3.9519 Acc: 0.5392
val Loss: 3.5432 Acc: 0.7188
Epoch 2/72
----------
train Loss: 0.8924 Acc: 0.8898
val Loss: 3.2632 Acc: 0.7812
Epoch 3/72
----------
train Loss: 0.2879 Acc: 0.9783
val Loss: 3.1290 Acc: 0.8203
Epoch 4/72
----------
train Loss: 0.1363 Acc: 0.9950
val Loss: 4.1138 Acc: 0.7812
Epoch 5/72
----------
train Loss: 0.0843 Acc: 0.9950
val Loss: 4.2965 Acc: 0.7891
Epoch 6/72
----------
train Loss: 0.0942 Acc: 0.9933
val Loss: 4.1277 Acc: 0.8125
Epoch 7/72
----------
train Loss: 0.1591 Acc: 0.9850
val Loss: 4.1018 Acc: 0.8125
Epoch 8/72
----------
train Loss: 0.3713 Acc: 0.9482
val Loss: 5.4269 Acc: 0.7344
Epoch 9/72
----------
train Loss: 0.6837 Acc: 0.9316
val Loss: 5.0341 Acc: 0.5703
Epoch 10/72
----------
train Loss: 1.2983 Acc: 0.8731
val Loss: 7.7807 Acc: 0.6641
Epoch 11/72
----------
train Loss: 0.9926 Acc: 0.8798
val Loss: 4.4064 Acc: 0.7188
Epoch 12/72
----------
train Loss: 0.7555 Acc: 0.9382
[I 2024-10-15 17:11:05,900] Trial 102 finished with value: 0.8125 and parameters: {'batch_size': 66, 'lr': 0.00010478121025752326, 'num_epochs': 72, 'weight_decay': 0.12222531217932861, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 4.2530 Acc: 0.7188
Early stopping at epoch 12 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.812500
Model weights saved at ./model_weights/ResNet34_bs_66_lr_0.00010478121025752326_epoch_72_wd_0.12222531217932861_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/57
----------
train Loss: 4.6385 Acc: 0.5359
val Loss: 2.5804 Acc: 0.7891
Epoch 2/57
----------
train Loss: 1.7237 Acc: 0.7896
val Loss: 5.4332 Acc: 0.5859
Epoch 3/57
----------
train Loss: 1.0020 Acc: 0.8965
val Loss: 1.8833 Acc: 0.8516
Epoch 4/57
----------
train Loss: 0.8605 Acc: 0.8815
val Loss: 4.2360 Acc: 0.7891
Epoch 5/57
----------
train Loss: 1.7874 Acc: 0.8114
val Loss: 3.4954 Acc: 0.6797
Epoch 6/57
----------
train Loss: 1.3512 Acc: 0.8581
val Loss: 3.9702 Acc: 0.7578
Epoch 7/57
----------
train Loss: 0.9467 Acc: 0.8998
val Loss: 2.7529 Acc: 0.7500
Epoch 8/57
----------
train Loss: 0.7451 Acc: 0.9265
val Loss: 4.4452 Acc: 0.8047
Epoch 9/57
----------
train Loss: 0.4031 Acc: 0.9533
val Loss: 1.9238 Acc: 0.8125
Epoch 10/57
----------
train Loss: 0.9602 Acc: 0.8998
val Loss: 7.2218 Acc: 0.4062
Epoch 11/57
----------
train Loss: 1.5895 Acc: 0.8280
val Loss: 2.7058 Acc: 0.8125
Epoch 12/57
----------
train Loss: 0.9902 Acc: 0.8664
val Loss: 2.0340 Acc: 0.7734
Epoch 13/57
----------
train Loss: 0.4986 Acc: 0.9416
val Loss: 2.2513 Acc: 0.7969
Epoch 14/57
----------
train Loss: 0.6516 Acc: 0.9566
val Loss: 2.9720 Acc: 0.6719
Epoch 15/57
----------
train Loss: 1.3937 Acc: 0.8598
val Loss: 49.2505 Acc: 0.2969
Epoch 16/57
----------
train Loss: 1.8546 Acc: 0.8347
val Loss: 5.7142 Acc: 0.7344
Epoch 17/57
----------
train Loss: 1.5011 Acc: 0.8815
val Loss: 3.6176 Acc: 0.5781
Epoch 18/57
----------
train Loss: 1.0660 Acc: 0.8781
val Loss: 2.4680 Acc: 0.8047
Epoch 19/57
----------
train Loss: 1.0223 Acc: 0.8798
val Loss: 7.4237 Acc: 0.6328
Epoch 20/57
----------
train Loss: 0.7235 Acc: 0.9182
val Loss: 5.4148 Acc: 0.7188
Epoch 21/57
----------
train Loss: 0.5941 Acc: 0.9399
val Loss: 2.0406 Acc: 0.8750
Epoch 22/57
----------
train Loss: 0.3539 Acc: 0.9649
val Loss: 3.6248 Acc: 0.7969
Epoch 23/57
----------
train Loss: 0.1835 Acc: 0.9816
val Loss: 2.3117 Acc: 0.7812
Epoch 24/57
----------
train Loss: 0.3515 Acc: 0.9566
val Loss: 3.1683 Acc: 0.8438
Epoch 25/57
----------
train Loss: 0.4505 Acc: 0.9699
val Loss: 4.0359 Acc: 0.6953
Epoch 26/57
----------
train Loss: 1.1643 Acc: 0.8965
val Loss: 6.4617 Acc: 0.6953
Epoch 27/57
----------
train Loss: 1.3666 Acc: 0.8815
val Loss: 7.8444 Acc: 0.5625
Epoch 28/57
----------
train Loss: 1.8999 Acc: 0.8481
val Loss: 3.1452 Acc: 0.7812
Epoch 29/57
----------
train Loss: 1.0677 Acc: 0.8881
[I 2024-10-15 17:13:17,334] Trial 103 finished with value: 0.84375 and parameters: {'batch_size': 97, 'lr': 0.00026849509016996947, 'num_epochs': 57, 'weight_decay': 0.09075264673265807, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 4.4930 Acc: 0.7109
Early stopping at epoch 29 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.843750
Model weights saved at ./model_weights/ResNet34_bs_97_lr_0.00026849509016996947_epoch_57_wd_0.09075264673265807_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/65
----------
train Loss: 3.9422 Acc: 0.5693
val Loss: 3.1296 Acc: 0.6484
Epoch 2/65
----------
train Loss: 1.4500 Acc: 0.8431
val Loss: 3.2234 Acc: 0.7266
Epoch 3/65
----------
train Loss: 0.6847 Acc: 0.9265
val Loss: 3.9926 Acc: 0.7891
Epoch 4/65
----------
train Loss: 0.6663 Acc: 0.9399
val Loss: 5.7080 Acc: 0.6172
Epoch 5/65
----------
train Loss: 0.8437 Acc: 0.8948
val Loss: 5.1033 Acc: 0.7266
Epoch 6/65
----------
train Loss: 0.9127 Acc: 0.8982
val Loss: 5.5030 Acc: 0.7344
Epoch 7/65
----------
train Loss: 0.9809 Acc: 0.9032
val Loss: 3.2829 Acc: 0.7578
Epoch 8/65
----------
train Loss: 1.3225 Acc: 0.8915
val Loss: 6.5763 Acc: 0.4375
Epoch 9/65
----------
train Loss: 1.9844 Acc: 0.8364
val Loss: 5.8583 Acc: 0.7031
Epoch 10/65
----------
train Loss: 1.0613 Acc: 0.8848
val Loss: 3.4410 Acc: 0.6797
Epoch 11/65
----------
train Loss: 1.0192 Acc: 0.8932
val Loss: 2.8211 Acc: 0.7656
Epoch 12/65
----------
train Loss: 0.9436 Acc: 0.9015
val Loss: 3.9321 Acc: 0.5625
Epoch 13/65
----------
train Loss: 1.0951 Acc: 0.8898
val Loss: 5.3160 Acc: 0.7891
Epoch 14/65
----------
train Loss: 0.7039 Acc: 0.9149
val Loss: 2.9315 Acc: 0.7734
Epoch 15/65
----------
train Loss: 0.7550 Acc: 0.9098
val Loss: 3.2671 Acc: 0.8281
Epoch 16/65
----------
train Loss: 0.7817 Acc: 0.9215
val Loss: 6.6846 Acc: 0.7969
Epoch 17/65
----------
train Loss: 1.1642 Acc: 0.8781
val Loss: 9.4165 Acc: 0.6641
Epoch 18/65
----------
train Loss: 1.4169 Acc: 0.8447
val Loss: 3.2498 Acc: 0.7891
Epoch 19/65
----------
train Loss: 1.2227 Acc: 0.8848
val Loss: 3.3814 Acc: 0.8047
Epoch 20/65
----------
train Loss: 1.1543 Acc: 0.8748
val Loss: 2.7481 Acc: 0.7422
Epoch 21/65
----------
train Loss: 1.2523 Acc: 0.8898
val Loss: 3.4221 Acc: 0.7344
Epoch 22/65
----------
train Loss: 0.9928 Acc: 0.8881
val Loss: 6.9468 Acc: 0.5078
Epoch 23/65
----------
train Loss: 1.1112 Acc: 0.9149
val Loss: 3.7676 Acc: 0.8281
Epoch 24/65
----------
train Loss: 0.5696 Acc: 0.9432
val Loss: 3.8238 Acc: 0.6953
Epoch 25/65
----------
train Loss: 0.6192 Acc: 0.9399
val Loss: 4.4282 Acc: 0.6172
Epoch 26/65
----------
train Loss: 0.5109 Acc: 0.9366
val Loss: 9.1461 Acc: 0.7578
Epoch 27/65
----------
train Loss: 0.3364 Acc: 0.9649
val Loss: 7.5821 Acc: 0.7969
Epoch 28/65
----------
train Loss: 0.4699 Acc: 0.9499
val Loss: 5.8977 Acc: 0.8438
Epoch 29/65
----------
train Loss: 0.7303 Acc: 0.9332
val Loss: 5.3056 Acc: 0.6172
Epoch 30/65
----------
train Loss: 1.6826 Acc: 0.8514
val Loss: 4.6595 Acc: 0.7422
Epoch 31/65
----------
train Loss: 1.3320 Acc: 0.8664
val Loss: 3.8503 Acc: 0.6250
Epoch 32/65
----------
train Loss: 0.6169 Acc: 0.9399
val Loss: 3.8963 Acc: 0.7969
Epoch 33/65
----------
train Loss: 0.5098 Acc: 0.9499
val Loss: 4.7693 Acc: 0.7031
Epoch 34/65
----------
train Loss: 0.6162 Acc: 0.9366
val Loss: 4.8235 Acc: 0.7500
Epoch 35/65
----------
train Loss: 0.6223 Acc: 0.9533
val Loss: 3.9946 Acc: 0.8047
Epoch 36/65
----------
train Loss: 0.6193 Acc: 0.9366
val Loss: 6.4809 Acc: 0.5703
Epoch 37/65
----------
train Loss: 0.9902 Acc: 0.9132
val Loss: 4.1990 Acc: 0.6250
Epoch 38/65
----------
train Loss: 1.1195 Acc: 0.8798
val Loss: 5.5427 Acc: 0.7891
Epoch 39/65
----------
train Loss: 0.8049 Acc: 0.9282
val Loss: 5.5149 Acc: 0.7891
Epoch 40/65
----------
train Loss: 0.6897 Acc: 0.9282
val Loss: 4.6198 Acc: 0.5469
Epoch 41/65
----------
train Loss: 0.3752 Acc: 0.9583
val Loss: 3.7314 Acc: 0.6484
Epoch 42/65
----------
train Loss: 0.6150 Acc: 0.9416
val Loss: 17.2453 Acc: 0.7031
Epoch 43/65
----------
train Loss: 0.8341 Acc: 0.9115
val Loss: 7.8688 Acc: 0.6797
Epoch 44/65
----------
train Loss: 0.5242 Acc: 0.9416
val Loss: 3.9606 Acc: 0.8281
Epoch 45/65
----------
train Loss: 0.7397 Acc: 0.9082
val Loss: 5.2734 Acc: 0.5781
Epoch 46/65
----------
train Loss: 1.2745 Acc: 0.8831
val Loss: 4.7598 Acc: 0.7656
Epoch 47/65
----------
train Loss: 0.7351 Acc: 0.9032
val Loss: 5.1633 Acc: 0.6953
Epoch 48/65
----------
train Loss: 0.3560 Acc: 0.9716
val Loss: 4.5881 Acc: 0.7266
Epoch 49/65
----------
train Loss: 0.4929 Acc: 0.9566
[I 2024-10-15 17:16:56,919] Trial 104 finished with value: 0.828125 and parameters: {'batch_size': 34, 'lr': 0.0001861030516232393, 'num_epochs': 65, 'weight_decay': 0.19992526937174623, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 4.5016 Acc: 0.7188
Early stopping at epoch 49 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.828125
Model weights saved at ./model_weights/ResNet34_bs_34_lr_0.0001861030516232393_epoch_65_wd_0.19992526937174623_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/43
----------
train Loss: 6.0932 Acc: 0.2137
val Loss: 6.2190 Acc: 0.3203
Epoch 2/43
----------
train Loss: 4.7561 Acc: 0.3406
val Loss: 5.6804 Acc: 0.4297
Epoch 3/43
----------
train Loss: 3.9174 Acc: 0.4741
val Loss: 5.2198 Acc: 0.4688
Epoch 4/43
----------
train Loss: 3.2706 Acc: 0.5927
val Loss: 4.8789 Acc: 0.5156
Epoch 5/43
----------
train Loss: 2.6919 Acc: 0.6628
val Loss: 4.5121 Acc: 0.5547
Epoch 6/43
----------
train Loss: 2.2330 Acc: 0.7212
val Loss: 4.2335 Acc: 0.5859
Epoch 7/43
----------
train Loss: 1.9408 Acc: 0.7863
val Loss: 4.0430 Acc: 0.6406
Epoch 8/43
----------
train Loss: 1.6813 Acc: 0.8063
val Loss: 3.8350 Acc: 0.7031
Epoch 9/43
----------
train Loss: 1.4799 Acc: 0.8531
val Loss: 3.6807 Acc: 0.7344
Epoch 10/43
----------
train Loss: 1.3430 Acc: 0.8614
val Loss: 3.5536 Acc: 0.7422
Epoch 11/43
----------
train Loss: 1.1422 Acc: 0.9098
val Loss: 3.4481 Acc: 0.7578
Epoch 12/43
----------
train Loss: 0.9969 Acc: 0.9382
val Loss: 3.3908 Acc: 0.7578
Epoch 13/43
----------
train Loss: 0.8659 Acc: 0.9399
val Loss: 3.3079 Acc: 0.7656
Epoch 14/43
----------
train Loss: 0.7701 Acc: 0.9516
val Loss: 3.2447 Acc: 0.7812
Epoch 15/43
----------
train Loss: 0.7326 Acc: 0.9466
val Loss: 3.2109 Acc: 0.8047
Epoch 16/43
----------
train Loss: 0.6582 Acc: 0.9683
val Loss: 3.1190 Acc: 0.7969
Epoch 17/43
----------
train Loss: 0.6317 Acc: 0.9583
val Loss: 3.0960 Acc: 0.7891
Epoch 18/43
----------
train Loss: 0.5131 Acc: 0.9883
val Loss: 3.1258 Acc: 0.7969
Epoch 19/43
----------
train Loss: 0.5242 Acc: 0.9783
val Loss: 3.1088 Acc: 0.7891
Epoch 20/43
----------
train Loss: 0.4534 Acc: 0.9800
val Loss: 3.0311 Acc: 0.7969
Epoch 21/43
----------
train Loss: 0.4021 Acc: 0.9850
val Loss: 3.0697 Acc: 0.7969
Epoch 22/43
----------
train Loss: 0.3630 Acc: 0.9866
val Loss: 3.1165 Acc: 0.8047
Epoch 23/43
----------
train Loss: 0.3201 Acc: 0.9917
val Loss: 3.0830 Acc: 0.7891
Epoch 24/43
----------
train Loss: 0.3105 Acc: 0.9883
val Loss: 3.1077 Acc: 0.7891
Epoch 25/43
----------
train Loss: 0.3067 Acc: 0.9883
val Loss: 3.0564 Acc: 0.7891
Epoch 26/43
----------
train Loss: 0.2648 Acc: 0.9900
val Loss: 3.1046 Acc: 0.7891
Epoch 27/43
----------
train Loss: 0.2323 Acc: 0.9900
val Loss: 3.1542 Acc: 0.7891
Epoch 28/43
----------
train Loss: 0.2234 Acc: 0.9917
val Loss: 3.1258 Acc: 0.7891
Epoch 29/43
----------
train Loss: 0.2296 Acc: 0.9933
val Loss: 3.0974 Acc: 0.7812
Epoch 30/43
----------
train Loss: 0.2120 Acc: 0.9917
val Loss: 3.1739 Acc: 0.7891
Epoch 31/43
----------
train Loss: 0.2213 Acc: 0.9900
val Loss: 3.3185 Acc: 0.7969
Epoch 32/43
----------
train Loss: 0.1924 Acc: 0.9900
val Loss: 3.3341 Acc: 0.8047
Epoch 33/43
----------
train Loss: 0.1881 Acc: 0.9917
val Loss: 3.4053 Acc: 0.8047
Epoch 34/43
----------
train Loss: 0.1709 Acc: 0.9933
val Loss: 3.2841 Acc: 0.7969
Epoch 35/43
----------
train Loss: 0.1490 Acc: 0.9900
val Loss: 3.3676 Acc: 0.7969
Epoch 36/43
----------
train Loss: 0.1735 Acc: 0.9917
val Loss: 3.3448 Acc: 0.7969
Epoch 37/43
----------
train Loss: 0.1703 Acc: 0.9917
val Loss: 3.2930 Acc: 0.7969
Epoch 38/43
----------
train Loss: 0.1408 Acc: 0.9933
val Loss: 3.2610 Acc: 0.7891
Epoch 39/43
----------
train Loss: 0.1752 Acc: 0.9917
val Loss: 3.4341 Acc: 0.7891
Epoch 40/43
----------
train Loss: 0.1529 Acc: 0.9917
val Loss: 3.4496 Acc: 0.7969
Epoch 41/43
----------
train Loss: 0.1184 Acc: 0.9950
val Loss: 3.5357 Acc: 0.7969
Epoch 42/43
----------
train Loss: 0.1184 Acc: 0.9933
val Loss: 3.5126 Acc: 0.7969
Epoch 43/43
----------
train Loss: 0.1719 Acc: 0.9933
[I 2024-10-15 17:20:11,152] Trial 105 finished with value: 0.78125 and parameters: {'batch_size': 81, 'lr': 5.251578503210673e-06, 'num_epochs': 43, 'weight_decay': 0.06345644763613245, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 3.3040 Acc: 0.7812
Best val Acc: 0.781250
Model weights saved at ./model_weights/ResNet34_bs_81_lr_5.251578503210673e-06_epoch_43_wd_0.06345644763613245_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/50
----------
train Loss: 5.3689 Acc: 0.2404
val Loss: 4.1411 Acc: 0.3984
Epoch 2/50
----------
train Loss: 2.7911 Acc: 0.5743
val Loss: 3.1154 Acc: 0.5859
Epoch 3/50
----------
train Loss: 1.6987 Acc: 0.7563
val Loss: 2.5423 Acc: 0.7344
Epoch 4/50
----------
train Loss: 1.0841 Acc: 0.8815
val Loss: 2.2912 Acc: 0.7578
Epoch 5/50
----------
train Loss: 0.7860 Acc: 0.9349
val Loss: 2.0942 Acc: 0.7812
Epoch 6/50
----------
train Loss: 0.5162 Acc: 0.9733
val Loss: 2.0169 Acc: 0.8359
Epoch 7/50
----------
train Loss: 0.3315 Acc: 0.9850
val Loss: 2.0036 Acc: 0.8516
Epoch 8/50
----------
train Loss: 0.2728 Acc: 0.9900
val Loss: 2.0097 Acc: 0.8516
Epoch 9/50
----------
train Loss: 0.2624 Acc: 0.9917
val Loss: 2.0211 Acc: 0.8359
Epoch 10/50
----------
train Loss: 0.1899 Acc: 0.9917
val Loss: 2.1816 Acc: 0.8125
Epoch 11/50
----------
train Loss: 0.1626 Acc: 0.9933
val Loss: 2.0959 Acc: 0.8438
Epoch 12/50
----------
train Loss: 0.1138 Acc: 0.9950
val Loss: 2.1582 Acc: 0.8203
Epoch 13/50
----------
train Loss: 0.1252 Acc: 0.9950
val Loss: 2.0428 Acc: 0.8281
Epoch 14/50
----------
train Loss: 0.1240 Acc: 0.9950
val Loss: 2.1813 Acc: 0.8359
Epoch 15/50
----------
train Loss: 0.1256 Acc: 0.9933
val Loss: 2.2653 Acc: 0.8438
Epoch 16/50
----------
train Loss: 0.1101 Acc: 0.9933
val Loss: 2.2649 Acc: 0.8438
Epoch 17/50
----------
train Loss: 0.0974 Acc: 0.9950
val Loss: 2.2947 Acc: 0.8594
Epoch 18/50
----------
train Loss: 0.0890 Acc: 0.9950
val Loss: 2.3076 Acc: 0.8359
Epoch 19/50
----------
train Loss: 0.0975 Acc: 0.9933
val Loss: 2.2483 Acc: 0.8281
Epoch 20/50
----------
train Loss: 0.0750 Acc: 0.9950
val Loss: 2.4980 Acc: 0.8281
Epoch 21/50
----------
train Loss: 0.1009 Acc: 0.9933
val Loss: 2.3075 Acc: 0.8359
Epoch 22/50
----------
train Loss: 0.1116 Acc: 0.9950
val Loss: 2.2115 Acc: 0.8203
Epoch 23/50
----------
train Loss: 0.0677 Acc: 0.9950
val Loss: 2.2279 Acc: 0.8203
Epoch 24/50
----------
train Loss: 0.0881 Acc: 0.9933
val Loss: 2.4484 Acc: 0.8203
Epoch 25/50
----------
train Loss: 0.1089 Acc: 0.9900
val Loss: 2.4531 Acc: 0.8438
Epoch 26/50
----------
train Loss: 0.0661 Acc: 0.9933
val Loss: 2.4251 Acc: 0.8438
Epoch 27/50
----------
train Loss: 0.0758 Acc: 0.9950
val Loss: 2.3935 Acc: 0.8203
Epoch 28/50
----------
train Loss: 0.0615 Acc: 0.9950
val Loss: 2.4257 Acc: 0.8359
Epoch 29/50
----------
train Loss: 0.0715 Acc: 0.9933
val Loss: 2.4320 Acc: 0.8359
Epoch 30/50
----------
train Loss: 0.0615 Acc: 0.9950
val Loss: 2.5326 Acc: 0.8359
Epoch 31/50
----------
train Loss: 0.0627 Acc: 0.9950
val Loss: 2.5633 Acc: 0.8281
Epoch 32/50
----------
train Loss: 0.0989 Acc: 0.9950
val Loss: 2.1937 Acc: 0.8281
Epoch 33/50
----------
train Loss: 0.0692 Acc: 0.9950
val Loss: 2.5201 Acc: 0.8359
Epoch 34/50
----------
train Loss: 0.0530 Acc: 0.9933
val Loss: 2.5192 Acc: 0.8281
Epoch 35/50
----------
train Loss: 0.0635 Acc: 0.9950
val Loss: 2.5414 Acc: 0.8359
Epoch 36/50
----------
train Loss: 0.0911 Acc: 0.9950
val Loss: 2.3309 Acc: 0.8203
Epoch 37/50
----------
train Loss: 0.0544 Acc: 0.9950
val Loss: 2.4012 Acc: 0.8203
Epoch 38/50
----------
train Loss: 0.0625 Acc: 0.9933
val Loss: 2.3690 Acc: 0.8359
Epoch 39/50
----------
train Loss: 0.0641 Acc: 0.9967
val Loss: 2.4450 Acc: 0.8438
Epoch 40/50
----------
train Loss: 0.0744 Acc: 0.9950
val Loss: 2.5110 Acc: 0.8203
Epoch 41/50
----------
train Loss: 0.0940 Acc: 0.9917
val Loss: 2.2478 Acc: 0.8281
Epoch 42/50
----------
train Loss: 0.0508 Acc: 0.9950
val Loss: 2.2965 Acc: 0.8438
Epoch 43/50
----------
train Loss: 0.0472 Acc: 0.9950
val Loss: 2.3480 Acc: 0.8438
Epoch 44/50
----------
train Loss: 0.0604 Acc: 0.9933
val Loss: 2.5032 Acc: 0.8203
Epoch 45/50
----------
train Loss: 0.0486 Acc: 0.9950
val Loss: 2.4547 Acc: 0.8359
Epoch 46/50
----------
train Loss: 0.0690 Acc: 0.9933
val Loss: 2.5508 Acc: 0.8281
Epoch 47/50
----------
train Loss: 0.0532 Acc: 0.9950
val Loss: 2.5547 Acc: 0.8359
Epoch 48/50
----------
train Loss: 0.0455 Acc: 0.9950
val Loss: 2.5778 Acc: 0.8203
Epoch 49/50
----------
train Loss: 0.0492 Acc: 0.9950
val Loss: 2.7280 Acc: 0.8203
Epoch 50/50
----------
train Loss: 0.0452 Acc: 0.9950
[I 2024-10-15 17:23:55,945] Trial 106 finished with value: 0.84375 and parameters: {'batch_size': 91, 'lr': 1.8785249287728325e-05, 'num_epochs': 50, 'weight_decay': 0.03744690641177467, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 2.5523 Acc: 0.8438
Best val Acc: 0.843750
Model weights saved at ./model_weights/ResNet34_bs_91_lr_1.8785249287728325e-05_epoch_50_wd_0.03744690641177467_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/46
----------
train Loss: 5.7008 Acc: 0.1953
val Loss: 5.0391 Acc: 0.2891
Epoch 2/46
----------
train Loss: 5.3598 Acc: 0.2705
val Loss: 4.7818 Acc: 0.3281
Epoch 3/46
----------
train Loss: 5.0515 Acc: 0.3372
val Loss: 4.5696 Acc: 0.3828
Epoch 4/46
----------
train Loss: 4.7605 Acc: 0.3773
val Loss: 4.3161 Acc: 0.4844
Epoch 5/46
----------
train Loss: 4.5003 Acc: 0.4357
val Loss: 4.1205 Acc: 0.5547
Epoch 6/46
----------
train Loss: 4.2429 Acc: 0.5192
val Loss: 3.9003 Acc: 0.5781
Epoch 7/46
----------
train Loss: 4.0537 Acc: 0.5609
val Loss: 3.7070 Acc: 0.6250
Epoch 8/46
----------
train Loss: 3.8532 Acc: 0.6127
val Loss: 3.4857 Acc: 0.6406
Epoch 9/46
----------
train Loss: 3.6023 Acc: 0.6861
val Loss: 3.4328 Acc: 0.6719
Epoch 10/46
----------
train Loss: 3.4633 Acc: 0.6795
val Loss: 3.2741 Acc: 0.7031
Epoch 11/46
----------
train Loss: 3.3319 Acc: 0.6861
val Loss: 3.1030 Acc: 0.7109
Epoch 12/46
----------
train Loss: 3.1030 Acc: 0.7212
val Loss: 3.0017 Acc: 0.7344
Epoch 13/46
----------
train Loss: 3.0201 Acc: 0.7379
val Loss: 2.9189 Acc: 0.7500
Epoch 14/46
----------
train Loss: 2.9140 Acc: 0.7446
val Loss: 2.7550 Acc: 0.7500
Epoch 15/46
----------
train Loss: 2.8679 Acc: 0.7112
val Loss: 2.6869 Acc: 0.7500
Epoch 16/46
----------
train Loss: 2.7185 Acc: 0.7346
val Loss: 2.6138 Acc: 0.7578
Epoch 17/46
----------
train Loss: 2.6269 Acc: 0.7529
val Loss: 2.5889 Acc: 0.7500
Epoch 18/46
----------
train Loss: 2.5980 Acc: 0.7295
val Loss: 2.4675 Acc: 0.7188
Epoch 19/46
----------
train Loss: 2.4571 Acc: 0.7646
val Loss: 2.4201 Acc: 0.7656
Epoch 20/46
----------
train Loss: 2.4261 Acc: 0.7529
val Loss: 2.3750 Acc: 0.7422
Epoch 21/46
----------
train Loss: 2.3240 Acc: 0.7813
val Loss: 2.2922 Acc: 0.7578
Epoch 22/46
----------
train Loss: 2.3201 Acc: 0.7596
val Loss: 2.2462 Acc: 0.7500
Epoch 23/46
----------
train Loss: 2.1541 Acc: 0.7880
val Loss: 2.1813 Acc: 0.7500
Epoch 24/46
----------
train Loss: 2.1341 Acc: 0.7813
val Loss: 2.1313 Acc: 0.7500
Epoch 25/46
----------
train Loss: 2.1873 Acc: 0.7679
val Loss: 2.0802 Acc: 0.7500
Epoch 26/46
----------
train Loss: 2.0156 Acc: 0.8247
val Loss: 2.0508 Acc: 0.7734
Epoch 27/46
----------
train Loss: 2.0476 Acc: 0.7997
val Loss: 2.0047 Acc: 0.7734
Epoch 28/46
----------
train Loss: 2.0330 Acc: 0.8030
val Loss: 1.9658 Acc: 0.7734
Epoch 29/46
----------
train Loss: 1.9189 Acc: 0.8381
val Loss: 1.9286 Acc: 0.7656
Epoch 30/46
----------
train Loss: 1.8237 Acc: 0.8264
val Loss: 1.8772 Acc: 0.7734
Epoch 31/46
----------
train Loss: 1.8465 Acc: 0.8347
val Loss: 1.8456 Acc: 0.7812
Epoch 32/46
----------
train Loss: 1.9568 Acc: 0.7763
val Loss: 1.8113 Acc: 0.7656
Epoch 33/46
----------
train Loss: 1.9224 Acc: 0.7813
val Loss: 1.8140 Acc: 0.7656
Epoch 34/46
----------
train Loss: 1.9189 Acc: 0.7479
val Loss: 1.7759 Acc: 0.7812
Epoch 35/46
----------
train Loss: 1.7990 Acc: 0.8364
val Loss: 1.7659 Acc: 0.7812
Epoch 36/46
----------
train Loss: 1.7972 Acc: 0.7963
val Loss: 1.7281 Acc: 0.7734
Epoch 37/46
----------
train Loss: 1.8231 Acc: 0.8063
val Loss: 1.7213 Acc: 0.7578
Epoch 38/46
----------
train Loss: 1.7263 Acc: 0.8297
val Loss: 1.7071 Acc: 0.7734
Epoch 39/46
----------
train Loss: 1.8525 Acc: 0.8013
val Loss: 1.6913 Acc: 0.7812
Epoch 40/46
----------
train Loss: 1.6684 Acc: 0.8047
val Loss: 1.6825 Acc: 0.7734
Epoch 41/46
----------
train Loss: 1.6056 Acc: 0.8631
val Loss: 1.6567 Acc: 0.7734
Epoch 42/46
----------
train Loss: 1.5762 Acc: 0.8481
val Loss: 1.6443 Acc: 0.7656
Epoch 43/46
----------
train Loss: 1.7049 Acc: 0.8197
val Loss: 1.6473 Acc: 0.7656
Epoch 44/46
----------
train Loss: 1.5908 Acc: 0.8664
val Loss: 1.6243 Acc: 0.7812
Epoch 45/46
----------
train Loss: 1.7225 Acc: 0.8414
val Loss: 1.6093 Acc: 0.7656
Epoch 46/46
----------
train Loss: 1.6023 Acc: 0.8664
[I 2024-10-15 17:27:22,971] Trial 107 finished with value: 0.78125 and parameters: {'batch_size': 85, 'lr': 3.88767003545761e-06, 'num_epochs': 46, 'weight_decay': 0.04767580069100243, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.5878 Acc: 0.7812
Best val Acc: 0.781250
Model weights saved at ./model_weights/ResNet34_bs_85_lr_3.88767003545761e-06_epoch_46_wd_0.04767580069100243_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/56
----------
train Loss: 0.9264 Acc: 0.6210
val Loss: 0.6135 Acc: 0.8047
Epoch 2/56
----------
train Loss: 0.2819 Acc: 0.9366
val Loss: 0.5255 Acc: 0.8359
Epoch 3/56
----------
train Loss: 0.1350 Acc: 0.9616
val Loss: 0.5130 Acc: 0.8438
Epoch 4/56
----------
train Loss: 0.1554 Acc: 0.9583
val Loss: 0.5086 Acc: 0.7891
Epoch 5/56
----------
train Loss: 0.2294 Acc: 0.9299
val Loss: 0.6821 Acc: 0.7969
Epoch 6/56
----------
train Loss: 0.3106 Acc: 0.8998
val Loss: 0.5824 Acc: 0.8672
Epoch 7/56
----------
train Loss: 0.3717 Acc: 0.8965
val Loss: 1.0745 Acc: 0.7188
Epoch 8/56
----------
train Loss: 0.2410 Acc: 0.9165
val Loss: 0.4928 Acc: 0.8750
Epoch 9/56
----------
train Loss: 0.1950 Acc: 0.9316
val Loss: 0.5760 Acc: 0.7891
Epoch 10/56
----------
train Loss: 0.1863 Acc: 0.9449
val Loss: 0.4811 Acc: 0.8516
Epoch 11/56
----------
train Loss: 0.1896 Acc: 0.9265
val Loss: 0.6781 Acc: 0.7891
Epoch 12/56
----------
train Loss: 0.2306 Acc: 0.9282
val Loss: 0.5988 Acc: 0.8516
Epoch 13/56
----------
train Loss: 0.1933 Acc: 0.9382
val Loss: 0.5209 Acc: 0.8125
Epoch 14/56
----------
train Loss: 0.2134 Acc: 0.9316
val Loss: 0.8465 Acc: 0.7656
Epoch 15/56
----------
train Loss: 0.2259 Acc: 0.9182
val Loss: 0.6118 Acc: 0.8125
Epoch 16/56
----------
train Loss: 0.2383 Acc: 0.9249
val Loss: 1.2669 Acc: 0.8047
Epoch 17/56
----------
train Loss: 0.2724 Acc: 0.9082
val Loss: 0.5233 Acc: 0.7891
Epoch 18/56
----------
train Loss: 0.2880 Acc: 0.9032
val Loss: 0.5514 Acc: 0.8203
Epoch 19/56
----------
train Loss: 0.2081 Acc: 0.9382
val Loss: 0.3561 Acc: 0.8828
Epoch 20/56
----------
train Loss: 0.2113 Acc: 0.9382
val Loss: 0.5831 Acc: 0.8047
Epoch 21/56
----------
train Loss: 0.1716 Acc: 0.9349
val Loss: 0.5429 Acc: 0.8516
Epoch 22/56
----------
train Loss: 0.2075 Acc: 0.9366
val Loss: 2.0419 Acc: 0.6094
Epoch 23/56
----------
train Loss: 0.2909 Acc: 0.9032
val Loss: 0.6091 Acc: 0.8281
Epoch 24/56
----------
train Loss: 0.2185 Acc: 0.9165
val Loss: 0.8492 Acc: 0.7656
Epoch 25/56
----------
train Loss: 0.1526 Acc: 0.9566
val Loss: 0.5280 Acc: 0.7969
Epoch 26/56
----------
train Loss: 0.2084 Acc: 0.9416
val Loss: 0.4522 Acc: 0.8516
Epoch 27/56
----------
train Loss: 0.1767 Acc: 0.9432
val Loss: 0.6583 Acc: 0.8047
Epoch 28/56
----------
train Loss: 0.2320 Acc: 0.9199
val Loss: 0.6363 Acc: 0.8281
Epoch 29/56
----------
train Loss: 0.2786 Acc: 0.9115
val Loss: 0.5507 Acc: 0.8438
Epoch 30/56
----------
train Loss: 0.2322 Acc: 0.9232
val Loss: 0.6930 Acc: 0.7656
Epoch 31/56
----------
train Loss: 0.2514 Acc: 0.9149
val Loss: 0.6076 Acc: 0.8359
Epoch 32/56
----------
train Loss: 0.1350 Acc: 0.9633
val Loss: 0.5555 Acc: 0.8125
Epoch 33/56
----------
train Loss: 0.1794 Acc: 0.9482
val Loss: 0.6131 Acc: 0.8125
Epoch 34/56
----------
train Loss: 0.2062 Acc: 0.9366
val Loss: 1.6983 Acc: 0.6328
Epoch 35/56
----------
train Loss: 0.1901 Acc: 0.9482
val Loss: 0.7489 Acc: 0.7891
Epoch 36/56
----------
train Loss: 0.1692 Acc: 0.9466
val Loss: 0.9289 Acc: 0.7578
Epoch 37/56
----------
train Loss: 0.2978 Acc: 0.9065
val Loss: 0.8220 Acc: 0.7344
Epoch 38/56
----------
train Loss: 0.2704 Acc: 0.9115
val Loss: 0.7910 Acc: 0.7734
Epoch 39/56
----------
train Loss: 0.1706 Acc: 0.9449
val Loss: 0.6101 Acc: 0.7891
Epoch 40/56
----------
train Loss: 0.2572 Acc: 0.9149
val Loss: 1.0825 Acc: 0.7734
Epoch 41/56
----------
train Loss: 0.1797 Acc: 0.9533
val Loss: 0.7344 Acc: 0.7812
Epoch 42/56
----------
train Loss: 0.2869 Acc: 0.9115
val Loss: 0.6973 Acc: 0.7188
Epoch 43/56
----------
train Loss: 0.2228 Acc: 0.9282
val Loss: 0.5207 Acc: 0.7891
Epoch 44/56
----------
train Loss: 0.1871 Acc: 0.9432
val Loss: 1.0207 Acc: 0.6016
Epoch 45/56
----------
train Loss: 0.1277 Acc: 0.9516
val Loss: 0.7640 Acc: 0.7734
Epoch 46/56
----------
train Loss: 0.2160 Acc: 0.9332
val Loss: 0.8145 Acc: 0.7578
Epoch 47/56
----------
train Loss: 0.1789 Acc: 0.9399
val Loss: 0.5117 Acc: 0.8203
Epoch 48/56
----------
train Loss: 0.1805 Acc: 0.9432
val Loss: 2.4567 Acc: 0.5156
Epoch 49/56
----------
train Loss: 0.2529 Acc: 0.9182
val Loss: 0.9849 Acc: 0.7578
Epoch 50/56
----------
train Loss: 0.1864 Acc: 0.9516
val Loss: 0.9023 Acc: 0.6562
Epoch 51/56
----------
train Loss: 0.2021 Acc: 0.9332
val Loss: 0.9868 Acc: 0.7266
Epoch 52/56
----------
train Loss: 0.2682 Acc: 0.9132
[I 2024-10-15 17:31:16,206] Trial 108 finished with value: 0.8203125 and parameters: {'batch_size': 76, 'lr': 0.00013103302024355026, 'num_epochs': 56, 'weight_decay': 0.13207267783873552, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 1.8351 Acc: 0.7578
Early stopping at epoch 52 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.820312
Model weights saved at ./model_weights/ResNet34_bs_76_lr_0.00013103302024355026_epoch_56_wd_0.13207267783873552_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/53
----------
train Loss: 5.4012 Acc: 0.1235
val Loss: 4.6740 Acc: 0.1953
Epoch 2/53
----------
train Loss: 4.6304 Acc: 0.2087
val Loss: 4.1953 Acc: 0.2656
Epoch 3/53
----------
train Loss: 4.0748 Acc: 0.3255
val Loss: 3.7402 Acc: 0.3594
Epoch 4/53
----------
train Loss: 3.5089 Acc: 0.4942
val Loss: 3.3417 Acc: 0.5156
Epoch 5/53
----------
train Loss: 3.1769 Acc: 0.5960
val Loss: 2.9284 Acc: 0.6328
Epoch 6/53
----------
train Loss: 2.9741 Acc: 0.6561
val Loss: 2.6402 Acc: 0.6641
Epoch 7/53
----------
train Loss: 2.6269 Acc: 0.7479
val Loss: 2.4324 Acc: 0.7031
Epoch 8/53
----------
train Loss: 2.4278 Acc: 0.7396
val Loss: 2.2456 Acc: 0.7109
Epoch 9/53
----------
train Loss: 2.2576 Acc: 0.7880
val Loss: 2.1007 Acc: 0.7500
Epoch 10/53
----------
train Loss: 2.1439 Acc: 0.7746
val Loss: 1.9696 Acc: 0.7734
Epoch 11/53
----------
train Loss: 2.0738 Acc: 0.7963
val Loss: 1.8356 Acc: 0.7891
Epoch 12/53
----------
train Loss: 2.0394 Acc: 0.7896
val Loss: 1.7293 Acc: 0.8047
Epoch 13/53
----------
train Loss: 1.8233 Acc: 0.8147
val Loss: 1.6959 Acc: 0.8047
Epoch 14/53
----------
train Loss: 2.0591 Acc: 0.7629
val Loss: 1.6166 Acc: 0.8203
Epoch 15/53
----------
train Loss: 1.8259 Acc: 0.8080
val Loss: 1.5330 Acc: 0.8359
Epoch 16/53
----------
train Loss: 1.5853 Acc: 0.8765
val Loss: 1.4847 Acc: 0.8281
Epoch 17/53
----------
train Loss: 1.8391 Acc: 0.7896
val Loss: 1.4507 Acc: 0.8359
Epoch 18/53
----------
train Loss: 1.6794 Acc: 0.8331
val Loss: 1.4127 Acc: 0.8359
Epoch 19/53
----------
train Loss: 1.7105 Acc: 0.8230
val Loss: 1.3723 Acc: 0.8516
Epoch 20/53
----------
train Loss: 1.6480 Acc: 0.8464
val Loss: 1.3467 Acc: 0.8516
Epoch 21/53
----------
train Loss: 1.6823 Acc: 0.8598
val Loss: 1.3439 Acc: 0.8516
Epoch 22/53
----------
train Loss: 1.7137 Acc: 0.8214
val Loss: 1.3333 Acc: 0.8594
Epoch 23/53
----------
train Loss: 1.5999 Acc: 0.8815
val Loss: 1.2698 Acc: 0.8516
Epoch 24/53
----------
train Loss: 1.5096 Acc: 0.8331
val Loss: 1.2799 Acc: 0.8594
Epoch 25/53
----------
train Loss: 1.4983 Acc: 0.8331
val Loss: 1.2684 Acc: 0.8438
Epoch 26/53
----------
train Loss: 1.5772 Acc: 0.8314
val Loss: 1.2825 Acc: 0.8438
Epoch 27/53
----------
train Loss: 1.4672 Acc: 0.8831
val Loss: 1.2266 Acc: 0.8672
Epoch 28/53
----------
train Loss: 1.5557 Acc: 0.8581
val Loss: 1.1974 Acc: 0.8672
Epoch 29/53
----------
train Loss: 1.4291 Acc: 0.8998
val Loss: 1.2022 Acc: 0.8594
Epoch 30/53
----------
train Loss: 1.4687 Acc: 0.8781
val Loss: 1.2046 Acc: 0.8594
Epoch 31/53
----------
train Loss: 1.5350 Acc: 0.8397
val Loss: 1.2161 Acc: 0.8438
Epoch 32/53
----------
train Loss: 1.4216 Acc: 0.8715
val Loss: 1.2261 Acc: 0.8438
Epoch 33/53
----------
train Loss: 1.4067 Acc: 0.8965
val Loss: 1.1923 Acc: 0.8438
Epoch 34/53
----------
train Loss: 1.3306 Acc: 0.9265
val Loss: 1.1783 Acc: 0.8516
Epoch 35/53
----------
train Loss: 1.3994 Acc: 0.8564
val Loss: 1.1891 Acc: 0.8516
Epoch 36/53
----------
train Loss: 1.2079 Acc: 0.9015
val Loss: 1.1676 Acc: 0.8672
Epoch 37/53
----------
train Loss: 1.4574 Acc: 0.8982
val Loss: 1.1884 Acc: 0.8594
Epoch 38/53
----------
train Loss: 1.4788 Acc: 0.8514
val Loss: 1.1764 Acc: 0.8594
Epoch 39/53
----------
train Loss: 1.3568 Acc: 0.8815
val Loss: 1.1308 Acc: 0.8594
Epoch 40/53
----------
train Loss: 1.3785 Acc: 0.9065
val Loss: 1.1464 Acc: 0.8594
Epoch 41/53
----------
train Loss: 1.1946 Acc: 0.9215
val Loss: 1.0900 Acc: 0.8594
Epoch 42/53
----------
train Loss: 1.2912 Acc: 0.9282
val Loss: 1.1326 Acc: 0.8672
Epoch 43/53
----------
train Loss: 1.3494 Acc: 0.8982
val Loss: 1.1412 Acc: 0.8672
Epoch 44/53
----------
train Loss: 1.2341 Acc: 0.9232
val Loss: 1.1172 Acc: 0.8672
Epoch 45/53
----------
train Loss: 1.4326 Acc: 0.8731
val Loss: 1.1211 Acc: 0.8672
Epoch 46/53
----------
train Loss: 1.2741 Acc: 0.9399
val Loss: 1.1188 Acc: 0.8672
Epoch 47/53
----------
train Loss: 1.3613 Acc: 0.9132
val Loss: 1.1018 Acc: 0.8750
Epoch 48/53
----------
train Loss: 1.2275 Acc: 0.9366
val Loss: 1.1025 Acc: 0.8594
Epoch 49/53
----------
train Loss: 1.3880 Acc: 0.9065
val Loss: 1.1172 Acc: 0.8828
Epoch 50/53
----------
train Loss: 1.2688 Acc: 0.8781
val Loss: 1.0775 Acc: 0.8750
Epoch 51/53
----------
train Loss: 1.2221 Acc: 0.9466
val Loss: 1.0979 Acc: 0.8594
Epoch 52/53
----------
train Loss: 1.3785 Acc: 0.9149
val Loss: 1.1323 Acc: 0.8594
Epoch 53/53
----------
train Loss: 1.3518 Acc: 0.8748
[I 2024-10-15 17:35:14,027] Trial 109 finished with value: 0.859375 and parameters: {'batch_size': 125, 'lr': 8.711879923790959e-06, 'num_epochs': 53, 'weight_decay': 0.028943793083083275, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.1135 Acc: 0.8594
Best val Acc: 0.859375
Model weights saved at ./model_weights/ResNet34_bs_125_lr_8.711879923790959e-06_epoch_53_wd_0.028943793083083275_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/64
----------
train Loss: 4.6175 Acc: 0.1953
val Loss: 4.2680 Acc: 0.2109
Epoch 2/64
----------
train Loss: 4.1681 Acc: 0.2738
val Loss: 4.0192 Acc: 0.2812
Epoch 3/64
----------
train Loss: 3.8147 Acc: 0.3923
val Loss: 3.6801 Acc: 0.4297
Epoch 4/64
----------
train Loss: 3.5086 Acc: 0.4875
val Loss: 3.4521 Acc: 0.5312
Epoch 5/64
----------
train Loss: 3.2577 Acc: 0.5810
val Loss: 3.2082 Acc: 0.6172
Epoch 6/64
----------
train Loss: 3.0090 Acc: 0.6728
val Loss: 3.0353 Acc: 0.6797
Epoch 7/64
----------
train Loss: 2.7694 Acc: 0.7195
val Loss: 2.8105 Acc: 0.6797
Epoch 8/64
----------
train Loss: 2.6256 Acc: 0.7513
val Loss: 2.6341 Acc: 0.7578
Epoch 9/64
----------
train Loss: 2.5298 Acc: 0.7412
val Loss: 2.5097 Acc: 0.7500
Epoch 10/64
----------
train Loss: 2.3847 Acc: 0.7613
val Loss: 2.3807 Acc: 0.7656
Epoch 11/64
----------
train Loss: 2.2574 Acc: 0.7780
val Loss: 2.2389 Acc: 0.7812
Epoch 12/64
----------
train Loss: 2.3350 Acc: 0.7279
val Loss: 2.1775 Acc: 0.7734
Epoch 13/64
----------
train Loss: 2.1193 Acc: 0.8080
val Loss: 2.0750 Acc: 0.7891
Epoch 14/64
----------
train Loss: 2.0828 Acc: 0.7529
val Loss: 2.0082 Acc: 0.7891
Epoch 15/64
----------
train Loss: 1.9733 Acc: 0.8247
val Loss: 1.9398 Acc: 0.7891
Epoch 16/64
----------
train Loss: 1.9249 Acc: 0.7913
val Loss: 1.8719 Acc: 0.8125
Epoch 17/64
----------
train Loss: 1.8717 Acc: 0.8013
val Loss: 1.8266 Acc: 0.8125
Epoch 18/64
----------
train Loss: 1.7015 Acc: 0.8548
val Loss: 1.7458 Acc: 0.8125
Epoch 19/64
----------
train Loss: 1.6556 Acc: 0.8564
val Loss: 1.7136 Acc: 0.8047
Epoch 20/64
----------
train Loss: 1.6459 Acc: 0.8881
val Loss: 1.6662 Acc: 0.8281
Epoch 21/64
----------
train Loss: 1.7165 Acc: 0.8331
val Loss: 1.6449 Acc: 0.8281
Epoch 22/64
----------
train Loss: 1.6795 Acc: 0.8464
val Loss: 1.6033 Acc: 0.8281
Epoch 23/64
----------
train Loss: 1.6655 Acc: 0.8280
val Loss: 1.5981 Acc: 0.8125
Epoch 24/64
----------
train Loss: 1.6219 Acc: 0.8881
val Loss: 1.5615 Acc: 0.8125
Epoch 25/64
----------
train Loss: 1.5775 Acc: 0.8715
val Loss: 1.5578 Acc: 0.8125
Epoch 26/64
----------
train Loss: 1.5805 Acc: 0.8381
val Loss: 1.5409 Acc: 0.8203
Epoch 27/64
----------
train Loss: 1.4876 Acc: 0.8481
val Loss: 1.5290 Acc: 0.8203
Epoch 28/64
----------
train Loss: 1.6872 Acc: 0.8280
val Loss: 1.5167 Acc: 0.8203
Epoch 29/64
----------
train Loss: 1.6932 Acc: 0.8063
val Loss: 1.5279 Acc: 0.7891
Epoch 30/64
----------
train Loss: 1.6513 Acc: 0.8247
val Loss: 1.5057 Acc: 0.8281
Epoch 31/64
----------
train Loss: 1.5558 Acc: 0.8247
val Loss: 1.5407 Acc: 0.8125
Epoch 32/64
----------
train Loss: 1.4874 Acc: 0.8564
val Loss: 1.5666 Acc: 0.8125
Epoch 33/64
----------
train Loss: 1.4956 Acc: 0.8948
val Loss: 1.5212 Acc: 0.8047
Epoch 34/64
----------
train Loss: 1.3712 Acc: 0.8848
val Loss: 1.5267 Acc: 0.8125
Epoch 35/64
----------
train Loss: 1.2457 Acc: 0.9065
val Loss: 1.5211 Acc: 0.8125
Epoch 36/64
----------
train Loss: 1.4683 Acc: 0.8331
val Loss: 1.4800 Acc: 0.7969
Epoch 37/64
----------
train Loss: 1.3944 Acc: 0.8965
val Loss: 1.4824 Acc: 0.8125
Epoch 38/64
----------
train Loss: 1.3848 Acc: 0.8664
val Loss: 1.4756 Acc: 0.8125
Epoch 39/64
----------
train Loss: 1.3543 Acc: 0.8881
val Loss: 1.4696 Acc: 0.8125
Epoch 40/64
----------
train Loss: 1.5863 Acc: 0.8464
val Loss: 1.4771 Acc: 0.8125
Epoch 41/64
----------
train Loss: 1.2366 Acc: 0.9132
val Loss: 1.4909 Acc: 0.8125
Epoch 42/64
----------
train Loss: 1.4266 Acc: 0.8815
val Loss: 1.4706 Acc: 0.8203
Epoch 43/64
----------
train Loss: 1.3450 Acc: 0.8948
val Loss: 1.4776 Acc: 0.8203
Epoch 44/64
----------
train Loss: 1.4111 Acc: 0.8280
val Loss: 1.4594 Acc: 0.8125
Epoch 45/64
----------
train Loss: 1.4379 Acc: 0.9149
val Loss: 1.5274 Acc: 0.7969
Epoch 46/64
----------
train Loss: 1.3078 Acc: 0.9048
val Loss: 1.4977 Acc: 0.8125
Epoch 47/64
----------
train Loss: 1.3474 Acc: 0.8932
val Loss: 1.4876 Acc: 0.8047
Epoch 48/64
----------
train Loss: 1.3687 Acc: 0.9132
val Loss: 1.5313 Acc: 0.8125
Epoch 49/64
----------
train Loss: 1.2569 Acc: 0.9432
val Loss: 1.4649 Acc: 0.8125
Epoch 50/64
----------
train Loss: 1.3106 Acc: 0.9048
val Loss: 1.4733 Acc: 0.8047
Epoch 51/64
----------
train Loss: 1.3208 Acc: 0.9182
val Loss: 1.4584 Acc: 0.8125
Epoch 52/64
----------
train Loss: 1.0910 Acc: 0.9466
val Loss: 1.4831 Acc: 0.7969
Epoch 53/64
----------
train Loss: 1.2756 Acc: 0.8781
val Loss: 1.4601 Acc: 0.8047
Epoch 54/64
----------
train Loss: 1.3955 Acc: 0.8932
val Loss: 1.4437 Acc: 0.8047
Epoch 55/64
----------
train Loss: 1.2071 Acc: 0.9382
val Loss: 1.4854 Acc: 0.8125
Epoch 56/64
----------
train Loss: 1.3325 Acc: 0.8915
val Loss: 1.5165 Acc: 0.7969
Epoch 57/64
----------
train Loss: 1.1187 Acc: 0.9199
val Loss: 1.4440 Acc: 0.7969
Epoch 58/64
----------
train Loss: 1.2921 Acc: 0.8998
val Loss: 1.4780 Acc: 0.8047
Epoch 59/64
----------
train Loss: 1.3617 Acc: 0.8848
val Loss: 1.4922 Acc: 0.8125
Epoch 60/64
----------
train Loss: 1.3229 Acc: 0.8998
val Loss: 1.4558 Acc: 0.8047
Epoch 61/64
----------
train Loss: 1.2899 Acc: 0.9215
val Loss: 1.4459 Acc: 0.8047
Epoch 62/64
----------
train Loss: 1.4059 Acc: 0.8614
val Loss: 1.4543 Acc: 0.7891
Epoch 63/64
----------
train Loss: 1.2583 Acc: 0.8548
val Loss: 1.4435 Acc: 0.8047
Epoch 64/64
----------
train Loss: 1.1343 Acc: 0.9132
[I 2024-10-15 17:40:01,689] Trial 110 finished with value: 0.796875 and parameters: {'batch_size': 109, 'lr': 6.657895961803002e-06, 'num_epochs': 64, 'weight_decay': 0.02156832703424912, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 50 with value: 0.90625.
val Loss: 1.4450 Acc: 0.7969
Best val Acc: 0.796875
Model weights saved at ./model_weights/ResNet34_bs_109_lr_6.657895961803002e-06_epoch_64_wd_0.02156832703424912_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/69
----------
train Loss: 3.9151 Acc: 0.5810
val Loss: 4.1883 Acc: 0.7422
Epoch 2/69
----------
train Loss: 1.1325 Acc: 0.8564
val Loss: 3.7563 Acc: 0.8359
Epoch 3/69
----------
train Loss: 0.4498 Acc: 0.9516
val Loss: 4.1125 Acc: 0.8359
Epoch 4/69
----------
train Loss: 0.4112 Acc: 0.9499
val Loss: 3.8223 Acc: 0.8203
Epoch 5/69
----------
train Loss: 0.2956 Acc: 0.9766
val Loss: 3.6536 Acc: 0.7969
Epoch 6/69
----------
train Loss: 0.7768 Acc: 0.9232
val Loss: 4.7321 Acc: 0.7812
Epoch 7/69
----------
train Loss: 0.5538 Acc: 0.9366
val Loss: 2.4799 Acc: 0.8281
Epoch 8/69
----------
train Loss: 0.2917 Acc: 0.9666
val Loss: 2.7801 Acc: 0.7969
Epoch 9/69
----------
train Loss: 0.2717 Acc: 0.9649
val Loss: 3.5229 Acc: 0.8594
Epoch 10/69
----------
train Loss: 0.2248 Acc: 0.9783
val Loss: 2.9406 Acc: 0.8281
Epoch 11/69
----------
train Loss: 0.1322 Acc: 0.9883
val Loss: 3.3840 Acc: 0.8906
Epoch 12/69
----------
train Loss: 0.0876 Acc: 0.9900
val Loss: 4.1857 Acc: 0.8516
Epoch 13/69
----------
train Loss: 0.1209 Acc: 0.9866
val Loss: 2.8807 Acc: 0.8594
Epoch 14/69
----------
train Loss: 0.1828 Acc: 0.9833
val Loss: 3.4914 Acc: 0.8438
Epoch 15/69
----------
train Loss: 0.1276 Acc: 0.9816
val Loss: 3.4532 Acc: 0.8203
Epoch 16/69
----------
train Loss: 0.0764 Acc: 0.9883
val Loss: 4.3883 Acc: 0.8281
Epoch 17/69
----------
train Loss: 0.1101 Acc: 0.9866
val Loss: 3.9150 Acc: 0.8281
Epoch 18/69
----------
train Loss: 0.0216 Acc: 1.0000
val Loss: 3.9117 Acc: 0.8672
Epoch 19/69
----------
train Loss: 0.0098 Acc: 1.0000
val Loss: 4.0818 Acc: 0.8516
Epoch 20/69
----------
train Loss: 0.0495 Acc: 0.9950
val Loss: 3.8603 Acc: 0.8516
Epoch 21/69
----------
train Loss: 0.0333 Acc: 0.9933
val Loss: 4.2646 Acc: 0.8672
Epoch 22/69
----------
train Loss: 0.0204 Acc: 1.0000
val Loss: 4.6629 Acc: 0.8672
Epoch 23/69
----------
train Loss: 0.0071 Acc: 1.0000
val Loss: 3.8179 Acc: 0.8750
Epoch 24/69
----------
train Loss: 0.0133 Acc: 1.0000
val Loss: 3.6875 Acc: 0.8750
Epoch 25/69
----------
train Loss: 0.0590 Acc: 0.9933
val Loss: 6.5591 Acc: 0.8203
Epoch 26/69
----------
train Loss: 0.0520 Acc: 0.9900
val Loss: 2.7150 Acc: 0.8672
Epoch 27/69
----------
train Loss: 0.0603 Acc: 0.9950
val Loss: 6.6752 Acc: 0.8281
Epoch 28/69
----------
train Loss: 0.0581 Acc: 0.9917
val Loss: 4.8014 Acc: 0.8125
Epoch 29/69
----------
train Loss: 0.0865 Acc: 0.9883
val Loss: 4.8871 Acc: 0.8281
Epoch 30/69
----------
train Loss: 0.0208 Acc: 1.0000
val Loss: 5.0853 Acc: 0.8203
Epoch 31/69
----------
train Loss: 0.0195 Acc: 0.9983
val Loss: 5.3603 Acc: 0.8359
Epoch 32/69
----------
train Loss: 0.1823 Acc: 0.9683
val Loss: 6.5277 Acc: 0.7422
Epoch 33/69
----------
train Loss: 0.2649 Acc: 0.9766
val Loss: 4.2607 Acc: 0.8281
Epoch 34/69
----------
train Loss: 0.5114 Acc: 0.9432
val Loss: 4.0111 Acc: 0.6250
Epoch 35/69
----------
train Loss: 1.3333 Acc: 0.8748
val Loss: 7.0566 Acc: 0.6641
Epoch 36/69
----------
train Loss: 1.1457 Acc: 0.8881
val Loss: 15.6060 Acc: 0.3828
Epoch 37/69
----------
train Loss: 0.8453 Acc: 0.9165
val Loss: 4.9647 Acc: 0.7656
Epoch 38/69
----------
train Loss: 0.5623 Acc: 0.9482
val Loss: 3.8754 Acc: 0.7891
Epoch 39/69
----------
train Loss: 0.3265 Acc: 0.9649
val Loss: 6.1864 Acc: 0.7188
Epoch 40/69
----------
train Loss: 0.1492 Acc: 0.9833
val Loss: 3.6851 Acc: 0.8672
Epoch 41/69
----------
train Loss: 0.2252 Acc: 0.9850
val Loss: 3.0281 Acc: 0.8438
Epoch 42/69
----------
train Loss: 0.5628 Acc: 0.9649
val Loss: 4.0283 Acc: 0.7578
Epoch 43/69
----------
train Loss: 0.4091 Acc: 0.9549
val Loss: 6.0818 Acc: 0.7891
Epoch 44/69
----------
train Loss: 0.2975 Acc: 0.9666
val Loss: 4.8860 Acc: 0.8203
Epoch 45/69
----------
train Loss: 0.0849 Acc: 0.9866
val Loss: 3.4624 Acc: 0.8281
Epoch 46/69
----------
train Loss: 0.0305 Acc: 0.9950
val Loss: 4.9236 Acc: 0.8203
Epoch 47/69
----------
train Loss: 0.0430 Acc: 1.0000
val Loss: 4.8889 Acc: 0.8281
Epoch 48/69
----------
train Loss: 0.0205 Acc: 0.9967
val Loss: 4.8496 Acc: 0.8359
Epoch 49/69
----------
train Loss: 0.0095 Acc: 1.0000
val Loss: 5.0861 Acc: 0.8359
Epoch 50/69
----------
train Loss: 0.0056 Acc: 1.0000
val Loss: 5.1765 Acc: 0.8359
Epoch 51/69
----------
train Loss: 0.0503 Acc: 0.9917
val Loss: 6.1924 Acc: 0.8125
Epoch 52/69
----------
train Loss: 0.0175 Acc: 1.0000
val Loss: 5.0819 Acc: 0.8516
Epoch 53/69
----------
train Loss: 0.0173 Acc: 0.9967
val Loss: 4.8780 Acc: 0.8516
Epoch 54/69
----------
train Loss: 0.0054 Acc: 1.0000
val Loss: 4.8803 Acc: 0.8438
Epoch 55/69
----------
train Loss: 0.0073 Acc: 1.0000
val Loss: 5.2976 Acc: 0.8438
Epoch 56/69
----------
train Loss: 0.0026 Acc: 1.0000
val Loss: 4.9528 Acc: 0.8438
Epoch 57/69
----------
train Loss: 0.0029 Acc: 1.0000
val Loss: 5.0655 Acc: 0.8516
Epoch 58/69
----------
train Loss: 0.0030 Acc: 1.0000
val Loss: 5.0274 Acc: 0.8438
Epoch 59/69
----------
train Loss: 0.0044 Acc: 1.0000
val Loss: 4.9273 Acc: 0.8516
Epoch 60/69
----------
train Loss: 0.0026 Acc: 1.0000
val Loss: 4.8550 Acc: 0.8516
Epoch 61/69
----------
train Loss: 0.0033 Acc: 1.0000
val Loss: 5.1995 Acc: 0.8516
Epoch 62/69
----------
train Loss: 0.0017 Acc: 1.0000
val Loss: 4.9665 Acc: 0.8516
Epoch 63/69
----------
train Loss: 0.0028 Acc: 1.0000
val Loss: 4.8721 Acc: 0.8516
Epoch 64/69
----------
train Loss: 0.0023 Acc: 1.0000
val Loss: 5.2251 Acc: 0.8516
Epoch 65/69
----------
train Loss: 0.0066 Acc: 0.9983
val Loss: 4.7763 Acc: 0.8516
Epoch 66/69
----------
train Loss: 0.0058 Acc: 1.0000
val Loss: 5.0795 Acc: 0.8438
Epoch 67/69
----------
train Loss: 0.0032 Acc: 1.0000
val Loss: 5.3246 Acc: 0.8203
Epoch 68/69
----------
train Loss: 0.0040 Acc: 1.0000
val Loss: 5.2173 Acc: 0.8359
Epoch 69/69
----------
train Loss: 0.0038 Acc: 1.0000
[I 2024-10-15 17:45:10,587] Trial 111 finished with value: 0.84375 and parameters: {'batch_size': 72, 'lr': 0.00023770263055052668, 'num_epochs': 69, 'weight_decay': 0.0032777284704090383, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 5.1090 Acc: 0.8438
Best val Acc: 0.843750
Model weights saved at ./model_weights/ResNet34_bs_72_lr_0.00023770263055052668_epoch_69_wd_0.0032777284704090383_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/67
----------
train Loss: 3.6447 Acc: 0.5810
val Loss: 2.6637 Acc: 0.8047
Epoch 2/67
----------
train Loss: 1.4245 Acc: 0.7730
val Loss: 2.4393 Acc: 0.8203
Epoch 3/67
----------
train Loss: 0.6204 Acc: 0.9149
val Loss: 2.3805 Acc: 0.8594
Epoch 4/67
----------
train Loss: 0.6275 Acc: 0.9282
val Loss: 3.6387 Acc: 0.6016
Epoch 5/67
----------
train Loss: 0.7789 Acc: 0.9015
val Loss: 3.5717 Acc: 0.7578
Epoch 6/67
----------
train Loss: 0.7398 Acc: 0.9065
val Loss: 2.7912 Acc: 0.6250
Epoch 7/67
----------
train Loss: 0.7819 Acc: 0.9165
val Loss: 1.9357 Acc: 0.6953
Epoch 8/67
----------
train Loss: 0.8798 Acc: 0.9132
[I 2024-10-15 17:45:47,336] Trial 112 finished with value: 0.859375 and parameters: {'batch_size': 68, 'lr': 0.0002131990008088168, 'num_epochs': 67, 'weight_decay': 0.08683477318329821, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 4.5469 Acc: 0.7109
Early stopping at epoch 8 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.859375
Model weights saved at ./model_weights/ResNet34_bs_68_lr_0.0002131990008088168_epoch_67_wd_0.08683477318329821_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/66
----------
train Loss: 4.2313 Acc: 0.5609
val Loss: 5.8015 Acc: 0.4453
Epoch 2/66
----------
train Loss: 2.3679 Acc: 0.7379
val Loss: 4.1890 Acc: 0.7031
Epoch 3/66
----------
train Loss: 2.2653 Acc: 0.8247
val Loss: 3.6461 Acc: 0.6016
Epoch 4/66
----------
train Loss: 1.2668 Acc: 0.8431
val Loss: 3.9996 Acc: 0.7578
Epoch 5/66
----------
train Loss: 1.3097 Acc: 0.8447
val Loss: 2.6383 Acc: 0.8359
Epoch 6/66
----------
train Loss: 1.5725 Acc: 0.8497
val Loss: 2.9927 Acc: 0.6875
Epoch 7/66
----------
train Loss: 1.3813 Acc: 0.8514
val Loss: 2.8767 Acc: 0.7656
Epoch 8/66
----------
train Loss: 1.3311 Acc: 0.8765
val Loss: 5.0181 Acc: 0.6797
Epoch 9/66
----------
train Loss: 2.1485 Acc: 0.7713
val Loss: 3.8736 Acc: 0.6797
Epoch 10/66
----------
train Loss: 1.4667 Acc: 0.8397
[I 2024-10-15 17:46:33,431] Trial 113 finished with value: 0.8359375 and parameters: {'batch_size': 73, 'lr': 0.00038060028014188493, 'num_epochs': 66, 'weight_decay': 0.07629729631553843, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 4.9194 Acc: 0.6484
Early stopping at epoch 10 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.835938
Model weights saved at ./model_weights/ResNet34_bs_73_lr_0.00038060028014188493_epoch_66_wd_0.07629729631553843_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/58
----------
train Loss: 3.8938 Acc: 0.5242
val Loss: 2.0503 Acc: 0.7891
Epoch 2/58
----------
train Loss: 1.4465 Acc: 0.8381
val Loss: 2.1053 Acc: 0.8672
Epoch 3/58
----------
train Loss: 0.6171 Acc: 0.9332
val Loss: 3.0384 Acc: 0.8750
Epoch 4/58
----------
train Loss: 0.4533 Acc: 0.9449
val Loss: 2.3935 Acc: 0.8828
Epoch 5/58
----------
train Loss: 0.3781 Acc: 0.9566
val Loss: 2.3599 Acc: 0.8281
Epoch 6/58
----------
train Loss: 0.6520 Acc: 0.9249
val Loss: 3.0849 Acc: 0.8281
Epoch 7/58
----------
train Loss: 0.7643 Acc: 0.9182
val Loss: 4.8723 Acc: 0.7266
Epoch 8/58
----------
train Loss: 0.9643 Acc: 0.8898
val Loss: 2.4249 Acc: 0.8594
Epoch 9/58
----------
train Loss: 0.9204 Acc: 0.9249
val Loss: 5.1749 Acc: 0.7812
Epoch 10/58
----------
train Loss: 0.6210 Acc: 0.9282
val Loss: 3.3261 Acc: 0.8125
Epoch 11/58
----------
train Loss: 0.3079 Acc: 0.9533
val Loss: 3.3067 Acc: 0.8750
Epoch 12/58
----------
train Loss: 0.4695 Acc: 0.9566
val Loss: 2.1892 Acc: 0.8359
Epoch 13/58
----------
train Loss: 1.1528 Acc: 0.9249
val Loss: 4.4851 Acc: 0.6250
Epoch 14/58
----------
train Loss: 0.9948 Acc: 0.8948
val Loss: 4.0032 Acc: 0.8125
Epoch 15/58
----------
train Loss: 1.2375 Acc: 0.8815
val Loss: 2.6140 Acc: 0.7500
Epoch 16/58
----------
train Loss: 0.8236 Acc: 0.9265
val Loss: 3.1166 Acc: 0.8438
Epoch 17/58
----------
train Loss: 1.0499 Acc: 0.9115
val Loss: 1.9544 Acc: 0.8438
Epoch 18/58
----------
train Loss: 0.6367 Acc: 0.9416
val Loss: 2.3800 Acc: 0.7969
Epoch 19/58
----------
train Loss: 0.5050 Acc: 0.9399
val Loss: 1.9953 Acc: 0.8203
Epoch 20/58
----------
train Loss: 0.2713 Acc: 0.9699
val Loss: 3.0424 Acc: 0.8906
Epoch 21/58
----------
train Loss: 0.3018 Acc: 0.9666
val Loss: 4.1608 Acc: 0.8750
Epoch 22/58
----------
train Loss: 0.1608 Acc: 0.9800
val Loss: 4.0910 Acc: 0.8828
Epoch 23/58
----------
train Loss: 0.2434 Acc: 0.9599
val Loss: 2.8904 Acc: 0.8828
Epoch 24/58
----------
train Loss: 0.3161 Acc: 0.9699
val Loss: 2.6496 Acc: 0.5703
Epoch 25/58
----------
train Loss: 0.5318 Acc: 0.9616
val Loss: 9.1712 Acc: 0.7188
Epoch 26/58
----------
train Loss: 0.8968 Acc: 0.9199
val Loss: 6.3179 Acc: 0.7109
Epoch 27/58
----------
train Loss: 1.3479 Acc: 0.8731
val Loss: 10.3131 Acc: 0.5781
Epoch 28/58
----------
train Loss: 1.1303 Acc: 0.8798
[I 2024-10-15 17:48:39,430] Trial 114 finished with value: 0.8828125 and parameters: {'batch_size': 106, 'lr': 0.00018403196342854107, 'num_epochs': 58, 'weight_decay': 0.0815818944092619, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 1.9385 Acc: 0.8047
Early stopping at epoch 28 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.882812
Model weights saved at ./model_weights/ResNet34_bs_106_lr_0.00018403196342854107_epoch_58_wd_0.0815818944092619_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/60
----------
train Loss: 4.1835 Acc: 0.4424
val Loss: 3.3115 Acc: 0.7578
Epoch 2/60
----------
train Loss: 1.4575 Acc: 0.8548
val Loss: 1.7401 Acc: 0.7422
Epoch 3/60
----------
train Loss: 0.5767 Acc: 0.9382
val Loss: 2.4379 Acc: 0.7266
Epoch 4/60
----------
train Loss: 0.4210 Acc: 0.9382
val Loss: 2.4874 Acc: 0.7500
Epoch 5/60
----------
train Loss: 0.6151 Acc: 0.9332
val Loss: 2.0275 Acc: 0.7812
Epoch 6/60
----------
train Loss: 0.8011 Acc: 0.9215
val Loss: 2.4499 Acc: 0.7891
Epoch 7/60
----------
train Loss: 0.9706 Acc: 0.9132
val Loss: 3.4432 Acc: 0.6953
Epoch 8/60
----------
train Loss: 0.9756 Acc: 0.9098
val Loss: 3.7145 Acc: 0.7344
Epoch 9/60
----------
train Loss: 0.9094 Acc: 0.8948
val Loss: 2.7517 Acc: 0.8047
Epoch 10/60
----------
train Loss: 0.9126 Acc: 0.9282
val Loss: 3.9939 Acc: 0.7812
Epoch 11/60
----------
train Loss: 0.5623 Acc: 0.9265
val Loss: 2.7109 Acc: 0.8203
Epoch 12/60
----------
train Loss: 0.5965 Acc: 0.9249
val Loss: 2.3227 Acc: 0.8438
Epoch 13/60
----------
train Loss: 0.3996 Acc: 0.9716
val Loss: 2.7273 Acc: 0.6719
Epoch 14/60
----------
train Loss: 0.3077 Acc: 0.9649
val Loss: 2.2306 Acc: 0.7109
Epoch 15/60
----------
train Loss: 0.3050 Acc: 0.9649
val Loss: 2.3387 Acc: 0.8359
Epoch 16/60
----------
train Loss: 0.3005 Acc: 0.9783
val Loss: 2.1092 Acc: 0.8438
Epoch 17/60
----------
train Loss: 0.4280 Acc: 0.9733
val Loss: 1.9863 Acc: 0.8203
Epoch 18/60
----------
train Loss: 0.7859 Acc: 0.9332
val Loss: 3.3277 Acc: 0.7812
Epoch 19/60
----------
train Loss: 1.3054 Acc: 0.8765
val Loss: 12.3261 Acc: 0.7422
Epoch 20/60
----------
train Loss: 1.0293 Acc: 0.9015
val Loss: 9.7521 Acc: 0.4531
Epoch 21/60
----------
train Loss: 1.3429 Acc: 0.8514
val Loss: 5.3552 Acc: 0.4688
Epoch 22/60
----------
train Loss: 1.1634 Acc: 0.8781
val Loss: 5.6035 Acc: 0.4688
Epoch 23/60
----------
train Loss: 0.7985 Acc: 0.9232
val Loss: 2.7837 Acc: 0.7734
Epoch 24/60
----------
train Loss: 0.2880 Acc: 0.9783
val Loss: 1.8859 Acc: 0.7891
Epoch 25/60
----------
train Loss: 0.1457 Acc: 0.9750
val Loss: 3.3247 Acc: 0.7891
Epoch 26/60
----------
train Loss: 0.1862 Acc: 0.9800
val Loss: 2.5940 Acc: 0.8281
Epoch 27/60
----------
train Loss: 0.2191 Acc: 0.9850
val Loss: 4.3150 Acc: 0.8516
Epoch 28/60
----------
train Loss: 0.2606 Acc: 0.9750
val Loss: 2.3747 Acc: 0.8359
Epoch 29/60
----------
train Loss: 0.1805 Acc: 0.9766
val Loss: 2.3321 Acc: 0.8750
Epoch 30/60
----------
train Loss: 0.1470 Acc: 0.9816
val Loss: 2.9492 Acc: 0.8203
Epoch 31/60
----------
train Loss: 0.2559 Acc: 0.9683
val Loss: 2.0901 Acc: 0.8125
Epoch 32/60
----------
train Loss: 0.7064 Acc: 0.9599
val Loss: 6.9016 Acc: 0.8203
Epoch 33/60
----------
train Loss: 0.8337 Acc: 0.9065
val Loss: 2.8215 Acc: 0.6875
Epoch 34/60
----------
train Loss: 0.5047 Acc: 0.9366
[I 2024-10-15 17:51:11,220] Trial 115 finished with value: 0.875 and parameters: {'batch_size': 100, 'lr': 0.00016928119366038162, 'num_epochs': 60, 'weight_decay': 0.10139023211466289, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 3.9327 Acc: 0.7734
Early stopping at epoch 34 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.875000
Model weights saved at ./model_weights/ResNet34_bs_100_lr_0.00016928119366038162_epoch_60_wd_0.10139023211466289_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/59
----------
train Loss: 0.9807 Acc: 0.6311
val Loss: 0.6087 Acc: 0.7734
Epoch 2/59
----------
train Loss: 0.2391 Acc: 0.9316
val Loss: 0.5098 Acc: 0.8359
Epoch 3/59
----------
train Loss: 0.1264 Acc: 0.9750
val Loss: 0.6841 Acc: 0.7891
Epoch 4/59
----------
train Loss: 0.2068 Acc: 0.9199
val Loss: 0.8472 Acc: 0.7578
Epoch 5/59
----------
train Loss: 0.3652 Acc: 0.8715
val Loss: 0.9861 Acc: 0.7969
Epoch 6/59
----------
train Loss: 0.3535 Acc: 0.8881
val Loss: 2.6217 Acc: 0.5000
Epoch 7/59
----------
train Loss: 0.3147 Acc: 0.8831
val Loss: 0.7725 Acc: 0.7812
Epoch 8/59
----------
train Loss: 0.1699 Acc: 0.9432
val Loss: 0.6334 Acc: 0.8203
Epoch 9/59
----------
train Loss: 0.2803 Acc: 0.9199
val Loss: 0.8598 Acc: 0.7344
Epoch 10/59
----------
train Loss: 0.2999 Acc: 0.9032
val Loss: 1.0236 Acc: 0.7031
Epoch 11/59
----------
train Loss: 0.2567 Acc: 0.9182
val Loss: 0.5935 Acc: 0.7969
Epoch 12/59
----------
train Loss: 0.2261 Acc: 0.9366
val Loss: 1.0966 Acc: 0.7578
Epoch 13/59
----------
train Loss: 0.2944 Acc: 0.9082
val Loss: 0.9921 Acc: 0.7656
Epoch 14/59
----------
train Loss: 0.2514 Acc: 0.9199
val Loss: 0.7362 Acc: 0.7734
Epoch 15/59
----------
train Loss: 0.2597 Acc: 0.9149
val Loss: 0.9673 Acc: 0.7578
Epoch 16/59
----------
train Loss: 0.4096 Acc: 0.8798
val Loss: 1.3310 Acc: 0.7422
Epoch 17/59
----------
train Loss: 0.3023 Acc: 0.8998
val Loss: 0.7469 Acc: 0.7734
Epoch 18/59
----------
train Loss: 0.3416 Acc: 0.8781
val Loss: 0.6263 Acc: 0.7891
Epoch 19/59
----------
train Loss: 0.1486 Acc: 0.9533
val Loss: 0.7699 Acc: 0.8203
Epoch 20/59
----------
train Loss: 0.2609 Acc: 0.9098
val Loss: 2.9980 Acc: 0.7031
Epoch 21/59
----------
train Loss: 0.3813 Acc: 0.8881
val Loss: 1.0508 Acc: 0.6406
Epoch 22/59
----------
train Loss: 0.3334 Acc: 0.8898
val Loss: 0.6438 Acc: 0.8047
Epoch 23/59
----------
train Loss: 0.2873 Acc: 0.8898
val Loss: 0.8032 Acc: 0.7266
Epoch 24/59
----------
train Loss: 0.3168 Acc: 0.8965
val Loss: 0.6974 Acc: 0.7422
Epoch 25/59
----------
train Loss: 0.2384 Acc: 0.9282
val Loss: 1.0425 Acc: 0.7344
Epoch 26/59
----------
train Loss: 0.2867 Acc: 0.9015
val Loss: 0.8851 Acc: 0.7109
Epoch 27/59
----------
train Loss: 0.2183 Acc: 0.9349
val Loss: 0.6770 Acc: 0.7656
Epoch 28/59
----------
train Loss: 0.2259 Acc: 0.9299
val Loss: 0.6153 Acc: 0.8281
Epoch 29/59
----------
train Loss: 0.2278 Acc: 0.9332
val Loss: 0.6329 Acc: 0.7578
Epoch 30/59
----------
train Loss: 0.2622 Acc: 0.9115
val Loss: 0.6020 Acc: 0.7812
Epoch 31/59
----------
train Loss: 0.2587 Acc: 0.9132
val Loss: 0.7839 Acc: 0.7656
Epoch 32/59
----------
train Loss: 0.1897 Acc: 0.9416
val Loss: 0.7153 Acc: 0.7734
Epoch 33/59
----------
train Loss: 0.2631 Acc: 0.9199
val Loss: 0.8997 Acc: 0.6797
Epoch 34/59
----------
train Loss: 0.2135 Acc: 0.9249
val Loss: 0.5215 Acc: 0.8359
Epoch 35/59
----------
train Loss: 0.1826 Acc: 0.9349
val Loss: 4.5909 Acc: 0.2734
Epoch 36/59
----------
train Loss: 0.4228 Acc: 0.8631
val Loss: 0.8810 Acc: 0.7188
Epoch 37/59
----------
train Loss: 0.3307 Acc: 0.8881
val Loss: 1.0869 Acc: 0.7344
Epoch 38/59
----------
train Loss: 0.3072 Acc: 0.9032
val Loss: 1.4659 Acc: 0.6562
Epoch 39/59
----------
train Loss: 0.2684 Acc: 0.9015
[I 2024-10-15 17:54:06,185] Trial 116 finished with value: 0.8359375 and parameters: {'batch_size': 105, 'lr': 0.00016475042609428626, 'num_epochs': 59, 'weight_decay': 0.1864723957865852, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 0.8727 Acc: 0.7266
Early stopping at epoch 39 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.835938
Model weights saved at ./model_weights/ResNet34_bs_105_lr_0.00016475042609428626_epoch_59_wd_0.1864723957865852_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/60
----------
train Loss: 4.3085 Acc: 0.4174
val Loss: 2.7110 Acc: 0.6328
Epoch 2/60
----------
train Loss: 1.2983 Acc: 0.8230
val Loss: 1.8932 Acc: 0.7969
Epoch 3/60
----------
train Loss: 0.4733 Acc: 0.9616
val Loss: 2.2097 Acc: 0.7891
Epoch 4/60
----------
train Loss: 0.1790 Acc: 0.9883
val Loss: 2.4969 Acc: 0.7969
Epoch 5/60
----------
train Loss: 0.1058 Acc: 0.9950
val Loss: 2.6070 Acc: 0.8047
Epoch 6/60
----------
train Loss: 0.1663 Acc: 0.9900
val Loss: 2.6248 Acc: 0.8125
Epoch 7/60
----------
train Loss: 0.1379 Acc: 0.9917
val Loss: 2.6674 Acc: 0.8203
Epoch 8/60
----------
train Loss: 0.0906 Acc: 0.9933
val Loss: 2.7276 Acc: 0.8125
Epoch 9/60
----------
train Loss: 0.1254 Acc: 0.9883
val Loss: 3.0010 Acc: 0.8203
Epoch 10/60
----------
train Loss: 0.1781 Acc: 0.9900
val Loss: 3.5741 Acc: 0.8516
Epoch 11/60
----------
train Loss: 0.6582 Acc: 0.9583
val Loss: 2.7607 Acc: 0.7188
Epoch 12/60
----------
train Loss: 1.0123 Acc: 0.8831
val Loss: 3.2545 Acc: 0.7422
Epoch 13/60
----------
train Loss: 0.9908 Acc: 0.9215
val Loss: 7.9909 Acc: 0.7812
Epoch 14/60
----------
train Loss: 0.7674 Acc: 0.9199
val Loss: 3.8230 Acc: 0.8203
Epoch 15/60
----------
train Loss: 0.5720 Acc: 0.9482
val Loss: 3.4630 Acc: 0.7578
Epoch 16/60
----------
train Loss: 0.3313 Acc: 0.9599
val Loss: 3.6371 Acc: 0.7812
Epoch 17/60
----------
train Loss: 0.2248 Acc: 0.9850
val Loss: 3.7969 Acc: 0.7812
Epoch 18/60
----------
train Loss: 0.1221 Acc: 0.9866
val Loss: 3.7337 Acc: 0.8047
Epoch 19/60
----------
train Loss: 0.0758 Acc: 0.9933
val Loss: 3.3067 Acc: 0.8359
Epoch 20/60
----------
train Loss: 0.0805 Acc: 0.9933
val Loss: 3.4980 Acc: 0.8203
Epoch 21/60
----------
train Loss: 0.0666 Acc: 0.9950
val Loss: 3.2446 Acc: 0.7969
Epoch 22/60
----------
train Loss: 0.0507 Acc: 0.9933
val Loss: 3.4769 Acc: 0.8047
Epoch 23/60
----------
train Loss: 0.2938 Acc: 0.9666
val Loss: 4.0924 Acc: 0.8047
Epoch 24/60
----------
train Loss: 0.1490 Acc: 0.9833
val Loss: 4.0255 Acc: 0.8047
Epoch 25/60
----------
train Loss: 0.2803 Acc: 0.9666
val Loss: 3.3930 Acc: 0.7891
Epoch 26/60
----------
train Loss: 0.3967 Acc: 0.9666
val Loss: 5.1189 Acc: 0.5391
Epoch 27/60
----------
train Loss: 0.5454 Acc: 0.9165
val Loss: 3.9292 Acc: 0.8438
Epoch 28/60
----------
train Loss: 0.4243 Acc: 0.9482
val Loss: 8.0888 Acc: 0.7891
Epoch 29/60
----------
train Loss: 0.9775 Acc: 0.8848
val Loss: 4.7525 Acc: 0.7188
Epoch 30/60
----------
train Loss: 1.1780 Acc: 0.8998
val Loss: 6.3132 Acc: 0.6484
Epoch 31/60
----------
train Loss: 0.7374 Acc: 0.9349
val Loss: 3.4496 Acc: 0.7969
Epoch 32/60
----------
train Loss: 0.4380 Acc: 0.9666
val Loss: 3.3296 Acc: 0.8516
Epoch 33/60
----------
train Loss: 0.2459 Acc: 0.9716
val Loss: 3.4957 Acc: 0.8125
Epoch 34/60
----------
train Loss: 0.1175 Acc: 0.9783
val Loss: 4.1476 Acc: 0.8125
Epoch 35/60
----------
train Loss: 0.1138 Acc: 0.9833
val Loss: 4.4431 Acc: 0.8438
Epoch 36/60
----------
train Loss: 0.0778 Acc: 0.9917
val Loss: 3.9245 Acc: 0.8359
Epoch 37/60
----------
train Loss: 0.0722 Acc: 0.9950
val Loss: 3.8621 Acc: 0.8516
Epoch 38/60
----------
train Loss: 0.0494 Acc: 0.9950
val Loss: 3.9358 Acc: 0.8594
Epoch 39/60
----------
train Loss: 0.0964 Acc: 0.9866
val Loss: 4.8981 Acc: 0.8594
Epoch 40/60
----------
train Loss: 0.3720 Acc: 0.9382
val Loss: 4.6385 Acc: 0.7969
Epoch 41/60
----------
train Loss: 0.8895 Acc: 0.9432
val Loss: 6.3554 Acc: 0.6797
Epoch 42/60
----------
train Loss: 0.6957 Acc: 0.9349
val Loss: 8.2234 Acc: 0.7188
Epoch 43/60
----------
train Loss: 0.5200 Acc: 0.9282
val Loss: 3.9159 Acc: 0.7734
Epoch 44/60
----------
train Loss: 0.4081 Acc: 0.9649
[I 2024-10-15 17:57:22,785] Trial 117 finished with value: 0.859375 and parameters: {'batch_size': 101, 'lr': 7.786381846061564e-05, 'num_epochs': 60, 'weight_decay': 0.10113375437830724, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 3.6629 Acc: 0.7344
Early stopping at epoch 44 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.859375
Model weights saved at ./model_weights/ResNet34_bs_101_lr_7.786381846061564e-05_epoch_60_wd_0.10113375437830724_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/55
----------
train Loss: 3.8733 Acc: 0.5526
val Loss: 2.0385 Acc: 0.8047
Epoch 2/55
----------
train Loss: 1.0777 Acc: 0.8664
val Loss: 1.9275 Acc: 0.8750
Epoch 3/55
----------
train Loss: 0.4939 Acc: 0.9516
val Loss: 1.9541 Acc: 0.8594
Epoch 4/55
----------
train Loss: 0.2446 Acc: 0.9833
val Loss: 1.7344 Acc: 0.8828
Epoch 5/55
----------
train Loss: 0.1871 Acc: 0.9850
val Loss: 1.5896 Acc: 0.9062
Epoch 6/55
----------
train Loss: 0.1419 Acc: 0.9883
val Loss: 1.6454 Acc: 0.8906
Epoch 7/55
----------
train Loss: 0.1179 Acc: 0.9850
val Loss: 1.5880 Acc: 0.8906
Epoch 8/55
----------
train Loss: 0.1697 Acc: 0.9850
val Loss: 2.9933 Acc: 0.8750
Epoch 9/55
----------
train Loss: 0.1682 Acc: 0.9816
val Loss: 1.9353 Acc: 0.8672
Epoch 10/55
----------
train Loss: 0.1267 Acc: 0.9883
val Loss: 1.8680 Acc: 0.8125
Epoch 11/55
----------
train Loss: 0.1594 Acc: 0.9833
val Loss: 1.6905 Acc: 0.8672
Epoch 12/55
----------
train Loss: 0.1241 Acc: 0.9850
val Loss: 2.4205 Acc: 0.8594
Epoch 13/55
----------
train Loss: 0.3011 Acc: 0.9766
val Loss: 2.2177 Acc: 0.8438
Epoch 14/55
----------
train Loss: 0.6826 Acc: 0.9115
val Loss: 4.3172 Acc: 0.7812
Epoch 15/55
----------
train Loss: 1.5540 Acc: 0.8748
val Loss: 6.5458 Acc: 0.6797
Epoch 16/55
----------
train Loss: 1.6892 Acc: 0.8447
val Loss: 2.5010 Acc: 0.7734
Epoch 17/55
----------
train Loss: 1.0552 Acc: 0.8915
val Loss: 3.8504 Acc: 0.8281
Epoch 18/55
----------
train Loss: 0.7655 Acc: 0.9332
val Loss: 2.4328 Acc: 0.8516
Epoch 19/55
----------
train Loss: 0.5491 Acc: 0.9416
val Loss: 3.1369 Acc: 0.8516
Epoch 20/55
----------
train Loss: 0.3032 Acc: 0.9649
val Loss: 1.9920 Acc: 0.8594
Epoch 21/55
----------
train Loss: 0.1671 Acc: 0.9850
val Loss: 1.9595 Acc: 0.8828
Epoch 22/55
----------
train Loss: 0.1789 Acc: 0.9800
val Loss: 1.7311 Acc: 0.9141
Epoch 23/55
----------
train Loss: 0.3211 Acc: 0.9699
val Loss: 3.1883 Acc: 0.8828
Epoch 24/55
----------
train Loss: 0.2423 Acc: 0.9649
val Loss: 2.8119 Acc: 0.8594
Epoch 25/55
----------
train Loss: 0.1955 Acc: 0.9833
val Loss: 3.1258 Acc: 0.8516
Epoch 26/55
----------
train Loss: 0.1347 Acc: 0.9833
val Loss: 1.9245 Acc: 0.8359
Epoch 27/55
----------
train Loss: 0.1061 Acc: 0.9883
val Loss: 2.5959 Acc: 0.8125
Epoch 28/55
----------
train Loss: 0.1381 Acc: 0.9866
val Loss: 3.0184 Acc: 0.8594
Epoch 29/55
----------
train Loss: 0.0975 Acc: 0.9866
val Loss: 2.4624 Acc: 0.8438
Epoch 30/55
----------
train Loss: 0.1560 Acc: 0.9800
val Loss: 2.4508 Acc: 0.8203
Epoch 31/55
----------
train Loss: 0.1578 Acc: 0.9800
val Loss: 2.9524 Acc: 0.8438
Epoch 32/55
----------
train Loss: 0.1484 Acc: 0.9833
val Loss: 3.4742 Acc: 0.8359
Epoch 33/55
----------
train Loss: 0.1936 Acc: 0.9866
val Loss: 4.5203 Acc: 0.8047
Epoch 34/55
----------
train Loss: 0.5260 Acc: 0.9533
val Loss: 21.0002 Acc: 0.4922
Epoch 35/55
----------
train Loss: 0.8588 Acc: 0.9182
val Loss: 7.6953 Acc: 0.6406
Epoch 36/55
----------
train Loss: 1.1493 Acc: 0.8698
val Loss: 3.5610 Acc: 0.7422
Epoch 37/55
----------
train Loss: 0.6276 Acc: 0.9332
val Loss: 5.6450 Acc: 0.7266
Epoch 38/55
----------
train Loss: 0.3363 Acc: 0.9516
val Loss: 2.3013 Acc: 0.8281
Epoch 39/55
----------
train Loss: 0.3029 Acc: 0.9666
val Loss: 3.3373 Acc: 0.8672
Epoch 40/55
----------
train Loss: 0.4534 Acc: 0.9599
val Loss: 2.5830 Acc: 0.8359
Epoch 41/55
----------
train Loss: 0.2715 Acc: 0.9716
val Loss: 2.6353 Acc: 0.8438
Epoch 42/55
----------
train Loss: 0.2490 Acc: 0.9649
val Loss: 2.9109 Acc: 0.8125
Epoch 43/55
----------
train Loss: 0.2205 Acc: 0.9783
val Loss: 2.8648 Acc: 0.8594
Epoch 44/55
----------
train Loss: 0.1215 Acc: 0.9833
val Loss: 2.9647 Acc: 0.8438
Epoch 45/55
----------
train Loss: 0.0693 Acc: 0.9900
val Loss: 2.7712 Acc: 0.8359
Epoch 46/55
----------
train Loss: 0.1238 Acc: 0.9816
val Loss: 2.6535 Acc: 0.8516
Epoch 47/55
----------
train Loss: 0.0955 Acc: 0.9900
val Loss: 2.8953 Acc: 0.8281
Epoch 48/55
----------
train Loss: 0.0770 Acc: 0.9883
val Loss: 2.6682 Acc: 0.8906
Epoch 49/55
----------
train Loss: 0.0689 Acc: 0.9900
val Loss: 3.3988 Acc: 0.8750
Epoch 50/55
----------
train Loss: 0.0627 Acc: 0.9917
val Loss: 3.5617 Acc: 0.8828
Epoch 51/55
----------
train Loss: 0.0789 Acc: 0.9917
val Loss: 3.3636 Acc: 0.8359
Epoch 52/55
----------
train Loss: 0.0819 Acc: 0.9900
val Loss: 3.0957 Acc: 0.8203
Epoch 53/55
----------
train Loss: 0.0687 Acc: 0.9917
val Loss: 3.5788 Acc: 0.8750
Epoch 54/55
----------
train Loss: 0.0624 Acc: 0.9917
val Loss: 3.4809 Acc: 0.8750
Epoch 55/55
----------
train Loss: 0.0570 Acc: 0.9917
[I 2024-10-15 18:01:30,893] Trial 118 finished with value: 0.875 and parameters: {'batch_size': 106, 'lr': 9.242128253680866e-05, 'num_epochs': 55, 'weight_decay': 0.06586514435646493, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 3.7194 Acc: 0.8750
Best val Acc: 0.875000
Model weights saved at ./model_weights/ResNet34_bs_106_lr_9.242128253680866e-05_epoch_55_wd_0.06586514435646493_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/47
----------
train Loss: 4.0492 Acc: 0.4942
val Loss: 3.4387 Acc: 0.7656
Epoch 2/47
----------
train Loss: 1.1037 Acc: 0.8614
val Loss: 2.7335 Acc: 0.8125
Epoch 3/47
----------
train Loss: 0.3176 Acc: 0.9633
val Loss: 2.7747 Acc: 0.8594
Epoch 4/47
----------
train Loss: 0.2292 Acc: 0.9866
val Loss: 3.2081 Acc: 0.8594
Epoch 5/47
----------
train Loss: 0.1911 Acc: 0.9733
val Loss: 3.0056 Acc: 0.8516
Epoch 6/47
----------
train Loss: 0.1810 Acc: 0.9800
val Loss: 4.0959 Acc: 0.8203
Epoch 7/47
----------
train Loss: 0.0938 Acc: 0.9917
val Loss: 4.0746 Acc: 0.7969
Epoch 8/47
----------
train Loss: 0.1266 Acc: 0.9900
val Loss: 4.7516 Acc: 0.8047
Epoch 9/47
----------
train Loss: 0.0977 Acc: 0.9850
val Loss: 4.0956 Acc: 0.8203
Epoch 10/47
----------
train Loss: 0.2171 Acc: 0.9766
val Loss: 3.4570 Acc: 0.7891
Epoch 11/47
----------
train Loss: 0.2805 Acc: 0.9649
val Loss: 4.9850 Acc: 0.7734
Epoch 12/47
----------
train Loss: 0.6524 Acc: 0.9199
val Loss: 7.3606 Acc: 0.7422
Epoch 13/47
----------
train Loss: 1.0995 Acc: 0.8982
val Loss: 8.2998 Acc: 0.6328
Epoch 14/47
----------
train Loss: 1.2476 Acc: 0.8865
val Loss: 10.7663 Acc: 0.3438
Epoch 15/47
----------
train Loss: 0.7131 Acc: 0.9265
val Loss: 4.4075 Acc: 0.7969
Epoch 16/47
----------
train Loss: 0.5407 Acc: 0.9332
val Loss: 3.9197 Acc: 0.8359
Epoch 17/47
----------
train Loss: 0.5610 Acc: 0.9416
val Loss: 4.7983 Acc: 0.6953
Epoch 18/47
----------
train Loss: 0.7802 Acc: 0.9482
val Loss: 5.5598 Acc: 0.8047
Epoch 19/47
----------
train Loss: 0.3822 Acc: 0.9349
val Loss: 5.6776 Acc: 0.7656
Epoch 20/47
----------
train Loss: 0.2477 Acc: 0.9800
val Loss: 3.5904 Acc: 0.8594
Epoch 21/47
----------
train Loss: 0.2813 Acc: 0.9699
val Loss: 4.5944 Acc: 0.7969
Epoch 22/47
----------
train Loss: 0.1306 Acc: 0.9866
val Loss: 3.3675 Acc: 0.8359
Epoch 23/47
----------
train Loss: 0.0469 Acc: 0.9933
val Loss: 3.4994 Acc: 0.8516
Epoch 24/47
----------
train Loss: 0.0950 Acc: 0.9950
val Loss: 4.9439 Acc: 0.8203
Epoch 25/47
----------
train Loss: 0.0534 Acc: 0.9950
val Loss: 4.2483 Acc: 0.8203
Epoch 26/47
----------
train Loss: 0.2261 Acc: 0.9883
val Loss: 4.7480 Acc: 0.8516
Epoch 27/47
----------
train Loss: 0.6008 Acc: 0.9199
val Loss: 4.3252 Acc: 0.7891
Epoch 28/47
----------
train Loss: 0.2276 Acc: 0.9750
val Loss: 4.1850 Acc: 0.8438
Epoch 29/47
----------
train Loss: 0.2258 Acc: 0.9850
val Loss: 3.5546 Acc: 0.8516
Epoch 30/47
----------
train Loss: 0.4578 Acc: 0.9649
val Loss: 2.8747 Acc: 0.8047
Epoch 31/47
----------
train Loss: 0.6105 Acc: 0.9232
val Loss: 6.0153 Acc: 0.7188
Epoch 32/47
----------
train Loss: 0.7853 Acc: 0.9232
val Loss: 6.1392 Acc: 0.7734
Epoch 33/47
----------
train Loss: 0.2561 Acc: 0.9783
val Loss: 4.3919 Acc: 0.8438
Epoch 34/47
----------
train Loss: 0.4660 Acc: 0.9566
val Loss: 5.3150 Acc: 0.7969
Epoch 35/47
----------
train Loss: 0.7383 Acc: 0.9416
val Loss: 3.8560 Acc: 0.7578
Epoch 36/47
----------
train Loss: 0.5130 Acc: 0.9432
val Loss: 3.1285 Acc: 0.8594
Epoch 37/47
----------
train Loss: 0.3236 Acc: 0.9683
val Loss: 3.3107 Acc: 0.8438
Epoch 38/47
----------
train Loss: 0.1775 Acc: 0.9800
val Loss: 5.0707 Acc: 0.8281
Epoch 39/47
----------
train Loss: 0.1622 Acc: 0.9866
val Loss: 5.6061 Acc: 0.7734
Epoch 40/47
----------
train Loss: 0.2378 Acc: 0.9883
val Loss: 4.8479 Acc: 0.8125
Epoch 41/47
----------
train Loss: 0.1466 Acc: 0.9766
val Loss: 3.9622 Acc: 0.8359
Epoch 42/47
----------
train Loss: 0.0633 Acc: 0.9967
val Loss: 4.4480 Acc: 0.8438
Epoch 43/47
----------
train Loss: 0.0897 Acc: 0.9883
val Loss: 4.3198 Acc: 0.8516
Epoch 44/47
----------
train Loss: 0.0782 Acc: 0.9900
val Loss: 3.4791 Acc: 0.8672
Epoch 45/47
----------
train Loss: 0.0321 Acc: 0.9983
val Loss: 4.7949 Acc: 0.8281
Epoch 46/47
----------
train Loss: 0.0435 Acc: 0.9967
val Loss: 4.3780 Acc: 0.8516
Epoch 47/47
----------
train Loss: 0.0302 Acc: 0.9967
[I 2024-10-15 18:05:03,028] Trial 119 finished with value: 0.8046875 and parameters: {'batch_size': 99, 'lr': 0.0001171086023417222, 'num_epochs': 47, 'weight_decay': 0.06479787366232917, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 5.5220 Acc: 0.8047
Best val Acc: 0.804688
Model weights saved at ./model_weights/ResNet34_bs_99_lr_0.0001171086023417222_epoch_47_wd_0.06479787366232917_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/90
----------
train Loss: 0.9155 Acc: 0.6594
val Loss: 0.7098 Acc: 0.7656
Epoch 2/90
----------
train Loss: 0.3259 Acc: 0.9098
val Loss: 0.6522 Acc: 0.7656
Epoch 3/90
----------
train Loss: 0.1437 Acc: 0.9833
val Loss: 0.7297 Acc: 0.7656
Epoch 4/90
----------
train Loss: 0.0649 Acc: 0.9967
val Loss: 0.6549 Acc: 0.8203
Epoch 5/90
----------
train Loss: 0.0661 Acc: 0.9917
val Loss: 0.7204 Acc: 0.8047
Epoch 6/90
----------
train Loss: 0.0905 Acc: 0.9783
val Loss: 0.7505 Acc: 0.7969
Epoch 7/90
----------
train Loss: 0.1812 Acc: 0.9399
val Loss: 1.4995 Acc: 0.6250
Epoch 8/90
----------
train Loss: 0.2400 Acc: 0.9249
val Loss: 1.5740 Acc: 0.7656
Epoch 9/90
----------
train Loss: 0.1713 Acc: 0.9516
val Loss: 1.0795 Acc: 0.6953
Epoch 10/90
----------
train Loss: 0.1108 Acc: 0.9616
val Loss: 0.8950 Acc: 0.7578
Epoch 11/90
----------
train Loss: 0.1285 Acc: 0.9499
val Loss: 0.7343 Acc: 0.7656
Epoch 12/90
----------
train Loss: 0.1435 Acc: 0.9499
val Loss: 0.8652 Acc: 0.8203
Epoch 13/90
----------
train Loss: 0.0990 Acc: 0.9699
val Loss: 0.9150 Acc: 0.7969
Epoch 14/90
----------
train Loss: 0.1255 Acc: 0.9616
val Loss: 0.7833 Acc: 0.7656
Epoch 15/90
----------
train Loss: 0.1049 Acc: 0.9666
val Loss: 0.6678 Acc: 0.8125
Epoch 16/90
----------
train Loss: 0.0864 Acc: 0.9733
val Loss: 0.7512 Acc: 0.7969
Epoch 17/90
----------
train Loss: 0.1185 Acc: 0.9533
val Loss: 1.4209 Acc: 0.7344
Epoch 18/90
----------
train Loss: 0.2306 Acc: 0.9332
val Loss: 1.8516 Acc: 0.5781
Epoch 19/90
----------
train Loss: 0.2098 Acc: 0.9249
val Loss: 1.1578 Acc: 0.7109
Epoch 20/90
----------
train Loss: 0.1838 Acc: 0.9482
val Loss: 0.8725 Acc: 0.7578
Epoch 21/90
----------
train Loss: 0.1501 Acc: 0.9466
val Loss: 0.7298 Acc: 0.7891
Epoch 22/90
----------
train Loss: 0.0805 Acc: 0.9733
val Loss: 0.9095 Acc: 0.7812
Epoch 23/90
----------
train Loss: 0.1016 Acc: 0.9666
val Loss: 0.7703 Acc: 0.8047
Epoch 24/90
----------
train Loss: 0.0583 Acc: 0.9833
val Loss: 0.8513 Acc: 0.7578
Epoch 25/90
----------
train Loss: 0.1185 Acc: 0.9649
val Loss: 1.7026 Acc: 0.6562
Epoch 26/90
----------
train Loss: 0.2058 Acc: 0.9432
val Loss: 0.7390 Acc: 0.7578
Epoch 27/90
----------
train Loss: 0.1970 Acc: 0.9432
val Loss: 1.1532 Acc: 0.7734
Epoch 28/90
----------
train Loss: 0.1026 Acc: 0.9683
val Loss: 0.9398 Acc: 0.7578
Epoch 29/90
----------
train Loss: 0.1264 Acc: 0.9616
val Loss: 0.8619 Acc: 0.7422
Epoch 30/90
----------
train Loss: 0.1861 Acc: 0.9482
val Loss: 1.1216 Acc: 0.7656
Epoch 31/90
----------
train Loss: 0.1349 Acc: 0.9616
val Loss: 1.3701 Acc: 0.5703
Epoch 32/90
----------
train Loss: 0.1361 Acc: 0.9549
val Loss: 0.9888 Acc: 0.7422
Epoch 33/90
----------
train Loss: 0.1801 Acc: 0.9449
val Loss: 0.8701 Acc: 0.8047
Epoch 34/90
----------
train Loss: 0.1461 Acc: 0.9583
val Loss: 0.8945 Acc: 0.7422
Epoch 35/90
----------
train Loss: 0.1063 Acc: 0.9649
val Loss: 0.7578 Acc: 0.7500
Epoch 36/90
----------
train Loss: 0.1506 Acc: 0.9649
val Loss: 0.8881 Acc: 0.7266
Epoch 37/90
----------
train Loss: 0.1445 Acc: 0.9566
val Loss: 1.2580 Acc: 0.7500
Epoch 38/90
----------
train Loss: 0.1095 Acc: 0.9666
val Loss: 1.1904 Acc: 0.7891
Epoch 39/90
----------
train Loss: 0.0638 Acc: 0.9816
val Loss: 0.7134 Acc: 0.7891
Epoch 40/90
----------
train Loss: 0.0452 Acc: 0.9866
val Loss: 0.8142 Acc: 0.7812
Epoch 41/90
----------
train Loss: 0.0880 Acc: 0.9699
val Loss: 1.3475 Acc: 0.7422
Epoch 42/90
----------
train Loss: 0.1439 Acc: 0.9449
val Loss: 1.2117 Acc: 0.7578
Epoch 43/90
----------
train Loss: 0.1855 Acc: 0.9449
val Loss: 1.2369 Acc: 0.6953
Epoch 44/90
----------
train Loss: 0.2059 Acc: 0.9249
val Loss: 1.0155 Acc: 0.7656
Epoch 45/90
----------
train Loss: 0.2404 Acc: 0.9182
val Loss: 0.6977 Acc: 0.7891
Epoch 46/90
----------
train Loss: 0.1750 Acc: 0.9449
val Loss: 1.3452 Acc: 0.7266
Epoch 47/90
----------
train Loss: 0.1059 Acc: 0.9733
val Loss: 0.7279 Acc: 0.7891
Epoch 48/90
----------
train Loss: 0.1409 Acc: 0.9583
val Loss: 1.0462 Acc: 0.7500
Epoch 49/90
----------
train Loss: 0.1497 Acc: 0.9466
val Loss: 1.0879 Acc: 0.7031
Epoch 50/90
----------
train Loss: 0.1577 Acc: 0.9549
val Loss: 1.0475 Acc: 0.7266
Epoch 51/90
----------
train Loss: 0.1248 Acc: 0.9566
val Loss: 0.7447 Acc: 0.8203
Epoch 52/90
----------
train Loss: 0.0860 Acc: 0.9683
val Loss: 1.4492 Acc: 0.7109
Epoch 53/90
----------
train Loss: 0.0821 Acc: 0.9750
val Loss: 0.9798 Acc: 0.7109
Epoch 54/90
----------
train Loss: 0.1263 Acc: 0.9583
val Loss: 1.0166 Acc: 0.7422
Epoch 55/90
----------
train Loss: 0.1718 Acc: 0.9416
val Loss: 1.8585 Acc: 0.6562
Epoch 56/90
----------
train Loss: 0.1056 Acc: 0.9649
val Loss: 1.4039 Acc: 0.7734
Epoch 57/90
----------
train Loss: 0.1768 Acc: 0.9416
val Loss: 1.1728 Acc: 0.7109
Epoch 58/90
----------
train Loss: 0.1235 Acc: 0.9633
val Loss: 1.1162 Acc: 0.6797
Epoch 59/90
----------
train Loss: 0.1444 Acc: 0.9616
val Loss: 1.2511 Acc: 0.7266
Epoch 60/90
----------
train Loss: 0.1207 Acc: 0.9633
val Loss: 0.9764 Acc: 0.7422
Epoch 61/90
----------
train Loss: 0.0757 Acc: 0.9766
val Loss: 0.8379 Acc: 0.7578
Epoch 62/90
----------
train Loss: 0.0893 Acc: 0.9783
val Loss: 0.7928 Acc: 0.7734
Epoch 63/90
----------
train Loss: 0.0831 Acc: 0.9750
val Loss: 0.9601 Acc: 0.8047
Epoch 64/90
----------
train Loss: 0.0915 Acc: 0.9683
val Loss: 1.1456 Acc: 0.7266
Epoch 65/90
----------
train Loss: 0.0776 Acc: 0.9766
val Loss: 0.6975 Acc: 0.7969
Epoch 66/90
----------
train Loss: 0.1683 Acc: 0.9549
val Loss: 1.3399 Acc: 0.7578
Epoch 67/90
----------
train Loss: 0.0897 Acc: 0.9800
val Loss: 0.7928 Acc: 0.7734
Epoch 68/90
----------
train Loss: 0.0841 Acc: 0.9699
val Loss: 0.9214 Acc: 0.8047
Epoch 69/90
----------
train Loss: 0.1048 Acc: 0.9616
val Loss: 1.2403 Acc: 0.6953
Epoch 70/90
----------
train Loss: 0.1023 Acc: 0.9716
val Loss: 1.0323 Acc: 0.7578
Epoch 71/90
----------
train Loss: 0.0597 Acc: 0.9850
val Loss: 0.6599 Acc: 0.8047
Epoch 72/90
----------
train Loss: 0.0696 Acc: 0.9733
val Loss: 1.2980 Acc: 0.7109
Epoch 73/90
----------
train Loss: 0.0741 Acc: 0.9716
val Loss: 0.9514 Acc: 0.6797
Epoch 74/90
----------
train Loss: 0.0827 Acc: 0.9783
val Loss: 0.7965 Acc: 0.7734
Epoch 75/90
----------
train Loss: 0.0833 Acc: 0.9800
val Loss: 1.4837 Acc: 0.6016
Epoch 76/90
----------
train Loss: 0.0998 Acc: 0.9733
val Loss: 0.8462 Acc: 0.7344
Epoch 77/90
----------
train Loss: 0.2210 Acc: 0.9332
val Loss: 2.5639 Acc: 0.4609
Epoch 78/90
----------
train Loss: 0.0848 Acc: 0.9783
val Loss: 0.9843 Acc: 0.7891
Epoch 79/90
----------
train Loss: 0.1604 Acc: 0.9499
val Loss: 1.1245 Acc: 0.7422
Epoch 80/90
----------
train Loss: 0.1775 Acc: 0.9449
val Loss: 0.9402 Acc: 0.7266
Epoch 81/90
----------
train Loss: 0.1213 Acc: 0.9716
val Loss: 0.7698 Acc: 0.7734
Epoch 82/90
----------
train Loss: 0.1266 Acc: 0.9566
val Loss: 1.2599 Acc: 0.7188
Epoch 83/90
----------
train Loss: 0.1481 Acc: 0.9566
val Loss: 0.8783 Acc: 0.7891
Epoch 84/90
----------
train Loss: 0.1196 Acc: 0.9649
val Loss: 1.0092 Acc: 0.7344
Epoch 85/90
----------
train Loss: 0.1228 Acc: 0.9716
val Loss: 0.7660 Acc: 0.7578
Epoch 86/90
----------
train Loss: 0.0540 Acc: 0.9900
val Loss: 1.2645 Acc: 0.7422
Epoch 87/90
----------
train Loss: 0.0595 Acc: 0.9766
val Loss: 1.4254 Acc: 0.7422
Epoch 88/90
----------
train Loss: 0.0476 Acc: 0.9917
val Loss: 0.7476 Acc: 0.7734
Epoch 89/90
----------
train Loss: 0.0391 Acc: 0.9917
val Loss: 0.8218 Acc: 0.7500
Epoch 90/90
----------
train Loss: 0.0577 Acc: 0.9866
[I 2024-10-15 18:11:46,083] Trial 120 finished with value: 0.75 and parameters: {'batch_size': 111, 'lr': 8.945944741259201e-05, 'num_epochs': 90, 'weight_decay': 0.14526733154849433, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 0.9382 Acc: 0.7500
Best val Acc: 0.750000
Model weights saved at ./model_weights/ResNet34_bs_111_lr_8.945944741259201e-05_epoch_90_wd_0.14526733154849433_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/58
----------
train Loss: 4.0474 Acc: 0.5359
val Loss: 3.1269 Acc: 0.7422
Epoch 2/58
----------
train Loss: 1.4014 Acc: 0.7963
val Loss: 2.5004 Acc: 0.7812
Epoch 3/58
----------
train Loss: 0.3586 Acc: 0.9566
val Loss: 2.8582 Acc: 0.7969
Epoch 4/58
----------
train Loss: 0.1795 Acc: 0.9833
val Loss: 3.4611 Acc: 0.7891
Epoch 5/58
----------
train Loss: 0.2333 Acc: 0.9816
val Loss: 3.1130 Acc: 0.8281
Epoch 6/58
----------
train Loss: 0.1727 Acc: 0.9850
val Loss: 4.2172 Acc: 0.8203
Epoch 7/58
----------
train Loss: 0.1576 Acc: 0.9900
val Loss: 3.5479 Acc: 0.7969
Epoch 8/58
----------
train Loss: 0.3561 Acc: 0.9633
val Loss: 5.7206 Acc: 0.5859
Epoch 9/58
----------
train Loss: 0.8366 Acc: 0.9098
val Loss: 5.7911 Acc: 0.7969
Epoch 10/58
----------
train Loss: 0.9416 Acc: 0.8982
val Loss: 2.9944 Acc: 0.7031
Epoch 11/58
----------
train Loss: 1.0952 Acc: 0.9199
val Loss: 6.5471 Acc: 0.7812
Epoch 12/58
----------
train Loss: 0.8820 Acc: 0.9048
val Loss: 2.3604 Acc: 0.7109
Epoch 13/58
----------
train Loss: 0.5532 Acc: 0.9399
val Loss: 4.3661 Acc: 0.7734
Epoch 14/58
----------
train Loss: 0.3357 Acc: 0.9599
val Loss: 4.2582 Acc: 0.7891
Epoch 15/58
----------
train Loss: 0.4340 Acc: 0.9482
val Loss: 2.8314 Acc: 0.7734
Epoch 16/58
----------
train Loss: 0.3081 Acc: 0.9699
val Loss: 2.4802 Acc: 0.7969
Epoch 17/58
----------
train Loss: 0.1369 Acc: 0.9766
val Loss: 2.6088 Acc: 0.8203
Epoch 18/58
----------
train Loss: 0.0698 Acc: 0.9933
val Loss: 3.7121 Acc: 0.8438
Epoch 19/58
----------
train Loss: 0.0222 Acc: 0.9983
val Loss: 3.6719 Acc: 0.8594
Epoch 20/58
----------
train Loss: 0.0500 Acc: 0.9950
val Loss: 3.7726 Acc: 0.8516
Epoch 21/58
----------
train Loss: 0.0758 Acc: 0.9917
val Loss: 3.5640 Acc: 0.8750
Epoch 22/58
----------
train Loss: 0.0430 Acc: 0.9983
val Loss: 2.4809 Acc: 0.8047
Epoch 23/58
----------
train Loss: 0.1010 Acc: 0.9866
val Loss: 3.3669 Acc: 0.8516
Epoch 24/58
----------
train Loss: 0.0747 Acc: 0.9917
val Loss: 3.1721 Acc: 0.8203
Epoch 25/58
----------
train Loss: 0.0931 Acc: 0.9866
val Loss: 3.1977 Acc: 0.8594
Epoch 26/58
----------
train Loss: 0.2519 Acc: 0.9683
val Loss: 3.0428 Acc: 0.7812
Epoch 27/58
----------
train Loss: 0.2760 Acc: 0.9800
val Loss: 3.9892 Acc: 0.7891
Epoch 28/58
----------
train Loss: 0.4003 Acc: 0.9633
val Loss: 4.0133 Acc: 0.7422
Epoch 29/58
----------
train Loss: 0.9054 Acc: 0.9115
val Loss: 9.1335 Acc: 0.4219
Epoch 30/58
----------
train Loss: 1.1099 Acc: 0.9249
[I 2024-10-15 18:13:58,840] Trial 121 finished with value: 0.859375 and parameters: {'batch_size': 107, 'lr': 0.00014301431385620072, 'num_epochs': 58, 'weight_decay': 0.04914547451194355, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 4.1763 Acc: 0.6875
Early stopping at epoch 30 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.859375
Model weights saved at ./model_weights/ResNet34_bs_107_lr_0.00014301431385620072_epoch_58_wd_0.04914547451194355_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/53
----------
train Loss: 4.3035 Acc: 0.5943
val Loss: 4.6074 Acc: 0.7969
Epoch 2/53
----------
train Loss: 1.9748 Acc: 0.7913
val Loss: 3.1510 Acc: 0.7109
Epoch 3/53
----------
train Loss: 1.2744 Acc: 0.8681
val Loss: 2.6688 Acc: 0.7422
Epoch 4/53
----------
train Loss: 0.8035 Acc: 0.9232
val Loss: 3.5731 Acc: 0.7812
Epoch 5/53
----------
train Loss: 0.7537 Acc: 0.9165
val Loss: 5.5748 Acc: 0.7891
Epoch 6/53
----------
train Loss: 0.8567 Acc: 0.8998
val Loss: 3.7868 Acc: 0.6328
Epoch 7/53
----------
train Loss: 1.1654 Acc: 0.8664
val Loss: 5.3414 Acc: 0.7344
Epoch 8/53
----------
train Loss: 1.2444 Acc: 0.8648
val Loss: 3.7335 Acc: 0.8359
Epoch 9/53
----------
train Loss: 0.8280 Acc: 0.9048
val Loss: 3.2278 Acc: 0.7031
Epoch 10/53
----------
train Loss: 1.1426 Acc: 0.8982
val Loss: 10.5286 Acc: 0.6719
Epoch 11/53
----------
train Loss: 1.2717 Acc: 0.8497
val Loss: 4.4632 Acc: 0.6250
Epoch 12/53
----------
train Loss: 0.7715 Acc: 0.9048
val Loss: 7.2749 Acc: 0.6406
Epoch 13/53
----------
train Loss: 2.0394 Acc: 0.8514
[I 2024-10-15 18:14:58,410] Trial 122 finished with value: 0.8359375 and parameters: {'batch_size': 106, 'lr': 0.0003451393689997674, 'num_epochs': 53, 'weight_decay': 0.05796368335876666, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 14.2014 Acc: 0.4531
Early stopping at epoch 13 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.835938
Model weights saved at ./model_weights/ResNet34_bs_106_lr_0.0003451393689997674_epoch_53_wd_0.05796368335876666_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/51
----------
train Loss: 4.2711 Acc: 0.3790
val Loss: 3.7287 Acc: 0.7031
Epoch 2/51
----------
train Loss: 1.3423 Acc: 0.8063
val Loss: 2.7440 Acc: 0.7656
Epoch 3/51
----------
train Loss: 0.5301 Acc: 0.9549
val Loss: 2.7564 Acc: 0.8359
Epoch 4/51
----------
train Loss: 0.2169 Acc: 0.9900
val Loss: 2.9862 Acc: 0.8594
Epoch 5/51
----------
train Loss: 0.1424 Acc: 0.9950
val Loss: 3.1298 Acc: 0.8594
Epoch 6/51
----------
train Loss: 0.1251 Acc: 0.9967
val Loss: 3.4687 Acc: 0.8594
Epoch 7/51
----------
train Loss: 0.1242 Acc: 0.9967
val Loss: 3.2802 Acc: 0.8516
Epoch 8/51
----------
train Loss: 0.0760 Acc: 0.9967
val Loss: 3.4343 Acc: 0.8516
Epoch 9/51
----------
train Loss: 0.0640 Acc: 0.9967
val Loss: 3.6465 Acc: 0.8594
Epoch 10/51
----------
train Loss: 0.0789 Acc: 0.9950
val Loss: 3.8819 Acc: 0.8359
Epoch 11/51
----------
train Loss: 0.0638 Acc: 0.9967
val Loss: 4.0705 Acc: 0.8359
Epoch 12/51
----------
train Loss: 0.0544 Acc: 0.9967
val Loss: 3.8425 Acc: 0.8516
Epoch 13/51
----------
train Loss: 0.0539 Acc: 0.9967
val Loss: 3.9324 Acc: 0.8594
Epoch 14/51
----------
train Loss: 0.0422 Acc: 0.9967
val Loss: 3.8021 Acc: 0.8594
Epoch 15/51
----------
train Loss: 0.0368 Acc: 1.0000
val Loss: 3.8887 Acc: 0.8594
Epoch 16/51
----------
train Loss: 0.0498 Acc: 0.9983
val Loss: 4.5822 Acc: 0.8281
Epoch 17/51
----------
train Loss: 0.1681 Acc: 0.9883
val Loss: 3.7072 Acc: 0.8203
Epoch 18/51
----------
train Loss: 0.1524 Acc: 0.9900
val Loss: 4.2318 Acc: 0.7969
Epoch 19/51
----------
train Loss: 0.4832 Acc: 0.9332
val Loss: 5.3141 Acc: 0.8203
Epoch 20/51
----------
train Loss: 0.6003 Acc: 0.9382
val Loss: 4.4114 Acc: 0.7891
Epoch 21/51
----------
train Loss: 0.2966 Acc: 0.9750
val Loss: 4.4271 Acc: 0.8047
Epoch 22/51
----------
train Loss: 0.8102 Acc: 0.9382
val Loss: 3.7058 Acc: 0.7500
Epoch 23/51
----------
train Loss: 1.0113 Acc: 0.9249
val Loss: 6.3196 Acc: 0.7734
Epoch 24/51
----------
train Loss: 0.5791 Acc: 0.9432
val Loss: 4.3683 Acc: 0.7812
Epoch 25/51
----------
train Loss: 0.2299 Acc: 0.9766
val Loss: 5.0542 Acc: 0.8203
Epoch 26/51
----------
train Loss: 0.1867 Acc: 0.9833
val Loss: 4.7799 Acc: 0.8203
Epoch 27/51
----------
train Loss: 0.0645 Acc: 0.9967
val Loss: 4.6681 Acc: 0.8359
Epoch 28/51
----------
train Loss: 0.0516 Acc: 0.9967
val Loss: 5.0406 Acc: 0.8672
Epoch 29/51
----------
train Loss: 0.0530 Acc: 0.9967
val Loss: 5.0633 Acc: 0.8516
Epoch 30/51
----------
train Loss: 0.1007 Acc: 0.9933
val Loss: 5.1171 Acc: 0.8594
Epoch 31/51
----------
train Loss: 0.0747 Acc: 0.9933
val Loss: 4.6499 Acc: 0.8438
Epoch 32/51
----------
train Loss: 0.0341 Acc: 0.9983
val Loss: 4.7066 Acc: 0.8516
Epoch 33/51
----------
train Loss: 0.0319 Acc: 0.9983
val Loss: 4.5186 Acc: 0.8438
Epoch 34/51
----------
train Loss: 0.0314 Acc: 0.9967
val Loss: 4.4882 Acc: 0.8438
Epoch 35/51
----------
train Loss: 0.0245 Acc: 0.9967
val Loss: 4.5185 Acc: 0.8516
Epoch 36/51
----------
train Loss: 0.0275 Acc: 0.9983
val Loss: 4.6349 Acc: 0.8359
Epoch 37/51
----------
train Loss: 0.0419 Acc: 0.9950
val Loss: 4.8913 Acc: 0.8594
Epoch 38/51
----------
train Loss: 0.0290 Acc: 0.9983
val Loss: 4.8309 Acc: 0.8438
Epoch 39/51
----------
train Loss: 0.0230 Acc: 0.9983
val Loss: 4.7683 Acc: 0.8359
Epoch 40/51
----------
train Loss: 0.0279 Acc: 0.9967
val Loss: 4.4670 Acc: 0.8359
Epoch 41/51
----------
train Loss: 0.0264 Acc: 0.9983
val Loss: 4.5931 Acc: 0.8281
Epoch 42/51
----------
train Loss: 0.0245 Acc: 0.9983
val Loss: 4.8384 Acc: 0.8359
Epoch 43/51
----------
train Loss: 0.0251 Acc: 0.9983
val Loss: 4.5969 Acc: 0.8516
Epoch 44/51
----------
train Loss: 0.0261 Acc: 0.9983
val Loss: 4.8113 Acc: 0.8516
Epoch 45/51
----------
train Loss: 0.0284 Acc: 0.9967
val Loss: 4.8620 Acc: 0.8594
Epoch 46/51
----------
train Loss: 0.0217 Acc: 0.9983
val Loss: 4.8140 Acc: 0.8359
Epoch 47/51
----------
train Loss: 0.0216 Acc: 0.9983
val Loss: 5.0037 Acc: 0.8438
Epoch 48/51
----------
train Loss: 0.0222 Acc: 0.9983
val Loss: 4.9407 Acc: 0.8516
Epoch 49/51
----------
train Loss: 0.0303 Acc: 0.9967
val Loss: 5.3552 Acc: 0.8359
Epoch 50/51
----------
train Loss: 0.0262 Acc: 0.9983
val Loss: 5.1510 Acc: 0.8281
Epoch 51/51
----------
train Loss: 0.0226 Acc: 0.9983
[I 2024-10-15 18:18:50,250] Trial 123 finished with value: 0.8515625 and parameters: {'batch_size': 63, 'lr': 5.4081454623701924e-05, 'num_epochs': 51, 'weight_decay': 0.04029373396331618, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 4.6824 Acc: 0.8516
Best val Acc: 0.851562
Model weights saved at ./model_weights/ResNet34_bs_63_lr_5.4081454623701924e-05_epoch_51_wd_0.04029373396331618_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/55
----------
train Loss: 4.4297 Acc: 0.3823
val Loss: 2.7092 Acc: 0.6875
Epoch 2/55
----------
train Loss: 1.3410 Acc: 0.8397
val Loss: 2.2251 Acc: 0.7891
Epoch 3/55
----------
train Loss: 0.4791 Acc: 0.9649
val Loss: 2.3201 Acc: 0.8047
Epoch 4/55
----------
train Loss: 0.3232 Acc: 0.9800
val Loss: 2.5012 Acc: 0.8125
Epoch 5/55
----------
train Loss: 0.2027 Acc: 0.9866
val Loss: 2.4661 Acc: 0.8047
Epoch 6/55
----------
train Loss: 0.1580 Acc: 0.9883
val Loss: 2.5214 Acc: 0.7969
Epoch 7/55
----------
train Loss: 0.1555 Acc: 0.9900
val Loss: 2.6488 Acc: 0.8047
Epoch 8/55
----------
train Loss: 0.1157 Acc: 0.9866
val Loss: 2.6497 Acc: 0.7969
Epoch 9/55
----------
train Loss: 0.0895 Acc: 0.9900
val Loss: 3.0335 Acc: 0.8047
Epoch 10/55
----------
train Loss: 0.0895 Acc: 0.9917
val Loss: 3.0070 Acc: 0.8047
Epoch 11/55
----------
train Loss: 0.0849 Acc: 0.9900
val Loss: 3.1015 Acc: 0.8281
Epoch 12/55
----------
train Loss: 0.0626 Acc: 0.9950
val Loss: 2.9939 Acc: 0.8203
Epoch 13/55
----------
train Loss: 0.0808 Acc: 0.9917
val Loss: 3.1562 Acc: 0.8438
Epoch 14/55
----------
train Loss: 0.0793 Acc: 0.9950
val Loss: 3.1399 Acc: 0.8203
Epoch 15/55
----------
train Loss: 0.0600 Acc: 0.9950
val Loss: 3.4473 Acc: 0.8359
Epoch 16/55
----------
train Loss: 0.0796 Acc: 0.9933
val Loss: 3.8962 Acc: 0.7891
Epoch 17/55
----------
train Loss: 0.3003 Acc: 0.9750
val Loss: 3.8792 Acc: 0.6562
Epoch 18/55
----------
train Loss: 1.8855 Acc: 0.8548
val Loss: 6.6020 Acc: 0.7812
Epoch 19/55
----------
train Loss: 1.4867 Acc: 0.8681
val Loss: 10.7408 Acc: 0.7734
Epoch 20/55
----------
train Loss: 1.0987 Acc: 0.8598
val Loss: 3.3095 Acc: 0.7031
Epoch 21/55
----------
train Loss: 0.4786 Acc: 0.9583
val Loss: 2.9731 Acc: 0.8359
Epoch 22/55
----------
train Loss: 0.3215 Acc: 0.9683
val Loss: 3.1774 Acc: 0.8203
Epoch 23/55
----------
train Loss: 0.1254 Acc: 0.9850
val Loss: 3.1896 Acc: 0.8125
Epoch 24/55
----------
train Loss: 0.1241 Acc: 0.9833
val Loss: 3.6665 Acc: 0.8281
Epoch 25/55
----------
train Loss: 0.1289 Acc: 0.9850
val Loss: 3.8362 Acc: 0.8281
Epoch 26/55
----------
train Loss: 0.0977 Acc: 0.9900
val Loss: 3.6280 Acc: 0.8359
Epoch 27/55
----------
train Loss: 0.0664 Acc: 0.9900
val Loss: 3.7999 Acc: 0.8281
Epoch 28/55
----------
train Loss: 0.0604 Acc: 0.9933
val Loss: 3.8185 Acc: 0.8281
Epoch 29/55
----------
train Loss: 0.0649 Acc: 0.9900
val Loss: 3.5025 Acc: 0.8203
Epoch 30/55
----------
train Loss: 0.0499 Acc: 0.9933
val Loss: 3.5508 Acc: 0.8359
Epoch 31/55
----------
train Loss: 0.0403 Acc: 0.9950
val Loss: 3.8205 Acc: 0.8438
Epoch 32/55
----------
train Loss: 0.0464 Acc: 0.9950
val Loss: 4.0334 Acc: 0.8359
Epoch 33/55
----------
train Loss: 0.0648 Acc: 0.9933
val Loss: 4.8299 Acc: 0.8359
Epoch 34/55
----------
train Loss: 0.1017 Acc: 0.9883
val Loss: 4.1206 Acc: 0.8047
Epoch 35/55
----------
train Loss: 0.0563 Acc: 0.9950
val Loss: 3.9300 Acc: 0.7891
Epoch 36/55
----------
train Loss: 0.0437 Acc: 0.9950
val Loss: 3.9429 Acc: 0.7969
Epoch 37/55
----------
train Loss: 0.0811 Acc: 0.9883
val Loss: 4.8759 Acc: 0.8203
Epoch 38/55
----------
train Loss: 0.2485 Acc: 0.9783
val Loss: 3.5146 Acc: 0.7656
Epoch 39/55
----------
train Loss: 0.3627 Acc: 0.9466
val Loss: 3.3805 Acc: 0.7969
Epoch 40/55
----------
train Loss: 0.4062 Acc: 0.9633
val Loss: 4.1140 Acc: 0.7969
Epoch 41/55
----------
train Loss: 0.7523 Acc: 0.9015
val Loss: 4.4099 Acc: 0.7422
Epoch 42/55
----------
train Loss: 0.6142 Acc: 0.9416
val Loss: 3.3819 Acc: 0.7344
Epoch 43/55
----------
train Loss: 0.8169 Acc: 0.9549
val Loss: 3.3782 Acc: 0.8047
Epoch 44/55
----------
train Loss: 0.5512 Acc: 0.9449
val Loss: 4.0474 Acc: 0.7969
Epoch 45/55
----------
train Loss: 0.2938 Acc: 0.9733
val Loss: 3.4661 Acc: 0.8125
Epoch 46/55
----------
train Loss: 0.1839 Acc: 0.9766
val Loss: 2.5618 Acc: 0.7812
Epoch 47/55
----------
train Loss: 0.2305 Acc: 0.9750
val Loss: 3.7574 Acc: 0.8125
Epoch 48/55
----------
train Loss: 0.2774 Acc: 0.9816
val Loss: 2.9430 Acc: 0.8203
Epoch 49/55
----------
train Loss: 0.2100 Acc: 0.9866
val Loss: 4.5538 Acc: 0.8203
Epoch 50/55
----------
train Loss: 0.1204 Acc: 0.9783
val Loss: 3.4330 Acc: 0.8594
Epoch 51/55
----------
train Loss: 0.0755 Acc: 0.9917
val Loss: 4.0412 Acc: 0.8438
Epoch 52/55
----------
train Loss: 0.0768 Acc: 0.9950
val Loss: 4.6692 Acc: 0.8125
Epoch 53/55
----------
train Loss: 0.0819 Acc: 0.9883
val Loss: 3.9068 Acc: 0.8438
Epoch 54/55
----------
train Loss: 0.0577 Acc: 0.9933
val Loss: 4.0066 Acc: 0.8281
Epoch 55/55
----------
train Loss: 0.0580 Acc: 0.9933
[I 2024-10-15 18:22:57,320] Trial 124 finished with value: 0.8359375 and parameters: {'batch_size': 116, 'lr': 6.395902753774155e-05, 'num_epochs': 55, 'weight_decay': 0.07195443908518095, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 4.2522 Acc: 0.8359
Best val Acc: 0.835938
Model weights saved at ./model_weights/ResNet34_bs_116_lr_6.395902753774155e-05_epoch_55_wd_0.07195443908518095_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/49
----------
train Loss: 3.9777 Acc: 0.5376
val Loss: 3.1035 Acc: 0.7578
Epoch 2/49
----------
train Loss: 1.0452 Acc: 0.8748
val Loss: 1.9283 Acc: 0.8438
Epoch 3/49
----------
train Loss: 0.7075 Acc: 0.9249
val Loss: 2.4241 Acc: 0.8047
Epoch 4/49
----------
train Loss: 0.5799 Acc: 0.9232
val Loss: 2.3874 Acc: 0.8594
Epoch 5/49
----------
train Loss: 0.4847 Acc: 0.9499
val Loss: 2.2458 Acc: 0.8047
Epoch 6/49
----------
train Loss: 0.2898 Acc: 0.9649
val Loss: 2.3417 Acc: 0.8594
Epoch 7/49
----------
train Loss: 0.1794 Acc: 0.9783
val Loss: 2.5387 Acc: 0.8359
Epoch 8/49
----------
train Loss: 0.2184 Acc: 0.9766
val Loss: 3.8586 Acc: 0.6797
Epoch 9/49
----------
train Loss: 0.8635 Acc: 0.9115
val Loss: 3.8650 Acc: 0.8203
Epoch 10/49
----------
train Loss: 0.7243 Acc: 0.9199
val Loss: 3.1944 Acc: 0.7578
Epoch 11/49
----------
train Loss: 0.9592 Acc: 0.9082
val Loss: 5.0493 Acc: 0.7734
Epoch 12/49
----------
train Loss: 0.8033 Acc: 0.9065
val Loss: 3.6622 Acc: 0.7188
Epoch 13/49
----------
train Loss: 0.8329 Acc: 0.9282
val Loss: 2.4787 Acc: 0.8047
Epoch 14/49
----------
train Loss: 0.4587 Acc: 0.9432
val Loss: 4.3223 Acc: 0.7031
Epoch 15/49
----------
train Loss: 0.5837 Acc: 0.9616
val Loss: 3.9798 Acc: 0.8203
Epoch 16/49
----------
train Loss: 0.5947 Acc: 0.9583
val Loss: 2.9589 Acc: 0.7656
Epoch 17/49
----------
train Loss: 0.2527 Acc: 0.9616
val Loss: 2.7945 Acc: 0.8203
Epoch 18/49
----------
train Loss: 0.2623 Acc: 0.9616
val Loss: 2.6747 Acc: 0.8438
Epoch 19/49
----------
train Loss: 0.2095 Acc: 0.9800
val Loss: 2.4570 Acc: 0.8203
Epoch 20/49
----------
train Loss: 0.1879 Acc: 0.9816
val Loss: 4.3531 Acc: 0.8438
Epoch 21/49
----------
train Loss: 0.1690 Acc: 0.9866
val Loss: 4.5295 Acc: 0.8203
Epoch 22/49
----------
train Loss: 0.1034 Acc: 0.9933
val Loss: 3.5475 Acc: 0.8125
Epoch 23/49
----------
train Loss: 0.1739 Acc: 0.9833
val Loss: 3.7259 Acc: 0.8047
Epoch 24/49
----------
train Loss: 0.0736 Acc: 0.9933
val Loss: 3.7792 Acc: 0.8203
Epoch 25/49
----------
train Loss: 0.1933 Acc: 0.9733
val Loss: 4.3745 Acc: 0.7812
Epoch 26/49
----------
train Loss: 0.3096 Acc: 0.9599
val Loss: 4.0248 Acc: 0.8281
Epoch 27/49
----------
train Loss: 0.3096 Acc: 0.9716
val Loss: 3.0217 Acc: 0.8750
Epoch 28/49
----------
train Loss: 0.2717 Acc: 0.9783
val Loss: 3.6058 Acc: 0.6953
Epoch 29/49
----------
train Loss: 0.2881 Acc: 0.9599
val Loss: 3.0036 Acc: 0.8672
Epoch 30/49
----------
train Loss: 0.2623 Acc: 0.9866
val Loss: 2.5961 Acc: 0.8438
Epoch 31/49
----------
train Loss: 0.8581 Acc: 0.9466
val Loss: 5.7347 Acc: 0.7812
Epoch 32/49
----------
train Loss: 1.4178 Acc: 0.8648
val Loss: 9.4201 Acc: 0.7500
Epoch 33/49
----------
train Loss: 1.3187 Acc: 0.8548
val Loss: 6.3467 Acc: 0.6172
Epoch 34/49
----------
train Loss: 0.6281 Acc: 0.9282
val Loss: 2.6237 Acc: 0.8203
Epoch 35/49
----------
train Loss: 0.2736 Acc: 0.9733
val Loss: 2.6419 Acc: 0.7734
Epoch 36/49
----------
train Loss: 0.2691 Acc: 0.9666
val Loss: 2.8215 Acc: 0.8359
Epoch 37/49
----------
train Loss: 0.2425 Acc: 0.9716
val Loss: 1.7861 Acc: 0.8047
Epoch 38/49
----------
train Loss: 0.1964 Acc: 0.9750
val Loss: 2.3670 Acc: 0.8516
Epoch 39/49
----------
train Loss: 0.1550 Acc: 0.9800
val Loss: 2.8288 Acc: 0.8203
Epoch 40/49
----------
train Loss: 0.2248 Acc: 0.9850
val Loss: 2.7407 Acc: 0.8281
Epoch 41/49
----------
train Loss: 0.2638 Acc: 0.9699
val Loss: 3.4529 Acc: 0.8516
Epoch 42/49
----------
train Loss: 0.1320 Acc: 0.9866
val Loss: 3.6772 Acc: 0.7969
Epoch 43/49
----------
train Loss: 0.1068 Acc: 0.9866
val Loss: 2.3894 Acc: 0.8203
Epoch 44/49
----------
train Loss: 0.0743 Acc: 0.9933
val Loss: 2.8701 Acc: 0.8281
Epoch 45/49
----------
train Loss: 0.0910 Acc: 0.9917
val Loss: 3.2130 Acc: 0.8750
Epoch 46/49
----------
train Loss: 0.1594 Acc: 0.9833
val Loss: 3.7038 Acc: 0.8672
Epoch 47/49
----------
train Loss: 0.1015 Acc: 0.9816
val Loss: 2.8148 Acc: 0.7969
Epoch 48/49
----------
train Loss: 0.3016 Acc: 0.9766
val Loss: 2.5489 Acc: 0.7812
Epoch 49/49
----------
train Loss: 0.9417 Acc: 0.9098
[I 2024-10-15 18:26:37,166] Trial 125 finished with value: 0.8671875 and parameters: {'batch_size': 102, 'lr': 0.00017950037616990835, 'num_epochs': 49, 'weight_decay': 0.03301350431542892, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 16.4371 Acc: 0.4531
Best val Acc: 0.867188
Model weights saved at ./model_weights/ResNet34_bs_102_lr_0.00017950037616990835_epoch_49_wd_0.03301350431542892_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/50
----------
train Loss: 3.7376 Acc: 0.5526
val Loss: 8.6612 Acc: 0.7031
Epoch 2/50
----------
train Loss: 1.3104 Acc: 0.8531
val Loss: 5.6484 Acc: 0.7188
Epoch 3/50
----------
train Loss: 0.5348 Acc: 0.9316
val Loss: 5.2653 Acc: 0.7422
Epoch 4/50
----------
train Loss: 0.3255 Acc: 0.9516
val Loss: 6.2631 Acc: 0.7422
Epoch 5/50
----------
train Loss: 0.2812 Acc: 0.9599
val Loss: 6.2959 Acc: 0.7109
Epoch 6/50
----------
train Loss: 0.5075 Acc: 0.9549
val Loss: 5.7997 Acc: 0.6172
Epoch 7/50
----------
train Loss: 0.7491 Acc: 0.9316
val Loss: 13.3357 Acc: 0.5938
Epoch 8/50
----------
train Loss: 0.6516 Acc: 0.9416
val Loss: 8.4794 Acc: 0.6250
Epoch 9/50
----------
train Loss: 1.0029 Acc: 0.8898
val Loss: 5.3584 Acc: 0.7031
Epoch 10/50
----------
train Loss: 0.3880 Acc: 0.9516
val Loss: 6.7192 Acc: 0.7578
Epoch 11/50
----------
train Loss: 0.4530 Acc: 0.9649
val Loss: 7.4134 Acc: 0.5312
Epoch 12/50
----------
train Loss: 0.5626 Acc: 0.9499
val Loss: 6.2940 Acc: 0.6953
Epoch 13/50
----------
train Loss: 0.1626 Acc: 0.9783
val Loss: 5.6288 Acc: 0.7109
Epoch 14/50
----------
train Loss: 0.1578 Acc: 0.9800
val Loss: 5.6206 Acc: 0.7344
Epoch 15/50
----------
train Loss: 0.0860 Acc: 0.9866
val Loss: 7.6502 Acc: 0.7109
Epoch 16/50
----------
train Loss: 0.1190 Acc: 0.9833
val Loss: 7.6691 Acc: 0.7109
Epoch 17/50
----------
train Loss: 0.1386 Acc: 0.9883
val Loss: 7.7369 Acc: 0.7188
Epoch 18/50
----------
train Loss: 0.4410 Acc: 0.9533
val Loss: 7.8848 Acc: 0.7422
Epoch 19/50
----------
train Loss: 0.1657 Acc: 0.9766
val Loss: 8.1506 Acc: 0.6875
Epoch 20/50
----------
train Loss: 0.0764 Acc: 0.9933
val Loss: 6.9484 Acc: 0.7344
Epoch 21/50
----------
train Loss: 0.0861 Acc: 0.9933
val Loss: 8.4151 Acc: 0.6797
Epoch 22/50
----------
train Loss: 0.0975 Acc: 0.9866
val Loss: 6.2271 Acc: 0.6562
Epoch 23/50
----------
train Loss: 0.4338 Acc: 0.9432
val Loss: 9.3311 Acc: 0.6562
Epoch 24/50
----------
train Loss: 0.7635 Acc: 0.9182
val Loss: 13.2904 Acc: 0.5781
Epoch 25/50
----------
train Loss: 0.7353 Acc: 0.9282
val Loss: 15.0577 Acc: 0.7031
Epoch 26/50
----------
train Loss: 1.1756 Acc: 0.9015
val Loss: 14.4319 Acc: 0.3125
Epoch 27/50
----------
train Loss: 1.0887 Acc: 0.8848
val Loss: 5.5687 Acc: 0.7188
Epoch 28/50
----------
train Loss: 0.8847 Acc: 0.9316
val Loss: 6.5397 Acc: 0.7109
Epoch 29/50
----------
train Loss: 0.6119 Acc: 0.9366
val Loss: 9.4563 Acc: 0.6719
Epoch 30/50
----------
train Loss: 0.6379 Acc: 0.9449
val Loss: 7.1111 Acc: 0.5625
Epoch 31/50
----------
train Loss: 0.5990 Acc: 0.9449
val Loss: 7.4234 Acc: 0.7500
Epoch 32/50
----------
train Loss: 0.3414 Acc: 0.9499
val Loss: 7.6992 Acc: 0.6953
Epoch 33/50
----------
train Loss: 0.2062 Acc: 0.9800
val Loss: 7.7823 Acc: 0.7578
Epoch 34/50
----------
train Loss: 0.1271 Acc: 0.9900
val Loss: 7.4642 Acc: 0.7500
Epoch 35/50
----------
train Loss: 0.0551 Acc: 0.9950
val Loss: 7.6835 Acc: 0.7344
Epoch 36/50
----------
train Loss: 0.1540 Acc: 0.9816
val Loss: 6.7673 Acc: 0.6719
Epoch 37/50
----------
train Loss: 0.1251 Acc: 0.9883
val Loss: 9.6453 Acc: 0.7578
Epoch 38/50
----------
train Loss: 0.0870 Acc: 0.9883
val Loss: 9.7607 Acc: 0.7031
Epoch 39/50
----------
train Loss: 0.0837 Acc: 0.9950
val Loss: 7.6519 Acc: 0.7500
Epoch 40/50
----------
train Loss: 0.0635 Acc: 0.9917
val Loss: 7.5014 Acc: 0.7422
Epoch 41/50
----------
train Loss: 0.0605 Acc: 0.9950
val Loss: 8.0983 Acc: 0.7422
Epoch 42/50
----------
train Loss: 0.2045 Acc: 0.9766
val Loss: 13.4518 Acc: 0.7109
Epoch 43/50
----------
train Loss: 0.3351 Acc: 0.9716
val Loss: 8.0823 Acc: 0.7109
Epoch 44/50
----------
train Loss: 0.7987 Acc: 0.9316
val Loss: 12.5692 Acc: 0.6797
Epoch 45/50
----------
train Loss: 0.5312 Acc: 0.9449
val Loss: 9.6464 Acc: 0.6875
Epoch 46/50
----------
train Loss: 0.1944 Acc: 0.9900
val Loss: 10.5238 Acc: 0.7578
Epoch 47/50
----------
train Loss: 0.2224 Acc: 0.9833
val Loss: 9.5469 Acc: 0.7109
Epoch 48/50
----------
train Loss: 0.3304 Acc: 0.9499
val Loss: 7.3525 Acc: 0.7656
Epoch 49/50
----------
train Loss: 0.4611 Acc: 0.9716
val Loss: 10.4224 Acc: 0.6875
Epoch 50/50
----------
train Loss: 0.4948 Acc: 0.9449
[I 2024-10-15 18:30:22,163] Trial 126 finished with value: 0.7421875 and parameters: {'batch_size': 101, 'lr': 0.0001913659776573178, 'num_epochs': 50, 'weight_decay': 0.033267946041814773, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 10.7596 Acc: 0.7422
Best val Acc: 0.742188
Model weights saved at ./model_weights/ResNet34_bs_101_lr_0.0001913659776573178_epoch_50_wd_0.033267946041814773_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/49
----------
train Loss: 4.4274 Acc: 0.4073
val Loss: 3.1807 Acc: 0.7344
Epoch 2/49
----------
train Loss: 1.5075 Acc: 0.7963
val Loss: 2.5520 Acc: 0.7656
Epoch 3/49
----------
train Loss: 0.7132 Acc: 0.9399
val Loss: 2.6044 Acc: 0.7656
Epoch 4/49
----------
train Loss: 0.3574 Acc: 0.9800
val Loss: 2.7355 Acc: 0.8047
Epoch 5/49
----------
train Loss: 0.2280 Acc: 0.9883
val Loss: 2.6600 Acc: 0.7891
Epoch 6/49
----------
train Loss: 0.1888 Acc: 0.9883
val Loss: 2.8066 Acc: 0.7969
Epoch 7/49
----------
train Loss: 0.1471 Acc: 0.9900
val Loss: 2.7635 Acc: 0.7812
Epoch 8/49
----------
train Loss: 0.1252 Acc: 0.9933
val Loss: 3.1303 Acc: 0.8125
Epoch 9/49
----------
train Loss: 0.0854 Acc: 0.9950
val Loss: 3.0022 Acc: 0.7734
Epoch 10/49
----------
train Loss: 0.0989 Acc: 0.9950
val Loss: 2.9708 Acc: 0.7969
Epoch 11/49
----------
train Loss: 0.1160 Acc: 0.9933
val Loss: 3.3664 Acc: 0.8047
Epoch 12/49
----------
train Loss: 0.0755 Acc: 0.9950
val Loss: 2.9114 Acc: 0.7969
Epoch 13/49
----------
train Loss: 0.0980 Acc: 0.9950
val Loss: 3.2366 Acc: 0.7891
Epoch 14/49
----------
train Loss: 0.1119 Acc: 0.9900
val Loss: 3.8846 Acc: 0.7812
Epoch 15/49
----------
train Loss: 0.1491 Acc: 0.9866
val Loss: 3.5580 Acc: 0.7969
Epoch 16/49
----------
train Loss: 0.1566 Acc: 0.9850
val Loss: 3.1286 Acc: 0.7969
Epoch 17/49
----------
train Loss: 0.1936 Acc: 0.9733
val Loss: 3.2607 Acc: 0.8047
Epoch 18/49
----------
train Loss: 0.4725 Acc: 0.9566
val Loss: 3.8718 Acc: 0.7969
Epoch 19/49
----------
train Loss: 0.8040 Acc: 0.9299
val Loss: 2.7966 Acc: 0.7031
Epoch 20/49
----------
train Loss: 0.5480 Acc: 0.9549
val Loss: 4.8125 Acc: 0.7656
Epoch 21/49
----------
train Loss: 0.3123 Acc: 0.9666
val Loss: 4.4053 Acc: 0.7969
Epoch 22/49
----------
train Loss: 0.2256 Acc: 0.9816
val Loss: 4.1682 Acc: 0.8125
Epoch 23/49
----------
train Loss: 0.4719 Acc: 0.9466
val Loss: 6.2163 Acc: 0.7578
Epoch 24/49
----------
train Loss: 0.7443 Acc: 0.9382
val Loss: 4.7315 Acc: 0.8125
Epoch 25/49
----------
train Loss: 0.4140 Acc: 0.9533
val Loss: 3.4249 Acc: 0.7734
Epoch 26/49
----------
train Loss: 0.2319 Acc: 0.9683
val Loss: 3.5656 Acc: 0.8203
Epoch 27/49
----------
train Loss: 0.1404 Acc: 0.9783
val Loss: 3.5342 Acc: 0.8047
Epoch 28/49
----------
train Loss: 0.0724 Acc: 0.9917
val Loss: 3.5638 Acc: 0.8438
Epoch 29/49
----------
train Loss: 0.0863 Acc: 0.9917
val Loss: 4.0918 Acc: 0.8359
Epoch 30/49
----------
train Loss: 0.0553 Acc: 0.9933
val Loss: 3.9017 Acc: 0.8359
Epoch 31/49
----------
train Loss: 0.0625 Acc: 0.9933
val Loss: 3.8850 Acc: 0.8359
Epoch 32/49
----------
train Loss: 0.0650 Acc: 0.9917
val Loss: 3.6228 Acc: 0.8203
Epoch 33/49
----------
train Loss: 0.2055 Acc: 0.9900
val Loss: 3.4510 Acc: 0.8047
Epoch 34/49
----------
train Loss: 0.1489 Acc: 0.9883
val Loss: 4.2940 Acc: 0.8125
Epoch 35/49
----------
train Loss: 0.1705 Acc: 0.9816
val Loss: 4.2299 Acc: 0.7734
Epoch 36/49
----------
train Loss: 0.0942 Acc: 0.9900
val Loss: 5.5292 Acc: 0.8203
Epoch 37/49
----------
train Loss: 0.0658 Acc: 0.9950
val Loss: 4.3721 Acc: 0.8125
Epoch 38/49
----------
train Loss: 0.0809 Acc: 0.9917
val Loss: 3.9460 Acc: 0.8516
Epoch 39/49
----------
train Loss: 0.0544 Acc: 0.9933
val Loss: 4.0830 Acc: 0.7969
Epoch 40/49
----------
train Loss: 0.0582 Acc: 0.9917
val Loss: 4.2602 Acc: 0.8359
Epoch 41/49
----------
train Loss: 0.0498 Acc: 0.9950
val Loss: 4.9139 Acc: 0.8125
Epoch 42/49
----------
train Loss: 0.0502 Acc: 0.9933
val Loss: 4.6482 Acc: 0.8438
Epoch 43/49
----------
train Loss: 0.0499 Acc: 0.9950
val Loss: 4.4482 Acc: 0.8359
Epoch 44/49
----------
train Loss: 0.0448 Acc: 0.9950
val Loss: 4.0270 Acc: 0.8203
Epoch 45/49
----------
train Loss: 0.0594 Acc: 0.9917
val Loss: 4.1861 Acc: 0.8516
Epoch 46/49
----------
train Loss: 0.0951 Acc: 0.9883
val Loss: 4.3200 Acc: 0.8359
Epoch 47/49
----------
train Loss: 0.1198 Acc: 0.9883
val Loss: 6.2338 Acc: 0.8047
Epoch 48/49
----------
train Loss: 0.0783 Acc: 0.9900
val Loss: 4.7911 Acc: 0.8125
Epoch 49/49
----------
train Loss: 0.0593 Acc: 0.9933
[I 2024-10-15 18:34:02,940] Trial 127 finished with value: 0.8359375 and parameters: {'batch_size': 111, 'lr': 4.386717689949754e-05, 'num_epochs': 49, 'weight_decay': 0.09865347977801357, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 5.3214 Acc: 0.8359
Best val Acc: 0.835938
Model weights saved at ./model_weights/ResNet34_bs_111_lr_4.386717689949754e-05_epoch_49_wd_0.09865347977801357_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/45
----------
train Loss: 0.9630 Acc: 0.5927
val Loss: 0.7307 Acc: 0.7344
Epoch 2/45
----------
train Loss: 0.2310 Acc: 0.9482
val Loss: 0.6476 Acc: 0.7500
Epoch 3/45
----------
train Loss: 0.0745 Acc: 0.9866
val Loss: 0.6041 Acc: 0.7500
Epoch 4/45
----------
train Loss: 0.0541 Acc: 0.9967
val Loss: 0.6363 Acc: 0.7422
Epoch 5/45
----------
train Loss: 0.0680 Acc: 0.9800
val Loss: 0.7165 Acc: 0.7109
Epoch 6/45
----------
train Loss: 0.1780 Acc: 0.9466
val Loss: 0.9862 Acc: 0.7109
Epoch 7/45
----------
train Loss: 0.2695 Acc: 0.9182
val Loss: 0.7754 Acc: 0.7500
Epoch 8/45
----------
train Loss: 0.1410 Acc: 0.9516
val Loss: 0.9649 Acc: 0.6953
Epoch 9/45
----------
train Loss: 0.0799 Acc: 0.9766
val Loss: 0.9787 Acc: 0.6953
Epoch 10/45
----------
train Loss: 0.0700 Acc: 0.9766
val Loss: 0.8304 Acc: 0.7734
Epoch 11/45
----------
train Loss: 0.0876 Acc: 0.9733
val Loss: 0.9465 Acc: 0.7344
Epoch 12/45
----------
train Loss: 0.1972 Acc: 0.9366
val Loss: 1.4361 Acc: 0.6484
Epoch 13/45
----------
train Loss: 0.1679 Acc: 0.9482
val Loss: 1.2525 Acc: 0.7344
Epoch 14/45
----------
train Loss: 0.1762 Acc: 0.9416
val Loss: 0.8665 Acc: 0.7578
Epoch 15/45
----------
train Loss: 0.1179 Acc: 0.9699
val Loss: 0.7299 Acc: 0.7500
Epoch 16/45
----------
train Loss: 0.1007 Acc: 0.9683
val Loss: 0.8977 Acc: 0.7656
Epoch 17/45
----------
train Loss: 0.0874 Acc: 0.9666
val Loss: 0.9847 Acc: 0.7422
Epoch 18/45
----------
train Loss: 0.1236 Acc: 0.9583
val Loss: 0.9695 Acc: 0.6875
Epoch 19/45
----------
train Loss: 0.1702 Acc: 0.9366
val Loss: 1.0575 Acc: 0.6797
Epoch 20/45
----------
train Loss: 0.1747 Acc: 0.9416
val Loss: 1.0181 Acc: 0.7500
Epoch 21/45
----------
train Loss: 0.1141 Acc: 0.9683
val Loss: 1.8345 Acc: 0.6094
Epoch 22/45
----------
train Loss: 0.1444 Acc: 0.9466
val Loss: 1.3428 Acc: 0.6875
Epoch 23/45
----------
train Loss: 0.1438 Acc: 0.9466
val Loss: 1.6958 Acc: 0.7109
Epoch 24/45
----------
train Loss: 0.1724 Acc: 0.9466
val Loss: 0.6912 Acc: 0.7500
Epoch 25/45
----------
train Loss: 0.1425 Acc: 0.9616
val Loss: 0.9748 Acc: 0.7500
Epoch 26/45
----------
train Loss: 0.0723 Acc: 0.9750
val Loss: 1.1071 Acc: 0.7188
Epoch 27/45
----------
train Loss: 0.0699 Acc: 0.9766
val Loss: 0.8437 Acc: 0.7266
Epoch 28/45
----------
train Loss: 0.0643 Acc: 0.9783
val Loss: 1.9306 Acc: 0.6250
Epoch 29/45
----------
train Loss: 0.1015 Acc: 0.9716
val Loss: 1.1653 Acc: 0.6953
Epoch 30/45
----------
train Loss: 0.1594 Acc: 0.9549
val Loss: 1.1221 Acc: 0.6797
Epoch 31/45
----------
train Loss: 0.1402 Acc: 0.9482
val Loss: 0.9176 Acc: 0.7266
Epoch 32/45
----------
train Loss: 0.2238 Acc: 0.9366
val Loss: 0.8727 Acc: 0.7188
Epoch 33/45
----------
train Loss: 0.1065 Acc: 0.9666
val Loss: 0.7560 Acc: 0.7188
Epoch 34/45
----------
train Loss: 0.0480 Acc: 0.9883
val Loss: 1.2399 Acc: 0.6953
Epoch 35/45
----------
train Loss: 0.0955 Acc: 0.9816
val Loss: 1.1520 Acc: 0.7344
Epoch 36/45
----------
train Loss: 0.0492 Acc: 0.9833
val Loss: 1.0535 Acc: 0.7188
Epoch 37/45
----------
train Loss: 0.1493 Acc: 0.9533
val Loss: 1.2314 Acc: 0.6562
Epoch 38/45
----------
train Loss: 0.1393 Acc: 0.9566
val Loss: 1.1476 Acc: 0.6953
Epoch 39/45
----------
train Loss: 0.1062 Acc: 0.9683
val Loss: 1.1744 Acc: 0.6484
Epoch 40/45
----------
train Loss: 0.0916 Acc: 0.9733
val Loss: 0.9305 Acc: 0.7344
Epoch 41/45
----------
train Loss: 0.1471 Acc: 0.9482
val Loss: 1.1058 Acc: 0.7422
Epoch 42/45
----------
train Loss: 0.1735 Acc: 0.9366
val Loss: 0.9215 Acc: 0.7109
Epoch 43/45
----------
train Loss: 0.0679 Acc: 0.9766
val Loss: 0.7641 Acc: 0.7891
Epoch 44/45
----------
train Loss: 0.1182 Acc: 0.9616
val Loss: 1.0452 Acc: 0.7031
Epoch 45/45
----------
train Loss: 0.1340 Acc: 0.9666
[I 2024-10-15 18:37:25,482] Trial 128 finished with value: 0.7890625 and parameters: {'batch_size': 104, 'lr': 9.799985479717035e-05, 'num_epochs': 45, 'weight_decay': 0.08348643781706838, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 1.7861 Acc: 0.7031
Best val Acc: 0.789062
Model weights saved at ./model_weights/ResNet34_bs_104_lr_9.799985479717035e-05_epoch_45_wd_0.08348643781706838_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/48
----------
train Loss: 3.7332 Acc: 0.5726
val Loss: 5.6705 Acc: 0.6953
Epoch 2/48
----------
train Loss: 1.1534 Acc: 0.8631
val Loss: 3.9269 Acc: 0.7891
Epoch 3/48
----------
train Loss: 0.5447 Acc: 0.9466
val Loss: 2.4672 Acc: 0.8594
Epoch 4/48
----------
train Loss: 0.3603 Acc: 0.9616
val Loss: 4.0915 Acc: 0.8281
Epoch 5/48
----------
train Loss: 0.3147 Acc: 0.9599
val Loss: 3.5477 Acc: 0.8672
Epoch 6/48
----------
train Loss: 0.2562 Acc: 0.9616
val Loss: 4.1075 Acc: 0.8125
Epoch 7/48
----------
train Loss: 0.2232 Acc: 0.9750
val Loss: 4.4644 Acc: 0.8516
Epoch 8/48
----------
train Loss: 0.2204 Acc: 0.9699
val Loss: 3.8970 Acc: 0.8359
Epoch 9/48
----------
train Loss: 0.3369 Acc: 0.9566
val Loss: 6.2723 Acc: 0.7969
Epoch 10/48
----------
train Loss: 0.4841 Acc: 0.9416
val Loss: 7.5446 Acc: 0.7578
Epoch 11/48
----------
train Loss: 0.4653 Acc: 0.9533
val Loss: 7.9015 Acc: 0.8125
Epoch 12/48
----------
train Loss: 0.4452 Acc: 0.9566
val Loss: 5.6214 Acc: 0.7969
Epoch 13/48
----------
train Loss: 0.3219 Acc: 0.9616
val Loss: 5.7053 Acc: 0.8125
Epoch 14/48
----------
train Loss: 0.2307 Acc: 0.9766
val Loss: 4.4792 Acc: 0.8516
Epoch 15/48
----------
train Loss: 0.2299 Acc: 0.9649
val Loss: 3.4727 Acc: 0.8203
Epoch 16/48
----------
train Loss: 0.2390 Acc: 0.9750
val Loss: 3.2602 Acc: 0.8594
Epoch 17/48
----------
train Loss: 0.3190 Acc: 0.9716
val Loss: 2.9158 Acc: 0.8359
Epoch 18/48
----------
train Loss: 0.2242 Acc: 0.9699
val Loss: 3.5971 Acc: 0.8672
Epoch 19/48
----------
train Loss: 0.5136 Acc: 0.9566
val Loss: 6.5462 Acc: 0.8203
Epoch 20/48
----------
train Loss: 0.6955 Acc: 0.9533
val Loss: 4.4278 Acc: 0.8047
Epoch 21/48
----------
train Loss: 0.5929 Acc: 0.9349
val Loss: 3.5350 Acc: 0.7812
Epoch 22/48
----------
train Loss: 0.5740 Acc: 0.9482
val Loss: 6.8475 Acc: 0.7734
Epoch 23/48
----------
train Loss: 0.3879 Acc: 0.9516
val Loss: 4.9340 Acc: 0.8281
Epoch 24/48
----------
train Loss: 0.3812 Acc: 0.9649
val Loss: 6.4242 Acc: 0.6328
Epoch 25/48
----------
train Loss: 0.3742 Acc: 0.9516
val Loss: 5.7230 Acc: 0.8438
Epoch 26/48
----------
train Loss: 0.4162 Acc: 0.9616
val Loss: 5.6177 Acc: 0.8125
Epoch 27/48
----------
train Loss: 0.5474 Acc: 0.9349
val Loss: 8.8822 Acc: 0.7500
Epoch 28/48
----------
train Loss: 0.3454 Acc: 0.9633
val Loss: 6.3559 Acc: 0.8359
Epoch 29/48
----------
train Loss: 0.2112 Acc: 0.9800
val Loss: 4.5873 Acc: 0.7422
Epoch 30/48
----------
train Loss: 0.1842 Acc: 0.9833
val Loss: 4.7590 Acc: 0.8359
Epoch 31/48
----------
train Loss: 0.0851 Acc: 0.9917
val Loss: 5.5922 Acc: 0.8359
Epoch 32/48
----------
train Loss: 0.0651 Acc: 0.9900
val Loss: 4.4498 Acc: 0.8750
Epoch 33/48
----------
train Loss: 0.0522 Acc: 0.9917
val Loss: 4.8418 Acc: 0.8516
Epoch 34/48
----------
train Loss: 0.0411 Acc: 0.9917
val Loss: 5.4811 Acc: 0.8594
Epoch 35/48
----------
train Loss: 0.0289 Acc: 0.9950
val Loss: 5.3643 Acc: 0.8672
Epoch 36/48
----------
train Loss: 0.0348 Acc: 0.9950
val Loss: 5.3109 Acc: 0.8359
Epoch 37/48
----------
train Loss: 0.0448 Acc: 0.9950
val Loss: 5.2652 Acc: 0.8594
Epoch 38/48
----------
train Loss: 0.1058 Acc: 0.9850
val Loss: 4.8460 Acc: 0.8672
Epoch 39/48
----------
train Loss: 0.1277 Acc: 0.9950
val Loss: 5.2128 Acc: 0.8438
Epoch 40/48
----------
train Loss: 0.0349 Acc: 0.9967
val Loss: 4.9295 Acc: 0.8281
Epoch 41/48
----------
train Loss: 0.0324 Acc: 0.9950
val Loss: 4.6647 Acc: 0.8359
Epoch 42/48
----------
train Loss: 0.0235 Acc: 0.9967
val Loss: 4.2401 Acc: 0.8672
Epoch 43/48
----------
train Loss: 0.0293 Acc: 0.9967
val Loss: 5.1611 Acc: 0.8359
Epoch 44/48
----------
train Loss: 0.0248 Acc: 0.9967
val Loss: 4.6635 Acc: 0.8203
Epoch 45/48
----------
train Loss: 0.0221 Acc: 0.9967
val Loss: 4.4061 Acc: 0.8281
Epoch 46/48
----------
train Loss: 0.0205 Acc: 0.9967
val Loss: 4.5193 Acc: 0.8359
Epoch 47/48
----------
train Loss: 0.0186 Acc: 0.9967
val Loss: 4.0260 Acc: 0.8594
Epoch 48/48
----------
train Loss: 0.0199 Acc: 0.9967
[I 2024-10-15 18:40:59,067] Trial 129 finished with value: 0.8359375 and parameters: {'batch_size': 98, 'lr': 0.00017070413649889827, 'num_epochs': 48, 'weight_decay': 0.011853242074416768, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 4.8033 Acc: 0.8359
Best val Acc: 0.835938
Model weights saved at ./model_weights/ResNet34_bs_98_lr_0.00017070413649889827_epoch_48_wd_0.011853242074416768_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/52
----------
train Loss: 4.0609 Acc: 0.4674
val Loss: 2.7931 Acc: 0.7969
Epoch 2/52
----------
train Loss: 1.4773 Acc: 0.8331
val Loss: 2.4481 Acc: 0.8047
Epoch 3/52
----------
train Loss: 0.4693 Acc: 0.9516
val Loss: 2.4736 Acc: 0.8594
Epoch 4/52
----------
train Loss: 0.2338 Acc: 0.9666
val Loss: 2.1824 Acc: 0.8828
Epoch 5/52
----------
train Loss: 0.1860 Acc: 0.9850
val Loss: 2.4815 Acc: 0.8516
Epoch 6/52
----------
train Loss: 0.1309 Acc: 0.9866
val Loss: 2.5663 Acc: 0.8516
Epoch 7/52
----------
train Loss: 0.1656 Acc: 0.9816
val Loss: 2.5833 Acc: 0.8359
Epoch 8/52
----------
train Loss: 0.1282 Acc: 0.9883
val Loss: 2.9669 Acc: 0.8594
Epoch 9/52
----------
train Loss: 0.1267 Acc: 0.9783
val Loss: 3.3632 Acc: 0.8125
Epoch 10/52
----------
train Loss: 0.3144 Acc: 0.9516
val Loss: 2.7979 Acc: 0.8594
Epoch 11/52
----------
train Loss: 0.2015 Acc: 0.9750
val Loss: 2.7578 Acc: 0.8672
Epoch 12/52
----------
train Loss: 0.2216 Acc: 0.9750
val Loss: 4.2219 Acc: 0.8359
Epoch 13/52
----------
train Loss: 0.1678 Acc: 0.9850
val Loss: 3.7534 Acc: 0.8594
Epoch 14/52
----------
train Loss: 0.1739 Acc: 0.9733
val Loss: 5.0966 Acc: 0.8516
Epoch 15/52
----------
train Loss: 0.3746 Acc: 0.9499
val Loss: 4.3105 Acc: 0.7734
Epoch 16/52
----------
train Loss: 0.5552 Acc: 0.9416
val Loss: 9.4306 Acc: 0.5938
Epoch 17/52
----------
train Loss: 1.4782 Acc: 0.8932
val Loss: 4.8676 Acc: 0.6953
Epoch 18/52
----------
train Loss: 0.7545 Acc: 0.8932
val Loss: 3.0078 Acc: 0.7578
Epoch 19/52
----------
train Loss: 0.2658 Acc: 0.9649
val Loss: 3.4535 Acc: 0.8750
Epoch 20/52
----------
train Loss: 0.1801 Acc: 0.9816
val Loss: 2.7514 Acc: 0.8281
Epoch 21/52
----------
train Loss: 0.1057 Acc: 0.9917
val Loss: 2.8134 Acc: 0.7812
Epoch 22/52
----------
train Loss: 0.1121 Acc: 0.9866
val Loss: 3.1783 Acc: 0.8516
Epoch 23/52
----------
train Loss: 0.0554 Acc: 0.9917
val Loss: 2.8683 Acc: 0.8438
Epoch 24/52
----------
train Loss: 0.0597 Acc: 0.9950
val Loss: 2.9338 Acc: 0.8359
Epoch 25/52
----------
train Loss: 0.0404 Acc: 0.9933
val Loss: 2.9896 Acc: 0.8438
Epoch 26/52
----------
train Loss: 0.0523 Acc: 0.9950
val Loss: 2.8832 Acc: 0.8359
Epoch 27/52
----------
train Loss: 0.0328 Acc: 0.9950
val Loss: 2.7998 Acc: 0.8203
Epoch 28/52
----------
train Loss: 0.0358 Acc: 0.9950
val Loss: 2.9443 Acc: 0.8203
Epoch 29/52
----------
train Loss: 0.0464 Acc: 0.9933
val Loss: 2.9082 Acc: 0.8359
Epoch 30/52
----------
train Loss: 0.0344 Acc: 0.9950
val Loss: 3.0510 Acc: 0.8359
Epoch 31/52
----------
train Loss: 0.0322 Acc: 0.9917
val Loss: 2.9268 Acc: 0.8516
Epoch 32/52
----------
train Loss: 0.0329 Acc: 0.9950
val Loss: 2.8261 Acc: 0.8359
Epoch 33/52
----------
train Loss: 0.0354 Acc: 0.9933
val Loss: 2.8194 Acc: 0.8359
Epoch 34/52
----------
train Loss: 0.1437 Acc: 0.9833
val Loss: 3.3128 Acc: 0.8047
Epoch 35/52
----------
train Loss: 0.1784 Acc: 0.9733
val Loss: 4.0219 Acc: 0.8203
Epoch 36/52
----------
train Loss: 0.1606 Acc: 0.9833
val Loss: 3.7315 Acc: 0.8125
Epoch 37/52
----------
train Loss: 0.4803 Acc: 0.9566
val Loss: 5.0676 Acc: 0.7344
Epoch 38/52
----------
train Loss: 0.7279 Acc: 0.9249
val Loss: 5.7712 Acc: 0.8125
Epoch 39/52
----------
train Loss: 0.8933 Acc: 0.9182
val Loss: 5.8171 Acc: 0.6719
Epoch 40/52
----------
train Loss: 0.8526 Acc: 0.9149
val Loss: 2.9114 Acc: 0.7969
Epoch 41/52
----------
train Loss: 0.6460 Acc: 0.9349
val Loss: 3.8256 Acc: 0.7812
Epoch 42/52
----------
train Loss: 0.3458 Acc: 0.9516
val Loss: 3.1629 Acc: 0.7812
Epoch 43/52
----------
train Loss: 0.2038 Acc: 0.9750
val Loss: 3.1586 Acc: 0.8516
Epoch 44/52
----------
train Loss: 0.0852 Acc: 0.9900
val Loss: 2.5766 Acc: 0.8906
Epoch 45/52
----------
train Loss: 0.0721 Acc: 0.9900
val Loss: 2.7497 Acc: 0.8828
Epoch 46/52
----------
train Loss: 0.0583 Acc: 0.9933
val Loss: 2.8590 Acc: 0.8672
Epoch 47/52
----------
train Loss: 0.0406 Acc: 0.9900
val Loss: 2.9285 Acc: 0.8750
Epoch 48/52
----------
train Loss: 0.0423 Acc: 0.9950
val Loss: 2.9655 Acc: 0.8828
Epoch 49/52
----------
train Loss: 0.0433 Acc: 0.9950
val Loss: 3.2942 Acc: 0.8828
Epoch 50/52
----------
train Loss: 0.0345 Acc: 0.9950
val Loss: 3.2467 Acc: 0.8828
Epoch 51/52
----------
train Loss: 0.0412 Acc: 0.9950
val Loss: 3.2782 Acc: 0.8906
Epoch 52/52
----------
train Loss: 0.0286 Acc: 0.9950
[I 2024-10-15 18:44:53,446] Trial 130 finished with value: 0.875 and parameters: {'batch_size': 96, 'lr': 0.00012530399165604637, 'num_epochs': 52, 'weight_decay': 0.0157054388068346, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 3.1637 Acc: 0.8750
Best val Acc: 0.875000
Model weights saved at ./model_weights/ResNet34_bs_96_lr_0.00012530399165604637_epoch_52_wd_0.0157054388068346_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/52
----------
train Loss: 3.7991 Acc: 0.5292
val Loss: 3.0848 Acc: 0.7344
Epoch 2/52
----------
train Loss: 0.8729 Acc: 0.8781
val Loss: 2.9800 Acc: 0.7891
Epoch 3/52
----------
train Loss: 0.2569 Acc: 0.9883
val Loss: 3.3785 Acc: 0.7812
Epoch 4/52
----------
train Loss: 0.2109 Acc: 0.9833
val Loss: 3.8092 Acc: 0.8047
Epoch 5/52
----------
train Loss: 0.1785 Acc: 0.9800
val Loss: 3.2608 Acc: 0.7969
Epoch 6/52
----------
train Loss: 0.0912 Acc: 0.9883
val Loss: 3.3027 Acc: 0.8203
Epoch 7/52
----------
train Loss: 0.0675 Acc: 0.9967
val Loss: 3.5038 Acc: 0.8203
Epoch 8/52
----------
train Loss: 0.0559 Acc: 0.9933
val Loss: 4.2202 Acc: 0.8281
Epoch 9/52
----------
train Loss: 0.0368 Acc: 0.9983
val Loss: 4.5695 Acc: 0.8047
Epoch 10/52
----------
train Loss: 0.0212 Acc: 0.9983
val Loss: 4.2030 Acc: 0.8203
Epoch 11/52
----------
train Loss: 0.0275 Acc: 0.9983
val Loss: 4.2224 Acc: 0.8125
Epoch 12/52
----------
train Loss: 0.0256 Acc: 0.9983
val Loss: 4.2889 Acc: 0.8281
Epoch 13/52
----------
train Loss: 0.0201 Acc: 0.9983
val Loss: 4.2126 Acc: 0.8125
Epoch 14/52
----------
train Loss: 0.0377 Acc: 0.9967
val Loss: 4.0402 Acc: 0.8203
Epoch 15/52
----------
train Loss: 0.0236 Acc: 0.9983
val Loss: 4.1195 Acc: 0.8125
Epoch 16/52
----------
train Loss: 0.1557 Acc: 0.9850
val Loss: 6.6978 Acc: 0.7812
Epoch 17/52
----------
train Loss: 0.8897 Acc: 0.9182
val Loss: 4.3983 Acc: 0.6797
Epoch 18/52
----------
train Loss: 1.9145 Acc: 0.8130
val Loss: 6.9727 Acc: 0.5859
Epoch 19/52
----------
train Loss: 1.5758 Acc: 0.8915
val Loss: 7.2770 Acc: 0.3438
Epoch 20/52
----------
train Loss: 0.8224 Acc: 0.9032
val Loss: 3.1173 Acc: 0.8125
Epoch 21/52
----------
train Loss: 0.4052 Acc: 0.9466
val Loss: 3.7294 Acc: 0.8047
Epoch 22/52
----------
train Loss: 0.2768 Acc: 0.9783
val Loss: 4.3374 Acc: 0.7812
Epoch 23/52
----------
train Loss: 0.2018 Acc: 0.9716
val Loss: 4.5061 Acc: 0.7891
Epoch 24/52
----------
train Loss: 0.0979 Acc: 0.9900
val Loss: 3.9514 Acc: 0.7969
Epoch 25/52
----------
train Loss: 0.1243 Acc: 0.9833
val Loss: 3.8386 Acc: 0.7891
Epoch 26/52
----------
train Loss: 0.0425 Acc: 0.9950
val Loss: 4.3446 Acc: 0.7656
Epoch 27/52
----------
train Loss: 0.0364 Acc: 0.9983
val Loss: 4.0149 Acc: 0.7969
Epoch 28/52
----------
train Loss: 0.0287 Acc: 0.9967
val Loss: 4.4243 Acc: 0.7812
Epoch 29/52
----------
train Loss: 0.0996 Acc: 0.9900
val Loss: 4.0495 Acc: 0.7891
Epoch 30/52
----------
train Loss: 0.2498 Acc: 0.9566
val Loss: 4.2834 Acc: 0.7969
Epoch 31/52
----------
train Loss: 0.1733 Acc: 0.9850
val Loss: 4.6073 Acc: 0.7969
Epoch 32/52
----------
train Loss: 0.0895 Acc: 0.9917
val Loss: 5.0636 Acc: 0.7578
Epoch 33/52
----------
train Loss: 0.0566 Acc: 0.9917
val Loss: 4.5384 Acc: 0.8203
Epoch 34/52
----------
train Loss: 0.0691 Acc: 0.9967
val Loss: 4.4627 Acc: 0.8047
Epoch 35/52
----------
train Loss: 0.0627 Acc: 0.9917
val Loss: 4.3902 Acc: 0.8125
Epoch 36/52
----------
train Loss: 0.0348 Acc: 0.9950
val Loss: 4.4231 Acc: 0.7969
Epoch 37/52
----------
train Loss: 0.0157 Acc: 0.9983
val Loss: 4.5899 Acc: 0.7969
Epoch 38/52
----------
train Loss: 0.0135 Acc: 0.9983
val Loss: 4.5224 Acc: 0.8281
Epoch 39/52
----------
train Loss: 0.0133 Acc: 0.9967
val Loss: 4.7799 Acc: 0.8125
Epoch 40/52
----------
train Loss: 0.0221 Acc: 0.9983
val Loss: 5.3036 Acc: 0.8047
Epoch 41/52
----------
train Loss: 0.0460 Acc: 0.9967
val Loss: 4.6442 Acc: 0.8125
Epoch 42/52
----------
train Loss: 0.0284 Acc: 0.9933
val Loss: 4.8360 Acc: 0.8047
Epoch 43/52
----------
train Loss: 0.0313 Acc: 0.9967
val Loss: 4.7460 Acc: 0.8281
Epoch 44/52
----------
train Loss: 0.1095 Acc: 0.9900
val Loss: 3.7104 Acc: 0.8281
Epoch 45/52
----------
train Loss: 0.0447 Acc: 0.9950
val Loss: 4.0695 Acc: 0.8203
Epoch 46/52
----------
train Loss: 0.0304 Acc: 0.9967
val Loss: 4.1371 Acc: 0.7969
Epoch 47/52
----------
train Loss: 0.0558 Acc: 0.9917
val Loss: 4.7070 Acc: 0.7891
Epoch 48/52
----------
train Loss: 0.0689 Acc: 0.9950
val Loss: 3.7070 Acc: 0.8047
Epoch 49/52
----------
train Loss: 0.0291 Acc: 0.9967
val Loss: 4.6131 Acc: 0.7969
Epoch 50/52
----------
train Loss: 0.0174 Acc: 0.9967
val Loss: 4.3139 Acc: 0.7891
Epoch 51/52
----------
train Loss: 0.0159 Acc: 0.9983
val Loss: 4.4369 Acc: 0.7969
Epoch 52/52
----------
train Loss: 0.0381 Acc: 0.9967
[I 2024-10-15 18:48:47,265] Trial 131 finished with value: 0.828125 and parameters: {'batch_size': 96, 'lr': 0.0001171272663227096, 'num_epochs': 52, 'weight_decay': 0.01539645890812177, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 3.9966 Acc: 0.8281
Best val Acc: 0.828125
Model weights saved at ./model_weights/ResNet34_bs_96_lr_0.0001171272663227096_epoch_52_wd_0.01539645890812177_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/56
----------
train Loss: 4.2053 Acc: 0.5142
val Loss: 3.9405 Acc: 0.6797
Epoch 2/56
----------
train Loss: 1.7777 Acc: 0.7863
val Loss: 3.7252 Acc: 0.6875
Epoch 3/56
----------
train Loss: 1.4343 Acc: 0.8314
val Loss: 4.9332 Acc: 0.6484
Epoch 4/56
----------
train Loss: 0.9185 Acc: 0.8965
val Loss: 4.5738 Acc: 0.6719
Epoch 5/56
----------
train Loss: 0.7253 Acc: 0.9132
val Loss: 3.7330 Acc: 0.7969
Epoch 6/56
----------
train Loss: 0.5513 Acc: 0.9466
val Loss: 3.0641 Acc: 0.7422
Epoch 7/56
----------
train Loss: 0.9448 Acc: 0.8998
val Loss: 6.0182 Acc: 0.6484
Epoch 8/56
----------
train Loss: 0.8758 Acc: 0.8898
val Loss: 4.7220 Acc: 0.7031
Epoch 9/56
----------
train Loss: 0.8171 Acc: 0.9132
val Loss: 5.2294 Acc: 0.7266
Epoch 10/56
----------
train Loss: 0.7768 Acc: 0.9132
[I 2024-10-15 18:49:32,425] Trial 132 finished with value: 0.796875 and parameters: {'batch_size': 101, 'lr': 0.00028650914244087247, 'num_epochs': 56, 'weight_decay': 0.0523785565251315, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 3.9422 Acc: 0.7344
Early stopping at epoch 10 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.796875
Model weights saved at ./model_weights/ResNet34_bs_101_lr_0.00028650914244087247_epoch_56_wd_0.0523785565251315_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/54
----------
train Loss: 4.3303 Acc: 0.5392
val Loss: 3.8796 Acc: 0.7031
Epoch 2/54
----------
train Loss: 1.5178 Acc: 0.8280
val Loss: 3.1635 Acc: 0.7891
Epoch 3/54
----------
train Loss: 0.7732 Acc: 0.9098
val Loss: 3.9659 Acc: 0.8281
Epoch 4/54
----------
train Loss: 0.6359 Acc: 0.9199
val Loss: 3.9645 Acc: 0.6797
Epoch 5/54
----------
train Loss: 0.7014 Acc: 0.9299
val Loss: 5.7975 Acc: 0.7500
Epoch 6/54
----------
train Loss: 0.4664 Acc: 0.9466
val Loss: 3.4907 Acc: 0.7500
Epoch 7/54
----------
train Loss: 0.5647 Acc: 0.9399
val Loss: 4.5457 Acc: 0.8359
Epoch 8/54
----------
train Loss: 0.7833 Acc: 0.9265
val Loss: 4.8719 Acc: 0.6797
Epoch 9/54
----------
train Loss: 0.8224 Acc: 0.8998
val Loss: 6.8335 Acc: 0.7969
Epoch 10/54
----------
train Loss: 0.6079 Acc: 0.9416
val Loss: 3.4095 Acc: 0.6484
Epoch 11/54
----------
train Loss: 0.5147 Acc: 0.9399
val Loss: 5.9233 Acc: 0.8672
Epoch 12/54
----------
train Loss: 0.4116 Acc: 0.9533
val Loss: 4.2195 Acc: 0.8281
Epoch 13/54
----------
train Loss: 0.3369 Acc: 0.9633
val Loss: 4.6398 Acc: 0.8125
Epoch 14/54
----------
train Loss: 0.3231 Acc: 0.9616
val Loss: 6.1734 Acc: 0.7891
Epoch 15/54
----------
train Loss: 0.2239 Acc: 0.9716
val Loss: 4.8721 Acc: 0.8125
Epoch 16/54
----------
train Loss: 0.1794 Acc: 0.9866
val Loss: 3.4047 Acc: 0.8125
Epoch 17/54
----------
train Loss: 0.2039 Acc: 0.9766
val Loss: 5.2846 Acc: 0.8359
Epoch 18/54
----------
train Loss: 0.2626 Acc: 0.9666
val Loss: 2.5557 Acc: 0.8594
Epoch 19/54
----------
train Loss: 0.1531 Acc: 0.9850
val Loss: 3.5253 Acc: 0.8359
Epoch 20/54
----------
train Loss: 0.1796 Acc: 0.9766
val Loss: 4.7037 Acc: 0.7344
Epoch 21/54
----------
train Loss: 0.2213 Acc: 0.9699
val Loss: 6.1757 Acc: 0.7969
Epoch 22/54
----------
train Loss: 0.4380 Acc: 0.9432
val Loss: 8.4411 Acc: 0.8047
Epoch 23/54
----------
train Loss: 0.9588 Acc: 0.8982
val Loss: 6.7307 Acc: 0.5234
Epoch 24/54
----------
train Loss: 1.7988 Acc: 0.8447
val Loss: 5.8460 Acc: 0.7031
Epoch 25/54
----------
train Loss: 1.0863 Acc: 0.8748
val Loss: 3.6840 Acc: 0.7812
Epoch 26/54
----------
train Loss: 0.7940 Acc: 0.9132
val Loss: 6.3226 Acc: 0.5703
Epoch 27/54
----------
train Loss: 0.7844 Acc: 0.9165
val Loss: 5.6332 Acc: 0.7734
Epoch 28/54
----------
train Loss: 0.3009 Acc: 0.9649
val Loss: 5.4940 Acc: 0.8047
Epoch 29/54
----------
train Loss: 0.3301 Acc: 0.9666
val Loss: 4.6655 Acc: 0.7891
Epoch 30/54
----------
train Loss: 0.1880 Acc: 0.9683
val Loss: 4.5284 Acc: 0.8516
Epoch 31/54
----------
train Loss: 0.2613 Acc: 0.9766
val Loss: 2.8189 Acc: 0.8594
Epoch 32/54
----------
train Loss: 0.1716 Acc: 0.9783
val Loss: 4.4270 Acc: 0.7969
Epoch 33/54
----------
train Loss: 0.1781 Acc: 0.9766
val Loss: 3.9743 Acc: 0.8438
Epoch 34/54
----------
train Loss: 0.1551 Acc: 0.9850
val Loss: 3.9740 Acc: 0.7734
Epoch 35/54
----------
train Loss: 0.1704 Acc: 0.9733
val Loss: 4.8868 Acc: 0.7969
Epoch 36/54
----------
train Loss: 0.1805 Acc: 0.9750
val Loss: 4.1897 Acc: 0.8281
Epoch 37/54
----------
train Loss: 0.2119 Acc: 0.9800
val Loss: 4.6034 Acc: 0.8047
Epoch 38/54
----------
train Loss: 0.1944 Acc: 0.9699
val Loss: 7.4129 Acc: 0.8125
Epoch 39/54
----------
train Loss: 0.3461 Acc: 0.9633
val Loss: 5.2922 Acc: 0.8516
Epoch 40/54
----------
train Loss: 0.1951 Acc: 0.9649
val Loss: 7.0020 Acc: 0.8281
Epoch 41/54
----------
train Loss: 0.3718 Acc: 0.9616
val Loss: 7.0749 Acc: 0.8516
Epoch 42/54
----------
train Loss: 0.5121 Acc: 0.9449
val Loss: 5.2889 Acc: 0.7109
Epoch 43/54
----------
train Loss: 0.5407 Acc: 0.9199
val Loss: 10.6319 Acc: 0.7031
Epoch 44/54
----------
train Loss: 0.8028 Acc: 0.9232
val Loss: 3.7579 Acc: 0.8281
Epoch 45/54
----------
train Loss: 0.3934 Acc: 0.9599
val Loss: 4.0902 Acc: 0.7969
Epoch 46/54
----------
train Loss: 0.3853 Acc: 0.9599
val Loss: 4.2022 Acc: 0.8281
Epoch 47/54
----------
train Loss: 0.2115 Acc: 0.9766
val Loss: 4.9715 Acc: 0.8750
Epoch 48/54
----------
train Loss: 0.3185 Acc: 0.9716
val Loss: 6.7503 Acc: 0.6953
Epoch 49/54
----------
train Loss: 0.1957 Acc: 0.9783
val Loss: 5.5967 Acc: 0.8047
Epoch 50/54
----------
train Loss: 0.1884 Acc: 0.9783
val Loss: 5.7892 Acc: 0.7812
Epoch 51/54
----------
train Loss: 0.3493 Acc: 0.9516
val Loss: 7.1203 Acc: 0.7031
Epoch 52/54
----------
train Loss: 0.4457 Acc: 0.9649
val Loss: 3.2807 Acc: 0.8906
Epoch 53/54
----------
train Loss: 0.5564 Acc: 0.9466
val Loss: 5.6044 Acc: 0.7031
Epoch 54/54
----------
train Loss: 0.9219 Acc: 0.8948
[I 2024-10-15 18:53:34,523] Trial 133 finished with value: 0.890625 and parameters: {'batch_size': 94, 'lr': 0.00022989347081113073, 'num_epochs': 54, 'weight_decay': 0.01972149260237663, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 4.2441 Acc: 0.7812
Best val Acc: 0.890625
Model weights saved at ./model_weights/ResNet34_bs_94_lr_0.00022989347081113073_epoch_54_wd_0.01972149260237663_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/55
----------
train Loss: 3.8035 Acc: 0.5326
val Loss: 2.8985 Acc: 0.8047
Epoch 2/55
----------
train Loss: 1.5186 Acc: 0.8497
val Loss: 2.7202 Acc: 0.7734
Epoch 3/55
----------
train Loss: 0.7182 Acc: 0.9015
val Loss: 2.1961 Acc: 0.8125
Epoch 4/55
----------
train Loss: 0.6165 Acc: 0.9366
val Loss: 2.2744 Acc: 0.7734
Epoch 5/55
----------
train Loss: 0.6348 Acc: 0.9182
val Loss: 4.2251 Acc: 0.7656
Epoch 6/55
----------
train Loss: 0.4267 Acc: 0.9633
val Loss: 4.2801 Acc: 0.8203
Epoch 7/55
----------
train Loss: 0.2442 Acc: 0.9733
val Loss: 3.6971 Acc: 0.8438
Epoch 8/55
----------
train Loss: 0.7056 Acc: 0.9499
val Loss: 8.4712 Acc: 0.6719
Epoch 9/55
----------
train Loss: 0.7744 Acc: 0.9098
val Loss: 4.2497 Acc: 0.8047
Epoch 10/55
----------
train Loss: 0.5450 Acc: 0.9282
val Loss: 4.1476 Acc: 0.8359
Epoch 11/55
----------
train Loss: 0.6478 Acc: 0.9416
val Loss: 2.5261 Acc: 0.7500
Epoch 12/55
----------
train Loss: 0.4314 Acc: 0.9499
val Loss: 3.4610 Acc: 0.8359
Epoch 13/55
----------
train Loss: 0.2134 Acc: 0.9750
val Loss: 3.3779 Acc: 0.8125
Epoch 14/55
----------
train Loss: 0.1405 Acc: 0.9883
val Loss: 3.3422 Acc: 0.8125
Epoch 15/55
----------
train Loss: 0.0942 Acc: 0.9866
val Loss: 4.0548 Acc: 0.8359
Epoch 16/55
----------
train Loss: 0.0717 Acc: 0.9950
val Loss: 4.6563 Acc: 0.8359
Epoch 17/55
----------
train Loss: 0.0794 Acc: 0.9900
val Loss: 4.0485 Acc: 0.8516
Epoch 18/55
----------
train Loss: 0.1102 Acc: 0.9900
val Loss: 3.1169 Acc: 0.8203
Epoch 19/55
----------
train Loss: 0.0565 Acc: 0.9950
val Loss: 3.9085 Acc: 0.8516
Epoch 20/55
----------
train Loss: 0.0532 Acc: 0.9933
val Loss: 4.4187 Acc: 0.8281
Epoch 21/55
----------
train Loss: 0.0536 Acc: 0.9950
val Loss: 3.1795 Acc: 0.8438
Epoch 22/55
----------
train Loss: 0.3447 Acc: 0.9883
val Loss: 14.6489 Acc: 0.4375
Epoch 23/55
----------
train Loss: 1.7917 Acc: 0.8531
val Loss: 12.2497 Acc: 0.6797
Epoch 24/55
----------
train Loss: 2.9691 Acc: 0.7546
val Loss: 20.0247 Acc: 0.2734
Epoch 25/55
----------
train Loss: 2.2911 Acc: 0.7546
val Loss: 4.7505 Acc: 0.6016
Epoch 26/55
----------
train Loss: 1.1347 Acc: 0.8698
[I 2024-10-15 18:55:31,319] Trial 134 finished with value: 0.84375 and parameters: {'batch_size': 95, 'lr': 0.00022833231038744807, 'num_epochs': 55, 'weight_decay': 0.019566495875618102, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 3.1629 Acc: 0.7500
Early stopping at epoch 26 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.843750
Model weights saved at ./model_weights/ResNet34_bs_95_lr_0.00022833231038744807_epoch_55_wd_0.019566495875618102_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/53
----------
train Loss: 4.2819 Acc: 0.4624
val Loss: 3.7870 Acc: 0.8359
Epoch 2/53
----------
train Loss: 1.4397 Acc: 0.8531
val Loss: 2.1911 Acc: 0.8438
Epoch 3/53
----------
train Loss: 0.5381 Acc: 0.9232
val Loss: 1.9187 Acc: 0.8438
Epoch 4/53
----------
train Loss: 0.2633 Acc: 0.9800
val Loss: 2.3452 Acc: 0.8906
Epoch 5/53
----------
train Loss: 0.1761 Acc: 0.9850
val Loss: 2.3913 Acc: 0.8750
Epoch 6/53
----------
train Loss: 0.1863 Acc: 0.9733
val Loss: 2.5651 Acc: 0.8828
Epoch 7/53
----------
train Loss: 0.3106 Acc: 0.9633
val Loss: 2.5334 Acc: 0.8438
Epoch 8/53
----------
train Loss: 0.2090 Acc: 0.9800
val Loss: 2.6076 Acc: 0.8516
Epoch 9/53
----------
train Loss: 0.3206 Acc: 0.9699
val Loss: 2.6650 Acc: 0.8438
Epoch 10/53
----------
train Loss: 0.6984 Acc: 0.9416
val Loss: 3.7800 Acc: 0.8672
Epoch 11/53
----------
train Loss: 0.9627 Acc: 0.9082
val Loss: 5.0581 Acc: 0.8516
Epoch 12/53
----------
train Loss: 1.4372 Acc: 0.8698
val Loss: 5.9093 Acc: 0.5312
Epoch 13/53
----------
train Loss: 0.8657 Acc: 0.8948
val Loss: 2.7180 Acc: 0.8281
Epoch 14/53
----------
train Loss: 0.3126 Acc: 0.9616
val Loss: 2.1765 Acc: 0.8594
Epoch 15/53
----------
train Loss: 0.1953 Acc: 0.9816
val Loss: 2.2000 Acc: 0.8906
Epoch 16/53
----------
train Loss: 0.1447 Acc: 0.9816
val Loss: 2.7856 Acc: 0.8984
Epoch 17/53
----------
train Loss: 0.1645 Acc: 0.9816
val Loss: 2.7686 Acc: 0.8828
Epoch 18/53
----------
train Loss: 0.2152 Acc: 0.9816
val Loss: 3.3340 Acc: 0.8438
Epoch 19/53
----------
train Loss: 0.2119 Acc: 0.9766
val Loss: 3.2317 Acc: 0.7656
Epoch 20/53
----------
train Loss: 0.2369 Acc: 0.9800
val Loss: 4.2625 Acc: 0.8750
Epoch 21/53
----------
train Loss: 0.1775 Acc: 0.9750
val Loss: 3.4135 Acc: 0.8594
Epoch 22/53
----------
train Loss: 0.2390 Acc: 0.9800
val Loss: 4.6177 Acc: 0.8594
Epoch 23/53
----------
train Loss: 0.2400 Acc: 0.9716
val Loss: 3.6308 Acc: 0.7500
Epoch 24/53
----------
train Loss: 0.3243 Acc: 0.9699
val Loss: 4.5634 Acc: 0.8438
Epoch 25/53
----------
train Loss: 0.1962 Acc: 0.9699
val Loss: 5.0055 Acc: 0.8281
Epoch 26/53
----------
train Loss: 0.1140 Acc: 0.9866
val Loss: 2.6836 Acc: 0.8359
Epoch 27/53
----------
train Loss: 0.0837 Acc: 0.9883
val Loss: 3.9458 Acc: 0.8438
Epoch 28/53
----------
train Loss: 0.0755 Acc: 0.9917
val Loss: 3.7879 Acc: 0.8672
Epoch 29/53
----------
train Loss: 0.0707 Acc: 0.9917
val Loss: 3.2644 Acc: 0.8750
Epoch 30/53
----------
train Loss: 0.0659 Acc: 0.9917
val Loss: 3.1950 Acc: 0.8828
Epoch 31/53
----------
train Loss: 0.0696 Acc: 0.9900
val Loss: 3.0864 Acc: 0.8594
Epoch 32/53
----------
train Loss: 0.0698 Acc: 0.9900
val Loss: 3.9295 Acc: 0.7578
Epoch 33/53
----------
train Loss: 0.1094 Acc: 0.9833
val Loss: 2.8500 Acc: 0.8672
Epoch 34/53
----------
train Loss: 0.0682 Acc: 0.9933
val Loss: 4.2391 Acc: 0.8516
Epoch 35/53
----------
train Loss: 0.0670 Acc: 0.9883
val Loss: 3.0418 Acc: 0.8594
Epoch 36/53
----------
train Loss: 0.1642 Acc: 0.9783
val Loss: 5.1393 Acc: 0.8516
Epoch 37/53
----------
train Loss: 0.2251 Acc: 0.9750
val Loss: 3.0703 Acc: 0.8203
Epoch 38/53
----------
train Loss: 0.2549 Acc: 0.9566
val Loss: 3.3924 Acc: 0.8438
Epoch 39/53
----------
train Loss: 0.3635 Acc: 0.9549
val Loss: 4.5990 Acc: 0.8047
Epoch 40/53
----------
train Loss: 0.4662 Acc: 0.9466
val Loss: 5.0863 Acc: 0.8281
Epoch 41/53
----------
train Loss: 0.5967 Acc: 0.9349
val Loss: 6.8416 Acc: 0.7344
Epoch 42/53
----------
train Loss: 2.1519 Acc: 0.8264
val Loss: 13.3910 Acc: 0.3750
Epoch 43/53
----------
train Loss: 1.8494 Acc: 0.8297
val Loss: 9.2108 Acc: 0.7578
Epoch 44/53
----------
train Loss: 0.7004 Acc: 0.9115
val Loss: 2.8326 Acc: 0.8203
Epoch 45/53
----------
train Loss: 0.4163 Acc: 0.9332
val Loss: 3.3092 Acc: 0.8828
Epoch 46/53
----------
train Loss: 0.2890 Acc: 0.9666
val Loss: 2.3650 Acc: 0.8906
Epoch 47/53
----------
train Loss: 0.1744 Acc: 0.9833
val Loss: 2.4891 Acc: 0.8750
Epoch 48/53
----------
train Loss: 0.1039 Acc: 0.9917
val Loss: 2.7172 Acc: 0.8828
Epoch 49/53
----------
train Loss: 0.1007 Acc: 0.9883
val Loss: 3.1508 Acc: 0.8828
Epoch 50/53
----------
train Loss: 0.1176 Acc: 0.9866
val Loss: 4.3103 Acc: 0.8516
Epoch 51/53
----------
train Loss: 0.1032 Acc: 0.9917
val Loss: 3.7642 Acc: 0.8672
Epoch 52/53
----------
train Loss: 0.0814 Acc: 0.9866
val Loss: 3.4823 Acc: 0.8828
Epoch 53/53
----------
train Loss: 0.0692 Acc: 0.9900
[I 2024-10-15 18:59:28,361] Trial 135 finished with value: 0.890625 and parameters: {'batch_size': 90, 'lr': 0.00014908366589842567, 'num_epochs': 53, 'weight_decay': 0.025139321445569473, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 3.9635 Acc: 0.8906
Best val Acc: 0.890625
Model weights saved at ./model_weights/ResNet34_bs_90_lr_0.00014908366589842567_epoch_53_wd_0.025139321445569473_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/53
----------
train Loss: 3.8440 Acc: 0.6411
val Loss: 2.9582 Acc: 0.7734
Epoch 2/53
----------
train Loss: 0.9772 Acc: 0.8781
val Loss: 3.0299 Acc: 0.8281
Epoch 3/53
----------
train Loss: 0.4167 Acc: 0.9566
val Loss: 3.1218 Acc: 0.8672
Epoch 4/53
----------
train Loss: 0.2904 Acc: 0.9666
val Loss: 4.6654 Acc: 0.7500
Epoch 5/53
----------
train Loss: 0.1931 Acc: 0.9766
val Loss: 3.7860 Acc: 0.8203
Epoch 6/53
----------
train Loss: 0.2041 Acc: 0.9699
val Loss: 3.3721 Acc: 0.8438
Epoch 7/53
----------
train Loss: 0.1742 Acc: 0.9800
val Loss: 4.2962 Acc: 0.8359
Epoch 8/53
----------
train Loss: 0.1925 Acc: 0.9800
val Loss: 3.6987 Acc: 0.7969
Epoch 9/53
----------
train Loss: 0.1024 Acc: 0.9900
val Loss: 4.0185 Acc: 0.8047
Epoch 10/53
----------
train Loss: 0.4311 Acc: 0.9699
val Loss: 5.4795 Acc: 0.7578
Epoch 11/53
----------
train Loss: 1.1798 Acc: 0.8664
val Loss: 5.9382 Acc: 0.8125
Epoch 12/53
----------
train Loss: 0.5586 Acc: 0.9332
val Loss: 6.7623 Acc: 0.8125
Epoch 13/53
----------
train Loss: 0.4450 Acc: 0.9516
val Loss: 7.6088 Acc: 0.7812
Epoch 14/53
----------
train Loss: 0.3420 Acc: 0.9699
val Loss: 4.3289 Acc: 0.7969
Epoch 15/53
----------
train Loss: 0.1247 Acc: 0.9833
val Loss: 4.1728 Acc: 0.8203
Epoch 16/53
----------
train Loss: 0.1266 Acc: 0.9866
val Loss: 5.0201 Acc: 0.7578
Epoch 17/53
----------
train Loss: 0.1388 Acc: 0.9783
val Loss: 4.7302 Acc: 0.8594
Epoch 18/53
----------
train Loss: 0.0820 Acc: 0.9950
val Loss: 4.9816 Acc: 0.8047
Epoch 19/53
----------
train Loss: 0.1039 Acc: 0.9883
val Loss: 4.0567 Acc: 0.8516
Epoch 20/53
----------
train Loss: 0.1887 Acc: 0.9800
val Loss: 6.1452 Acc: 0.8281
Epoch 21/53
----------
train Loss: 0.2301 Acc: 0.9866
val Loss: 4.8103 Acc: 0.7969
Epoch 22/53
----------
train Loss: 0.1438 Acc: 0.9716
val Loss: 4.7862 Acc: 0.8281
Epoch 23/53
----------
train Loss: 0.0528 Acc: 0.9933
val Loss: 5.1937 Acc: 0.8516
Epoch 24/53
----------
train Loss: 0.1240 Acc: 0.9917
val Loss: 6.0214 Acc: 0.7656
Epoch 25/53
----------
train Loss: 0.0827 Acc: 0.9900
val Loss: 5.7519 Acc: 0.7812
Epoch 26/53
----------
train Loss: 0.1356 Acc: 0.9800
val Loss: 4.1628 Acc: 0.7734
Epoch 27/53
----------
train Loss: 0.1361 Acc: 0.9850
val Loss: 5.4820 Acc: 0.7969
Epoch 28/53
----------
train Loss: 0.2325 Acc: 0.9699
val Loss: 8.6923 Acc: 0.8359
Epoch 29/53
----------
train Loss: 0.2304 Acc: 0.9833
val Loss: 3.9155 Acc: 0.8125
Epoch 30/53
----------
train Loss: 0.2757 Acc: 0.9716
val Loss: 5.2422 Acc: 0.7188
Epoch 31/53
----------
train Loss: 0.9952 Acc: 0.9015
val Loss: 7.4918 Acc: 0.4375
Epoch 32/53
----------
train Loss: 1.9210 Acc: 0.8698
val Loss: 7.1450 Acc: 0.6875
Epoch 33/53
----------
train Loss: 1.1826 Acc: 0.9082
val Loss: 4.3383 Acc: 0.7812
Epoch 34/53
----------
train Loss: 0.6367 Acc: 0.9649
val Loss: 3.9328 Acc: 0.7656
Epoch 35/53
----------
train Loss: 0.2804 Acc: 0.9716
val Loss: 4.1026 Acc: 0.7578
Epoch 36/53
----------
train Loss: 0.2035 Acc: 0.9766
val Loss: 5.6671 Acc: 0.8281
Epoch 37/53
----------
train Loss: 0.1614 Acc: 0.9733
val Loss: 4.8938 Acc: 0.7891
Epoch 38/53
----------
train Loss: 0.0945 Acc: 0.9900
val Loss: 4.7704 Acc: 0.8438
Epoch 39/53
----------
train Loss: 0.0589 Acc: 0.9933
val Loss: 4.8791 Acc: 0.8594
Epoch 40/53
----------
train Loss: 0.0448 Acc: 0.9950
val Loss: 4.7204 Acc: 0.8281
Epoch 41/53
----------
train Loss: 0.0537 Acc: 0.9933
val Loss: 4.7589 Acc: 0.8281
Epoch 42/53
----------
train Loss: 0.0581 Acc: 0.9933
val Loss: 5.1173 Acc: 0.8438
Epoch 43/53
----------
train Loss: 0.0845 Acc: 0.9883
val Loss: 6.4948 Acc: 0.8438
Epoch 44/53
----------
train Loss: 0.1000 Acc: 0.9917
val Loss: 4.9655 Acc: 0.8438
Epoch 45/53
----------
train Loss: 0.0853 Acc: 0.9917
val Loss: 5.6492 Acc: 0.8281
Epoch 46/53
----------
train Loss: 0.0459 Acc: 0.9933
val Loss: 4.8977 Acc: 0.8281
Epoch 47/53
----------
train Loss: 0.0350 Acc: 0.9967
val Loss: 4.7851 Acc: 0.8516
Epoch 48/53
----------
train Loss: 0.0384 Acc: 0.9950
val Loss: 5.4568 Acc: 0.8359
Epoch 49/53
----------
train Loss: 0.0503 Acc: 0.9917
val Loss: 5.2000 Acc: 0.8438
Epoch 50/53
----------
train Loss: 0.0555 Acc: 0.9967
val Loss: 5.4967 Acc: 0.8516
Epoch 51/53
----------
train Loss: 0.0395 Acc: 0.9950
val Loss: 4.8772 Acc: 0.8438
Epoch 52/53
----------
train Loss: 0.0457 Acc: 0.9950
val Loss: 5.0425 Acc: 0.8594
Epoch 53/53
----------
train Loss: 0.0338 Acc: 0.9967
[I 2024-10-15 19:03:24,092] Trial 136 finished with value: 0.8671875 and parameters: {'batch_size': 89, 'lr': 0.00014156527501897414, 'num_epochs': 53, 'weight_decay': 0.018010997776867814, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 4.9805 Acc: 0.8672
Best val Acc: 0.867188
Model weights saved at ./model_weights/ResNet34_bs_89_lr_0.00014156527501897414_epoch_53_wd_0.018010997776867814_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/54
----------
train Loss: 4.5679 Acc: 0.5626
val Loss: 3.5045 Acc: 0.7578
Epoch 2/54
----------
train Loss: 3.4645 Acc: 0.6761
val Loss: 4.6202 Acc: 0.6016
Epoch 3/54
----------
train Loss: 2.1673 Acc: 0.7980
val Loss: 3.0425 Acc: 0.7344
Epoch 4/54
----------
train Loss: 1.3052 Acc: 0.8798
val Loss: 2.0549 Acc: 0.7734
Epoch 5/54
----------
train Loss: 1.2548 Acc: 0.8765
val Loss: 2.2433 Acc: 0.6484
Epoch 6/54
----------
train Loss: 1.0223 Acc: 0.8915
val Loss: 2.3586 Acc: 0.8203
Epoch 7/54
----------
train Loss: 1.4985 Acc: 0.8748
val Loss: 4.2687 Acc: 0.6172
Epoch 8/54
----------
train Loss: 0.8739 Acc: 0.8915
val Loss: 2.6194 Acc: 0.7812
Epoch 9/54
----------
train Loss: 0.7557 Acc: 0.9199
val Loss: 2.1605 Acc: 0.7031
Epoch 10/54
----------
train Loss: 1.4149 Acc: 0.8648
val Loss: 5.0269 Acc: 0.4219
Epoch 11/54
----------
train Loss: 1.9464 Acc: 0.8013
val Loss: 3.4863 Acc: 0.6406
Epoch 12/54
----------
train Loss: 0.9128 Acc: 0.8948
val Loss: 1.9668 Acc: 0.8125
Epoch 13/54
----------
train Loss: 0.7044 Acc: 0.8998
val Loss: 2.3998 Acc: 0.7891
Epoch 14/54
----------
train Loss: 0.4653 Acc: 0.9482
val Loss: 3.7423 Acc: 0.7656
Epoch 15/54
----------
train Loss: 0.3972 Acc: 0.9499
val Loss: 3.0823 Acc: 0.7500
Epoch 16/54
----------
train Loss: 0.5666 Acc: 0.9232
val Loss: 3.5642 Acc: 0.6953
Epoch 17/54
----------
train Loss: 0.3078 Acc: 0.9549
val Loss: 1.7363 Acc: 0.8438
Epoch 18/54
----------
train Loss: 0.1591 Acc: 0.9766
val Loss: 2.1523 Acc: 0.8672
Epoch 19/54
----------
train Loss: 0.2834 Acc: 0.9716
val Loss: 4.2140 Acc: 0.7578
Epoch 20/54
----------
train Loss: 1.8994 Acc: 0.8531
val Loss: 11.1702 Acc: 0.7031
Epoch 21/54
----------
train Loss: 1.7277 Acc: 0.8080
val Loss: 4.0649 Acc: 0.5078
Epoch 22/54
----------
train Loss: 2.5930 Acc: 0.7312
val Loss: 7.4830 Acc: 0.6328
Epoch 23/54
----------
train Loss: 1.3718 Acc: 0.8581
[I 2024-10-15 19:05:07,633] Trial 137 finished with value: 0.8671875 and parameters: {'batch_size': 93, 'lr': 0.00043685515191556134, 'num_epochs': 54, 'weight_decay': 0.02678415196670734, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 1.7865 Acc: 0.7812
Early stopping at epoch 23 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.867188
Model weights saved at ./model_weights/ResNet34_bs_93_lr_0.00043685515191556134_epoch_54_wd_0.02678415196670734_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/57
----------
train Loss: 3.9712 Acc: 0.5710
val Loss: 3.3878 Acc: 0.7188
Epoch 2/57
----------
train Loss: 1.3179 Acc: 0.8564
val Loss: 3.5652 Acc: 0.7266
Epoch 3/57
----------
train Loss: 0.5436 Acc: 0.9399
val Loss: 3.1722 Acc: 0.7734
Epoch 4/57
----------
train Loss: 0.4427 Acc: 0.9533
val Loss: 2.8670 Acc: 0.8281
Epoch 5/57
----------
train Loss: 0.2460 Acc: 0.9716
val Loss: 5.8123 Acc: 0.8047
Epoch 6/57
----------
train Loss: 0.2374 Acc: 0.9766
val Loss: 3.6758 Acc: 0.8594
Epoch 7/57
----------
train Loss: 0.1836 Acc: 0.9733
val Loss: 3.2012 Acc: 0.7656
Epoch 8/57
----------
train Loss: 0.1073 Acc: 0.9850
val Loss: 4.2609 Acc: 0.8438
Epoch 9/57
----------
train Loss: 0.1552 Acc: 0.9866
val Loss: 4.7492 Acc: 0.7734
Epoch 10/57
----------
train Loss: 0.2306 Acc: 0.9683
val Loss: 3.5707 Acc: 0.8750
Epoch 11/57
----------
train Loss: 0.3587 Acc: 0.9616
val Loss: 4.5610 Acc: 0.7734
Epoch 12/57
----------
train Loss: 0.1789 Acc: 0.9783
val Loss: 6.1708 Acc: 0.8359
Epoch 13/57
----------
train Loss: 0.6059 Acc: 0.9416
val Loss: 6.1086 Acc: 0.7969
Epoch 14/57
----------
train Loss: 1.2154 Acc: 0.8781
val Loss: 7.0002 Acc: 0.3750
Epoch 15/57
----------
train Loss: 2.4291 Acc: 0.8314
val Loss: 6.5049 Acc: 0.6250
Epoch 16/57
----------
train Loss: 1.4603 Acc: 0.8581
val Loss: 5.0167 Acc: 0.6797
Epoch 17/57
----------
train Loss: 0.9436 Acc: 0.9015
val Loss: 3.8363 Acc: 0.6484
Epoch 18/57
----------
train Loss: 0.5662 Acc: 0.9516
val Loss: 4.4206 Acc: 0.8438
Epoch 19/57
----------
train Loss: 0.9037 Acc: 0.9232
val Loss: 3.5933 Acc: 0.7344
Epoch 20/57
----------
train Loss: 0.4020 Acc: 0.9399
val Loss: 5.2539 Acc: 0.8281
Epoch 21/57
----------
train Loss: 0.1884 Acc: 0.9750
val Loss: 3.6649 Acc: 0.8438
Epoch 22/57
----------
train Loss: 0.2315 Acc: 0.9716
val Loss: 3.6478 Acc: 0.7812
Epoch 23/57
----------
train Loss: 0.1279 Acc: 0.9850
val Loss: 3.2778 Acc: 0.8125
Epoch 24/57
----------
train Loss: 0.1874 Acc: 0.9766
val Loss: 8.1780 Acc: 0.8125
Epoch 25/57
----------
train Loss: 0.2928 Acc: 0.9683
val Loss: 4.2578 Acc: 0.8125
Epoch 26/57
----------
train Loss: 0.0720 Acc: 0.9933
val Loss: 3.3574 Acc: 0.8359
Epoch 27/57
----------
train Loss: 0.0597 Acc: 0.9950
val Loss: 4.4034 Acc: 0.8359
Epoch 28/57
----------
train Loss: 0.0693 Acc: 0.9900
val Loss: 4.9260 Acc: 0.8359
Epoch 29/57
----------
train Loss: 0.0919 Acc: 0.9900
val Loss: 4.7095 Acc: 0.8281
Epoch 30/57
----------
train Loss: 0.0702 Acc: 0.9933
val Loss: 4.3493 Acc: 0.8359
Epoch 31/57
----------
train Loss: 0.0279 Acc: 0.9967
val Loss: 4.4201 Acc: 0.8359
Epoch 32/57
----------
train Loss: 0.0302 Acc: 0.9967
val Loss: 4.8073 Acc: 0.8516
Epoch 33/57
----------
train Loss: 0.0278 Acc: 0.9950
val Loss: 4.7796 Acc: 0.8359
Epoch 34/57
----------
train Loss: 0.0207 Acc: 0.9967
val Loss: 4.4758 Acc: 0.8125
Epoch 35/57
----------
train Loss: 0.1249 Acc: 0.9850
val Loss: 7.2953 Acc: 0.7500
Epoch 36/57
----------
train Loss: 0.2565 Acc: 0.9766
val Loss: 5.0879 Acc: 0.7500
Epoch 37/57
----------
train Loss: 1.0594 Acc: 0.8915
val Loss: 15.8408 Acc: 0.5156
Epoch 38/57
----------
train Loss: 2.7476 Acc: 0.7696
val Loss: 9.5922 Acc: 0.3594
Epoch 39/57
----------
train Loss: 2.0971 Acc: 0.7896
[I 2024-10-15 19:08:03,323] Trial 138 finished with value: 0.8125 and parameters: {'batch_size': 88, 'lr': 0.0001843897006957952, 'num_epochs': 57, 'weight_decay': 0.029254924631977892, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 11.5014 Acc: 0.3281
Early stopping at epoch 39 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.812500
Model weights saved at ./model_weights/ResNet34_bs_88_lr_0.0001843897006957952_epoch_57_wd_0.029254924631977892_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/51
----------
train Loss: 3.8189 Acc: 0.5860
val Loss: 2.6228 Acc: 0.8047
Epoch 2/51
----------
train Loss: 1.7838 Acc: 0.8164
val Loss: 6.8833 Acc: 0.4375
Epoch 3/51
----------
train Loss: 1.3657 Acc: 0.8431
val Loss: 3.6808 Acc: 0.7031
Epoch 4/51
----------
train Loss: 1.1810 Acc: 0.8664
val Loss: 3.9084 Acc: 0.7891
Epoch 5/51
----------
train Loss: 1.2002 Acc: 0.8631
val Loss: 3.5291 Acc: 0.8125
Epoch 6/51
----------
train Loss: 1.0319 Acc: 0.8765
val Loss: 2.3013 Acc: 0.7734
Epoch 7/51
----------
train Loss: 0.5224 Acc: 0.9199
val Loss: 3.2370 Acc: 0.5859
Epoch 8/51
----------
train Loss: 0.3207 Acc: 0.9699
val Loss: 3.2483 Acc: 0.8359
Epoch 9/51
----------
train Loss: 0.2020 Acc: 0.9666
val Loss: 2.8422 Acc: 0.8516
Epoch 10/51
----------
train Loss: 0.3924 Acc: 0.9516
val Loss: 2.6323 Acc: 0.7656
Epoch 11/51
----------
train Loss: 0.1931 Acc: 0.9716
val Loss: 3.2145 Acc: 0.7500
Epoch 12/51
----------
train Loss: 0.3381 Acc: 0.9666
val Loss: 4.2360 Acc: 0.7969
Epoch 13/51
----------
train Loss: 0.4102 Acc: 0.9583
val Loss: 2.7951 Acc: 0.8828
Epoch 14/51
----------
train Loss: 0.4947 Acc: 0.9382
val Loss: 2.3548 Acc: 0.8281
Epoch 15/51
----------
train Loss: 1.3844 Acc: 0.8881
val Loss: 76.3015 Acc: 0.6875
Epoch 16/51
----------
train Loss: 2.4492 Acc: 0.7963
val Loss: 3.0993 Acc: 0.7188
Epoch 17/51
----------
train Loss: 1.6705 Acc: 0.8397
val Loss: 2.1435 Acc: 0.8281
Epoch 18/51
----------
train Loss: 1.5641 Acc: 0.8464
val Loss: 2.2442 Acc: 0.8750
Epoch 19/51
----------
train Loss: 0.6984 Acc: 0.9299
val Loss: 2.8117 Acc: 0.8359
Epoch 20/51
----------
train Loss: 0.4029 Acc: 0.9549
val Loss: 3.8395 Acc: 0.8125
Epoch 21/51
----------
train Loss: 0.4164 Acc: 0.9549
val Loss: 1.9633 Acc: 0.8125
Epoch 22/51
----------
train Loss: 0.2438 Acc: 0.9716
val Loss: 3.0198 Acc: 0.7891
Epoch 23/51
----------
train Loss: 0.1935 Acc: 0.9783
val Loss: 4.2994 Acc: 0.8516
Epoch 24/51
----------
train Loss: 0.4086 Acc: 0.9449
val Loss: 2.8619 Acc: 0.8359
Epoch 25/51
----------
train Loss: 0.4146 Acc: 0.9649
val Loss: 3.2988 Acc: 0.8594
Epoch 26/51
----------
train Loss: 1.3155 Acc: 0.8715
val Loss: 3.2463 Acc: 0.8125
Epoch 27/51
----------
train Loss: 1.0448 Acc: 0.8965
val Loss: 3.5044 Acc: 0.7500
Epoch 28/51
----------
train Loss: 0.9353 Acc: 0.8848
val Loss: 3.1641 Acc: 0.7812
Epoch 29/51
----------
train Loss: 0.4964 Acc: 0.9366
val Loss: 2.6980 Acc: 0.8125
Epoch 30/51
----------
train Loss: 0.2768 Acc: 0.9666
val Loss: 5.5323 Acc: 0.7734
Epoch 31/51
----------
train Loss: 0.2620 Acc: 0.9783
val Loss: 4.4018 Acc: 0.8203
Epoch 32/51
----------
train Loss: 0.5592 Acc: 0.9199
val Loss: 4.5346 Acc: 0.6328
Epoch 33/51
----------
train Loss: 0.8912 Acc: 0.9048
val Loss: 6.4311 Acc: 0.6953
Epoch 34/51
----------
train Loss: 1.2329 Acc: 0.8765
val Loss: 19.3542 Acc: 0.1953
Epoch 35/51
----------
train Loss: 1.2264 Acc: 0.8548
val Loss: 3.6526 Acc: 0.8047
Epoch 36/51
----------
train Loss: 0.5011 Acc: 0.9466
val Loss: 4.3697 Acc: 0.7891
Epoch 37/51
----------
train Loss: 0.4997 Acc: 0.9449
val Loss: 2.9059 Acc: 0.8281
Epoch 38/51
----------
train Loss: 0.3923 Acc: 0.9533
val Loss: 3.6016 Acc: 0.7500
Epoch 39/51
----------
train Loss: 0.6056 Acc: 0.9132
val Loss: 4.1885 Acc: 0.7969
Epoch 40/51
----------
train Loss: 0.4957 Acc: 0.9482
val Loss: 4.0206 Acc: 0.7109
Epoch 41/51
----------
train Loss: 0.5139 Acc: 0.9516
val Loss: 3.5405 Acc: 0.8281
Epoch 42/51
----------
train Loss: 0.5380 Acc: 0.9416
val Loss: 5.3239 Acc: 0.7734
Epoch 43/51
----------
train Loss: 0.3308 Acc: 0.9633
val Loss: 4.8628 Acc: 0.5234
Epoch 44/51
----------
train Loss: 0.2366 Acc: 0.9733
val Loss: 3.6596 Acc: 0.8750
Epoch 45/51
----------
train Loss: 0.4179 Acc: 0.9649
val Loss: 15.2684 Acc: 0.4062
Epoch 46/51
----------
train Loss: 1.3350 Acc: 0.8731
val Loss: 20.7945 Acc: 0.3828
Epoch 47/51
----------
train Loss: 2.1525 Acc: 0.8581
val Loss: 3.8054 Acc: 0.6953
Epoch 48/51
----------
train Loss: 1.7320 Acc: 0.8314
val Loss: 3.6290 Acc: 0.5859
Epoch 49/51
----------
train Loss: 1.2123 Acc: 0.8798
val Loss: 3.0855 Acc: 0.8672
Epoch 50/51
----------
train Loss: 0.4434 Acc: 0.9482
val Loss: 3.4372 Acc: 0.7188
Epoch 51/51
----------
train Loss: 0.3889 Acc: 0.9516
[I 2024-10-15 19:11:50,600] Trial 139 finished with value: 0.8671875 and parameters: {'batch_size': 93, 'lr': 0.00028359808986082714, 'num_epochs': 51, 'weight_decay': 0.04350985065679283, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 5.7360 Acc: 0.7891
Best val Acc: 0.867188
Model weights saved at ./model_weights/ResNet34_bs_93_lr_0.00028359808986082714_epoch_51_wd_0.04350985065679283_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/28
----------
train Loss: 4.4864 Acc: 0.3639
val Loss: 4.3116 Acc: 0.6953
Epoch 2/28
----------
train Loss: 1.1793 Acc: 0.8531
val Loss: 3.2080 Acc: 0.7656
Epoch 3/28
----------
train Loss: 0.4029 Acc: 0.9666
val Loss: 3.3308 Acc: 0.7656
Epoch 4/28
----------
train Loss: 0.1681 Acc: 0.9850
val Loss: 3.5412 Acc: 0.7734
Epoch 5/28
----------
train Loss: 0.1356 Acc: 0.9917
val Loss: 4.2871 Acc: 0.7656
Epoch 6/28
----------
train Loss: 0.0873 Acc: 0.9967
val Loss: 4.4931 Acc: 0.7578
Epoch 7/28
----------
train Loss: 0.0629 Acc: 0.9933
val Loss: 4.4938 Acc: 0.7656
Epoch 8/28
----------
train Loss: 0.0888 Acc: 0.9917
val Loss: 5.1151 Acc: 0.7891
Epoch 9/28
----------
train Loss: 0.1108 Acc: 0.9933
val Loss: 4.9074 Acc: 0.7656
Epoch 10/28
----------
train Loss: 0.0679 Acc: 0.9933
val Loss: 4.8024 Acc: 0.7812
Epoch 11/28
----------
train Loss: 0.0543 Acc: 0.9950
val Loss: 5.2311 Acc: 0.7656
Epoch 12/28
----------
train Loss: 0.0558 Acc: 0.9917
val Loss: 5.8819 Acc: 0.7500
Epoch 13/28
----------
train Loss: 0.0346 Acc: 0.9950
val Loss: 5.4301 Acc: 0.7656
Epoch 14/28
----------
train Loss: 0.0375 Acc: 0.9950
val Loss: 5.0524 Acc: 0.7422
Epoch 15/28
----------
train Loss: 0.0352 Acc: 0.9950
val Loss: 5.6287 Acc: 0.7500
Epoch 16/28
----------
train Loss: 0.0255 Acc: 0.9967
val Loss: 5.6885 Acc: 0.7656
Epoch 17/28
----------
train Loss: 0.0340 Acc: 0.9967
val Loss: 5.0839 Acc: 0.7812
Epoch 18/28
----------
train Loss: 0.0365 Acc: 0.9967
val Loss: 5.8047 Acc: 0.7734
Epoch 19/28
----------
train Loss: 0.0667 Acc: 0.9950
val Loss: 5.5602 Acc: 0.7891
Epoch 20/28
----------
train Loss: 0.0536 Acc: 0.9933
val Loss: 6.8256 Acc: 0.7578
Epoch 21/28
----------
train Loss: 0.1666 Acc: 0.9783
val Loss: 6.3661 Acc: 0.7578
Epoch 22/28
----------
train Loss: 0.7240 Acc: 0.9132
val Loss: 5.7253 Acc: 0.6953
Epoch 23/28
----------
train Loss: 1.7139 Acc: 0.8381
val Loss: 8.4473 Acc: 0.6875
Epoch 24/28
----------
train Loss: 1.4428 Acc: 0.8831
val Loss: 6.0395 Acc: 0.7266
Epoch 25/28
----------
train Loss: 0.6054 Acc: 0.9382
val Loss: 4.1734 Acc: 0.8125
Epoch 26/28
----------
train Loss: 0.5254 Acc: 0.9649
val Loss: 4.7231 Acc: 0.7188
Epoch 27/28
----------
train Loss: 0.2592 Acc: 0.9733
val Loss: 4.8479 Acc: 0.7812
Epoch 28/28
----------
train Loss: 0.1221 Acc: 0.9883
[I 2024-10-15 19:13:55,908] Trial 140 finished with value: 0.8046875 and parameters: {'batch_size': 98, 'lr': 7.89283874870438e-05, 'num_epochs': 28, 'weight_decay': 0.023636848169972753, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 4.9328 Acc: 0.8047
Best val Acc: 0.804688
Model weights saved at ./model_weights/ResNet34_bs_98_lr_7.89283874870438e-05_epoch_28_wd_0.023636848169972753_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/53
----------
train Loss: 3.7821 Acc: 0.5075
val Loss: 4.3263 Acc: 0.7734
Epoch 2/53
----------
train Loss: 1.0521 Acc: 0.8881
val Loss: 3.6590 Acc: 0.7891
Epoch 3/53
----------
train Loss: 0.3917 Acc: 0.9666
val Loss: 3.3476 Acc: 0.8047
Epoch 4/53
----------
train Loss: 0.2386 Acc: 0.9750
val Loss: 4.4460 Acc: 0.8047
Epoch 5/53
----------
train Loss: 0.2147 Acc: 0.9783
val Loss: 4.2765 Acc: 0.8047
Epoch 6/53
----------
train Loss: 0.1060 Acc: 0.9850
val Loss: 4.3059 Acc: 0.7969
Epoch 7/53
----------
train Loss: 0.0920 Acc: 0.9900
val Loss: 4.7668 Acc: 0.7891
Epoch 8/53
----------
train Loss: 0.1394 Acc: 0.9800
val Loss: 3.6065 Acc: 0.7969
Epoch 9/53
----------
train Loss: 0.0913 Acc: 0.9933
val Loss: 5.0607 Acc: 0.8047
Epoch 10/53
----------
train Loss: 0.1383 Acc: 0.9816
val Loss: 3.4666 Acc: 0.8047
Epoch 11/53
----------
train Loss: 0.1970 Acc: 0.9816
val Loss: 4.9186 Acc: 0.8047
Epoch 12/53
----------
train Loss: 0.5359 Acc: 0.9382
val Loss: 4.7754 Acc: 0.6719
Epoch 13/53
----------
train Loss: 1.6450 Acc: 0.8514
val Loss: 6.7139 Acc: 0.5625
Epoch 14/53
----------
train Loss: 1.5797 Acc: 0.8431
val Loss: 8.0628 Acc: 0.6797
Epoch 15/53
----------
train Loss: 0.7667 Acc: 0.9199
val Loss: 5.8249 Acc: 0.7422
Epoch 16/53
----------
train Loss: 0.4665 Acc: 0.9599
val Loss: 4.5202 Acc: 0.8281
Epoch 17/53
----------
train Loss: 0.3778 Acc: 0.9449
val Loss: 5.4266 Acc: 0.8203
Epoch 18/53
----------
train Loss: 0.1781 Acc: 0.9816
val Loss: 4.2260 Acc: 0.8125
Epoch 19/53
----------
train Loss: 0.1088 Acc: 0.9917
val Loss: 3.1929 Acc: 0.8125
Epoch 20/53
----------
train Loss: 0.1340 Acc: 0.9816
val Loss: 4.8722 Acc: 0.7812
Epoch 21/53
----------
train Loss: 0.0953 Acc: 0.9917
val Loss: 4.4261 Acc: 0.8359
Epoch 22/53
----------
train Loss: 0.0968 Acc: 0.9900
val Loss: 3.9155 Acc: 0.8125
Epoch 23/53
----------
train Loss: 0.1233 Acc: 0.9850
val Loss: 4.4998 Acc: 0.8203
Epoch 24/53
----------
train Loss: 0.0913 Acc: 0.9883
val Loss: 4.3038 Acc: 0.8203
Epoch 25/53
----------
train Loss: 0.0912 Acc: 0.9900
val Loss: 4.3239 Acc: 0.8203
Epoch 26/53
----------
train Loss: 0.0652 Acc: 0.9900
val Loss: 4.6570 Acc: 0.8281
Epoch 27/53
----------
train Loss: 0.0444 Acc: 0.9950
val Loss: 4.6847 Acc: 0.8281
Epoch 28/53
----------
train Loss: 0.0367 Acc: 0.9950
val Loss: 4.4986 Acc: 0.8281
Epoch 29/53
----------
train Loss: 0.0378 Acc: 0.9950
val Loss: 5.1692 Acc: 0.8203
Epoch 30/53
----------
train Loss: 0.0277 Acc: 0.9933
val Loss: 4.6948 Acc: 0.8125
Epoch 31/53
----------
train Loss: 0.0298 Acc: 0.9967
val Loss: 5.0197 Acc: 0.8203
Epoch 32/53
----------
train Loss: 0.0209 Acc: 0.9967
val Loss: 4.9875 Acc: 0.8203
Epoch 33/53
----------
train Loss: 0.0242 Acc: 0.9967
val Loss: 4.9835 Acc: 0.8125
Epoch 34/53
----------
train Loss: 0.0207 Acc: 0.9967
val Loss: 4.9747 Acc: 0.8125
Epoch 35/53
----------
train Loss: 0.0226 Acc: 0.9967
val Loss: 4.8304 Acc: 0.8281
Epoch 36/53
----------
train Loss: 0.0200 Acc: 0.9967
val Loss: 5.4702 Acc: 0.8203
Epoch 37/53
----------
train Loss: 0.0723 Acc: 0.9933
val Loss: 7.5250 Acc: 0.8281
Epoch 38/53
----------
train Loss: 0.0587 Acc: 0.9933
val Loss: 4.8928 Acc: 0.8203
Epoch 39/53
----------
train Loss: 0.0356 Acc: 0.9950
val Loss: 3.7778 Acc: 0.8203
Epoch 40/53
----------
train Loss: 0.0294 Acc: 0.9967
val Loss: 4.9391 Acc: 0.8359
Epoch 41/53
----------
train Loss: 0.0175 Acc: 0.9967
val Loss: 5.0678 Acc: 0.8281
Epoch 42/53
----------
train Loss: 0.0521 Acc: 0.9933
val Loss: 5.0331 Acc: 0.8203
Epoch 43/53
----------
train Loss: 0.0833 Acc: 0.9900
val Loss: 5.9702 Acc: 0.7891
Epoch 44/53
----------
train Loss: 0.3020 Acc: 0.9516
val Loss: 4.5929 Acc: 0.7500
Epoch 45/53
----------
train Loss: 1.2778 Acc: 0.8948
val Loss: 51.3903 Acc: 0.2500
Epoch 46/53
----------
train Loss: 2.5356 Acc: 0.7963
val Loss: 7.8226 Acc: 0.5547
Epoch 47/53
----------
train Loss: 2.1414 Acc: 0.8164
val Loss: 5.2527 Acc: 0.6641
Epoch 48/53
----------
train Loss: 1.3805 Acc: 0.8715
val Loss: 5.4887 Acc: 0.7969
Epoch 49/53
----------
train Loss: 0.6121 Acc: 0.9165
val Loss: 4.1511 Acc: 0.8281
Epoch 50/53
----------
train Loss: 0.3869 Acc: 0.9566
val Loss: 3.5295 Acc: 0.8438
Epoch 51/53
----------
train Loss: 0.2378 Acc: 0.9649
val Loss: 4.4580 Acc: 0.8203
Epoch 52/53
----------
train Loss: 0.1643 Acc: 0.9816
val Loss: 5.3710 Acc: 0.8281
Epoch 53/53
----------
train Loss: 0.1678 Acc: 0.9833
[I 2024-10-15 19:17:53,324] Trial 141 finished with value: 0.828125 and parameters: {'batch_size': 90, 'lr': 0.00014621322315695447, 'num_epochs': 53, 'weight_decay': 0.018608354270794193, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 4.0904 Acc: 0.7734
Best val Acc: 0.828125
Model weights saved at ./model_weights/ResNet34_bs_90_lr_0.00014621322315695447_epoch_53_wd_0.018608354270794193_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/49
----------
train Loss: 4.1806 Acc: 0.5793
val Loss: 2.4948 Acc: 0.7344
Epoch 2/49
----------
train Loss: 1.2596 Acc: 0.8497
val Loss: 2.0399 Acc: 0.8438
Epoch 3/49
----------
train Loss: 0.4486 Acc: 0.9633
val Loss: 2.1123 Acc: 0.8281
Epoch 4/49
----------
train Loss: 0.1840 Acc: 0.9850
val Loss: 2.1550 Acc: 0.8203
Epoch 5/49
----------
train Loss: 0.1366 Acc: 0.9833
val Loss: 2.3940 Acc: 0.8125
Epoch 6/49
----------
train Loss: 0.1391 Acc: 0.9900
val Loss: 2.3595 Acc: 0.8203
Epoch 7/49
----------
train Loss: 0.1145 Acc: 0.9866
val Loss: 2.3376 Acc: 0.8594
Epoch 8/49
----------
train Loss: 0.1556 Acc: 0.9800
val Loss: 2.9040 Acc: 0.8438
Epoch 9/49
----------
train Loss: 0.1709 Acc: 0.9783
val Loss: 2.4657 Acc: 0.8672
Epoch 10/49
----------
train Loss: 0.2931 Acc: 0.9666
val Loss: 2.7028 Acc: 0.8047
Epoch 11/49
----------
train Loss: 0.2251 Acc: 0.9699
val Loss: 2.3443 Acc: 0.8359
Epoch 12/49
----------
train Loss: 0.1850 Acc: 0.9800
val Loss: 2.5232 Acc: 0.7891
Epoch 13/49
----------
train Loss: 0.2897 Acc: 0.9583
val Loss: 2.8675 Acc: 0.8047
Epoch 14/49
----------
train Loss: 0.2197 Acc: 0.9816
val Loss: 4.7785 Acc: 0.7422
Epoch 15/49
----------
train Loss: 1.2759 Acc: 0.9232
val Loss: 3.7659 Acc: 0.7812
Epoch 16/49
----------
train Loss: 0.6296 Acc: 0.9349
val Loss: 2.5551 Acc: 0.7578
Epoch 17/49
----------
train Loss: 0.4861 Acc: 0.9399
val Loss: 2.5207 Acc: 0.7578
Epoch 18/49
----------
train Loss: 0.4207 Acc: 0.9716
val Loss: 2.8892 Acc: 0.7734
Epoch 19/49
----------
train Loss: 0.5736 Acc: 0.9566
val Loss: 1.9302 Acc: 0.8281
Epoch 20/49
----------
train Loss: 0.5019 Acc: 0.9499
val Loss: 1.9202 Acc: 0.7734
Epoch 21/49
----------
train Loss: 0.3192 Acc: 0.9599
val Loss: 2.3271 Acc: 0.8281
Epoch 22/49
----------
train Loss: 0.3993 Acc: 0.9699
val Loss: 2.3432 Acc: 0.8438
Epoch 23/49
----------
train Loss: 0.2447 Acc: 0.9616
val Loss: 3.1445 Acc: 0.8047
Epoch 24/49
----------
train Loss: 0.1009 Acc: 0.9866
val Loss: 2.6632 Acc: 0.8672
Epoch 25/49
----------
train Loss: 0.0884 Acc: 0.9900
val Loss: 2.3251 Acc: 0.8281
Epoch 26/49
----------
train Loss: 0.0692 Acc: 0.9950
val Loss: 2.4453 Acc: 0.8672
Epoch 27/49
----------
train Loss: 0.0506 Acc: 0.9933
val Loss: 2.4117 Acc: 0.8672
Epoch 28/49
----------
train Loss: 0.0617 Acc: 0.9933
val Loss: 2.2769 Acc: 0.8672
Epoch 29/49
----------
train Loss: 0.0533 Acc: 0.9933
val Loss: 2.4387 Acc: 0.8750
Epoch 30/49
----------
train Loss: 0.0464 Acc: 0.9933
val Loss: 2.6458 Acc: 0.8750
Epoch 31/49
----------
train Loss: 0.0370 Acc: 0.9950
val Loss: 2.5325 Acc: 0.8750
Epoch 32/49
----------
train Loss: 0.0466 Acc: 0.9900
val Loss: 2.4187 Acc: 0.8750
Epoch 33/49
----------
train Loss: 0.0560 Acc: 0.9933
val Loss: 2.8840 Acc: 0.8594
Epoch 34/49
----------
train Loss: 0.1129 Acc: 0.9900
val Loss: 2.9688 Acc: 0.8594
Epoch 35/49
----------
train Loss: 0.0578 Acc: 0.9917
val Loss: 3.0327 Acc: 0.8594
Epoch 36/49
----------
train Loss: 0.0994 Acc: 0.9883
val Loss: 3.6624 Acc: 0.8672
Epoch 37/49
----------
train Loss: 0.2925 Acc: 0.9616
val Loss: 2.6443 Acc: 0.8203
Epoch 38/49
----------
train Loss: 0.2590 Acc: 0.9549
val Loss: 2.5210 Acc: 0.8281
Epoch 39/49
----------
train Loss: 0.1569 Acc: 0.9833
val Loss: 3.8356 Acc: 0.7812
Epoch 40/49
----------
train Loss: 0.1584 Acc: 0.9850
val Loss: 2.6511 Acc: 0.8281
Epoch 41/49
----------
train Loss: 0.1437 Acc: 0.9850
val Loss: 3.1822 Acc: 0.7891
Epoch 42/49
----------
train Loss: 0.3645 Acc: 0.9599
val Loss: 2.5763 Acc: 0.7500
Epoch 43/49
----------
train Loss: 0.2626 Acc: 0.9750
val Loss: 2.0986 Acc: 0.8281
Epoch 44/49
----------
train Loss: 0.2806 Acc: 0.9616
val Loss: 3.6211 Acc: 0.8828
Epoch 45/49
----------
train Loss: 0.3149 Acc: 0.9633
val Loss: 3.8416 Acc: 0.8516
Epoch 46/49
----------
train Loss: 0.3479 Acc: 0.9683
val Loss: 2.7816 Acc: 0.7812
Epoch 47/49
----------
train Loss: 0.4871 Acc: 0.9199
val Loss: 2.8231 Acc: 0.8750
Epoch 48/49
----------
train Loss: 0.6901 Acc: 0.9482
val Loss: 4.3931 Acc: 0.7422
Epoch 49/49
----------
train Loss: 0.4386 Acc: 0.9683
[I 2024-10-15 19:21:34,032] Trial 142 finished with value: 0.875 and parameters: {'batch_size': 88, 'lr': 0.00010585063751036901, 'num_epochs': 49, 'weight_decay': 0.017453021343624708, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 3.6081 Acc: 0.8203
Best val Acc: 0.875000
Model weights saved at ./model_weights/ResNet34_bs_88_lr_0.00010585063751036901_epoch_49_wd_0.017453021343624708_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/49
----------
train Loss: 4.0635 Acc: 0.5442
val Loss: 2.2360 Acc: 0.7891
Epoch 2/49
----------
train Loss: 1.1093 Acc: 0.8531
val Loss: 2.3357 Acc: 0.8203
Epoch 3/49
----------
train Loss: 0.5119 Acc: 0.9449
val Loss: 2.3667 Acc: 0.7656
Epoch 4/49
----------
train Loss: 0.2859 Acc: 0.9816
val Loss: 2.9367 Acc: 0.8281
Epoch 5/49
----------
train Loss: 0.1945 Acc: 0.9750
val Loss: 2.5844 Acc: 0.8047
Epoch 6/49
----------
train Loss: 0.1298 Acc: 0.9883
val Loss: 2.4206 Acc: 0.8359
Epoch 7/49
----------
train Loss: 0.0865 Acc: 0.9883
val Loss: 2.6529 Acc: 0.8203
Epoch 8/49
----------
train Loss: 0.1440 Acc: 0.9933
val Loss: 3.1185 Acc: 0.8359
Epoch 9/49
----------
train Loss: 0.1493 Acc: 0.9783
val Loss: 3.1078 Acc: 0.8203
Epoch 10/49
----------
train Loss: 0.1166 Acc: 0.9900
val Loss: 2.8415 Acc: 0.8281
Epoch 11/49
----------
train Loss: 0.1861 Acc: 0.9783
val Loss: 3.0022 Acc: 0.8438
Epoch 12/49
----------
train Loss: 0.1562 Acc: 0.9900
val Loss: 3.4569 Acc: 0.7656
Epoch 13/49
----------
train Loss: 0.2353 Acc: 0.9733
val Loss: 3.1416 Acc: 0.8594
Epoch 14/49
----------
train Loss: 0.2293 Acc: 0.9699
val Loss: 3.9770 Acc: 0.8438
Epoch 15/49
----------
train Loss: 0.4088 Acc: 0.9499
val Loss: 4.1197 Acc: 0.6797
Epoch 16/49
----------
train Loss: 1.7991 Acc: 0.8748
val Loss: 6.3553 Acc: 0.4062
Epoch 17/49
----------
train Loss: 1.6185 Acc: 0.8247
val Loss: 4.0515 Acc: 0.7969
Epoch 18/49
----------
train Loss: 0.9542 Acc: 0.9048
val Loss: 3.3125 Acc: 0.7812
Epoch 19/49
----------
train Loss: 0.4657 Acc: 0.9332
val Loss: 2.5627 Acc: 0.8281
Epoch 20/49
----------
train Loss: 0.3031 Acc: 0.9666
val Loss: 2.8410 Acc: 0.8438
Epoch 21/49
----------
train Loss: 0.2079 Acc: 0.9783
val Loss: 2.7054 Acc: 0.8125
Epoch 22/49
----------
train Loss: 0.1788 Acc: 0.9766
val Loss: 2.2998 Acc: 0.8359
Epoch 23/49
----------
train Loss: 0.1146 Acc: 0.9900
val Loss: 3.1726 Acc: 0.8516
Epoch 24/49
----------
train Loss: 0.2007 Acc: 0.9833
val Loss: 3.0443 Acc: 0.8281
Epoch 25/49
----------
train Loss: 0.2737 Acc: 0.9716
val Loss: 2.6638 Acc: 0.8203
Epoch 26/49
----------
train Loss: 0.1427 Acc: 0.9883
val Loss: 3.1389 Acc: 0.8047
Epoch 27/49
----------
train Loss: 0.0775 Acc: 0.9900
val Loss: 2.5333 Acc: 0.8281
Epoch 28/49
----------
train Loss: 0.0701 Acc: 0.9933
val Loss: 3.1515 Acc: 0.8516
Epoch 29/49
----------
train Loss: 0.0842 Acc: 0.9933
val Loss: 3.3320 Acc: 0.8672
Epoch 30/49
----------
train Loss: 0.0518 Acc: 0.9933
val Loss: 3.3947 Acc: 0.8438
Epoch 31/49
----------
train Loss: 0.0418 Acc: 0.9950
val Loss: 3.2999 Acc: 0.8672
Epoch 32/49
----------
train Loss: 0.0549 Acc: 0.9933
val Loss: 3.2482 Acc: 0.8672
Epoch 33/49
----------
train Loss: 0.0747 Acc: 0.9900
val Loss: 3.3552 Acc: 0.8594
Epoch 34/49
----------
train Loss: 0.0676 Acc: 0.9933
val Loss: 3.0312 Acc: 0.8438
Epoch 35/49
----------
train Loss: 0.0474 Acc: 0.9950
val Loss: 3.0515 Acc: 0.8438
Epoch 36/49
----------
train Loss: 0.0475 Acc: 0.9933
val Loss: 3.1726 Acc: 0.8516
Epoch 37/49
----------
train Loss: 0.0648 Acc: 0.9917
val Loss: 4.0499 Acc: 0.7578
Epoch 38/49
----------
train Loss: 0.3065 Acc: 0.9599
val Loss: 3.2610 Acc: 0.8594
Epoch 39/49
----------
train Loss: 0.3667 Acc: 0.9783
val Loss: 2.6242 Acc: 0.8438
Epoch 40/49
----------
train Loss: 0.1911 Acc: 0.9800
val Loss: 2.8339 Acc: 0.8125
Epoch 41/49
----------
train Loss: 0.2243 Acc: 0.9750
val Loss: 4.3752 Acc: 0.8438
Epoch 42/49
----------
train Loss: 0.1162 Acc: 0.9917
val Loss: 3.7127 Acc: 0.8672
Epoch 43/49
----------
train Loss: 0.0509 Acc: 0.9950
val Loss: 3.2003 Acc: 0.8516
Epoch 44/49
----------
train Loss: 0.0559 Acc: 0.9933
val Loss: 3.2064 Acc: 0.8516
Epoch 45/49
----------
train Loss: 0.0484 Acc: 0.9950
val Loss: 3.1729 Acc: 0.8516
Epoch 46/49
----------
train Loss: 0.0484 Acc: 0.9950
val Loss: 3.3895 Acc: 0.8672
Epoch 47/49
----------
train Loss: 0.1013 Acc: 0.9900
val Loss: 3.2491 Acc: 0.8750
Epoch 48/49
----------
train Loss: 0.0717 Acc: 0.9900
val Loss: 3.3863 Acc: 0.8281
Epoch 49/49
----------
train Loss: 0.0486 Acc: 0.9933
[I 2024-10-15 19:25:15,656] Trial 143 finished with value: 0.828125 and parameters: {'batch_size': 86, 'lr': 0.00010799576313942937, 'num_epochs': 49, 'weight_decay': 0.02313334281744726, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 3.5239 Acc: 0.8281
Best val Acc: 0.828125
Model weights saved at ./model_weights/ResNet34_bs_86_lr_0.00010799576313942937_epoch_49_wd_0.02313334281744726_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/47
----------
train Loss: 4.1604 Acc: 0.5559
val Loss: 4.3110 Acc: 0.6016
Epoch 2/47
----------
train Loss: 1.4213 Acc: 0.8164
val Loss: 3.4620 Acc: 0.7031
Epoch 3/47
----------
train Loss: 1.0915 Acc: 0.8881
val Loss: 2.9031 Acc: 0.7891
Epoch 4/47
----------
train Loss: 0.5440 Acc: 0.9132
val Loss: 4.5395 Acc: 0.7031
Epoch 5/47
----------
train Loss: 0.3007 Acc: 0.9699
val Loss: 5.3154 Acc: 0.7734
Epoch 6/47
----------
train Loss: 0.2641 Acc: 0.9716
val Loss: 5.9389 Acc: 0.8203
Epoch 7/47
----------
train Loss: 0.2543 Acc: 0.9750
val Loss: 4.0843 Acc: 0.8281
Epoch 8/47
----------
train Loss: 0.2932 Acc: 0.9649
val Loss: 5.0990 Acc: 0.8125
Epoch 9/47
----------
train Loss: 0.3754 Acc: 0.9499
val Loss: 3.5023 Acc: 0.7578
Epoch 10/47
----------
train Loss: 0.2556 Acc: 0.9649
val Loss: 4.8823 Acc: 0.7578
Epoch 11/47
----------
train Loss: 0.2123 Acc: 0.9783
val Loss: 6.4276 Acc: 0.7891
Epoch 12/47
----------
train Loss: 0.1875 Acc: 0.9866
val Loss: 5.9713 Acc: 0.8125
Epoch 13/47
----------
train Loss: 0.5740 Acc: 0.9516
val Loss: 8.8259 Acc: 0.5703
Epoch 14/47
----------
train Loss: 0.7486 Acc: 0.9015
val Loss: 8.6561 Acc: 0.7344
Epoch 15/47
----------
train Loss: 1.4749 Acc: 0.8798
val Loss: 6.1553 Acc: 0.7734
Epoch 16/47
----------
train Loss: 1.4293 Acc: 0.8598
val Loss: 3.3686 Acc: 0.8125
Epoch 17/47
----------
train Loss: 0.7484 Acc: 0.9282
val Loss: 4.5675 Acc: 0.7734
Epoch 18/47
----------
train Loss: 0.5094 Acc: 0.9316
val Loss: 4.1336 Acc: 0.7891
Epoch 19/47
----------
train Loss: 0.3823 Acc: 0.9583
val Loss: 3.2424 Acc: 0.7578
Epoch 20/47
----------
train Loss: 0.1614 Acc: 0.9866
val Loss: 3.7169 Acc: 0.7891
Epoch 21/47
----------
train Loss: 0.0900 Acc: 0.9917
val Loss: 4.0342 Acc: 0.8203
Epoch 22/47
----------
train Loss: 0.0970 Acc: 0.9883
val Loss: 4.4781 Acc: 0.8359
Epoch 23/47
----------
train Loss: 0.0655 Acc: 0.9917
val Loss: 4.3999 Acc: 0.8281
Epoch 24/47
----------
train Loss: 0.0789 Acc: 0.9850
val Loss: 4.9914 Acc: 0.7734
Epoch 25/47
----------
train Loss: 0.0611 Acc: 0.9933
val Loss: 4.9771 Acc: 0.8047
Epoch 26/47
----------
train Loss: 0.0828 Acc: 0.9900
val Loss: 4.0050 Acc: 0.8203
Epoch 27/47
----------
train Loss: 0.0451 Acc: 0.9967
val Loss: 4.3638 Acc: 0.8281
Epoch 28/47
----------
train Loss: 0.0459 Acc: 0.9967
val Loss: 4.5607 Acc: 0.8125
Epoch 29/47
----------
train Loss: 0.0472 Acc: 0.9967
val Loss: 5.5513 Acc: 0.7891
Epoch 30/47
----------
train Loss: 0.0493 Acc: 0.9933
val Loss: 4.1604 Acc: 0.7969
Epoch 31/47
----------
train Loss: 0.0371 Acc: 0.9967
val Loss: 4.8110 Acc: 0.8125
Epoch 32/47
----------
train Loss: 0.0275 Acc: 0.9950
val Loss: 5.8983 Acc: 0.8281
Epoch 33/47
----------
train Loss: 0.0353 Acc: 0.9950
val Loss: 5.9941 Acc: 0.8125
Epoch 34/47
----------
train Loss: 0.0413 Acc: 0.9950
val Loss: 4.9217 Acc: 0.8281
Epoch 35/47
----------
train Loss: 0.0467 Acc: 0.9950
val Loss: 8.1653 Acc: 0.8203
Epoch 36/47
----------
train Loss: 0.0904 Acc: 0.9883
val Loss: 5.9678 Acc: 0.7188
Epoch 37/47
----------
train Loss: 0.1543 Acc: 0.9766
val Loss: 5.7743 Acc: 0.7812
Epoch 38/47
----------
train Loss: 0.6328 Acc: 0.9182
val Loss: 3.5120 Acc: 0.7188
Epoch 39/47
----------
train Loss: 1.6408 Acc: 0.8364
val Loss: 15.0212 Acc: 0.4453
Epoch 40/47
----------
train Loss: 2.3272 Acc: 0.8030
val Loss: 39.7232 Acc: 0.2266
Epoch 41/47
----------
train Loss: 2.3693 Acc: 0.7379
val Loss: 4.1671 Acc: 0.7500
Epoch 42/47
----------
train Loss: 1.1549 Acc: 0.8698
val Loss: 5.2091 Acc: 0.7812
Epoch 43/47
----------
train Loss: 0.6697 Acc: 0.9149
val Loss: 4.8403 Acc: 0.7500
Epoch 44/47
----------
train Loss: 0.4391 Acc: 0.9516
val Loss: 4.3226 Acc: 0.7656
Epoch 45/47
----------
train Loss: 0.2829 Acc: 0.9649
val Loss: 4.3660 Acc: 0.7969
Epoch 46/47
----------
train Loss: 0.2570 Acc: 0.9666
val Loss: 4.7580 Acc: 0.7656
Epoch 47/47
----------
train Loss: 0.6983 Acc: 0.9299
[I 2024-10-15 19:28:46,012] Trial 144 finished with value: 0.765625 and parameters: {'batch_size': 91, 'lr': 0.00023729512170076546, 'num_epochs': 47, 'weight_decay': 0.014796262199340826, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 4.7208 Acc: 0.6953
Best val Acc: 0.765625
Model weights saved at ./model_weights/ResNet34_bs_91_lr_0.00023729512170076546_epoch_47_wd_0.014796262199340826_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/51
----------
train Loss: 4.4148 Acc: 0.4107
val Loss: 2.9266 Acc: 0.7500
Epoch 2/51
----------
train Loss: 0.9772 Acc: 0.8748
val Loss: 2.9510 Acc: 0.8203
Epoch 3/51
----------
train Loss: 0.3349 Acc: 0.9599
val Loss: 2.8040 Acc: 0.8359
Epoch 4/51
----------
train Loss: 0.1542 Acc: 0.9816
val Loss: 3.6523 Acc: 0.8438
Epoch 5/51
----------
train Loss: 0.1226 Acc: 0.9933
val Loss: 3.5318 Acc: 0.8359
Epoch 6/51
----------
train Loss: 0.1655 Acc: 0.9866
val Loss: 2.7809 Acc: 0.8281
Epoch 7/51
----------
train Loss: 0.2116 Acc: 0.9750
val Loss: 3.3297 Acc: 0.8594
Epoch 8/51
----------
train Loss: 0.3287 Acc: 0.9516
val Loss: 4.2341 Acc: 0.8438
Epoch 9/51
----------
train Loss: 0.5608 Acc: 0.9332
val Loss: 6.0337 Acc: 0.7891
Epoch 10/51
----------
train Loss: 1.1709 Acc: 0.8898
val Loss: 6.0658 Acc: 0.7109
Epoch 11/51
----------
train Loss: 1.4967 Acc: 0.8564
val Loss: 5.6224 Acc: 0.7031
Epoch 12/51
----------
train Loss: 0.6984 Acc: 0.9366
val Loss: 3.5310 Acc: 0.7969
Epoch 13/51
----------
train Loss: 0.3106 Acc: 0.9583
val Loss: 3.7261 Acc: 0.7969
Epoch 14/51
----------
train Loss: 0.2136 Acc: 0.9800
val Loss: 4.6684 Acc: 0.8438
Epoch 15/51
----------
train Loss: 0.2575 Acc: 0.9699
val Loss: 5.5509 Acc: 0.7891
Epoch 16/51
----------
train Loss: 0.3326 Acc: 0.9733
val Loss: 4.1086 Acc: 0.7578
Epoch 17/51
----------
train Loss: 0.4088 Acc: 0.9449
val Loss: 5.6955 Acc: 0.8516
Epoch 18/51
----------
train Loss: 0.3093 Acc: 0.9666
val Loss: 3.9311 Acc: 0.7891
Epoch 19/51
----------
train Loss: 0.2643 Acc: 0.9733
val Loss: 4.6451 Acc: 0.8125
Epoch 20/51
----------
train Loss: 0.1957 Acc: 0.9783
val Loss: 3.9235 Acc: 0.8438
Epoch 21/51
----------
train Loss: 0.1178 Acc: 0.9900
val Loss: 3.5059 Acc: 0.8594
Epoch 22/51
----------
train Loss: 0.0664 Acc: 0.9933
val Loss: 3.7462 Acc: 0.8203
Epoch 23/51
----------
train Loss: 0.1237 Acc: 0.9816
val Loss: 5.8008 Acc: 0.8359
Epoch 24/51
----------
train Loss: 0.2574 Acc: 0.9766
val Loss: 4.4298 Acc: 0.8125
Epoch 25/51
----------
train Loss: 0.1684 Acc: 0.9800
val Loss: 5.5188 Acc: 0.8359
Epoch 26/51
----------
train Loss: 0.2601 Acc: 0.9699
val Loss: 5.0158 Acc: 0.8594
Epoch 27/51
----------
train Loss: 0.6961 Acc: 0.9098
val Loss: 5.0135 Acc: 0.6719
Epoch 28/51
----------
train Loss: 1.3024 Acc: 0.8982
val Loss: 5.5523 Acc: 0.5859
Epoch 29/51
----------
train Loss: 1.0621 Acc: 0.8781
val Loss: 7.1489 Acc: 0.7344
Epoch 30/51
----------
train Loss: 1.1155 Acc: 0.8998
val Loss: 7.2318 Acc: 0.6016
Epoch 31/51
----------
train Loss: 0.6161 Acc: 0.9249
val Loss: 3.7496 Acc: 0.8516
Epoch 32/51
----------
train Loss: 0.3489 Acc: 0.9549
val Loss: 3.9294 Acc: 0.8203
Epoch 33/51
----------
train Loss: 0.3289 Acc: 0.9633
val Loss: 2.9110 Acc: 0.8125
Epoch 34/51
----------
train Loss: 0.3937 Acc: 0.9599
val Loss: 4.3562 Acc: 0.7969
Epoch 35/51
----------
train Loss: 0.3572 Acc: 0.9649
val Loss: 6.0116 Acc: 0.7578
Epoch 36/51
----------
train Loss: 0.2846 Acc: 0.9716
val Loss: 5.3996 Acc: 0.6797
Epoch 37/51
----------
train Loss: 0.1606 Acc: 0.9866
val Loss: 6.6423 Acc: 0.7969
Epoch 38/51
----------
train Loss: 0.1005 Acc: 0.9883
val Loss: 5.7814 Acc: 0.8125
Epoch 39/51
----------
train Loss: 0.1672 Acc: 0.9866
val Loss: 6.7977 Acc: 0.8047
Epoch 40/51
----------
train Loss: 0.9932 Acc: 0.9432
val Loss: 13.0331 Acc: 0.3516
Epoch 41/51
----------
train Loss: 0.6497 Acc: 0.9366
val Loss: 6.0346 Acc: 0.7812
Epoch 42/51
----------
train Loss: 0.3046 Acc: 0.9750
val Loss: 7.8545 Acc: 0.7031
Epoch 43/51
----------
train Loss: 0.2450 Acc: 0.9666
val Loss: 3.7875 Acc: 0.8359
Epoch 44/51
----------
train Loss: 0.4000 Acc: 0.9566
val Loss: 3.6934 Acc: 0.8203
Epoch 45/51
----------
train Loss: 0.2289 Acc: 0.9883
val Loss: 4.8358 Acc: 0.8281
Epoch 46/51
----------
train Loss: 0.2434 Acc: 0.9683
val Loss: 5.0721 Acc: 0.7812
Epoch 47/51
----------
train Loss: 0.4459 Acc: 0.9516
val Loss: 6.3302 Acc: 0.8125
Epoch 48/51
----------
train Loss: 0.1846 Acc: 0.9766
val Loss: 5.6211 Acc: 0.8281
Epoch 49/51
----------
train Loss: 0.2371 Acc: 0.9699
val Loss: 4.1133 Acc: 0.7891
Epoch 50/51
----------
train Loss: 0.1533 Acc: 0.9883
val Loss: 4.8597 Acc: 0.7812
Epoch 51/51
----------
train Loss: 0.0742 Acc: 0.9917
[I 2024-10-15 19:32:36,047] Trial 145 finished with value: 0.8046875 and parameters: {'batch_size': 95, 'lr': 0.00012718067320630782, 'num_epochs': 51, 'weight_decay': 0.05948781343372064, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 5.1403 Acc: 0.8047
Best val Acc: 0.804688
Model weights saved at ./model_weights/ResNet34_bs_95_lr_0.00012718067320630782_epoch_51_wd_0.05948781343372064_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/41
----------
train Loss: 4.2684 Acc: 0.4775
val Loss: 2.9380 Acc: 0.7344
Epoch 2/41
----------
train Loss: 1.3007 Acc: 0.8414
val Loss: 2.4653 Acc: 0.7734
Epoch 3/41
----------
train Loss: 0.4124 Acc: 0.9599
val Loss: 2.4999 Acc: 0.8047
Epoch 4/41
----------
train Loss: 0.2073 Acc: 0.9850
val Loss: 2.8238 Acc: 0.8359
Epoch 5/41
----------
train Loss: 0.1388 Acc: 0.9900
val Loss: 2.8912 Acc: 0.8203
Epoch 6/41
----------
train Loss: 0.1159 Acc: 0.9900
val Loss: 2.8574 Acc: 0.8359
Epoch 7/41
----------
train Loss: 0.0679 Acc: 0.9950
val Loss: 3.4848 Acc: 0.8125
Epoch 8/41
----------
train Loss: 0.0953 Acc: 0.9933
val Loss: 3.7301 Acc: 0.7891
Epoch 9/41
----------
train Loss: 0.0801 Acc: 0.9933
val Loss: 3.1285 Acc: 0.7891
Epoch 10/41
----------
train Loss: 0.0686 Acc: 0.9917
val Loss: 3.7530 Acc: 0.8047
Epoch 11/41
----------
train Loss: 0.0775 Acc: 0.9917
val Loss: 3.4440 Acc: 0.8125
Epoch 12/41
----------
train Loss: 0.1145 Acc: 0.9866
val Loss: 3.3519 Acc: 0.7969
Epoch 13/41
----------
train Loss: 0.0973 Acc: 0.9933
val Loss: 3.8021 Acc: 0.8047
Epoch 14/41
----------
train Loss: 0.0828 Acc: 0.9883
val Loss: 3.5250 Acc: 0.7969
Epoch 15/41
----------
train Loss: 0.2586 Acc: 0.9633
val Loss: 4.3640 Acc: 0.8047
Epoch 16/41
----------
train Loss: 0.7553 Acc: 0.9098
val Loss: 7.2276 Acc: 0.7031
Epoch 17/41
----------
train Loss: 1.4046 Acc: 0.8731
val Loss: 8.9467 Acc: 0.7266
Epoch 18/41
----------
train Loss: 1.7068 Acc: 0.8548
val Loss: 6.7600 Acc: 0.5156
Epoch 19/41
----------
train Loss: 0.9020 Acc: 0.9098
val Loss: 2.8547 Acc: 0.8125
Epoch 20/41
----------
train Loss: 0.4139 Acc: 0.9666
val Loss: 3.8679 Acc: 0.7891
Epoch 21/41
----------
train Loss: 0.2272 Acc: 0.9800
val Loss: 4.5117 Acc: 0.7969
Epoch 22/41
----------
train Loss: 0.1073 Acc: 0.9833
val Loss: 4.4193 Acc: 0.7656
Epoch 23/41
----------
train Loss: 0.0908 Acc: 0.9933
val Loss: 4.2683 Acc: 0.7969
Epoch 24/41
----------
train Loss: 0.0612 Acc: 0.9950
val Loss: 4.1118 Acc: 0.8125
Epoch 25/41
----------
train Loss: 0.0315 Acc: 0.9950
val Loss: 4.1514 Acc: 0.8125
Epoch 26/41
----------
train Loss: 0.0297 Acc: 0.9967
val Loss: 4.2032 Acc: 0.8125
Epoch 27/41
----------
train Loss: 0.0380 Acc: 0.9967
val Loss: 4.6936 Acc: 0.8047
Epoch 28/41
----------
train Loss: 0.0430 Acc: 0.9967
val Loss: 5.1251 Acc: 0.7969
Epoch 29/41
----------
train Loss: 0.0373 Acc: 0.9950
val Loss: 4.5135 Acc: 0.7891
Epoch 30/41
----------
train Loss: 0.0298 Acc: 0.9967
val Loss: 4.4855 Acc: 0.8125
Epoch 31/41
----------
train Loss: 0.0450 Acc: 0.9950
val Loss: 5.1213 Acc: 0.7891
Epoch 32/41
----------
train Loss: 0.0374 Acc: 0.9950
val Loss: 5.4223 Acc: 0.7812
Epoch 33/41
----------
train Loss: 0.0417 Acc: 0.9967
val Loss: 4.5961 Acc: 0.7734
Epoch 34/41
----------
train Loss: 0.0509 Acc: 0.9950
val Loss: 5.1538 Acc: 0.7891
Epoch 35/41
----------
train Loss: 0.0316 Acc: 0.9950
val Loss: 5.8555 Acc: 0.8047
Epoch 36/41
----------
train Loss: 0.0713 Acc: 0.9850
val Loss: 3.8371 Acc: 0.8125
Epoch 37/41
----------
train Loss: 0.2953 Acc: 0.9800
val Loss: 4.6878 Acc: 0.7188
Epoch 38/41
----------
train Loss: 0.1788 Acc: 0.9800
val Loss: 4.5587 Acc: 0.8047
Epoch 39/41
----------
train Loss: 0.2853 Acc: 0.9633
val Loss: 5.8155 Acc: 0.8203
Epoch 40/41
----------
train Loss: 0.2051 Acc: 0.9633
val Loss: 4.3840 Acc: 0.7734
Epoch 41/41
----------
train Loss: 0.1952 Acc: 0.9783
[I 2024-10-15 19:35:38,328] Trial 146 finished with value: 0.78125 and parameters: {'batch_size': 83, 'lr': 9.052842186109114e-05, 'num_epochs': 41, 'weight_decay': 0.03514370025955954, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 5.9705 Acc: 0.7812
Best val Acc: 0.781250
Model weights saved at ./model_weights/ResNet34_bs_83_lr_9.052842186109114e-05_epoch_41_wd_0.03514370025955954_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/60
----------
train Loss: 3.9981 Acc: 0.5292
val Loss: 4.1434 Acc: 0.7109
Epoch 2/60
----------
train Loss: 1.0656 Acc: 0.8748
val Loss: 3.1708 Acc: 0.8047
Epoch 3/60
----------
train Loss: 0.4266 Acc: 0.9666
val Loss: 3.5890 Acc: 0.7969
Epoch 4/60
----------
train Loss: 0.2309 Acc: 0.9917
val Loss: 4.1583 Acc: 0.8281
Epoch 5/60
----------
train Loss: 0.1350 Acc: 0.9950
val Loss: 4.1391 Acc: 0.8047
Epoch 6/60
----------
train Loss: 0.1063 Acc: 0.9950
val Loss: 4.5352 Acc: 0.7734
Epoch 7/60
----------
train Loss: 0.0858 Acc: 0.9950
val Loss: 4.4771 Acc: 0.8047
Epoch 8/60
----------
train Loss: 0.0666 Acc: 0.9967
val Loss: 4.4373 Acc: 0.7969
Epoch 9/60
----------
train Loss: 0.0541 Acc: 0.9983
val Loss: 4.5618 Acc: 0.7891
Epoch 10/60
----------
train Loss: 0.1769 Acc: 0.9917
val Loss: 4.7031 Acc: 0.8047
Epoch 11/60
----------
train Loss: 0.1384 Acc: 0.9900
val Loss: 4.5542 Acc: 0.7969
Epoch 12/60
----------
train Loss: 0.1152 Acc: 0.9950
val Loss: 4.3937 Acc: 0.7969
Epoch 13/60
----------
train Loss: 0.1181 Acc: 0.9933
val Loss: 4.5513 Acc: 0.7891
Epoch 14/60
----------
train Loss: 0.4070 Acc: 0.9649
val Loss: 6.4642 Acc: 0.7812
Epoch 15/60
----------
train Loss: 0.5662 Acc: 0.9382
val Loss: 5.7201 Acc: 0.7578
Epoch 16/60
----------
train Loss: 0.8066 Acc: 0.9015
val Loss: 4.9015 Acc: 0.7188
Epoch 17/60
----------
train Loss: 0.6331 Acc: 0.9399
val Loss: 6.1593 Acc: 0.7656
Epoch 18/60
----------
train Loss: 0.2843 Acc: 0.9699
val Loss: 4.9183 Acc: 0.8281
Epoch 19/60
----------
train Loss: 0.2041 Acc: 0.9816
val Loss: 5.6134 Acc: 0.7656
Epoch 20/60
----------
train Loss: 0.2459 Acc: 0.9816
val Loss: 4.8061 Acc: 0.7891
Epoch 21/60
----------
train Loss: 0.6636 Acc: 0.9499
val Loss: 6.2030 Acc: 0.7578
Epoch 22/60
----------
train Loss: 0.3434 Acc: 0.9583
val Loss: 6.4307 Acc: 0.6406
Epoch 23/60
----------
train Loss: 0.3347 Acc: 0.9699
val Loss: 4.1748 Acc: 0.8203
Epoch 24/60
----------
train Loss: 0.1901 Acc: 0.9800
val Loss: 6.2591 Acc: 0.7578
Epoch 25/60
----------
train Loss: 0.1535 Acc: 0.9833
val Loss: 4.4583 Acc: 0.7969
Epoch 26/60
----------
train Loss: 0.1102 Acc: 0.9883
val Loss: 3.8723 Acc: 0.7969
Epoch 27/60
----------
train Loss: 0.0848 Acc: 0.9850
val Loss: 4.7791 Acc: 0.8438
Epoch 28/60
----------
train Loss: 0.0499 Acc: 0.9967
val Loss: 5.3790 Acc: 0.8281
Epoch 29/60
----------
train Loss: 0.0464 Acc: 0.9950
val Loss: 5.0285 Acc: 0.8125
Epoch 30/60
----------
train Loss: 0.0738 Acc: 0.9950
val Loss: 4.5610 Acc: 0.8047
Epoch 31/60
----------
train Loss: 0.0506 Acc: 0.9967
val Loss: 4.2071 Acc: 0.8125
Epoch 32/60
----------
train Loss: 0.0465 Acc: 0.9933
val Loss: 4.4678 Acc: 0.8125
Epoch 33/60
----------
train Loss: 0.0348 Acc: 0.9967
val Loss: 4.7304 Acc: 0.8203
Epoch 34/60
----------
train Loss: 0.0398 Acc: 0.9967
val Loss: 4.5649 Acc: 0.8281
Epoch 35/60
----------
train Loss: 0.0390 Acc: 0.9933
val Loss: 4.5916 Acc: 0.8203
Epoch 36/60
----------
train Loss: 0.0503 Acc: 0.9950
val Loss: 4.9150 Acc: 0.8203
Epoch 37/60
----------
train Loss: 0.0675 Acc: 0.9933
val Loss: 6.0334 Acc: 0.8125
Epoch 38/60
----------
train Loss: 0.0469 Acc: 0.9933
val Loss: 4.4618 Acc: 0.8203
Epoch 39/60
----------
train Loss: 0.0468 Acc: 0.9967
val Loss: 5.9706 Acc: 0.8281
Epoch 40/60
----------
train Loss: 0.0596 Acc: 0.9933
val Loss: 3.9911 Acc: 0.8359
Epoch 41/60
----------
train Loss: 0.0511 Acc: 0.9967
val Loss: 6.3881 Acc: 0.7891
Epoch 42/60
----------
train Loss: 0.0378 Acc: 0.9967
val Loss: 4.7368 Acc: 0.8125
Epoch 43/60
----------
train Loss: 0.0788 Acc: 0.9917
val Loss: 9.4529 Acc: 0.8047
Epoch 44/60
----------
train Loss: 0.2615 Acc: 0.9699
val Loss: 3.6254 Acc: 0.5781
Epoch 45/60
----------
train Loss: 0.3306 Acc: 0.9649
val Loss: 7.5241 Acc: 0.7891
Epoch 46/60
----------
train Loss: 0.4832 Acc: 0.9566
val Loss: 11.0586 Acc: 0.6875
Epoch 47/60
----------
train Loss: 0.8993 Acc: 0.9282
val Loss: 7.3212 Acc: 0.6328
Epoch 48/60
----------
train Loss: 1.2757 Acc: 0.8965
val Loss: 6.9612 Acc: 0.6797
Epoch 49/60
----------
train Loss: 0.9087 Acc: 0.9399
val Loss: 5.9458 Acc: 0.7812
Epoch 50/60
----------
train Loss: 0.4046 Acc: 0.9683
val Loss: 4.7221 Acc: 0.7891
Epoch 51/60
----------
train Loss: 0.4493 Acc: 0.9683
val Loss: 6.5940 Acc: 0.8047
Epoch 52/60
----------
train Loss: 0.2641 Acc: 0.9783
val Loss: 3.9446 Acc: 0.7656
Epoch 53/60
----------
train Loss: 0.4912 Acc: 0.9432
val Loss: 6.3825 Acc: 0.7812
Epoch 54/60
----------
train Loss: 0.2953 Acc: 0.9783
val Loss: 3.7913 Acc: 0.7656
Epoch 55/60
----------
train Loss: 0.2916 Acc: 0.9733
val Loss: 4.4088 Acc: 0.7812
Epoch 56/60
----------
train Loss: 0.2574 Acc: 0.9833
val Loss: 6.4171 Acc: 0.8047
Epoch 57/60
----------
train Loss: 0.2591 Acc: 0.9549
val Loss: 5.5609 Acc: 0.7656
Epoch 58/60
----------
train Loss: 0.2826 Acc: 0.9699
val Loss: 5.6040 Acc: 0.8047
Epoch 59/60
----------
train Loss: 0.1554 Acc: 0.9800
val Loss: 5.9135 Acc: 0.7969
Epoch 60/60
----------
train Loss: 0.1101 Acc: 0.9950
[I 2024-10-15 19:40:05,806] Trial 147 finished with value: 0.8125 and parameters: {'batch_size': 59, 'lr': 6.501913480966478e-05, 'num_epochs': 60, 'weight_decay': 0.07178913822218767, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 4.2884 Acc: 0.8125
Best val Acc: 0.812500
Model weights saved at ./model_weights/ResNet34_bs_59_lr_6.501913480966478e-05_epoch_60_wd_0.07178913822218767_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/43
----------
train Loss: 4.2219 Acc: 0.5676
val Loss: 4.2017 Acc: 0.6641
Epoch 2/43
----------
train Loss: 2.3273 Acc: 0.7663
val Loss: 5.2263 Acc: 0.6406
Epoch 3/43
----------
train Loss: 1.7774 Acc: 0.8147
val Loss: 3.8024 Acc: 0.8281
Epoch 4/43
----------
train Loss: 1.2594 Acc: 0.8698
val Loss: 2.4521 Acc: 0.7812
Epoch 5/43
----------
train Loss: 1.3873 Acc: 0.8664
val Loss: 2.7697 Acc: 0.6953
Epoch 6/43
----------
train Loss: 1.2981 Acc: 0.8464
val Loss: 4.5074 Acc: 0.6328
Epoch 7/43
----------
train Loss: 1.5732 Acc: 0.8364
val Loss: 3.6544 Acc: 0.5781
Epoch 8/43
----------
train Loss: 1.7930 Acc: 0.8130
val Loss: 4.3728 Acc: 0.7344
Epoch 9/43
----------
train Loss: 1.3597 Acc: 0.8464
val Loss: 3.6467 Acc: 0.7734
Epoch 10/43
----------
train Loss: 1.3897 Acc: 0.8614
val Loss: 15.6151 Acc: 0.3281
Epoch 11/43
----------
train Loss: 1.3892 Acc: 0.8598
val Loss: 6.3440 Acc: 0.6016
Epoch 12/43
----------
train Loss: 1.1723 Acc: 0.8664
val Loss: 4.8686 Acc: 0.6094
Epoch 13/43
----------
train Loss: 1.1309 Acc: 0.8865
val Loss: 6.4073 Acc: 0.4141
Epoch 14/43
----------
train Loss: 1.1406 Acc: 0.8581
[I 2024-10-15 19:41:08,511] Trial 148 finished with value: 0.7734375 and parameters: {'batch_size': 102, 'lr': 0.00033626529489383996, 'num_epochs': 43, 'weight_decay': 0.12141588583434103, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 4.7209 Acc: 0.6719
Early stopping at epoch 14 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.773438
Model weights saved at ./model_weights/ResNet34_bs_102_lr_0.00033626529489383996_epoch_43_wd_0.12141588583434103_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/49
----------
train Loss: 5.0103 Acc: 0.5092
val Loss: 53.7875 Acc: 0.2031
Epoch 2/49
----------
train Loss: 3.8605 Acc: 0.6344
val Loss: 6.7576 Acc: 0.7500
Epoch 3/49
----------
train Loss: 2.5764 Acc: 0.7195
val Loss: 5.1394 Acc: 0.5469
Epoch 4/49
----------
train Loss: 1.7076 Acc: 0.8080
val Loss: 6.5417 Acc: 0.7734
Epoch 5/49
----------
train Loss: 2.1288 Acc: 0.7947
val Loss: 6.4923 Acc: 0.6328
Epoch 6/49
----------
train Loss: 1.7583 Acc: 0.8180
val Loss: 6.7832 Acc: 0.5391
Epoch 7/49
----------
train Loss: 2.0732 Acc: 0.7663
val Loss: 5.5462 Acc: 0.6172
Epoch 8/49
----------
train Loss: 1.2849 Acc: 0.8614
val Loss: 2.8174 Acc: 0.8203
Epoch 9/49
----------
train Loss: 1.1058 Acc: 0.8698
val Loss: 3.9455 Acc: 0.7500
Epoch 10/49
----------
train Loss: 0.9233 Acc: 0.8831
val Loss: 7.3392 Acc: 0.6641
Epoch 11/49
----------
train Loss: 1.2208 Acc: 0.8564
val Loss: 7.5588 Acc: 0.6250
Epoch 12/49
----------
train Loss: 1.0567 Acc: 0.8798
val Loss: 2.7451 Acc: 0.7656
Epoch 13/49
----------
train Loss: 0.6696 Acc: 0.9132
val Loss: 3.7582 Acc: 0.8438
Epoch 14/49
----------
train Loss: 0.5980 Acc: 0.9215
val Loss: 8.5169 Acc: 0.6406
Epoch 15/49
----------
train Loss: 1.3444 Acc: 0.8497
val Loss: 3.2597 Acc: 0.6406
Epoch 16/49
----------
train Loss: 0.7204 Acc: 0.9232
val Loss: 5.8282 Acc: 0.7969
Epoch 17/49
----------
train Loss: 0.5794 Acc: 0.9299
val Loss: 7.4405 Acc: 0.7812
Epoch 18/49
----------
train Loss: 0.4873 Acc: 0.9466
val Loss: 4.9550 Acc: 0.6875
Epoch 19/49
----------
train Loss: 0.6853 Acc: 0.9165
val Loss: 5.3578 Acc: 0.8047
Epoch 20/49
----------
train Loss: 0.6614 Acc: 0.9249
val Loss: 11.4771 Acc: 0.7812
Epoch 21/49
----------
train Loss: 1.5069 Acc: 0.8614
val Loss: 6.7806 Acc: 0.4688
Epoch 22/49
----------
train Loss: 2.2573 Acc: 0.7629
val Loss: 11.3196 Acc: 0.3984
Epoch 23/49
----------
train Loss: 1.5137 Acc: 0.8481
val Loss: 5.6672 Acc: 0.7734
Epoch 24/49
----------
train Loss: 0.7223 Acc: 0.9098
val Loss: 5.6916 Acc: 0.7734
Epoch 25/49
----------
train Loss: 0.4865 Acc: 0.9432
val Loss: 5.3710 Acc: 0.7266
Epoch 26/49
----------
train Loss: 0.3006 Acc: 0.9616
val Loss: 6.5323 Acc: 0.7578
Epoch 27/49
----------
train Loss: 0.5455 Acc: 0.9549
val Loss: 6.4667 Acc: 0.7656
Epoch 28/49
----------
train Loss: 0.5068 Acc: 0.9399
val Loss: 5.7640 Acc: 0.7891
Epoch 29/49
----------
train Loss: 0.3514 Acc: 0.9716
val Loss: 7.1270 Acc: 0.7266
Epoch 30/49
----------
train Loss: 0.2590 Acc: 0.9716
val Loss: 5.1656 Acc: 0.7969
Epoch 31/49
----------
train Loss: 0.2565 Acc: 0.9699
val Loss: 7.0256 Acc: 0.7969
Epoch 32/49
----------
train Loss: 0.1718 Acc: 0.9833
val Loss: 5.2102 Acc: 0.7578
Epoch 33/49
----------
train Loss: 0.1803 Acc: 0.9783
val Loss: 5.8749 Acc: 0.7734
Epoch 34/49
----------
train Loss: 0.3394 Acc: 0.9633
val Loss: 5.3000 Acc: 0.7734
Epoch 35/49
----------
train Loss: 0.4516 Acc: 0.9349
val Loss: 7.6221 Acc: 0.7734
Epoch 36/49
----------
train Loss: 0.7655 Acc: 0.9249
val Loss: 6.5799 Acc: 0.4297
Epoch 37/49
----------
train Loss: 2.3955 Acc: 0.7796
val Loss: 9.3088 Acc: 0.3594
Epoch 38/49
----------
train Loss: 2.7614 Acc: 0.7346
val Loss: 15.6046 Acc: 0.2031
Epoch 39/49
----------
train Loss: 1.3880 Acc: 0.8497
val Loss: 7.1297 Acc: 0.7734
Epoch 40/49
----------
train Loss: 1.2974 Acc: 0.8831
val Loss: 8.8184 Acc: 0.7109
Epoch 41/49
----------
train Loss: 0.8950 Acc: 0.8848
val Loss: 5.4840 Acc: 0.7344
Epoch 42/49
----------
train Loss: 0.4385 Acc: 0.9499
val Loss: 4.6484 Acc: 0.8516
Epoch 43/49
----------
train Loss: 0.3013 Acc: 0.9683
val Loss: 5.6895 Acc: 0.7656
Epoch 44/49
----------
train Loss: 0.2327 Acc: 0.9816
val Loss: 6.1606 Acc: 0.8359
Epoch 45/49
----------
train Loss: 0.1978 Acc: 0.9800
val Loss: 5.6359 Acc: 0.7578
Epoch 46/49
----------
train Loss: 0.2475 Acc: 0.9733
val Loss: 6.4102 Acc: 0.6797
Epoch 47/49
----------
train Loss: 0.1438 Acc: 0.9883
val Loss: 5.9898 Acc: 0.7969
Epoch 48/49
----------
train Loss: 0.1094 Acc: 0.9933
val Loss: 6.5202 Acc: 0.7656
Epoch 49/49
----------
train Loss: 0.1832 Acc: 0.9750
[I 2024-10-15 19:44:47,525] Trial 149 finished with value: 0.8203125 and parameters: {'batch_size': 87, 'lr': 0.000615992472876527, 'num_epochs': 49, 'weight_decay': 0.008004512856192303, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 50 with value: 0.90625.
val Loss: 5.5722 Acc: 0.8203
Best val Acc: 0.820312
Model weights saved at ./model_weights/ResNet34_bs_87_lr_0.000615992472876527_epoch_49_wd_0.008004512856192303_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/56
----------
train Loss: 4.0790 Acc: 0.5459
val Loss: 3.6224 Acc: 0.6094
Epoch 2/56
----------
train Loss: 1.3553 Acc: 0.8314
val Loss: 2.5181 Acc: 0.8594
Epoch 3/56
----------
train Loss: 0.6813 Acc: 0.9282
val Loss: 1.7145 Acc: 0.8125
Epoch 4/56
----------
train Loss: 0.4082 Acc: 0.9516
val Loss: 1.2878 Acc: 0.8516
Epoch 5/56
----------
train Loss: 0.3864 Acc: 0.9633
val Loss: 3.1269 Acc: 0.8516
Epoch 6/56
----------
train Loss: 0.4623 Acc: 0.9482
val Loss: 2.6768 Acc: 0.7734
Epoch 7/56
----------
train Loss: 0.6615 Acc: 0.9232
val Loss: 1.8007 Acc: 0.8359
Epoch 8/56
----------
train Loss: 0.8514 Acc: 0.9132
val Loss: 12.8719 Acc: 0.4297
Epoch 9/56
----------
train Loss: 0.7909 Acc: 0.8982
val Loss: 7.2862 Acc: 0.5859
Epoch 10/56
----------
train Loss: 1.1967 Acc: 0.9032
val Loss: 1.6972 Acc: 0.8750
Epoch 11/56
----------
train Loss: 0.7554 Acc: 0.9165
val Loss: 2.6450 Acc: 0.8438
Epoch 12/56
----------
train Loss: 0.3973 Acc: 0.9499
val Loss: 1.9039 Acc: 0.8125
Epoch 13/56
----------
train Loss: 0.8508 Acc: 0.9082
val Loss: 3.2531 Acc: 0.5625
Epoch 14/56
----------
train Loss: 0.4119 Acc: 0.9566
val Loss: 1.5561 Acc: 0.8438
Epoch 15/56
----------
train Loss: 0.3151 Acc: 0.9683
val Loss: 1.8882 Acc: 0.8281
Epoch 16/56
----------
train Loss: 0.1690 Acc: 0.9750
val Loss: 1.3209 Acc: 0.8984
Epoch 17/56
----------
train Loss: 0.1828 Acc: 0.9816
val Loss: 1.8255 Acc: 0.8672
Epoch 18/56
----------
train Loss: 0.1395 Acc: 0.9866
val Loss: 1.4692 Acc: 0.8750
Epoch 19/56
----------
train Loss: 0.1967 Acc: 0.9900
val Loss: 1.4398 Acc: 0.8828
Epoch 20/56
----------
train Loss: 0.4625 Acc: 0.9683
val Loss: 3.0434 Acc: 0.8672
Epoch 21/56
----------
train Loss: 0.8543 Acc: 0.9449
val Loss: 4.1081 Acc: 0.7188
Epoch 22/56
----------
train Loss: 1.8590 Acc: 0.8447
val Loss: 4.4682 Acc: 0.5000
Epoch 23/56
----------
train Loss: 1.2803 Acc: 0.8514
val Loss: 1.5485 Acc: 0.8516
Epoch 24/56
----------
train Loss: 0.3993 Acc: 0.9466
val Loss: 1.7761 Acc: 0.9062
Epoch 25/56
----------
train Loss: 0.2877 Acc: 0.9733
val Loss: 1.0229 Acc: 0.8750
Epoch 26/56
----------
train Loss: 0.1805 Acc: 0.9833
val Loss: 2.0505 Acc: 0.8750
Epoch 27/56
----------
train Loss: 0.1675 Acc: 0.9833
val Loss: 1.7437 Acc: 0.8828
Epoch 28/56
----------
train Loss: 0.2331 Acc: 0.9716
val Loss: 1.2352 Acc: 0.8984
Epoch 29/56
----------
train Loss: 0.1428 Acc: 0.9900
val Loss: 1.3617 Acc: 0.8984
Epoch 30/56
----------
train Loss: 0.1699 Acc: 0.9850
val Loss: 1.3604 Acc: 0.8984
Epoch 31/56
----------
train Loss: 0.1326 Acc: 0.9883
val Loss: 2.3475 Acc: 0.8828
Epoch 32/56
----------
train Loss: 0.0927 Acc: 0.9917
val Loss: 1.2056 Acc: 0.8906
Epoch 33/56
----------
train Loss: 0.0622 Acc: 0.9917
val Loss: 1.2656 Acc: 0.9062
Epoch 34/56
----------
train Loss: 0.0943 Acc: 0.9850
val Loss: 1.5749 Acc: 0.9062
Epoch 35/56
----------
train Loss: 0.0981 Acc: 0.9900
val Loss: 2.8837 Acc: 0.8516
Epoch 36/56
----------
train Loss: 0.1351 Acc: 0.9783
val Loss: 1.5234 Acc: 0.9141
Epoch 37/56
----------
train Loss: 0.3223 Acc: 0.9616
val Loss: 1.8723 Acc: 0.8594
Epoch 38/56
----------
train Loss: 0.3551 Acc: 0.9649
val Loss: 4.5175 Acc: 0.8359
Epoch 39/56
----------
train Loss: 1.3653 Acc: 0.8581
val Loss: 12.5656 Acc: 0.5234
Epoch 40/56
----------
train Loss: 1.6687 Acc: 0.8364
val Loss: 2.5890 Acc: 0.7344
Epoch 41/56
----------
train Loss: 1.7130 Acc: 0.8364
[I 2024-10-15 19:47:52,408] Trial 150 finished with value: 0.9140625 and parameters: {'batch_size': 122, 'lr': 0.00020471349670332024, 'num_epochs': 56, 'weight_decay': 0.032993571440402165, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 5.7117 Acc: 0.7031
Early stopping at epoch 41 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.914062
Model weights saved at ./model_weights/ResNet34_bs_122_lr_0.00020471349670332024_epoch_56_wd_0.032993571440402165_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/58
----------
train Loss: 3.9967 Acc: 0.5159
val Loss: 4.7253 Acc: 0.7500
Epoch 2/58
----------
train Loss: 1.5231 Acc: 0.8197
val Loss: 3.6700 Acc: 0.8438
Epoch 3/58
----------
train Loss: 0.8625 Acc: 0.8932
val Loss: 2.6163 Acc: 0.7891
Epoch 4/58
----------
train Loss: 0.5976 Acc: 0.9316
val Loss: 3.4373 Acc: 0.7891
Epoch 5/58
----------
train Loss: 0.5253 Acc: 0.9282
val Loss: 3.4445 Acc: 0.8047
Epoch 6/58
----------
train Loss: 0.7037 Acc: 0.9299
val Loss: 2.1269 Acc: 0.8438
Epoch 7/58
----------
train Loss: 0.4478 Acc: 0.9366
val Loss: 4.0354 Acc: 0.8359
Epoch 8/58
----------
train Loss: 0.8295 Acc: 0.9366
val Loss: 3.7515 Acc: 0.7734
Epoch 9/58
----------
train Loss: 0.5283 Acc: 0.9466
val Loss: 3.9524 Acc: 0.7969
Epoch 10/58
----------
train Loss: 0.4138 Acc: 0.9416
val Loss: 2.9260 Acc: 0.8047
Epoch 11/58
----------
train Loss: 0.4103 Acc: 0.9533
val Loss: 2.2830 Acc: 0.8281
Epoch 12/58
----------
train Loss: 0.5328 Acc: 0.9399
val Loss: 2.3136 Acc: 0.7812
Epoch 13/58
----------
train Loss: 0.4322 Acc: 0.9583
val Loss: 3.4064 Acc: 0.7891
Epoch 14/58
----------
train Loss: 0.2069 Acc: 0.9816
val Loss: 3.9643 Acc: 0.8125
Epoch 15/58
----------
train Loss: 0.2000 Acc: 0.9750
val Loss: 3.0790 Acc: 0.8750
Epoch 16/58
----------
train Loss: 0.1447 Acc: 0.9883
val Loss: 4.0858 Acc: 0.8438
Epoch 17/58
----------
train Loss: 0.1162 Acc: 0.9816
val Loss: 2.4910 Acc: 0.8672
Epoch 18/58
----------
train Loss: 0.0993 Acc: 0.9900
val Loss: 2.3800 Acc: 0.9141
Epoch 19/58
----------
train Loss: 0.1115 Acc: 0.9833
val Loss: 3.3125 Acc: 0.8438
Epoch 20/58
----------
train Loss: 0.1740 Acc: 0.9833
val Loss: 4.4376 Acc: 0.6562
Epoch 21/58
----------
train Loss: 0.1907 Acc: 0.9750
val Loss: 2.6223 Acc: 0.8750
Epoch 22/58
----------
train Loss: 0.2424 Acc: 0.9616
val Loss: 3.4795 Acc: 0.8516
Epoch 23/58
----------
train Loss: 0.2659 Acc: 0.9766
val Loss: 3.5284 Acc: 0.8125
Epoch 24/58
----------
train Loss: 0.2967 Acc: 0.9699
val Loss: 3.5641 Acc: 0.8125
Epoch 25/58
----------
train Loss: 0.7861 Acc: 0.9215
val Loss: 7.7335 Acc: 0.5938
Epoch 26/58
----------
train Loss: 2.5109 Acc: 0.8130
val Loss: 32.4941 Acc: 0.6250
Epoch 27/58
----------
train Loss: 2.2204 Acc: 0.8297
val Loss: 4.5878 Acc: 0.6641
Epoch 28/58
----------
train Loss: 1.7766 Acc: 0.7930
val Loss: 2.9313 Acc: 0.6875
Epoch 29/58
----------
train Loss: 0.8592 Acc: 0.8948
[I 2024-10-15 19:50:01,653] Trial 151 finished with value: 0.8125 and parameters: {'batch_size': 117, 'lr': 0.00019328595404973352, 'num_epochs': 58, 'weight_decay': 0.027839856809721987, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 4.4125 Acc: 0.7266
Early stopping at epoch 29 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.812500
Model weights saved at ./model_weights/ResNet34_bs_117_lr_0.00019328595404973352_epoch_58_wd_0.027839856809721987_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/55
----------
train Loss: 4.1272 Acc: 0.5292
val Loss: 3.8808 Acc: 0.7344
Epoch 2/55
----------
train Loss: 1.8796 Acc: 0.8013
val Loss: 5.1642 Acc: 0.7734
Epoch 3/55
----------
train Loss: 0.7334 Acc: 0.9149
val Loss: 2.2299 Acc: 0.8359
Epoch 4/55
----------
train Loss: 0.4401 Acc: 0.9516
val Loss: 2.6323 Acc: 0.8438
Epoch 5/55
----------
train Loss: 0.4951 Acc: 0.9482
val Loss: 2.5390 Acc: 0.8125
Epoch 6/55
----------
train Loss: 0.6007 Acc: 0.9366
val Loss: 1.9469 Acc: 0.8125
Epoch 7/55
----------
train Loss: 0.4643 Acc: 0.9349
val Loss: 2.9157 Acc: 0.8203
Epoch 8/55
----------
train Loss: 0.2552 Acc: 0.9683
val Loss: 4.9489 Acc: 0.7344
Epoch 9/55
----------
train Loss: 0.3198 Acc: 0.9616
val Loss: 2.7541 Acc: 0.8359
Epoch 10/55
----------
train Loss: 0.1866 Acc: 0.9800
val Loss: 2.6949 Acc: 0.8359
Epoch 11/55
----------
train Loss: 0.1177 Acc: 0.9850
val Loss: 3.2051 Acc: 0.8750
Epoch 12/55
----------
train Loss: 0.1064 Acc: 0.9900
val Loss: 2.6576 Acc: 0.8438
Epoch 13/55
----------
train Loss: 0.0786 Acc: 0.9917
val Loss: 2.7774 Acc: 0.8594
Epoch 14/55
----------
train Loss: 0.1222 Acc: 0.9833
val Loss: 3.5279 Acc: 0.7656
Epoch 15/55
----------
train Loss: 0.1990 Acc: 0.9733
val Loss: 2.4934 Acc: 0.8359
Epoch 16/55
----------
train Loss: 0.3295 Acc: 0.9533
val Loss: 2.4579 Acc: 0.8203
Epoch 17/55
----------
train Loss: 0.3457 Acc: 0.9683
val Loss: 4.2204 Acc: 0.8125
Epoch 18/55
----------
train Loss: 0.5730 Acc: 0.9332
val Loss: 5.9664 Acc: 0.7969
Epoch 19/55
----------
train Loss: 1.6300 Acc: 0.8130
val Loss: 23.5074 Acc: 0.4453
Epoch 20/55
----------
train Loss: 2.6296 Acc: 0.7730
val Loss: 4.9416 Acc: 0.7969
Epoch 21/55
----------
train Loss: 1.3098 Acc: 0.8548
val Loss: 2.6855 Acc: 0.7734
Epoch 22/55
----------
train Loss: 0.6381 Acc: 0.9316
val Loss: 1.9542 Acc: 0.8438
Epoch 23/55
----------
train Loss: 0.3452 Acc: 0.9566
val Loss: 2.2392 Acc: 0.8125
Epoch 24/55
----------
train Loss: 0.5053 Acc: 0.9399
val Loss: 3.2646 Acc: 0.7969
Epoch 25/55
----------
train Loss: 0.7044 Acc: 0.9332
val Loss: 2.8588 Acc: 0.8281
Epoch 26/55
----------
train Loss: 0.5647 Acc: 0.9265
val Loss: 2.0440 Acc: 0.8125
Epoch 27/55
----------
train Loss: 0.2640 Acc: 0.9616
val Loss: 2.2764 Acc: 0.8984
Epoch 28/55
----------
train Loss: 0.1827 Acc: 0.9866
val Loss: 2.1040 Acc: 0.8594
Epoch 29/55
----------
train Loss: 0.1490 Acc: 0.9783
val Loss: 2.3488 Acc: 0.8281
Epoch 30/55
----------
train Loss: 0.1374 Acc: 0.9866
val Loss: 2.8863 Acc: 0.8594
Epoch 31/55
----------
train Loss: 0.1091 Acc: 0.9866
val Loss: 2.9437 Acc: 0.8672
Epoch 32/55
----------
train Loss: 0.0774 Acc: 0.9917
val Loss: 2.9216 Acc: 0.8281
Epoch 33/55
----------
train Loss: 0.0610 Acc: 0.9917
val Loss: 3.1656 Acc: 0.8359
Epoch 34/55
----------
train Loss: 0.0705 Acc: 0.9917
val Loss: 3.0342 Acc: 0.8672
Epoch 35/55
----------
train Loss: 0.0677 Acc: 0.9917
val Loss: 3.0385 Acc: 0.8594
Epoch 36/55
----------
train Loss: 0.0483 Acc: 0.9917
val Loss: 2.7574 Acc: 0.8594
Epoch 37/55
----------
train Loss: 0.0531 Acc: 0.9933
val Loss: 3.1002 Acc: 0.8438
Epoch 38/55
----------
train Loss: 0.0428 Acc: 0.9933
val Loss: 2.8885 Acc: 0.8516
Epoch 39/55
----------
train Loss: 0.0385 Acc: 0.9933
val Loss: 3.0878 Acc: 0.8516
Epoch 40/55
----------
train Loss: 0.0450 Acc: 0.9933
val Loss: 3.0524 Acc: 0.8594
Epoch 41/55
----------
train Loss: 0.0437 Acc: 0.9933
val Loss: 3.2131 Acc: 0.8438
Epoch 42/55
----------
train Loss: 0.0571 Acc: 0.9933
val Loss: 3.1319 Acc: 0.8438
Epoch 43/55
----------
train Loss: 0.0392 Acc: 0.9950
val Loss: 3.3824 Acc: 0.8594
Epoch 44/55
----------
train Loss: 0.0360 Acc: 0.9950
val Loss: 3.4694 Acc: 0.8594
Epoch 45/55
----------
train Loss: 0.1229 Acc: 0.9917
val Loss: 3.7723 Acc: 0.8281
Epoch 46/55
----------
train Loss: 0.2383 Acc: 0.9733
val Loss: 3.9585 Acc: 0.8359
Epoch 47/55
----------
train Loss: 0.5076 Acc: 0.9616
val Loss: 3.7864 Acc: 0.7500
Epoch 48/55
----------
train Loss: 1.4680 Acc: 0.8731
val Loss: 5.4206 Acc: 0.6562
Epoch 49/55
----------
train Loss: 0.7781 Acc: 0.9149
val Loss: 3.3281 Acc: 0.7734
Epoch 50/55
----------
train Loss: 0.6811 Acc: 0.9232
val Loss: 3.0543 Acc: 0.6875
Epoch 51/55
----------
train Loss: 0.8240 Acc: 0.9332
[I 2024-10-15 19:53:51,143] Trial 152 finished with value: 0.8359375 and parameters: {'batch_size': 121, 'lr': 0.00020757360599327014, 'num_epochs': 55, 'weight_decay': 0.01128035452260911, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 5.0230 Acc: 0.7656
Early stopping at epoch 51 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.835938
Model weights saved at ./model_weights/ResNet34_bs_121_lr_0.00020757360599327014_epoch_55_wd_0.01128035452260911_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/62
----------
train Loss: 3.9027 Acc: 0.5659
val Loss: 3.1117 Acc: 0.7656
Epoch 2/62
----------
train Loss: 1.1309 Acc: 0.8848
val Loss: 2.8045 Acc: 0.7969
Epoch 3/62
----------
train Loss: 0.6531 Acc: 0.9299
val Loss: 3.6238 Acc: 0.7500
Epoch 4/62
----------
train Loss: 0.4081 Acc: 0.9516
val Loss: 3.1859 Acc: 0.7812
Epoch 5/62
----------
train Loss: 0.2184 Acc: 0.9800
val Loss: 3.0790 Acc: 0.8281
Epoch 6/62
----------
train Loss: 0.1698 Acc: 0.9733
val Loss: 4.5571 Acc: 0.7891
Epoch 7/62
----------
train Loss: 0.1899 Acc: 0.9699
val Loss: 4.2227 Acc: 0.7969
Epoch 8/62
----------
train Loss: 0.2521 Acc: 0.9683
val Loss: 4.7869 Acc: 0.7891
Epoch 9/62
----------
train Loss: 0.3170 Acc: 0.9716
val Loss: 5.7055 Acc: 0.7969
Epoch 10/62
----------
train Loss: 0.5453 Acc: 0.9265
val Loss: 4.6325 Acc: 0.7344
Epoch 11/62
----------
train Loss: 0.5129 Acc: 0.9299
val Loss: 7.4797 Acc: 0.6953
Epoch 12/62
----------
train Loss: 0.7694 Acc: 0.9132
val Loss: 5.1522 Acc: 0.7500
Epoch 13/62
----------
train Loss: 0.7514 Acc: 0.9399
val Loss: 4.7374 Acc: 0.7500
Epoch 14/62
----------
train Loss: 0.9012 Acc: 0.9382
val Loss: 5.7078 Acc: 0.7812
Epoch 15/62
----------
train Loss: 0.3940 Acc: 0.9583
val Loss: 3.7947 Acc: 0.7969
Epoch 16/62
----------
train Loss: 0.4839 Acc: 0.9549
val Loss: 4.3927 Acc: 0.7891
Epoch 17/62
----------
train Loss: 0.4561 Acc: 0.9449
val Loss: 4.2341 Acc: 0.8047
Epoch 18/62
----------
train Loss: 0.5125 Acc: 0.9449
val Loss: 3.4952 Acc: 0.8125
Epoch 19/62
----------
train Loss: 0.2170 Acc: 0.9633
val Loss: 4.5441 Acc: 0.7969
Epoch 20/62
----------
train Loss: 0.2718 Acc: 0.9783
val Loss: 5.6782 Acc: 0.7500
Epoch 21/62
----------
train Loss: 0.6232 Acc: 0.9382
val Loss: 4.1234 Acc: 0.7891
Epoch 22/62
----------
train Loss: 0.4571 Acc: 0.9583
val Loss: 4.6955 Acc: 0.8281
Epoch 23/62
----------
train Loss: 0.2991 Acc: 0.9816
val Loss: 5.8231 Acc: 0.7578
Epoch 24/62
----------
train Loss: 0.2968 Acc: 0.9649
val Loss: 3.5597 Acc: 0.8359
Epoch 25/62
----------
train Loss: 0.2215 Acc: 0.9783
val Loss: 3.7538 Acc: 0.8203
Epoch 26/62
----------
train Loss: 0.1374 Acc: 0.9800
val Loss: 4.1847 Acc: 0.8281
Epoch 27/62
----------
train Loss: 0.0922 Acc: 0.9900
val Loss: 3.9577 Acc: 0.8125
Epoch 28/62
----------
train Loss: 0.1250 Acc: 0.9850
val Loss: 3.5152 Acc: 0.8125
Epoch 29/62
----------
train Loss: 0.3305 Acc: 0.9616
val Loss: 6.5693 Acc: 0.8047
Epoch 30/62
----------
train Loss: 0.3089 Acc: 0.9633
val Loss: 5.5322 Acc: 0.7656
Epoch 31/62
----------
train Loss: 0.3505 Acc: 0.9449
val Loss: 4.7162 Acc: 0.6641
Epoch 32/62
----------
train Loss: 0.6002 Acc: 0.9299
val Loss: 6.0194 Acc: 0.7812
Epoch 33/62
----------
train Loss: 0.9977 Acc: 0.9249
val Loss: 5.9196 Acc: 0.7188
Epoch 34/62
----------
train Loss: 0.9807 Acc: 0.8965
val Loss: 11.3466 Acc: 0.4141
Epoch 35/62
----------
train Loss: 1.5010 Acc: 0.8715
val Loss: 6.4454 Acc: 0.6875
Epoch 36/62
----------
train Loss: 0.8000 Acc: 0.9149
val Loss: 6.1257 Acc: 0.7188
Epoch 37/62
----------
train Loss: 0.3082 Acc: 0.9716
val Loss: 4.1528 Acc: 0.7969
Epoch 38/62
----------
train Loss: 0.1575 Acc: 0.9833
val Loss: 3.9469 Acc: 0.7969
Epoch 39/62
----------
train Loss: 0.1468 Acc: 0.9883
val Loss: 4.2522 Acc: 0.7969
Epoch 40/62
----------
train Loss: 0.3627 Acc: 0.9566
val Loss: 4.4210 Acc: 0.8047
Epoch 41/62
----------
train Loss: 0.1500 Acc: 0.9833
val Loss: 4.0231 Acc: 0.8281
Epoch 42/62
----------
train Loss: 0.1738 Acc: 0.9850
val Loss: 4.3936 Acc: 0.8047
Epoch 43/62
----------
train Loss: 0.2289 Acc: 0.9783
val Loss: 4.2762 Acc: 0.7109
Epoch 44/62
----------
train Loss: 0.0935 Acc: 0.9900
val Loss: 6.1233 Acc: 0.7656
Epoch 45/62
----------
train Loss: 0.1236 Acc: 0.9850
val Loss: 5.7121 Acc: 0.7812
Epoch 46/62
----------
train Loss: 0.0802 Acc: 0.9883
val Loss: 5.6317 Acc: 0.7891
Epoch 47/62
----------
train Loss: 0.0424 Acc: 0.9950
val Loss: 5.1396 Acc: 0.8047
Epoch 48/62
----------
train Loss: 0.0755 Acc: 0.9933
val Loss: 5.4575 Acc: 0.8125
Epoch 49/62
----------
train Loss: 0.2094 Acc: 0.9616
val Loss: 4.4245 Acc: 0.7812
Epoch 50/62
----------
train Loss: 0.1867 Acc: 0.9750
val Loss: 4.8526 Acc: 0.7812
Epoch 51/62
----------
train Loss: 0.4373 Acc: 0.9583
val Loss: 4.7068 Acc: 0.6562
Epoch 52/62
----------
train Loss: 0.3779 Acc: 0.9616
val Loss: 9.2103 Acc: 0.7188
Epoch 53/62
----------
train Loss: 0.5374 Acc: 0.9482
val Loss: 7.5060 Acc: 0.7578
Epoch 54/62
----------
train Loss: 0.8791 Acc: 0.9282
val Loss: 14.2401 Acc: 0.7578
Epoch 55/62
----------
train Loss: 0.7663 Acc: 0.9098
val Loss: 5.6795 Acc: 0.7188
Epoch 56/62
----------
train Loss: 0.8109 Acc: 0.9282
val Loss: 4.5814 Acc: 0.7656
Epoch 57/62
----------
train Loss: 0.4428 Acc: 0.9366
val Loss: 3.8727 Acc: 0.7656
Epoch 58/62
----------
train Loss: 0.3151 Acc: 0.9516
val Loss: 5.8690 Acc: 0.7266
Epoch 59/62
----------
train Loss: 0.3878 Acc: 0.9816
val Loss: 4.6515 Acc: 0.7812
Epoch 60/62
----------
train Loss: 0.2538 Acc: 0.9766
val Loss: 4.7465 Acc: 0.7812
Epoch 61/62
----------
train Loss: 0.6524 Acc: 0.9516
val Loss: 3.0550 Acc: 0.6953
Epoch 62/62
----------
train Loss: 0.3627 Acc: 0.9416
[I 2024-10-15 19:58:32,162] Trial 153 finished with value: 0.796875 and parameters: {'batch_size': 125, 'lr': 0.00016020252866153856, 'num_epochs': 62, 'weight_decay': 0.034017952208545484, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 5.5577 Acc: 0.7969
Best val Acc: 0.796875
Model weights saved at ./model_weights/ResNet34_bs_125_lr_0.00016020252866153856_epoch_62_wd_0.034017952208545484_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/52
----------
train Loss: 3.8002 Acc: 0.6077
val Loss: 8.3984 Acc: 0.7422
Epoch 2/52
----------
train Loss: 1.9659 Acc: 0.8130
val Loss: 3.0814 Acc: 0.7812
Epoch 3/52
----------
train Loss: 1.2536 Acc: 0.8815
val Loss: 3.3554 Acc: 0.7422
Epoch 4/52
----------
train Loss: 0.8418 Acc: 0.9132
val Loss: 3.3953 Acc: 0.8047
Epoch 5/52
----------
train Loss: 0.5805 Acc: 0.9182
val Loss: 3.3714 Acc: 0.6328
Epoch 6/52
----------
train Loss: 0.3750 Acc: 0.9499
val Loss: 4.7067 Acc: 0.8125
Epoch 7/52
----------
train Loss: 0.6758 Acc: 0.9249
val Loss: 4.9580 Acc: 0.8281
Epoch 8/52
----------
train Loss: 0.4537 Acc: 0.9382
val Loss: 3.9786 Acc: 0.7812
Epoch 9/52
----------
train Loss: 0.8448 Acc: 0.9048
val Loss: 6.6749 Acc: 0.4375
Epoch 10/52
----------
train Loss: 1.3343 Acc: 0.8831
val Loss: 5.3495 Acc: 0.7812
Epoch 11/52
----------
train Loss: 0.6026 Acc: 0.9332
val Loss: 4.8316 Acc: 0.7812
Epoch 12/52
----------
train Loss: 0.3950 Acc: 0.9599
val Loss: 4.3519 Acc: 0.6875
Epoch 13/52
----------
train Loss: 0.5243 Acc: 0.9482
val Loss: 4.4576 Acc: 0.8047
Epoch 14/52
----------
train Loss: 0.5642 Acc: 0.9316
val Loss: 3.3721 Acc: 0.8125
Epoch 15/52
----------
train Loss: 1.2062 Acc: 0.9048
val Loss: 4.8692 Acc: 0.8125
Epoch 16/52
----------
train Loss: 1.1563 Acc: 0.8831
val Loss: 5.5968 Acc: 0.7969
Epoch 17/52
----------
train Loss: 0.4485 Acc: 0.9449
val Loss: 3.2558 Acc: 0.8047
Epoch 18/52
----------
train Loss: 0.2803 Acc: 0.9566
val Loss: 3.1815 Acc: 0.8438
Epoch 19/52
----------
train Loss: 0.2597 Acc: 0.9649
val Loss: 2.5390 Acc: 0.8359
Epoch 20/52
----------
train Loss: 0.1927 Acc: 0.9783
val Loss: 2.9342 Acc: 0.8359
Epoch 21/52
----------
train Loss: 0.2279 Acc: 0.9800
val Loss: 4.4566 Acc: 0.6484
Epoch 22/52
----------
train Loss: 0.7939 Acc: 0.8898
val Loss: 8.1420 Acc: 0.6016
Epoch 23/52
----------
train Loss: 0.4653 Acc: 0.9516
val Loss: 3.7860 Acc: 0.7734
Epoch 24/52
----------
train Loss: 0.9029 Acc: 0.9082
val Loss: 6.9399 Acc: 0.6328
Epoch 25/52
----------
train Loss: 1.9733 Acc: 0.8631
[I 2024-10-15 20:00:25,376] Trial 154 finished with value: 0.8359375 and parameters: {'batch_size': 100, 'lr': 0.00024657953438721343, 'num_epochs': 52, 'weight_decay': 0.04918133901723728, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 7.7879 Acc: 0.4688
Early stopping at epoch 25 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.835938
Model weights saved at ./model_weights/ResNet34_bs_100_lr_0.00024657953438721343_epoch_52_wd_0.04918133901723728_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/54
----------
train Loss: 4.2063 Acc: 0.5359
val Loss: 2.8568 Acc: 0.7812
Epoch 2/54
----------
train Loss: 1.2204 Acc: 0.8497
val Loss: 1.5428 Acc: 0.8828
Epoch 3/54
----------
train Loss: 0.4932 Acc: 0.9566
val Loss: 1.5857 Acc: 0.8750
Epoch 4/54
----------
train Loss: 0.3020 Acc: 0.9733
val Loss: 0.9546 Acc: 0.9219
Epoch 5/54
----------
train Loss: 0.1904 Acc: 0.9750
val Loss: 1.6917 Acc: 0.8750
Epoch 6/54
----------
train Loss: 0.2059 Acc: 0.9733
val Loss: 1.6926 Acc: 0.8281
Epoch 7/54
----------
train Loss: 0.2473 Acc: 0.9733
val Loss: 1.0010 Acc: 0.8672
Epoch 8/54
----------
train Loss: 0.1914 Acc: 0.9833
val Loss: 1.4132 Acc: 0.8750
Epoch 9/54
----------
train Loss: 0.2126 Acc: 0.9783
val Loss: 2.1149 Acc: 0.8516
Epoch 10/54
----------
train Loss: 0.1685 Acc: 0.9816
val Loss: 1.6864 Acc: 0.8594
Epoch 11/54
----------
train Loss: 0.4152 Acc: 0.9583
val Loss: 3.2784 Acc: 0.8125
Epoch 12/54
----------
train Loss: 0.7269 Acc: 0.9282
val Loss: 4.2787 Acc: 0.7578
Epoch 13/54
----------
train Loss: 1.3421 Acc: 0.8798
val Loss: 4.0133 Acc: 0.8047
Epoch 14/54
----------
train Loss: 1.4821 Acc: 0.8848
val Loss: 5.3580 Acc: 0.7266
Epoch 15/54
----------
train Loss: 1.3189 Acc: 0.8765
val Loss: 1.7551 Acc: 0.8594
Epoch 16/54
----------
train Loss: 0.5739 Acc: 0.9199
val Loss: 1.1503 Acc: 0.8906
Epoch 17/54
----------
train Loss: 0.2531 Acc: 0.9633
val Loss: 0.9131 Acc: 0.8984
Epoch 18/54
----------
train Loss: 0.2279 Acc: 0.9733
val Loss: 2.3146 Acc: 0.8828
Epoch 19/54
----------
train Loss: 0.1320 Acc: 0.9883
val Loss: 1.3090 Acc: 0.9219
Epoch 20/54
----------
train Loss: 0.0815 Acc: 0.9900
val Loss: 1.5478 Acc: 0.9141
Epoch 21/54
----------
train Loss: 0.0929 Acc: 0.9883
val Loss: 2.1918 Acc: 0.8828
Epoch 22/54
----------
train Loss: 0.0663 Acc: 0.9917
val Loss: 1.3788 Acc: 0.9062
Epoch 23/54
----------
train Loss: 0.0614 Acc: 0.9917
val Loss: 1.6326 Acc: 0.9062
Epoch 24/54
----------
train Loss: 0.0596 Acc: 0.9900
val Loss: 2.6344 Acc: 0.8984
Epoch 25/54
----------
train Loss: 0.0591 Acc: 0.9933
val Loss: 1.7136 Acc: 0.8984
Epoch 26/54
----------
train Loss: 0.1654 Acc: 0.9766
val Loss: 1.9419 Acc: 0.9219
Epoch 27/54
----------
train Loss: 0.1252 Acc: 0.9783
val Loss: 2.6892 Acc: 0.8672
Epoch 28/54
----------
train Loss: 0.1740 Acc: 0.9833
val Loss: 1.9622 Acc: 0.7656
Epoch 29/54
----------
train Loss: 0.3069 Acc: 0.9499
val Loss: 4.4144 Acc: 0.8828
Epoch 30/54
----------
train Loss: 0.6322 Acc: 0.9265
val Loss: 2.0937 Acc: 0.8984
Epoch 31/54
----------
train Loss: 0.8185 Acc: 0.9366
val Loss: 19.1395 Acc: 0.4531
Epoch 32/54
----------
train Loss: 1.2102 Acc: 0.9132
val Loss: 3.2450 Acc: 0.8281
Epoch 33/54
----------
train Loss: 0.5127 Acc: 0.9282
val Loss: 2.5383 Acc: 0.8281
Epoch 34/54
----------
train Loss: 0.4529 Acc: 0.9599
val Loss: 5.0493 Acc: 0.8438
Epoch 35/54
----------
train Loss: 0.6616 Acc: 0.9282
val Loss: 5.7133 Acc: 0.8516
Epoch 36/54
----------
train Loss: 0.5956 Acc: 0.9265
val Loss: 3.0866 Acc: 0.8047
Epoch 37/54
----------
train Loss: 0.8523 Acc: 0.9366
val Loss: 2.2748 Acc: 0.8594
Epoch 38/54
----------
train Loss: 0.6135 Acc: 0.9566
val Loss: 1.8589 Acc: 0.8750
Epoch 39/54
----------
train Loss: 0.4700 Acc: 0.9616
val Loss: 2.9794 Acc: 0.9062
Epoch 40/54
----------
train Loss: 0.2885 Acc: 0.9683
val Loss: 1.6718 Acc: 0.7891
Epoch 41/54
----------
train Loss: 0.1010 Acc: 0.9833
val Loss: 2.0645 Acc: 0.8828
Epoch 42/54
----------
train Loss: 0.0937 Acc: 0.9883
val Loss: 2.8876 Acc: 0.8594
Epoch 43/54
----------
train Loss: 0.0696 Acc: 0.9900
val Loss: 2.4497 Acc: 0.8750
Epoch 44/54
----------
train Loss: 0.0635 Acc: 0.9900
val Loss: 2.6750 Acc: 0.8672
Epoch 45/54
----------
train Loss: 0.0795 Acc: 0.9866
val Loss: 2.4628 Acc: 0.8750
Epoch 46/54
----------
train Loss: 0.0767 Acc: 0.9917
val Loss: 2.2527 Acc: 0.8906
Epoch 47/54
----------
train Loss: 0.0478 Acc: 0.9933
val Loss: 2.4522 Acc: 0.9141
Epoch 48/54
----------
train Loss: 0.0495 Acc: 0.9917
val Loss: 2.0006 Acc: 0.8828
Epoch 49/54
----------
train Loss: 0.0431 Acc: 0.9933
val Loss: 2.2139 Acc: 0.8984
Epoch 50/54
----------
train Loss: 0.0609 Acc: 0.9900
val Loss: 2.4818 Acc: 0.8828
Epoch 51/54
----------
train Loss: 0.1124 Acc: 0.9866
val Loss: 3.2455 Acc: 0.7656
Epoch 52/54
----------
train Loss: 0.2686 Acc: 0.9649
val Loss: 4.7413 Acc: 0.9141
Epoch 53/54
----------
train Loss: 0.2396 Acc: 0.9699
val Loss: 3.3460 Acc: 0.8984
Epoch 54/54
----------
train Loss: 0.5734 Acc: 0.9349
[I 2024-10-15 20:04:27,721] Trial 155 finished with value: 0.859375 and parameters: {'batch_size': 122, 'lr': 0.00013329248276619255, 'num_epochs': 54, 'weight_decay': 0.03816764645214523, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 1.6039 Acc: 0.8594
Best val Acc: 0.859375
Model weights saved at ./model_weights/ResNet34_bs_122_lr_0.00013329248276619255_epoch_54_wd_0.03816764645214523_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/57
----------
train Loss: 3.9510 Acc: 0.6611
val Loss: 4.6043 Acc: 0.7734
Epoch 2/57
----------
train Loss: 1.1356 Acc: 0.8514
val Loss: 3.5231 Acc: 0.7969
Epoch 3/57
----------
train Loss: 0.3325 Acc: 0.9766
val Loss: 3.0465 Acc: 0.8672
Epoch 4/57
----------
train Loss: 0.2105 Acc: 0.9866
val Loss: 2.7763 Acc: 0.8203
Epoch 5/57
----------
train Loss: 0.1416 Acc: 0.9883
val Loss: 3.1275 Acc: 0.8359
Epoch 6/57
----------
train Loss: 0.1106 Acc: 0.9883
val Loss: 3.0632 Acc: 0.8125
Epoch 7/57
----------
train Loss: 0.1285 Acc: 0.9883
val Loss: 3.3682 Acc: 0.8125
Epoch 8/57
----------
train Loss: 0.1339 Acc: 0.9900
val Loss: 3.6106 Acc: 0.8281
Epoch 9/57
----------
train Loss: 0.0959 Acc: 0.9917
val Loss: 3.7587 Acc: 0.7734
Epoch 10/57
----------
train Loss: 0.0801 Acc: 0.9900
val Loss: 3.3942 Acc: 0.7969
Epoch 11/57
----------
train Loss: 0.0671 Acc: 0.9933
val Loss: 4.0523 Acc: 0.7969
Epoch 12/57
----------
train Loss: 0.2285 Acc: 0.9783
val Loss: 4.1993 Acc: 0.7578
Epoch 13/57
----------
train Loss: 0.4081 Acc: 0.9633
val Loss: 4.9097 Acc: 0.8047
Epoch 14/57
----------
train Loss: 0.9581 Acc: 0.9115
val Loss: 4.6612 Acc: 0.7266
Epoch 15/57
----------
train Loss: 1.2621 Acc: 0.8581
val Loss: 4.7503 Acc: 0.6250
Epoch 16/57
----------
train Loss: 0.8031 Acc: 0.9098
val Loss: 5.4262 Acc: 0.7969
Epoch 17/57
----------
train Loss: 0.3996 Acc: 0.9566
val Loss: 3.7714 Acc: 0.8047
Epoch 18/57
----------
train Loss: 0.3383 Acc: 0.9733
val Loss: 4.9877 Acc: 0.8047
Epoch 19/57
----------
train Loss: 0.4008 Acc: 0.9716
val Loss: 5.5420 Acc: 0.8047
Epoch 20/57
----------
train Loss: 0.2305 Acc: 0.9800
val Loss: 5.3070 Acc: 0.8438
Epoch 21/57
----------
train Loss: 0.1967 Acc: 0.9833
val Loss: 4.5524 Acc: 0.7891
Epoch 22/57
----------
train Loss: 0.2957 Acc: 0.9716
val Loss: 6.2579 Acc: 0.8047
Epoch 23/57
----------
train Loss: 0.1593 Acc: 0.9800
val Loss: 3.8912 Acc: 0.8047
Epoch 24/57
----------
train Loss: 0.1100 Acc: 0.9866
val Loss: 5.3607 Acc: 0.8281
Epoch 25/57
----------
train Loss: 0.0826 Acc: 0.9917
val Loss: 5.0853 Acc: 0.8438
Epoch 26/57
----------
train Loss: 0.0657 Acc: 0.9933
val Loss: 5.2477 Acc: 0.8594
Epoch 27/57
----------
train Loss: 0.0518 Acc: 0.9933
val Loss: 5.6587 Acc: 0.8281
Epoch 28/57
----------
train Loss: 0.0491 Acc: 0.9950
val Loss: 5.6250 Acc: 0.8438
Epoch 29/57
----------
train Loss: 0.0628 Acc: 0.9933
val Loss: 5.0309 Acc: 0.8594
Epoch 30/57
----------
train Loss: 0.0716 Acc: 0.9917
val Loss: 4.9401 Acc: 0.8516
Epoch 31/57
----------
train Loss: 0.0486 Acc: 0.9950
val Loss: 4.8947 Acc: 0.8516
Epoch 32/57
----------
train Loss: 0.0527 Acc: 0.9917
val Loss: 4.6880 Acc: 0.8594
Epoch 33/57
----------
train Loss: 0.0537 Acc: 0.9933
val Loss: 4.9594 Acc: 0.8594
Epoch 34/57
----------
train Loss: 0.0450 Acc: 0.9900
val Loss: 5.0124 Acc: 0.8594
Epoch 35/57
----------
train Loss: 0.0421 Acc: 0.9950
val Loss: 4.8579 Acc: 0.8594
Epoch 36/57
----------
train Loss: 0.0475 Acc: 0.9950
val Loss: 4.7654 Acc: 0.8516
Epoch 37/57
----------
train Loss: 0.0426 Acc: 0.9933
val Loss: 5.0796 Acc: 0.8516
Epoch 38/57
----------
train Loss: 0.0471 Acc: 0.9933
val Loss: 4.9336 Acc: 0.8594
Epoch 39/57
----------
train Loss: 0.0361 Acc: 0.9950
val Loss: 4.7635 Acc: 0.8594
Epoch 40/57
----------
train Loss: 0.0438 Acc: 0.9950
val Loss: 5.1395 Acc: 0.8672
Epoch 41/57
----------
train Loss: 0.0398 Acc: 0.9950
val Loss: 5.4396 Acc: 0.8516
Epoch 42/57
----------
train Loss: 0.0402 Acc: 0.9950
val Loss: 4.9931 Acc: 0.8516
Epoch 43/57
----------
train Loss: 0.0415 Acc: 0.9950
val Loss: 4.8697 Acc: 0.8594
Epoch 44/57
----------
train Loss: 0.0378 Acc: 0.9933
val Loss: 5.0410 Acc: 0.8438
Epoch 45/57
----------
train Loss: 0.0431 Acc: 0.9933
val Loss: 4.5061 Acc: 0.8672
Epoch 46/57
----------
train Loss: 0.0393 Acc: 0.9950
val Loss: 4.6436 Acc: 0.8516
Epoch 47/57
----------
train Loss: 0.0504 Acc: 0.9950
val Loss: 4.5559 Acc: 0.8516
Epoch 48/57
----------
train Loss: 0.0650 Acc: 0.9917
val Loss: 5.2563 Acc: 0.8750
Epoch 49/57
----------
train Loss: 0.0479 Acc: 0.9950
val Loss: 4.8843 Acc: 0.8516
Epoch 50/57
----------
train Loss: 0.0452 Acc: 0.9950
val Loss: 5.3035 Acc: 0.8125
Epoch 51/57
----------
train Loss: 0.0507 Acc: 0.9900
val Loss: 4.1652 Acc: 0.8516
Epoch 52/57
----------
train Loss: 0.1248 Acc: 0.9917
val Loss: 11.2829 Acc: 0.8203
Epoch 53/57
----------
train Loss: 1.6860 Acc: 0.8698
val Loss: 7.9590 Acc: 0.7031
Epoch 54/57
----------
train Loss: 1.8696 Acc: 0.7780
val Loss: 5.2791 Acc: 0.4688
Epoch 55/57
----------
train Loss: 1.5778 Acc: 0.8414
val Loss: 2.8855 Acc: 0.7578
Epoch 56/57
----------
train Loss: 0.7636 Acc: 0.9015
val Loss: 2.7837 Acc: 0.8516
Epoch 57/57
----------
train Loss: 0.5743 Acc: 0.9249
[I 2024-10-15 20:08:40,174] Trial 156 finished with value: 0.8515625 and parameters: {'batch_size': 65, 'lr': 0.00010076222492759583, 'num_epochs': 57, 'weight_decay': 0.020191634612120275, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 2.5892 Acc: 0.7812
Best val Acc: 0.851562
Model weights saved at ./model_weights/ResNet34_bs_65_lr_0.00010076222492759583_epoch_57_wd_0.020191634612120275_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/46
----------
train Loss: 4.0626 Acc: 0.5025
val Loss: 3.6547 Acc: 0.5859
Epoch 2/46
----------
train Loss: 1.2114 Acc: 0.8464
val Loss: 2.7365 Acc: 0.7969
Epoch 3/46
----------
train Loss: 0.7132 Acc: 0.9132
val Loss: 3.5510 Acc: 0.6953
Epoch 4/46
----------
train Loss: 0.2563 Acc: 0.9783
val Loss: 3.7282 Acc: 0.8047
Epoch 5/46
----------
train Loss: 0.1490 Acc: 0.9917
val Loss: 3.5111 Acc: 0.7812
Epoch 6/46
----------
train Loss: 0.0984 Acc: 0.9900
val Loss: 3.4308 Acc: 0.7891
Epoch 7/46
----------
train Loss: 0.1301 Acc: 0.9850
val Loss: 3.5547 Acc: 0.7969
Epoch 8/46
----------
train Loss: 0.1288 Acc: 0.9900
val Loss: 3.3140 Acc: 0.7734
Epoch 9/46
----------
train Loss: 0.1060 Acc: 0.9917
val Loss: 3.7453 Acc: 0.7891
Epoch 10/46
----------
train Loss: 0.3014 Acc: 0.9816
val Loss: 5.4533 Acc: 0.6562
Epoch 11/46
----------
train Loss: 0.5385 Acc: 0.9282
val Loss: 9.0035 Acc: 0.5078
Epoch 12/46
----------
train Loss: 1.6834 Acc: 0.8648
val Loss: 3.5162 Acc: 0.5703
Epoch 13/46
----------
train Loss: 1.3667 Acc: 0.8497
val Loss: 6.2193 Acc: 0.7422
Epoch 14/46
----------
train Loss: 0.9006 Acc: 0.9098
val Loss: 2.7764 Acc: 0.8203
Epoch 15/46
----------
train Loss: 0.3818 Acc: 0.9583
val Loss: 4.9992 Acc: 0.7188
Epoch 16/46
----------
train Loss: 0.3680 Acc: 0.9733
val Loss: 2.8903 Acc: 0.7734
Epoch 17/46
----------
train Loss: 0.1927 Acc: 0.9733
val Loss: 3.6884 Acc: 0.7891
Epoch 18/46
----------
train Loss: 0.3140 Acc: 0.9633
val Loss: 4.3207 Acc: 0.7812
Epoch 19/46
----------
train Loss: 0.2194 Acc: 0.9750
val Loss: 3.0362 Acc: 0.7812
Epoch 20/46
----------
train Loss: 0.1565 Acc: 0.9783
val Loss: 2.7203 Acc: 0.8438
Epoch 21/46
----------
train Loss: 0.2057 Acc: 0.9750
val Loss: 4.2542 Acc: 0.8359
Epoch 22/46
----------
train Loss: 0.1544 Acc: 0.9850
val Loss: 3.4706 Acc: 0.8281
Epoch 23/46
----------
train Loss: 0.0746 Acc: 0.9950
val Loss: 3.4788 Acc: 0.8516
Epoch 24/46
----------
train Loss: 0.0809 Acc: 0.9933
val Loss: 3.5456 Acc: 0.8125
Epoch 25/46
----------
train Loss: 0.0795 Acc: 0.9883
val Loss: 3.5988 Acc: 0.8359
Epoch 26/46
----------
train Loss: 0.1379 Acc: 0.9900
val Loss: 4.2030 Acc: 0.8359
Epoch 27/46
----------
train Loss: 0.4357 Acc: 0.9783
val Loss: 5.7844 Acc: 0.7812
Epoch 28/46
----------
train Loss: 0.4513 Acc: 0.9649
val Loss: 3.3085 Acc: 0.7734
Epoch 29/46
----------
train Loss: 1.3390 Acc: 0.8598
val Loss: 6.9485 Acc: 0.7891
Epoch 30/46
----------
train Loss: 1.2480 Acc: 0.9165
val Loss: 5.0930 Acc: 0.6484
Epoch 31/46
----------
train Loss: 0.6739 Acc: 0.9149
val Loss: 2.9614 Acc: 0.7266
Epoch 32/46
----------
train Loss: 0.5853 Acc: 0.9366
val Loss: 3.4619 Acc: 0.7500
Epoch 33/46
----------
train Loss: 0.3682 Acc: 0.9699
val Loss: 3.7620 Acc: 0.7734
Epoch 34/46
----------
train Loss: 0.2671 Acc: 0.9800
val Loss: 3.1218 Acc: 0.8281
Epoch 35/46
----------
train Loss: 0.1856 Acc: 0.9766
val Loss: 2.8700 Acc: 0.8047
Epoch 36/46
----------
train Loss: 0.2413 Acc: 0.9733
val Loss: 3.1042 Acc: 0.7969
Epoch 37/46
----------
train Loss: 0.1825 Acc: 0.9800
val Loss: 3.1745 Acc: 0.7969
Epoch 38/46
----------
train Loss: 0.1135 Acc: 0.9866
val Loss: 3.7980 Acc: 0.8125
Epoch 39/46
----------
train Loss: 0.0815 Acc: 0.9950
val Loss: 3.1577 Acc: 0.8281
Epoch 40/46
----------
train Loss: 0.0592 Acc: 0.9950
val Loss: 2.8668 Acc: 0.8516
Epoch 41/46
----------
train Loss: 0.0666 Acc: 0.9917
val Loss: 3.2968 Acc: 0.8516
Epoch 42/46
----------
train Loss: 0.0655 Acc: 0.9933
val Loss: 3.2273 Acc: 0.8203
Epoch 43/46
----------
train Loss: 0.0732 Acc: 0.9933
val Loss: 2.7400 Acc: 0.8359
Epoch 44/46
----------
train Loss: 0.0588 Acc: 0.9950
val Loss: 2.9840 Acc: 0.8359
Epoch 45/46
----------
train Loss: 0.0442 Acc: 0.9950
val Loss: 2.9955 Acc: 0.8438
Epoch 46/46
----------
train Loss: 0.0475 Acc: 0.9933
[I 2024-10-15 20:12:05,242] Trial 157 finished with value: 0.859375 and parameters: {'batch_size': 128, 'lr': 0.0001634656465112139, 'num_epochs': 46, 'weight_decay': 0.024547012425729316, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 2.8640 Acc: 0.8594
Best val Acc: 0.859375
Model weights saved at ./model_weights/ResNet34_bs_128_lr_0.0001634656465112139_epoch_46_wd_0.024547012425729316_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/50
----------
train Loss: 4.1329 Acc: 0.5726
val Loss: 6.1274 Acc: 0.7500
Epoch 2/50
----------
train Loss: 2.2411 Acc: 0.7479
val Loss: 2.8377 Acc: 0.7031
Epoch 3/50
----------
train Loss: 1.4947 Acc: 0.8397
val Loss: 2.5426 Acc: 0.8047
Epoch 4/50
----------
train Loss: 1.0581 Acc: 0.8815
val Loss: 2.2072 Acc: 0.7969
Epoch 5/50
----------
train Loss: 0.5349 Acc: 0.9232
val Loss: 2.5468 Acc: 0.8047
Epoch 6/50
----------
train Loss: 0.6352 Acc: 0.9432
val Loss: 3.9894 Acc: 0.6250
Epoch 7/50
----------
train Loss: 0.5201 Acc: 0.9466
val Loss: 5.9155 Acc: 0.7656
Epoch 8/50
----------
train Loss: 1.0698 Acc: 0.8798
val Loss: 4.5390 Acc: 0.5781
Epoch 9/50
----------
train Loss: 1.2899 Acc: 0.8614
val Loss: 5.2599 Acc: 0.5938
Epoch 10/50
----------
train Loss: 1.2378 Acc: 0.8865
val Loss: 5.3485 Acc: 0.7734
Epoch 11/50
----------
train Loss: 1.1038 Acc: 0.8965
val Loss: 8.1963 Acc: 0.6641
Epoch 12/50
----------
train Loss: 0.9065 Acc: 0.9065
val Loss: 2.5862 Acc: 0.7656
Epoch 13/50
----------
train Loss: 0.7705 Acc: 0.9115
val Loss: 5.3851 Acc: 0.7578
Epoch 14/50
----------
train Loss: 0.7728 Acc: 0.9316
val Loss: 3.3374 Acc: 0.7031
Epoch 15/50
----------
train Loss: 0.4833 Acc: 0.9366
val Loss: 4.3969 Acc: 0.8047
Epoch 16/50
----------
train Loss: 0.5009 Acc: 0.9549
val Loss: 4.0731 Acc: 0.8359
Epoch 17/50
----------
train Loss: 0.3955 Acc: 0.9683
val Loss: 3.8221 Acc: 0.8125
Epoch 18/50
----------
train Loss: 0.8622 Acc: 0.9449
val Loss: 10.0948 Acc: 0.7656
Epoch 19/50
----------
train Loss: 1.1662 Acc: 0.8865
val Loss: 3.4317 Acc: 0.7344
Epoch 20/50
----------
train Loss: 0.8563 Acc: 0.9265
val Loss: 7.3797 Acc: 0.6641
Epoch 21/50
----------
train Loss: 1.6448 Acc: 0.8865
val Loss: 3.3077 Acc: 0.6875
Epoch 22/50
----------
train Loss: 0.7489 Acc: 0.9265
val Loss: 4.4339 Acc: 0.7734
Epoch 23/50
----------
train Loss: 0.7180 Acc: 0.9215
val Loss: 4.2750 Acc: 0.7266
Epoch 24/50
----------
train Loss: 0.3833 Acc: 0.9599
val Loss: 4.3416 Acc: 0.7656
Epoch 25/50
----------
train Loss: 0.9554 Acc: 0.8948
val Loss: 7.3925 Acc: 0.7188
Epoch 26/50
----------
train Loss: 1.1242 Acc: 0.9282
val Loss: 5.1259 Acc: 0.5312
Epoch 27/50
----------
train Loss: 0.7673 Acc: 0.9149
val Loss: 2.9428 Acc: 0.7812
Epoch 28/50
----------
train Loss: 0.4389 Acc: 0.9399
val Loss: 3.6858 Acc: 0.8203
Epoch 29/50
----------
train Loss: 0.2811 Acc: 0.9649
val Loss: 7.3613 Acc: 0.8047
Epoch 30/50
----------
train Loss: 0.2608 Acc: 0.9733
val Loss: 3.5489 Acc: 0.6875
Epoch 31/50
----------
train Loss: 0.5429 Acc: 0.9282
val Loss: 3.0637 Acc: 0.7891
Epoch 32/50
----------
train Loss: 0.4586 Acc: 0.9416
val Loss: 4.9582 Acc: 0.7656
Epoch 33/50
----------
train Loss: 0.3827 Acc: 0.9566
val Loss: 4.5400 Acc: 0.7812
Epoch 34/50
----------
train Loss: 0.2898 Acc: 0.9716
val Loss: 5.9189 Acc: 0.7500
Epoch 35/50
----------
train Loss: 0.1755 Acc: 0.9833
val Loss: 5.4186 Acc: 0.7891
Epoch 36/50
----------
train Loss: 0.1556 Acc: 0.9833
val Loss: 5.8176 Acc: 0.7891
Epoch 37/50
----------
train Loss: 0.3073 Acc: 0.9633
val Loss: 8.7597 Acc: 0.6562
Epoch 38/50
----------
train Loss: 0.6487 Acc: 0.9366
val Loss: 3.8420 Acc: 0.6562
Epoch 39/50
----------
train Loss: 0.8652 Acc: 0.9115
val Loss: 6.5645 Acc: 0.7188
Epoch 40/50
----------
train Loss: 1.5181 Acc: 0.8531
val Loss: 7.2962 Acc: 0.6953
Epoch 41/50
----------
train Loss: 1.0791 Acc: 0.8831
[I 2024-10-15 20:15:08,273] Trial 158 finished with value: 0.7890625 and parameters: {'batch_size': 77, 'lr': 0.000327095738262107, 'num_epochs': 50, 'weight_decay': 0.04317605032216358, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 4.5292 Acc: 0.7266
Early stopping at epoch 41 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.789062
Model weights saved at ./model_weights/ResNet34_bs_77_lr_0.000327095738262107_epoch_50_wd_0.04317605032216358_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/52
----------
train Loss: 4.5969 Acc: 0.5392
val Loss: 4.4688 Acc: 0.4688
Epoch 2/52
----------
train Loss: 2.8532 Acc: 0.6895
val Loss: 2.9633 Acc: 0.5703
Epoch 3/52
----------
train Loss: 1.4650 Acc: 0.8464
val Loss: 1.9948 Acc: 0.8203
Epoch 4/52
----------
train Loss: 1.0773 Acc: 0.8765
val Loss: 2.0413 Acc: 0.6953
Epoch 5/52
----------
train Loss: 0.8107 Acc: 0.9082
val Loss: 1.5455 Acc: 0.8516
Epoch 6/52
----------
train Loss: 0.8740 Acc: 0.8948
val Loss: 1.8247 Acc: 0.8516
Epoch 7/52
----------
train Loss: 0.6176 Acc: 0.9165
val Loss: 1.8361 Acc: 0.7734
Epoch 8/52
----------
train Loss: 0.8431 Acc: 0.9149
val Loss: 2.0097 Acc: 0.7500
Epoch 9/52
----------
train Loss: 0.9288 Acc: 0.8932
val Loss: 2.8536 Acc: 0.7891
Epoch 10/52
----------
train Loss: 0.7300 Acc: 0.9232
val Loss: 2.4756 Acc: 0.6953
Epoch 11/52
----------
train Loss: 1.2060 Acc: 0.8932
val Loss: 3.1950 Acc: 0.8047
Epoch 12/52
----------
train Loss: 1.4645 Acc: 0.8848
val Loss: 3.0708 Acc: 0.7656
Epoch 13/52
----------
train Loss: 0.6359 Acc: 0.9232
val Loss: 2.0300 Acc: 0.7422
Epoch 14/52
----------
train Loss: 0.3389 Acc: 0.9599
val Loss: 2.1438 Acc: 0.8516
Epoch 15/52
----------
train Loss: 0.2749 Acc: 0.9683
val Loss: 2.5367 Acc: 0.7891
Epoch 16/52
----------
train Loss: 0.2703 Acc: 0.9699
val Loss: 2.1385 Acc: 0.8750
Epoch 17/52
----------
train Loss: 0.2484 Acc: 0.9583
val Loss: 1.9449 Acc: 0.8125
Epoch 18/52
----------
train Loss: 0.2812 Acc: 0.9649
val Loss: 3.6061 Acc: 0.8359
Epoch 19/52
----------
train Loss: 0.2997 Acc: 0.9666
val Loss: 2.7524 Acc: 0.7969
Epoch 20/52
----------
train Loss: 0.5520 Acc: 0.9299
val Loss: 3.0414 Acc: 0.8047
Epoch 21/52
----------
train Loss: 0.7595 Acc: 0.9132
val Loss: 5.8291 Acc: 0.6953
Epoch 22/52
----------
train Loss: 0.7166 Acc: 0.9366
val Loss: 5.4396 Acc: 0.8125
Epoch 23/52
----------
train Loss: 1.9970 Acc: 0.8598
val Loss: 3.5096 Acc: 0.4844
Epoch 24/52
----------
train Loss: 1.2062 Acc: 0.8598
val Loss: 3.1433 Acc: 0.7969
Epoch 25/52
----------
train Loss: 0.7767 Acc: 0.9215
val Loss: 2.8011 Acc: 0.7891
Epoch 26/52
----------
train Loss: 0.4832 Acc: 0.9316
val Loss: 2.6301 Acc: 0.7734
Epoch 27/52
----------
train Loss: 0.2161 Acc: 0.9699
val Loss: 2.0143 Acc: 0.8516
Epoch 28/52
----------
train Loss: 0.3239 Acc: 0.9616
val Loss: 2.1758 Acc: 0.7656
Epoch 29/52
----------
train Loss: 0.2592 Acc: 0.9699
val Loss: 3.0049 Acc: 0.7891
Epoch 30/52
----------
train Loss: 0.5654 Acc: 0.9599
val Loss: 2.5231 Acc: 0.8047
Epoch 31/52
----------
train Loss: 0.7590 Acc: 0.9065
val Loss: 2.4330 Acc: 0.7891
Epoch 32/52
----------
train Loss: 0.4695 Acc: 0.9499
val Loss: 4.1879 Acc: 0.7422
Epoch 33/52
----------
train Loss: 0.4583 Acc: 0.9299
val Loss: 2.9055 Acc: 0.7266
Epoch 34/52
----------
train Loss: 0.2536 Acc: 0.9599
val Loss: 2.6958 Acc: 0.8438
Epoch 35/52
----------
train Loss: 0.2148 Acc: 0.9833
val Loss: 2.5719 Acc: 0.7969
Epoch 36/52
----------
train Loss: 0.7080 Acc: 0.9516
val Loss: 22.0585 Acc: 0.2031
Epoch 37/52
----------
train Loss: 0.8228 Acc: 0.9015
val Loss: 5.7648 Acc: 0.7500
Epoch 38/52
----------
train Loss: 1.3157 Acc: 0.8915
val Loss: 4.1234 Acc: 0.8125
Epoch 39/52
----------
train Loss: 0.7229 Acc: 0.9149
val Loss: 2.6745 Acc: 0.8281
Epoch 40/52
----------
train Loss: 0.3708 Acc: 0.9633
val Loss: 2.3497 Acc: 0.7969
Epoch 41/52
----------
train Loss: 0.2720 Acc: 0.9683
val Loss: 2.6591 Acc: 0.8594
Epoch 42/52
----------
train Loss: 0.3568 Acc: 0.9549
val Loss: 1.8649 Acc: 0.8516
Epoch 43/52
----------
train Loss: 0.3645 Acc: 0.9432
val Loss: 1.9832 Acc: 0.8203
Epoch 44/52
----------
train Loss: 0.2512 Acc: 0.9733
val Loss: 2.9843 Acc: 0.8281
Epoch 45/52
----------
train Loss: 0.1870 Acc: 0.9733
val Loss: 2.5300 Acc: 0.8359
Epoch 46/52
----------
train Loss: 0.1885 Acc: 0.9783
val Loss: 2.4495 Acc: 0.8203
Epoch 47/52
----------
train Loss: 0.0828 Acc: 0.9967
val Loss: 2.6145 Acc: 0.8438
Epoch 48/52
----------
train Loss: 0.0930 Acc: 0.9967
val Loss: 3.8258 Acc: 0.8203
Epoch 49/52
----------
train Loss: 0.0522 Acc: 0.9933
val Loss: 2.7411 Acc: 0.8203
Epoch 50/52
----------
train Loss: 0.0496 Acc: 0.9967
val Loss: 3.1947 Acc: 0.8125
Epoch 51/52
----------
train Loss: 0.0448 Acc: 0.9950
val Loss: 2.8195 Acc: 0.8281
Epoch 52/52
----------
train Loss: 0.0535 Acc: 0.9917
[I 2024-10-15 20:19:00,785] Trial 159 finished with value: 0.8203125 and parameters: {'batch_size': 92, 'lr': 0.0004415664569666572, 'num_epochs': 52, 'weight_decay': 0.009946904544905474, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 2.8751 Acc: 0.8203
Best val Acc: 0.820312
Model weights saved at ./model_weights/ResNet34_bs_92_lr_0.0004415664569666572_epoch_52_wd_0.009946904544905474_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/56
----------
train Loss: 5.4543 Acc: 0.1903
val Loss: 6.2059 Acc: 0.2109
Epoch 2/56
----------
train Loss: 5.0060 Acc: 0.2487
val Loss: 5.9548 Acc: 0.2656
Epoch 3/56
----------
train Loss: 4.6965 Acc: 0.3022
val Loss: 5.7479 Acc: 0.2969
Epoch 4/56
----------
train Loss: 4.4337 Acc: 0.3422
val Loss: 5.5510 Acc: 0.3281
Epoch 5/56
----------
train Loss: 4.1430 Acc: 0.4023
val Loss: 5.4045 Acc: 0.3516
Epoch 6/56
----------
train Loss: 3.8961 Acc: 0.4775
val Loss: 5.2416 Acc: 0.3984
Epoch 7/56
----------
train Loss: 3.6647 Acc: 0.5109
val Loss: 5.0915 Acc: 0.4062
Epoch 8/56
----------
train Loss: 3.4159 Acc: 0.5693
val Loss: 4.9822 Acc: 0.4375
Epoch 9/56
----------
train Loss: 3.2460 Acc: 0.5927
val Loss: 4.8477 Acc: 0.4453
Epoch 10/56
----------
train Loss: 3.0700 Acc: 0.6377
val Loss: 4.7456 Acc: 0.4609
Epoch 11/56
----------
train Loss: 2.9009 Acc: 0.6477
val Loss: 4.6445 Acc: 0.5000
Epoch 12/56
----------
train Loss: 2.7367 Acc: 0.6845
val Loss: 4.5330 Acc: 0.5391
Epoch 13/56
----------
train Loss: 2.6149 Acc: 0.7012
val Loss: 4.4508 Acc: 0.5469
Epoch 14/56
----------
train Loss: 2.4652 Acc: 0.7396
val Loss: 4.3680 Acc: 0.5703
Epoch 15/56
----------
train Loss: 2.3815 Acc: 0.7245
val Loss: 4.2601 Acc: 0.5938
Epoch 16/56
----------
train Loss: 2.2468 Acc: 0.7563
val Loss: 4.1992 Acc: 0.6016
Epoch 17/56
----------
train Loss: 2.0861 Acc: 0.7730
val Loss: 4.1380 Acc: 0.5859
Epoch 18/56
----------
train Loss: 2.0368 Acc: 0.7780
val Loss: 4.0678 Acc: 0.5938
Epoch 19/56
----------
train Loss: 1.9371 Acc: 0.7930
val Loss: 4.0113 Acc: 0.6250
Epoch 20/56
----------
train Loss: 1.8219 Acc: 0.8030
val Loss: 3.9518 Acc: 0.6484
Epoch 21/56
----------
train Loss: 1.7624 Acc: 0.8297
val Loss: 3.9014 Acc: 0.6562
Epoch 22/56
----------
train Loss: 1.6888 Acc: 0.8247
val Loss: 3.8476 Acc: 0.6797
Epoch 23/56
----------
train Loss: 1.6209 Acc: 0.8464
val Loss: 3.8038 Acc: 0.6719
Epoch 24/56
----------
train Loss: 1.5310 Acc: 0.8497
val Loss: 3.7552 Acc: 0.6719
Epoch 25/56
----------
train Loss: 1.5039 Acc: 0.8564
val Loss: 3.7145 Acc: 0.7031
Epoch 26/56
----------
train Loss: 1.3885 Acc: 0.8715
val Loss: 3.6872 Acc: 0.6953
Epoch 27/56
----------
train Loss: 1.3660 Acc: 0.8815
val Loss: 3.6554 Acc: 0.6875
Epoch 28/56
----------
train Loss: 1.2653 Acc: 0.8781
val Loss: 3.6296 Acc: 0.6953
Epoch 29/56
----------
train Loss: 1.2380 Acc: 0.8848
val Loss: 3.5752 Acc: 0.7109
Epoch 30/56
----------
train Loss: 1.1768 Acc: 0.9048
val Loss: 3.5571 Acc: 0.7109
Epoch 31/56
----------
train Loss: 1.1674 Acc: 0.9032
val Loss: 3.5072 Acc: 0.7031
Epoch 32/56
----------
train Loss: 1.1056 Acc: 0.9082
val Loss: 3.4780 Acc: 0.6953
Epoch 33/56
----------
train Loss: 1.0452 Acc: 0.9215
val Loss: 3.4554 Acc: 0.7031
Epoch 34/56
----------
train Loss: 1.0064 Acc: 0.9332
val Loss: 3.4278 Acc: 0.7109
Epoch 35/56
----------
train Loss: 0.9468 Acc: 0.9349
val Loss: 3.4149 Acc: 0.7188
Epoch 36/56
----------
train Loss: 0.9941 Acc: 0.9332
val Loss: 3.3832 Acc: 0.7031
Epoch 37/56
----------
train Loss: 0.9359 Acc: 0.9282
val Loss: 3.3578 Acc: 0.6953
Epoch 38/56
----------
train Loss: 0.8546 Acc: 0.9499
val Loss: 3.3587 Acc: 0.7031
Epoch 39/56
----------
train Loss: 0.8310 Acc: 0.9382
val Loss: 3.3505 Acc: 0.7031
Epoch 40/56
----------
train Loss: 0.8620 Acc: 0.9466
val Loss: 3.3170 Acc: 0.7031
Epoch 41/56
----------
train Loss: 0.7881 Acc: 0.9583
val Loss: 3.3059 Acc: 0.7031
Epoch 42/56
----------
train Loss: 0.7200 Acc: 0.9683
val Loss: 3.3006 Acc: 0.7109
Epoch 43/56
----------
train Loss: 0.7008 Acc: 0.9699
val Loss: 3.2764 Acc: 0.7109
Epoch 44/56
----------
train Loss: 0.7023 Acc: 0.9633
val Loss: 3.2853 Acc: 0.7266
Epoch 45/56
----------
train Loss: 0.6646 Acc: 0.9733
val Loss: 3.2891 Acc: 0.7188
Epoch 46/56
----------
train Loss: 0.6808 Acc: 0.9750
val Loss: 3.2473 Acc: 0.7266
Epoch 47/56
----------
train Loss: 0.6388 Acc: 0.9683
val Loss: 3.2634 Acc: 0.7188
Epoch 48/56
----------
train Loss: 0.6027 Acc: 0.9750
val Loss: 3.2603 Acc: 0.7344
Epoch 49/56
----------
train Loss: 0.6160 Acc: 0.9750
val Loss: 3.2538 Acc: 0.7422
Epoch 50/56
----------
train Loss: 0.5696 Acc: 0.9783
val Loss: 3.2559 Acc: 0.7656
Epoch 51/56
----------
train Loss: 0.5391 Acc: 0.9800
val Loss: 3.2829 Acc: 0.7734
Epoch 52/56
----------
train Loss: 0.5696 Acc: 0.9699
val Loss: 3.2619 Acc: 0.7734
Epoch 53/56
----------
train Loss: 0.5161 Acc: 0.9783
val Loss: 3.2488 Acc: 0.7812
Epoch 54/56
----------
train Loss: 0.4832 Acc: 0.9833
val Loss: 3.2456 Acc: 0.7812
Epoch 55/56
----------
train Loss: 0.4599 Acc: 0.9833
val Loss: 3.2445 Acc: 0.7734
Epoch 56/56
----------
train Loss: 0.4603 Acc: 0.9833
[I 2024-10-15 20:23:11,470] Trial 160 finished with value: 0.78125 and parameters: {'batch_size': 97, 'lr': 1.7348620114949292e-06, 'num_epochs': 56, 'weight_decay': 0.08816667299332483, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 3.2139 Acc: 0.7812
Best val Acc: 0.781250
Model weights saved at ./model_weights/ResNet34_bs_97_lr_1.7348620114949292e-06_epoch_56_wd_0.08816667299332483_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/53
----------
train Loss: 3.9483 Acc: 0.5426
val Loss: 3.5815 Acc: 0.7656
Epoch 2/53
----------
train Loss: 1.2417 Acc: 0.8481
val Loss: 2.4826 Acc: 0.7969
Epoch 3/53
----------
train Loss: 0.4426 Acc: 0.9566
val Loss: 3.9806 Acc: 0.7969
Epoch 4/53
----------
train Loss: 0.2080 Acc: 0.9816
val Loss: 3.3704 Acc: 0.8125
Epoch 5/53
----------
train Loss: 0.1578 Acc: 0.9883
val Loss: 2.9842 Acc: 0.7891
Epoch 6/53
----------
train Loss: 0.0993 Acc: 0.9933
val Loss: 3.2294 Acc: 0.8203
Epoch 7/53
----------
train Loss: 0.0706 Acc: 0.9933
val Loss: 3.4809 Acc: 0.8125
Epoch 8/53
----------
train Loss: 0.0506 Acc: 0.9950
val Loss: 4.0016 Acc: 0.8281
Epoch 9/53
----------
train Loss: 0.0467 Acc: 0.9933
val Loss: 4.2273 Acc: 0.8203
Epoch 10/53
----------
train Loss: 0.0429 Acc: 0.9950
val Loss: 3.6654 Acc: 0.8203
Epoch 11/53
----------
train Loss: 0.0312 Acc: 0.9950
val Loss: 3.9406 Acc: 0.8125
Epoch 12/53
----------
train Loss: 0.0404 Acc: 0.9950
val Loss: 4.0226 Acc: 0.8203
Epoch 13/53
----------
train Loss: 0.0314 Acc: 0.9950
val Loss: 3.8567 Acc: 0.8203
Epoch 14/53
----------
train Loss: 0.0330 Acc: 0.9950
val Loss: 3.8225 Acc: 0.8281
Epoch 15/53
----------
train Loss: 0.0537 Acc: 0.9933
val Loss: 3.8991 Acc: 0.8281
Epoch 16/53
----------
train Loss: 0.3084 Acc: 0.9583
val Loss: 5.7802 Acc: 0.7578
Epoch 17/53
----------
train Loss: 0.6611 Acc: 0.9282
val Loss: 8.1421 Acc: 0.4922
Epoch 18/53
----------
train Loss: 1.8634 Acc: 0.7947
val Loss: 4.6420 Acc: 0.5781
Epoch 19/53
----------
train Loss: 1.7363 Acc: 0.8614
val Loss: 3.6395 Acc: 0.6094
Epoch 20/53
----------
train Loss: 0.8112 Acc: 0.9048
val Loss: 2.7034 Acc: 0.8359
Epoch 21/53
----------
train Loss: 0.4164 Acc: 0.9533
val Loss: 2.4967 Acc: 0.8359
Epoch 22/53
----------
train Loss: 0.1423 Acc: 0.9866
val Loss: 2.7748 Acc: 0.8203
Epoch 23/53
----------
train Loss: 0.0886 Acc: 0.9917
val Loss: 3.4974 Acc: 0.8203
Epoch 24/53
----------
train Loss: 0.0570 Acc: 0.9950
val Loss: 3.5168 Acc: 0.8359
Epoch 25/53
----------
train Loss: 0.0617 Acc: 0.9917
val Loss: 3.9179 Acc: 0.8359
Epoch 26/53
----------
train Loss: 0.0595 Acc: 0.9933
val Loss: 4.2138 Acc: 0.8281
Epoch 27/53
----------
train Loss: 0.1548 Acc: 0.9833
val Loss: 4.4952 Acc: 0.8281
Epoch 28/53
----------
train Loss: 0.0914 Acc: 0.9866
val Loss: 3.9151 Acc: 0.8438
Epoch 29/53
----------
train Loss: 0.0487 Acc: 0.9950
val Loss: 3.6357 Acc: 0.8359
Epoch 30/53
----------
train Loss: 0.0289 Acc: 0.9967
val Loss: 3.5721 Acc: 0.8438
Epoch 31/53
----------
train Loss: 0.0247 Acc: 0.9967
val Loss: 3.9054 Acc: 0.8359
Epoch 32/53
----------
train Loss: 0.0370 Acc: 0.9967
val Loss: 3.4426 Acc: 0.8438
Epoch 33/53
----------
train Loss: 0.0266 Acc: 0.9967
val Loss: 3.4398 Acc: 0.8594
Epoch 34/53
----------
train Loss: 0.0283 Acc: 0.9967
val Loss: 3.9723 Acc: 0.8281
Epoch 35/53
----------
train Loss: 0.0248 Acc: 0.9967
val Loss: 4.1619 Acc: 0.8281
Epoch 36/53
----------
train Loss: 0.0234 Acc: 0.9950
val Loss: 3.6224 Acc: 0.8359
Epoch 37/53
----------
train Loss: 0.0294 Acc: 0.9967
val Loss: 4.3712 Acc: 0.8516
Epoch 38/53
----------
train Loss: 0.0187 Acc: 0.9967
val Loss: 4.5759 Acc: 0.8359
Epoch 39/53
----------
train Loss: 0.0335 Acc: 0.9967
val Loss: 4.2956 Acc: 0.8438
Epoch 40/53
----------
train Loss: 0.1042 Acc: 0.9900
val Loss: 3.7161 Acc: 0.8438
Epoch 41/53
----------
train Loss: 0.0346 Acc: 0.9950
val Loss: 3.9813 Acc: 0.8594
Epoch 42/53
----------
train Loss: 0.0273 Acc: 0.9967
val Loss: 3.8095 Acc: 0.8594
Epoch 43/53
----------
train Loss: 0.0375 Acc: 0.9967
val Loss: 3.6804 Acc: 0.8516
Epoch 44/53
----------
train Loss: 0.0851 Acc: 0.9917
val Loss: 6.6975 Acc: 0.7812
Epoch 45/53
----------
train Loss: 0.3609 Acc: 0.9683
val Loss: 3.7630 Acc: 0.8438
Epoch 46/53
----------
train Loss: 0.6106 Acc: 0.9132
val Loss: 7.0295 Acc: 0.6953
Epoch 47/53
----------
train Loss: 1.2201 Acc: 0.8998
val Loss: 10.9207 Acc: 0.5469
Epoch 48/53
----------
train Loss: 1.6122 Acc: 0.8664
val Loss: 10.4654 Acc: 0.4922
Epoch 49/53
----------
train Loss: 0.7657 Acc: 0.9098
val Loss: 3.2829 Acc: 0.8125
Epoch 50/53
----------
train Loss: 0.7230 Acc: 0.9215
val Loss: 2.6242 Acc: 0.7656
Epoch 51/53
----------
train Loss: 0.2289 Acc: 0.9783
val Loss: 3.5772 Acc: 0.8047
Epoch 52/53
----------
train Loss: 0.1585 Acc: 0.9800
val Loss: 4.3250 Acc: 0.8125
Epoch 53/53
----------
train Loss: 0.1334 Acc: 0.9800
[I 2024-10-15 20:27:08,183] Trial 161 finished with value: 0.8203125 and parameters: {'batch_size': 88, 'lr': 0.00013922443293944346, 'num_epochs': 53, 'weight_decay': 0.012511575793142517, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 4.1048 Acc: 0.8203
Best val Acc: 0.820312
Model weights saved at ./model_weights/ResNet34_bs_88_lr_0.00013922443293944346_epoch_53_wd_0.012511575793142517_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/58
----------
train Loss: 3.8597 Acc: 0.5392
val Loss: 2.9414 Acc: 0.8359
Epoch 2/58
----------
train Loss: 1.0113 Acc: 0.8781
val Loss: 3.4268 Acc: 0.8125
Epoch 3/58
----------
train Loss: 0.3296 Acc: 0.9666
val Loss: 2.5468 Acc: 0.8594
Epoch 4/58
----------
train Loss: 0.2186 Acc: 0.9783
val Loss: 3.2061 Acc: 0.8359
Epoch 5/58
----------
train Loss: 0.2203 Acc: 0.9783
val Loss: 2.6691 Acc: 0.8359
Epoch 6/58
----------
train Loss: 0.2592 Acc: 0.9699
val Loss: 5.0720 Acc: 0.7969
Epoch 7/58
----------
train Loss: 0.2661 Acc: 0.9666
val Loss: 2.9786 Acc: 0.7734
Epoch 8/58
----------
train Loss: 0.1291 Acc: 0.9866
val Loss: 3.2765 Acc: 0.8125
Epoch 9/58
----------
train Loss: 0.1427 Acc: 0.9816
val Loss: 4.0694 Acc: 0.8438
Epoch 10/58
----------
train Loss: 0.1380 Acc: 0.9866
val Loss: 3.3989 Acc: 0.8359
Epoch 11/58
----------
train Loss: 0.2323 Acc: 0.9783
val Loss: 3.5421 Acc: 0.8438
Epoch 12/58
----------
train Loss: 0.3952 Acc: 0.9633
val Loss: 5.5185 Acc: 0.8047
Epoch 13/58
----------
train Loss: 1.1099 Acc: 0.9032
val Loss: 6.0131 Acc: 0.7656
Epoch 14/58
----------
train Loss: 0.6818 Acc: 0.8965
val Loss: 5.3483 Acc: 0.8203
Epoch 15/58
----------
train Loss: 0.8485 Acc: 0.9132
val Loss: 6.1546 Acc: 0.6797
Epoch 16/58
----------
train Loss: 0.5071 Acc: 0.9633
val Loss: 3.6922 Acc: 0.8047
Epoch 17/58
----------
train Loss: 0.3308 Acc: 0.9599
val Loss: 4.2078 Acc: 0.7969
Epoch 18/58
----------
train Loss: 0.3283 Acc: 0.9649
val Loss: 3.9823 Acc: 0.7734
Epoch 19/58
----------
train Loss: 0.1908 Acc: 0.9783
val Loss: 3.0573 Acc: 0.8203
Epoch 20/58
----------
train Loss: 0.1373 Acc: 0.9783
val Loss: 2.4979 Acc: 0.8906
Epoch 21/58
----------
train Loss: 0.1021 Acc: 0.9900
val Loss: 3.0542 Acc: 0.8516
Epoch 22/58
----------
train Loss: 0.0520 Acc: 0.9933
val Loss: 3.1977 Acc: 0.8828
Epoch 23/58
----------
train Loss: 0.0408 Acc: 0.9933
val Loss: 3.5385 Acc: 0.8672
Epoch 24/58
----------
train Loss: 0.0360 Acc: 0.9950
val Loss: 3.6185 Acc: 0.8594
Epoch 25/58
----------
train Loss: 0.0390 Acc: 0.9950
val Loss: 3.3768 Acc: 0.8672
Epoch 26/58
----------
train Loss: 0.0331 Acc: 0.9950
val Loss: 3.3567 Acc: 0.8594
Epoch 27/58
----------
train Loss: 0.0375 Acc: 0.9950
val Loss: 3.4515 Acc: 0.8516
Epoch 28/58
----------
train Loss: 0.0451 Acc: 0.9950
val Loss: 3.5571 Acc: 0.8438
Epoch 29/58
----------
train Loss: 0.0471 Acc: 0.9933
val Loss: 3.5087 Acc: 0.8281
Epoch 30/58
----------
train Loss: 0.0442 Acc: 0.9950
val Loss: 3.8739 Acc: 0.8203
Epoch 31/58
----------
train Loss: 0.0321 Acc: 0.9950
val Loss: 3.4356 Acc: 0.8516
Epoch 32/58
----------
train Loss: 0.0283 Acc: 0.9950
val Loss: 3.4677 Acc: 0.8438
Epoch 33/58
----------
train Loss: 0.0307 Acc: 0.9950
val Loss: 3.3736 Acc: 0.8672
Epoch 34/58
----------
train Loss: 0.0361 Acc: 0.9933
val Loss: 3.6030 Acc: 0.8594
Epoch 35/58
----------
train Loss: 0.0375 Acc: 0.9950
val Loss: 4.4665 Acc: 0.8438
Epoch 36/58
----------
train Loss: 0.0287 Acc: 0.9950
val Loss: 4.2604 Acc: 0.8516
Epoch 37/58
----------
train Loss: 0.0282 Acc: 0.9950
val Loss: 4.3070 Acc: 0.8438
Epoch 38/58
----------
train Loss: 0.0297 Acc: 0.9950
val Loss: 4.1364 Acc: 0.8359
Epoch 39/58
----------
train Loss: 0.0316 Acc: 0.9950
val Loss: 4.3041 Acc: 0.8438
Epoch 40/58
----------
train Loss: 0.0240 Acc: 0.9950
val Loss: 3.9933 Acc: 0.8516
Epoch 41/58
----------
train Loss: 0.0348 Acc: 0.9950
val Loss: 5.1218 Acc: 0.8359
Epoch 42/58
----------
train Loss: 0.0762 Acc: 0.9917
val Loss: 4.2348 Acc: 0.8516
Epoch 43/58
----------
train Loss: 0.0427 Acc: 0.9917
val Loss: 4.9948 Acc: 0.8281
Epoch 44/58
----------
train Loss: 0.0400 Acc: 0.9950
val Loss: 4.1456 Acc: 0.8281
Epoch 45/58
----------
train Loss: 0.0298 Acc: 0.9950
val Loss: 4.2174 Acc: 0.8125
Epoch 46/58
----------
train Loss: 0.0482 Acc: 0.9933
val Loss: 4.3969 Acc: 0.8594
Epoch 47/58
----------
train Loss: 0.4160 Acc: 0.9399
val Loss: 6.3448 Acc: 0.7422
Epoch 48/58
----------
train Loss: 1.0059 Acc: 0.8865
val Loss: 6.9955 Acc: 0.6250
Epoch 49/58
----------
train Loss: 2.1158 Acc: 0.8280
val Loss: 7.6597 Acc: 0.3672
Epoch 50/58
----------
train Loss: 2.1796 Acc: 0.8114
val Loss: 4.4665 Acc: 0.5625
Epoch 51/58
----------
train Loss: 1.1336 Acc: 0.8715
[I 2024-10-15 20:30:58,282] Trial 162 finished with value: 0.859375 and parameters: {'batch_size': 84, 'lr': 0.00011958209703308629, 'num_epochs': 58, 'weight_decay': 0.01645074033104354, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 4.5066 Acc: 0.6641
Early stopping at epoch 51 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.859375
Model weights saved at ./model_weights/ResNet34_bs_84_lr_0.00011958209703308629_epoch_58_wd_0.01645074033104354_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/34
----------
train Loss: 3.8501 Acc: 0.5409
val Loss: 4.4063 Acc: 0.7031
Epoch 2/34
----------
train Loss: 2.1731 Acc: 0.7846
val Loss: 3.2983 Acc: 0.7188
Epoch 3/34
----------
train Loss: 1.0161 Acc: 0.8731
val Loss: 2.6540 Acc: 0.8203
Epoch 4/34
----------
train Loss: 0.3519 Acc: 0.9683
val Loss: 1.9161 Acc: 0.8438
Epoch 5/34
----------
train Loss: 0.2018 Acc: 0.9850
val Loss: 2.1374 Acc: 0.8828
Epoch 6/34
----------
train Loss: 0.1342 Acc: 0.9900
val Loss: 3.2785 Acc: 0.8672
Epoch 7/34
----------
train Loss: 0.1652 Acc: 0.9850
val Loss: 2.7080 Acc: 0.8125
Epoch 8/34
----------
train Loss: 0.1383 Acc: 0.9766
val Loss: 2.1597 Acc: 0.8359
Epoch 9/34
----------
train Loss: 0.3403 Acc: 0.9649
val Loss: 5.0200 Acc: 0.7500
Epoch 10/34
----------
train Loss: 1.2081 Acc: 0.8748
val Loss: 8.7939 Acc: 0.4141
Epoch 11/34
----------
train Loss: 1.0889 Acc: 0.9182
val Loss: 3.2962 Acc: 0.7656
Epoch 12/34
----------
train Loss: 1.1347 Acc: 0.8932
val Loss: 2.8998 Acc: 0.7266
Epoch 13/34
----------
train Loss: 1.3235 Acc: 0.9065
[I 2024-10-15 20:31:57,419] Trial 163 finished with value: 0.8359375 and parameters: {'batch_size': 90, 'lr': 0.00020934825890435397, 'num_epochs': 34, 'weight_decay': 0.017109752305753317, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 6.4561 Acc: 0.6797
Early stopping at epoch 13 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.835938
Model weights saved at ./model_weights/ResNet34_bs_90_lr_0.00020934825890435397_epoch_34_wd_0.017109752305753317_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/54
----------
train Loss: 4.0350 Acc: 0.5826
val Loss: 2.7468 Acc: 0.6484
Epoch 2/54
----------
train Loss: 1.3048 Acc: 0.8514
val Loss: 1.9884 Acc: 0.7188
Epoch 3/54
----------
train Loss: 0.5208 Acc: 0.9499
val Loss: 2.3510 Acc: 0.8359
Epoch 4/54
----------
train Loss: 0.3761 Acc: 0.9649
val Loss: 2.7074 Acc: 0.8281
Epoch 5/54
----------
train Loss: 0.2304 Acc: 0.9750
val Loss: 2.6982 Acc: 0.8125
Epoch 6/54
----------
train Loss: 0.1393 Acc: 0.9866
val Loss: 3.3640 Acc: 0.8516
Epoch 7/54
----------
train Loss: 0.1370 Acc: 0.9883
val Loss: 2.8245 Acc: 0.8281
Epoch 8/54
----------
train Loss: 0.1105 Acc: 0.9917
val Loss: 2.9367 Acc: 0.8125
Epoch 9/54
----------
train Loss: 0.2020 Acc: 0.9766
val Loss: 2.4788 Acc: 0.7891
Epoch 10/54
----------
train Loss: 0.4755 Acc: 0.9683
val Loss: 3.6565 Acc: 0.7969
Epoch 11/54
----------
train Loss: 1.0864 Acc: 0.8881
val Loss: 3.5194 Acc: 0.6953
Epoch 12/54
----------
train Loss: 0.8184 Acc: 0.9115
val Loss: 4.2528 Acc: 0.7891
Epoch 13/54
----------
train Loss: 0.7441 Acc: 0.9048
val Loss: 3.3564 Acc: 0.6562
Epoch 14/54
----------
train Loss: 0.4871 Acc: 0.9299
val Loss: 3.2214 Acc: 0.7500
Epoch 15/54
----------
train Loss: 0.2935 Acc: 0.9633
val Loss: 3.8712 Acc: 0.8438
Epoch 16/54
----------
train Loss: 0.2079 Acc: 0.9783
val Loss: 3.6738 Acc: 0.8203
Epoch 17/54
----------
train Loss: 0.2189 Acc: 0.9766
val Loss: 3.2239 Acc: 0.7578
Epoch 18/54
----------
train Loss: 0.3251 Acc: 0.9850
val Loss: 2.8432 Acc: 0.7969
Epoch 19/54
----------
train Loss: 0.4471 Acc: 0.9549
val Loss: 2.1429 Acc: 0.8281
Epoch 20/54
----------
train Loss: 0.2174 Acc: 0.9800
val Loss: 2.7449 Acc: 0.7969
Epoch 21/54
----------
train Loss: 0.2853 Acc: 0.9716
val Loss: 2.3718 Acc: 0.8281
Epoch 22/54
----------
train Loss: 0.1617 Acc: 0.9883
val Loss: 2.8496 Acc: 0.8203
Epoch 23/54
----------
train Loss: 0.0541 Acc: 0.9950
val Loss: 2.4615 Acc: 0.8281
Epoch 24/54
----------
train Loss: 0.0663 Acc: 0.9917
val Loss: 2.6417 Acc: 0.8203
Epoch 25/54
----------
train Loss: 0.0608 Acc: 0.9950
val Loss: 2.6735 Acc: 0.8359
Epoch 26/54
----------
train Loss: 0.0504 Acc: 0.9950
val Loss: 2.4593 Acc: 0.8359
Epoch 27/54
----------
train Loss: 0.0413 Acc: 0.9950
val Loss: 2.7567 Acc: 0.8359
Epoch 28/54
----------
train Loss: 0.0596 Acc: 0.9933
val Loss: 3.1744 Acc: 0.8359
Epoch 29/54
----------
train Loss: 0.0311 Acc: 0.9983
val Loss: 3.1588 Acc: 0.7422
Epoch 30/54
----------
train Loss: 0.0462 Acc: 0.9950
val Loss: 2.9623 Acc: 0.8047
Epoch 31/54
----------
train Loss: 0.1076 Acc: 0.9900
val Loss: 3.3036 Acc: 0.8281
Epoch 32/54
----------
train Loss: 0.2675 Acc: 0.9699
val Loss: 5.2272 Acc: 0.8047
Epoch 33/54
----------
train Loss: 0.2518 Acc: 0.9633
val Loss: 3.2611 Acc: 0.6641
Epoch 34/54
----------
train Loss: 0.2602 Acc: 0.9666
val Loss: 4.1751 Acc: 0.8047
Epoch 35/54
----------
train Loss: 0.4294 Acc: 0.9683
val Loss: 9.7239 Acc: 0.6797
Epoch 36/54
----------
train Loss: 1.0750 Acc: 0.8664
val Loss: 4.3506 Acc: 0.7344
Epoch 37/54
----------
train Loss: 1.2045 Acc: 0.8948
val Loss: 4.4380 Acc: 0.7266
Epoch 38/54
----------
train Loss: 1.3858 Acc: 0.8965
val Loss: 3.3527 Acc: 0.6094
Epoch 39/54
----------
train Loss: 1.3242 Acc: 0.9215
[I 2024-10-15 20:34:56,738] Trial 164 finished with value: 0.8046875 and parameters: {'batch_size': 95, 'lr': 0.00015127692167383523, 'num_epochs': 54, 'weight_decay': 0.02073197508386085, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 2.7539 Acc: 0.7344
Early stopping at epoch 39 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.804688
Model weights saved at ./model_weights/ResNet34_bs_95_lr_0.00015127692167383523_epoch_54_wd_0.02073197508386085_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/50
----------
train Loss: 3.8164 Acc: 0.6511
val Loss: 4.8455 Acc: 0.7969
Epoch 2/50
----------
train Loss: 1.0228 Acc: 0.8598
val Loss: 2.8637 Acc: 0.8203
Epoch 3/50
----------
train Loss: 0.3827 Acc: 0.9733
val Loss: 3.0260 Acc: 0.8125
Epoch 4/50
----------
train Loss: 0.2133 Acc: 0.9866
val Loss: 2.9047 Acc: 0.8281
Epoch 5/50
----------
train Loss: 0.1750 Acc: 0.9833
val Loss: 2.9705 Acc: 0.8438
Epoch 6/50
----------
train Loss: 0.0975 Acc: 0.9917
val Loss: 3.1471 Acc: 0.8281
Epoch 7/50
----------
train Loss: 0.1071 Acc: 0.9933
val Loss: 3.8643 Acc: 0.8203
Epoch 8/50
----------
train Loss: 0.0823 Acc: 0.9933
val Loss: 3.2961 Acc: 0.8281
Epoch 9/50
----------
train Loss: 0.0638 Acc: 0.9917
val Loss: 3.9598 Acc: 0.8125
Epoch 10/50
----------
train Loss: 0.0547 Acc: 0.9933
val Loss: 3.8147 Acc: 0.8125
Epoch 11/50
----------
train Loss: 0.0620 Acc: 0.9933
val Loss: 3.7351 Acc: 0.8438
Epoch 12/50
----------
train Loss: 0.0717 Acc: 0.9917
val Loss: 3.7018 Acc: 0.8438
Epoch 13/50
----------
train Loss: 0.0880 Acc: 0.9900
val Loss: 4.2748 Acc: 0.8203
Epoch 14/50
----------
train Loss: 0.0635 Acc: 0.9917
val Loss: 5.1029 Acc: 0.8125
Epoch 15/50
----------
train Loss: 0.0695 Acc: 0.9917
val Loss: 5.1845 Acc: 0.7969
Epoch 16/50
----------
train Loss: 0.1193 Acc: 0.9883
val Loss: 6.1353 Acc: 0.7812
Epoch 17/50
----------
train Loss: 0.3778 Acc: 0.9533
val Loss: 3.9963 Acc: 0.6484
Epoch 18/50
----------
train Loss: 2.2205 Acc: 0.8114
val Loss: 16.7222 Acc: 0.5156
Epoch 19/50
----------
train Loss: 2.3678 Acc: 0.7713
val Loss: 4.9671 Acc: 0.6562
Epoch 20/50
----------
train Loss: 1.5167 Acc: 0.8197
val Loss: 3.0244 Acc: 0.7422
Epoch 21/50
----------
train Loss: 0.7614 Acc: 0.9015
val Loss: 3.6510 Acc: 0.8203
Epoch 22/50
----------
train Loss: 0.4556 Acc: 0.9516
val Loss: 2.6322 Acc: 0.8750
Epoch 23/50
----------
train Loss: 0.2114 Acc: 0.9683
val Loss: 3.0755 Acc: 0.8359
Epoch 24/50
----------
train Loss: 0.2345 Acc: 0.9783
val Loss: 3.1960 Acc: 0.8203
Epoch 25/50
----------
train Loss: 0.2251 Acc: 0.9616
val Loss: 2.5443 Acc: 0.8828
Epoch 26/50
----------
train Loss: 0.1208 Acc: 0.9833
val Loss: 3.4227 Acc: 0.7734
Epoch 27/50
----------
train Loss: 0.1194 Acc: 0.9883
val Loss: 3.4564 Acc: 0.8516
Epoch 28/50
----------
train Loss: 0.1428 Acc: 0.9866
val Loss: 3.6772 Acc: 0.8516
Epoch 29/50
----------
train Loss: 0.1229 Acc: 0.9833
val Loss: 3.4291 Acc: 0.8359
Epoch 30/50
----------
train Loss: 0.1572 Acc: 0.9850
val Loss: 4.1495 Acc: 0.8047
Epoch 31/50
----------
train Loss: 0.2436 Acc: 0.9833
val Loss: 3.4283 Acc: 0.8359
Epoch 32/50
----------
train Loss: 0.2192 Acc: 0.9566
val Loss: 4.1372 Acc: 0.8359
Epoch 33/50
----------
train Loss: 0.0942 Acc: 0.9917
val Loss: 5.1863 Acc: 0.8281
Epoch 34/50
----------
train Loss: 0.0976 Acc: 0.9917
val Loss: 4.1700 Acc: 0.8281
Epoch 35/50
----------
train Loss: 0.1275 Acc: 0.9866
val Loss: 3.3351 Acc: 0.8906
Epoch 36/50
----------
train Loss: 0.1088 Acc: 0.9816
val Loss: 2.7295 Acc: 0.8672
Epoch 37/50
----------
train Loss: 0.1571 Acc: 0.9733
val Loss: 6.3409 Acc: 0.7891
Epoch 38/50
----------
train Loss: 0.1318 Acc: 0.9816
val Loss: 6.0375 Acc: 0.7812
Epoch 39/50
----------
train Loss: 0.0607 Acc: 0.9917
val Loss: 5.6047 Acc: 0.8047
Epoch 40/50
----------
train Loss: 0.1336 Acc: 0.9816
val Loss: 6.2635 Acc: 0.8125
Epoch 41/50
----------
train Loss: 0.4148 Acc: 0.9533
val Loss: 3.5320 Acc: 0.8594
Epoch 42/50
----------
train Loss: 0.8637 Acc: 0.9149
val Loss: 8.2182 Acc: 0.6641
Epoch 43/50
----------
train Loss: 0.9586 Acc: 0.9149
val Loss: 7.5276 Acc: 0.7109
Epoch 44/50
----------
train Loss: 0.9985 Acc: 0.8965
val Loss: 7.5513 Acc: 0.7500
Epoch 45/50
----------
train Loss: 0.7589 Acc: 0.9199
val Loss: 3.0912 Acc: 0.5938
Epoch 46/50
----------
train Loss: 0.8817 Acc: 0.9032
[I 2024-10-15 20:38:23,385] Trial 165 finished with value: 0.859375 and parameters: {'batch_size': 80, 'lr': 8.264579470056435e-05, 'num_epochs': 50, 'weight_decay': 0.05838080627280475, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 4.2871 Acc: 0.7734
Early stopping at epoch 46 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.859375
Model weights saved at ./model_weights/ResNet34_bs_80_lr_8.264579470056435e-05_epoch_50_wd_0.05838080627280475_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/44
----------
train Loss: 3.9909 Acc: 0.5993
val Loss: 3.9468 Acc: 0.7188
Epoch 2/44
----------
train Loss: 1.9449 Acc: 0.7713
val Loss: 5.6564 Acc: 0.7812
Epoch 3/44
----------
train Loss: 1.0567 Acc: 0.8865
val Loss: 4.1814 Acc: 0.7734
Epoch 4/44
----------
train Loss: 0.6727 Acc: 0.9149
val Loss: 4.7438 Acc: 0.7969
Epoch 5/44
----------
train Loss: 0.8597 Acc: 0.9132
val Loss: 4.1769 Acc: 0.7656
Epoch 6/44
----------
train Loss: 0.5277 Acc: 0.9432
val Loss: 5.4164 Acc: 0.8281
Epoch 7/44
----------
train Loss: 0.4846 Acc: 0.9482
val Loss: 5.5758 Acc: 0.7578
Epoch 8/44
----------
train Loss: 1.2017 Acc: 0.8881
val Loss: 8.5431 Acc: 0.5859
Epoch 9/44
----------
train Loss: 1.2723 Acc: 0.8564
val Loss: 4.7907 Acc: 0.6406
Epoch 10/44
----------
train Loss: 0.7244 Acc: 0.9149
val Loss: 3.2856 Acc: 0.7734
Epoch 11/44
----------
train Loss: 0.8759 Acc: 0.9265
val Loss: 4.7621 Acc: 0.8281
Epoch 12/44
----------
train Loss: 0.3966 Acc: 0.9516
val Loss: 3.7160 Acc: 0.7891
Epoch 13/44
----------
train Loss: 0.4838 Acc: 0.9516
val Loss: 4.1204 Acc: 0.7578
Epoch 14/44
----------
train Loss: 0.2462 Acc: 0.9766
val Loss: 3.7113 Acc: 0.8359
Epoch 15/44
----------
train Loss: 0.3954 Acc: 0.9583
val Loss: 5.4405 Acc: 0.8125
Epoch 16/44
----------
train Loss: 0.3173 Acc: 0.9666
val Loss: 4.2874 Acc: 0.8281
Epoch 17/44
----------
train Loss: 0.5396 Acc: 0.9482
val Loss: 3.4342 Acc: 0.8125
Epoch 18/44
----------
train Loss: 0.5045 Acc: 0.9182
val Loss: 6.2945 Acc: 0.7422
Epoch 19/44
----------
train Loss: 0.9135 Acc: 0.9249
val Loss: 7.5759 Acc: 0.4062
Epoch 20/44
----------
train Loss: 1.7095 Acc: 0.8331
val Loss: 4.2633 Acc: 0.6875
Epoch 21/44
----------
train Loss: 1.0538 Acc: 0.8898
val Loss: 7.7713 Acc: 0.6328
Epoch 22/44
----------
train Loss: 1.1391 Acc: 0.8948
[I 2024-10-15 20:40:01,836] Trial 166 finished with value: 0.8125 and parameters: {'batch_size': 113, 'lr': 0.0002777738049031937, 'num_epochs': 44, 'weight_decay': 0.03104039896333598, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 7.1478 Acc: 0.7344
Early stopping at epoch 22 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.812500
Model weights saved at ./model_weights/ResNet34_bs_113_lr_0.0002777738049031937_epoch_44_wd_0.03104039896333598_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/48
----------
train Loss: 5.3433 Acc: 0.3205
val Loss: 6.4834 Acc: 0.2891
Epoch 2/48
----------
train Loss: 5.1199 Acc: 0.3406
val Loss: 5.8820 Acc: 0.3672
Epoch 3/48
----------
train Loss: 4.8642 Acc: 0.3723
val Loss: 5.6607 Acc: 0.4141
Epoch 4/48
----------
train Loss: 4.6699 Acc: 0.4257
val Loss: 5.5100 Acc: 0.4141
Epoch 5/48
----------
train Loss: 4.4790 Acc: 0.4391
val Loss: 5.3730 Acc: 0.4297
Epoch 6/48
----------
train Loss: 4.3245 Acc: 0.4674
val Loss: 5.2521 Acc: 0.4531
Epoch 7/48
----------
train Loss: 4.1425 Acc: 0.5025
val Loss: 5.1605 Acc: 0.4219
Epoch 8/48
----------
train Loss: 3.9533 Acc: 0.5242
val Loss: 5.0451 Acc: 0.4531
Epoch 9/48
----------
train Loss: 3.8530 Acc: 0.5426
val Loss: 4.9541 Acc: 0.4531
Epoch 10/48
----------
train Loss: 3.6839 Acc: 0.5693
val Loss: 4.8534 Acc: 0.4688
Epoch 11/48
----------
train Loss: 3.5742 Acc: 0.5810
val Loss: 4.7504 Acc: 0.4766
Epoch 12/48
----------
train Loss: 3.4278 Acc: 0.6027
val Loss: 4.6882 Acc: 0.4766
Epoch 13/48
----------
train Loss: 3.2979 Acc: 0.6344
val Loss: 4.6040 Acc: 0.5234
Epoch 14/48
----------
train Loss: 3.1593 Acc: 0.6210
val Loss: 4.5047 Acc: 0.5156
Epoch 15/48
----------
train Loss: 3.0361 Acc: 0.6644
val Loss: 4.4289 Acc: 0.5391
Epoch 16/48
----------
train Loss: 2.9565 Acc: 0.6678
val Loss: 4.3506 Acc: 0.5625
Epoch 17/48
----------
train Loss: 2.8823 Acc: 0.6861
val Loss: 4.2848 Acc: 0.5625
Epoch 18/48
----------
train Loss: 2.7889 Acc: 0.6845
val Loss: 4.2005 Acc: 0.5938
Epoch 19/48
----------
train Loss: 2.6675 Acc: 0.7078
val Loss: 4.1412 Acc: 0.6016
Epoch 20/48
----------
train Loss: 2.6179 Acc: 0.7245
val Loss: 4.0590 Acc: 0.6172
Epoch 21/48
----------
train Loss: 2.4908 Acc: 0.7179
val Loss: 3.9975 Acc: 0.6172
Epoch 22/48
----------
train Loss: 2.4647 Acc: 0.7129
val Loss: 3.9558 Acc: 0.6250
Epoch 23/48
----------
train Loss: 2.3613 Acc: 0.7329
val Loss: 3.9002 Acc: 0.6484
Epoch 24/48
----------
train Loss: 2.2630 Acc: 0.7596
val Loss: 3.8604 Acc: 0.6328
Epoch 25/48
----------
train Loss: 2.2140 Acc: 0.7579
val Loss: 3.8317 Acc: 0.6719
Epoch 26/48
----------
train Loss: 2.1086 Acc: 0.7863
val Loss: 3.7866 Acc: 0.6484
Epoch 27/48
----------
train Loss: 2.0705 Acc: 0.7730
val Loss: 3.7058 Acc: 0.6797
Epoch 28/48
----------
train Loss: 2.0128 Acc: 0.7997
val Loss: 3.6578 Acc: 0.7109
Epoch 29/48
----------
train Loss: 1.9714 Acc: 0.7947
val Loss: 3.6382 Acc: 0.7031
Epoch 30/48
----------
train Loss: 1.8615 Acc: 0.7980
val Loss: 3.5772 Acc: 0.7109
Epoch 31/48
----------
train Loss: 1.8321 Acc: 0.8264
val Loss: 3.5155 Acc: 0.7031
Epoch 32/48
----------
train Loss: 1.8461 Acc: 0.8097
val Loss: 3.5057 Acc: 0.7031
Epoch 33/48
----------
train Loss: 1.8038 Acc: 0.8063
val Loss: 3.4559 Acc: 0.7031
Epoch 34/48
----------
train Loss: 1.6842 Acc: 0.8280
val Loss: 3.4001 Acc: 0.7031
Epoch 35/48
----------
train Loss: 1.6395 Acc: 0.8314
val Loss: 3.3763 Acc: 0.7031
Epoch 36/48
----------
train Loss: 1.5570 Acc: 0.8548
val Loss: 3.3471 Acc: 0.7188
Epoch 37/48
----------
train Loss: 1.5351 Acc: 0.8397
val Loss: 3.3449 Acc: 0.7188
Epoch 38/48
----------
train Loss: 1.5148 Acc: 0.8564
val Loss: 3.2874 Acc: 0.7188
Epoch 39/48
----------
train Loss: 1.5191 Acc: 0.8497
val Loss: 3.2781 Acc: 0.7188
Epoch 40/48
----------
train Loss: 1.4674 Acc: 0.8447
val Loss: 3.2222 Acc: 0.7188
Epoch 41/48
----------
train Loss: 1.4081 Acc: 0.8531
val Loss: 3.2254 Acc: 0.7188
Epoch 42/48
----------
train Loss: 1.3783 Acc: 0.8781
val Loss: 3.1564 Acc: 0.7188
Epoch 43/48
----------
train Loss: 1.3333 Acc: 0.8798
val Loss: 3.1328 Acc: 0.7188
Epoch 44/48
----------
train Loss: 1.2667 Acc: 0.8898
val Loss: 3.1071 Acc: 0.7266
Epoch 45/48
----------
train Loss: 1.2165 Acc: 0.9032
val Loss: 3.0990 Acc: 0.7266
Epoch 46/48
----------
train Loss: 1.2461 Acc: 0.8831
val Loss: 3.0219 Acc: 0.7422
Epoch 47/48
----------
train Loss: 1.1836 Acc: 0.8965
val Loss: 3.0321 Acc: 0.7500
Epoch 48/48
----------
train Loss: 1.1442 Acc: 0.9048
[I 2024-10-15 20:43:36,494] Trial 167 finished with value: 0.734375 and parameters: {'batch_size': 105, 'lr': 1.018458756756187e-06, 'num_epochs': 48, 'weight_decay': 0.0245440315865845, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 3.0249 Acc: 0.7344
Best val Acc: 0.734375
Model weights saved at ./model_weights/ResNet34_bs_105_lr_1.018458756756187e-06_epoch_48_wd_0.0245440315865845_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/60
----------
train Loss: 3.8838 Acc: 0.5426
val Loss: 3.4045 Acc: 0.6016
Epoch 2/60
----------
train Loss: 1.1471 Acc: 0.8548
val Loss: 3.2800 Acc: 0.7969
Epoch 3/60
----------
train Loss: 0.6999 Acc: 0.8982
val Loss: 3.1117 Acc: 0.7578
Epoch 4/60
----------
train Loss: 0.5501 Acc: 0.9566
val Loss: 3.4854 Acc: 0.7188
Epoch 5/60
----------
train Loss: 0.5882 Acc: 0.9332
val Loss: 2.8981 Acc: 0.7969
Epoch 6/60
----------
train Loss: 0.3562 Acc: 0.9599
val Loss: 3.5946 Acc: 0.8359
Epoch 7/60
----------
train Loss: 0.5095 Acc: 0.9482
val Loss: 2.5664 Acc: 0.7578
Epoch 8/60
----------
train Loss: 0.8716 Acc: 0.9265
val Loss: 7.1670 Acc: 0.6250
Epoch 9/60
----------
train Loss: 0.7966 Acc: 0.8982
val Loss: 6.4656 Acc: 0.8047
Epoch 10/60
----------
train Loss: 0.7823 Acc: 0.9382
val Loss: 4.3252 Acc: 0.7656
Epoch 11/60
----------
train Loss: 0.6546 Acc: 0.9232
val Loss: 3.0635 Acc: 0.7422
Epoch 12/60
----------
train Loss: 0.6416 Acc: 0.9215
val Loss: 4.6714 Acc: 0.7891
Epoch 13/60
----------
train Loss: 0.4035 Acc: 0.9649
val Loss: 3.3722 Acc: 0.8125
Epoch 14/60
----------
train Loss: 0.6476 Acc: 0.9566
val Loss: 5.8766 Acc: 0.7500
Epoch 15/60
----------
train Loss: 0.9849 Acc: 0.8998
val Loss: 3.4377 Acc: 0.7500
Epoch 16/60
----------
train Loss: 0.7795 Acc: 0.9232
val Loss: 3.9209 Acc: 0.7422
Epoch 17/60
----------
train Loss: 0.6700 Acc: 0.9182
val Loss: 6.2307 Acc: 0.7812
Epoch 18/60
----------
train Loss: 0.3478 Acc: 0.9583
val Loss: 7.0264 Acc: 0.7812
Epoch 19/60
----------
train Loss: 0.1908 Acc: 0.9716
val Loss: 5.8285 Acc: 0.7891
Epoch 20/60
----------
train Loss: 0.2428 Acc: 0.9616
val Loss: 5.1027 Acc: 0.7656
Epoch 21/60
----------
train Loss: 0.1345 Acc: 0.9866
val Loss: 4.7201 Acc: 0.8125
Epoch 22/60
----------
train Loss: 0.0880 Acc: 0.9933
val Loss: 6.0102 Acc: 0.8203
Epoch 23/60
----------
train Loss: 0.3155 Acc: 0.9699
val Loss: 4.7235 Acc: 0.6562
Epoch 24/60
----------
train Loss: 0.6738 Acc: 0.9482
val Loss: 6.5312 Acc: 0.7812
Epoch 25/60
----------
train Loss: 1.0917 Acc: 0.9232
val Loss: 7.2032 Acc: 0.5000
Epoch 26/60
----------
train Loss: 1.2320 Acc: 0.8748
val Loss: 12.5222 Acc: 0.7266
Epoch 27/60
----------
train Loss: 0.9407 Acc: 0.9249
val Loss: 3.8505 Acc: 0.7344
Epoch 28/60
----------
train Loss: 0.7885 Acc: 0.9149
val Loss: 3.0807 Acc: 0.7734
Epoch 29/60
----------
train Loss: 0.4228 Acc: 0.9583
val Loss: 3.0276 Acc: 0.8203
Epoch 30/60
----------
train Loss: 0.2340 Acc: 0.9683
val Loss: 4.8075 Acc: 0.7812
Epoch 31/60
----------
train Loss: 0.3208 Acc: 0.9666
val Loss: 6.2381 Acc: 0.7812
Epoch 32/60
----------
train Loss: 0.1708 Acc: 0.9866
val Loss: 5.6220 Acc: 0.8047
Epoch 33/60
----------
train Loss: 0.1432 Acc: 0.9900
val Loss: 3.9529 Acc: 0.7734
Epoch 34/60
----------
train Loss: 0.1878 Acc: 0.9833
val Loss: 4.8997 Acc: 0.7969
Epoch 35/60
----------
train Loss: 0.8489 Acc: 0.9048
val Loss: 10.4905 Acc: 0.5781
Epoch 36/60
----------
train Loss: 1.1896 Acc: 0.8748
val Loss: 5.3415 Acc: 0.6797
Epoch 37/60
----------
train Loss: 0.6446 Acc: 0.9316
val Loss: 6.0594 Acc: 0.8047
Epoch 38/60
----------
train Loss: 0.7491 Acc: 0.9115
val Loss: 2.0477 Acc: 0.8359
Epoch 39/60
----------
train Loss: 0.3710 Acc: 0.9449
val Loss: 4.3455 Acc: 0.8359
Epoch 40/60
----------
train Loss: 0.2627 Acc: 0.9699
val Loss: 3.1576 Acc: 0.8125
Epoch 41/60
----------
train Loss: 0.3502 Acc: 0.9566
val Loss: 5.7504 Acc: 0.8125
Epoch 42/60
----------
train Loss: 0.2858 Acc: 0.9683
val Loss: 4.3417 Acc: 0.8438
Epoch 43/60
----------
train Loss: 0.2501 Acc: 0.9633
val Loss: 4.2690 Acc: 0.7188
Epoch 44/60
----------
train Loss: 0.0864 Acc: 0.9816
val Loss: 3.7310 Acc: 0.7656
Epoch 45/60
----------
train Loss: 0.1878 Acc: 0.9800
val Loss: 6.3938 Acc: 0.7812
Epoch 46/60
----------
train Loss: 0.1180 Acc: 0.9816
val Loss: 5.2931 Acc: 0.8125
Epoch 47/60
----------
train Loss: 0.0594 Acc: 0.9917
val Loss: 4.9140 Acc: 0.8672
Epoch 48/60
----------
train Loss: 0.0344 Acc: 0.9983
val Loss: 5.8605 Acc: 0.8047
Epoch 49/60
----------
train Loss: 0.1162 Acc: 0.9833
val Loss: 4.7631 Acc: 0.7656
Epoch 50/60
----------
train Loss: 0.0752 Acc: 0.9933
val Loss: 5.6713 Acc: 0.8125
Epoch 51/60
----------
train Loss: 0.0341 Acc: 0.9983
val Loss: 10.6205 Acc: 0.7734
Epoch 52/60
----------
train Loss: 0.2317 Acc: 0.9750
[I 2024-10-15 20:47:28,600] Trial 168 finished with value: 0.8671875 and parameters: {'batch_size': 89, 'lr': 0.00017649876567430348, 'num_epochs': 60, 'weight_decay': 0.06909878928602986, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 12.8411 Acc: 0.6250
Early stopping at epoch 52 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.867188
Model weights saved at ./model_weights/ResNet34_bs_89_lr_0.00017649876567430348_epoch_60_wd_0.06909878928602986_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/55
----------
train Loss: 8.3824 Acc: 0.2588
val Loss: 2790.2525 Acc: 0.5938
Epoch 2/55
----------
train Loss: 5.7500 Acc: 0.1937
val Loss: 6.9453 Acc: 0.1250
Epoch 3/55
----------
train Loss: 5.7167 Acc: 0.1903
val Loss: 6.5732 Acc: 0.1641
Epoch 4/55
----------
train Loss: 5.5342 Acc: 0.3205
val Loss: 6.2655 Acc: 0.1172
Epoch 5/55
----------
train Loss: 5.8088 Acc: 0.2053
val Loss: 6.5786 Acc: 0.1641
Epoch 6/55
----------
train Loss: 5.4147 Acc: 0.2721
[I 2024-10-15 20:47:56,484] Trial 169 finished with value: 0.59375 and parameters: {'batch_size': 99, 'lr': 0.007028251648244176, 'num_epochs': 55, 'weight_decay': 0.01309651282866675, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 6.1607 Acc: 0.3984
Early stopping at epoch 6 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.593750
Model weights saved at ./model_weights/ResNet34_bs_99_lr_0.007028251648244176_epoch_55_wd_0.01309651282866675_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/52
----------
train Loss: 4.0212 Acc: 0.4841
val Loss: 2.5938 Acc: 0.7656
Epoch 2/52
----------
train Loss: 0.8886 Acc: 0.8881
val Loss: 1.8887 Acc: 0.8047
Epoch 3/52
----------
train Loss: 0.3860 Acc: 0.9649
val Loss: 3.0603 Acc: 0.7891
Epoch 4/52
----------
train Loss: 0.2223 Acc: 0.9883
val Loss: 2.5908 Acc: 0.8281
Epoch 5/52
----------
train Loss: 0.1596 Acc: 0.9866
val Loss: 2.7100 Acc: 0.8359
Epoch 6/52
----------
train Loss: 0.1316 Acc: 0.9883
val Loss: 3.1464 Acc: 0.8203
Epoch 7/52
----------
train Loss: 0.1003 Acc: 0.9900
val Loss: 2.8118 Acc: 0.8281
Epoch 8/52
----------
train Loss: 0.0762 Acc: 0.9933
val Loss: 3.0033 Acc: 0.8281
Epoch 9/52
----------
train Loss: 0.0816 Acc: 0.9917
val Loss: 3.2993 Acc: 0.8359
Epoch 10/52
----------
train Loss: 0.0860 Acc: 0.9933
val Loss: 2.4035 Acc: 0.8438
Epoch 11/52
----------
train Loss: 0.2578 Acc: 0.9783
val Loss: 3.3399 Acc: 0.7500
Epoch 12/52
----------
train Loss: 1.2186 Acc: 0.8881
val Loss: 15.1377 Acc: 0.8125
Epoch 13/52
----------
train Loss: 2.3524 Acc: 0.8214
val Loss: 8.9914 Acc: 0.5625
Epoch 14/52
----------
train Loss: 1.5971 Acc: 0.8314
val Loss: 3.2282 Acc: 0.6641
Epoch 15/52
----------
train Loss: 0.7804 Acc: 0.9282
val Loss: 2.7445 Acc: 0.8359
Epoch 16/52
----------
train Loss: 0.6115 Acc: 0.9432
val Loss: 1.6479 Acc: 0.8203
Epoch 17/52
----------
train Loss: 0.3351 Acc: 0.9716
val Loss: 2.1852 Acc: 0.8359
Epoch 18/52
----------
train Loss: 0.2191 Acc: 0.9733
val Loss: 2.6968 Acc: 0.8281
Epoch 19/52
----------
train Loss: 0.1044 Acc: 0.9866
val Loss: 2.0942 Acc: 0.8359
Epoch 20/52
----------
train Loss: 0.1217 Acc: 0.9866
val Loss: 4.1492 Acc: 0.8438
Epoch 21/52
----------
train Loss: 0.2789 Acc: 0.9633
val Loss: 3.9649 Acc: 0.7734
Epoch 22/52
----------
train Loss: 0.5109 Acc: 0.9482
val Loss: 4.8020 Acc: 0.7812
Epoch 23/52
----------
train Loss: 0.4271 Acc: 0.9349
val Loss: 2.5187 Acc: 0.8125
Epoch 24/52
----------
train Loss: 0.6631 Acc: 0.9366
val Loss: 3.6861 Acc: 0.5859
Epoch 25/52
----------
train Loss: 1.0190 Acc: 0.9065
val Loss: 2.4391 Acc: 0.7891
Epoch 26/52
----------
train Loss: 0.6232 Acc: 0.9482
val Loss: 1.8376 Acc: 0.7969
Epoch 27/52
----------
train Loss: 0.4768 Acc: 0.9716
val Loss: 1.7087 Acc: 0.8594
Epoch 28/52
----------
train Loss: 0.7110 Acc: 0.9416
val Loss: 2.9455 Acc: 0.8438
Epoch 29/52
----------
train Loss: 0.5037 Acc: 0.9449
val Loss: 5.1086 Acc: 0.7422
Epoch 30/52
----------
train Loss: 0.4439 Acc: 0.9516
val Loss: 5.1252 Acc: 0.8125
Epoch 31/52
----------
train Loss: 0.3494 Acc: 0.9699
val Loss: 4.5371 Acc: 0.8125
Epoch 32/52
----------
train Loss: 0.1823 Acc: 0.9750
val Loss: 3.8403 Acc: 0.8047
Epoch 33/52
----------
train Loss: 0.1098 Acc: 0.9917
val Loss: 4.3520 Acc: 0.7891
Epoch 34/52
----------
train Loss: 0.7974 Acc: 0.9599
val Loss: 5.5445 Acc: 0.4688
Epoch 35/52
----------
train Loss: 0.8142 Acc: 0.9332
val Loss: 2.9903 Acc: 0.8516
Epoch 36/52
----------
train Loss: 0.4342 Acc: 0.9549
val Loss: 3.3855 Acc: 0.7500
Epoch 37/52
----------
train Loss: 0.3198 Acc: 0.9716
val Loss: 2.2785 Acc: 0.8281
Epoch 38/52
----------
train Loss: 0.3299 Acc: 0.9432
val Loss: 5.1137 Acc: 0.7734
Epoch 39/52
----------
train Loss: 0.3051 Acc: 0.9766
val Loss: 2.4043 Acc: 0.7969
Epoch 40/52
----------
train Loss: 0.1694 Acc: 0.9816
val Loss: 2.7128 Acc: 0.8359
Epoch 41/52
----------
train Loss: 0.1071 Acc: 0.9866
val Loss: 3.5679 Acc: 0.8281
Epoch 42/52
----------
train Loss: 0.0680 Acc: 0.9950
val Loss: 2.7069 Acc: 0.8281
Epoch 43/52
----------
train Loss: 0.0561 Acc: 0.9950
val Loss: 3.1059 Acc: 0.8594
Epoch 44/52
----------
train Loss: 0.0513 Acc: 0.9950
val Loss: 3.1474 Acc: 0.8359
Epoch 45/52
----------
train Loss: 0.1311 Acc: 0.9900
val Loss: 4.1260 Acc: 0.8125
Epoch 46/52
----------
train Loss: 0.3326 Acc: 0.9733
val Loss: 1.9818 Acc: 0.8203
Epoch 47/52
----------
train Loss: 0.6471 Acc: 0.9482
val Loss: 21.5266 Acc: 0.7734
Epoch 48/52
----------
train Loss: 1.1775 Acc: 0.9115
val Loss: 4.3678 Acc: 0.7578
Epoch 49/52
----------
train Loss: 1.2448 Acc: 0.8598
val Loss: 2.4453 Acc: 0.7891
Epoch 50/52
----------
train Loss: 0.9663 Acc: 0.8898
val Loss: 1.7698 Acc: 0.8203
Epoch 51/52
----------
train Loss: 0.6418 Acc: 0.9366
val Loss: 3.2819 Acc: 0.8438
Epoch 52/52
----------
train Loss: 0.5127 Acc: 0.9349
[I 2024-10-15 20:51:49,856] Trial 170 finished with value: 0.828125 and parameters: {'batch_size': 118, 'lr': 0.00010833376568567828, 'num_epochs': 52, 'weight_decay': 0.10222850523003342, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 2.8581 Acc: 0.8281
Best val Acc: 0.828125
Model weights saved at ./model_weights/ResNet34_bs_118_lr_0.00010833376568567828_epoch_52_wd_0.10222850523003342_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/54
----------
train Loss: 4.7583 Acc: 0.4942
val Loss: 7.8281 Acc: 0.3125
Epoch 2/54
----------
train Loss: 2.6866 Acc: 0.7279
val Loss: 4.8208 Acc: 0.5859
Epoch 3/54
----------
train Loss: 2.2479 Acc: 0.7262
val Loss: 3.1602 Acc: 0.7812
Epoch 4/54
----------
train Loss: 1.1925 Acc: 0.8698
val Loss: 3.2646 Acc: 0.8203
Epoch 5/54
----------
train Loss: 1.0898 Acc: 0.8748
val Loss: 6.9378 Acc: 0.6641
Epoch 6/54
----------
train Loss: 1.0451 Acc: 0.8715
val Loss: 4.7696 Acc: 0.7031
Epoch 7/54
----------
train Loss: 0.8315 Acc: 0.9149
val Loss: 4.6408 Acc: 0.7188
Epoch 8/54
----------
train Loss: 0.7152 Acc: 0.9215
val Loss: 4.5724 Acc: 0.7109
Epoch 9/54
----------
train Loss: 0.9223 Acc: 0.8731
[I 2024-10-15 20:52:30,169] Trial 171 finished with value: 0.8203125 and parameters: {'batch_size': 93, 'lr': 0.0004797568070391892, 'num_epochs': 54, 'weight_decay': 0.026730631400709668, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 4.9664 Acc: 0.6875
Early stopping at epoch 9 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.820312
Model weights saved at ./model_weights/ResNet34_bs_93_lr_0.0004797568070391892_epoch_54_wd_0.026730631400709668_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/53
----------
train Loss: 5.0747 Acc: 0.4407
val Loss: 11.8224 Acc: 0.6562
Epoch 2/53
----------
train Loss: 3.9390 Acc: 0.5876
val Loss: 5.7980 Acc: 0.4609
Epoch 3/53
----------
train Loss: 3.0198 Acc: 0.7179
val Loss: 13.1568 Acc: 0.4453
Epoch 4/53
----------
train Loss: 2.6935 Acc: 0.7429
val Loss: 3.3990 Acc: 0.7656
Epoch 5/53
----------
train Loss: 2.7597 Acc: 0.7028
val Loss: 4.7878 Acc: 0.6250
Epoch 6/53
----------
train Loss: 3.0751 Acc: 0.6978
val Loss: 3.2357 Acc: 0.7969
Epoch 7/53
----------
train Loss: 2.4635 Acc: 0.7763
val Loss: 4.7567 Acc: 0.6016
Epoch 8/53
----------
train Loss: 2.3398 Acc: 0.7629
val Loss: 8.8108 Acc: 0.6719
Epoch 9/53
----------
train Loss: 2.2799 Acc: 0.7362
val Loss: 3.1199 Acc: 0.5000
Epoch 10/53
----------
train Loss: 2.1706 Acc: 0.7963
val Loss: 6.6013 Acc: 0.6016
Epoch 11/53
----------
train Loss: 2.1372 Acc: 0.7896
val Loss: 4.3150 Acc: 0.7812
Epoch 12/53
----------
train Loss: 2.0311 Acc: 0.7863
val Loss: 16.1821 Acc: 0.6797
Epoch 13/53
----------
train Loss: 1.9203 Acc: 0.7613
val Loss: 3.3820 Acc: 0.7656
Epoch 14/53
----------
train Loss: 1.8430 Acc: 0.7997
val Loss: 8.1901 Acc: 0.5000
Epoch 15/53
----------
train Loss: 2.7387 Acc: 0.7446
val Loss: 17.9294 Acc: 0.3672
Epoch 16/53
----------
train Loss: 2.6232 Acc: 0.7078
val Loss: 4.3933 Acc: 0.7500
Epoch 17/53
----------
train Loss: 2.0847 Acc: 0.7930
val Loss: 8.8866 Acc: 0.5781
Epoch 18/53
----------
train Loss: 1.9342 Acc: 0.7997
val Loss: 3.8805 Acc: 0.7422
Epoch 19/53
----------
train Loss: 2.2957 Acc: 0.7947
val Loss: 6.5347 Acc: 0.6875
Epoch 20/53
----------
train Loss: 2.8297 Acc: 0.7763
val Loss: 6.5874 Acc: 0.6328
Epoch 21/53
----------
train Loss: 1.8446 Acc: 0.7696
val Loss: 5.4580 Acc: 0.7266
Epoch 22/53
----------
train Loss: 1.8976 Acc: 0.8130
val Loss: 4.3143 Acc: 0.7188
Epoch 23/53
----------
train Loss: 1.3896 Acc: 0.8564
val Loss: 4.4875 Acc: 0.7578
Epoch 24/53
----------
train Loss: 1.4940 Acc: 0.8431
val Loss: 6.4516 Acc: 0.7344
Epoch 25/53
----------
train Loss: 1.5582 Acc: 0.8013
val Loss: 4.8238 Acc: 0.6562
Epoch 26/53
----------
train Loss: 1.4773 Acc: 0.8130
val Loss: 10.0794 Acc: 0.7188
Epoch 27/53
----------
train Loss: 1.4306 Acc: 0.8397
val Loss: 7.4006 Acc: 0.6719
Epoch 28/53
----------
train Loss: 1.7386 Acc: 0.8264
val Loss: 7.5409 Acc: 0.6641
Epoch 29/53
----------
train Loss: 1.7969 Acc: 0.8397
val Loss: 4.1100 Acc: 0.6250
Epoch 30/53
----------
train Loss: 1.7176 Acc: 0.8264
val Loss: 5.4742 Acc: 0.6562
Epoch 31/53
----------
train Loss: 1.4872 Acc: 0.8164
val Loss: 6.5676 Acc: 0.7734
Epoch 32/53
----------
train Loss: 1.4185 Acc: 0.8264
val Loss: 5.3325 Acc: 0.8281
Epoch 33/53
----------
train Loss: 1.0232 Acc: 0.8698
val Loss: 5.7391 Acc: 0.7734
Epoch 34/53
----------
train Loss: 2.0648 Acc: 0.8030
val Loss: 5.5511 Acc: 0.6875
Epoch 35/53
----------
train Loss: 1.8280 Acc: 0.7646
val Loss: 11.4510 Acc: 0.5312
Epoch 36/53
----------
train Loss: 1.5197 Acc: 0.8013
val Loss: 5.6410 Acc: 0.7500
Epoch 37/53
----------
train Loss: 1.1975 Acc: 0.8698
[I 2024-10-15 20:55:13,191] Trial 172 finished with value: 0.828125 and parameters: {'batch_size': 93, 'lr': 0.0007870730269312982, 'num_epochs': 53, 'weight_decay': 0.029957755578544902, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 8.7519 Acc: 0.5391
Early stopping at epoch 37 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.828125
Model weights saved at ./model_weights/ResNet34_bs_93_lr_0.0007870730269312982_epoch_53_wd_0.029957755578544902_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/56
----------
train Loss: 3.8942 Acc: 0.5593
val Loss: 4.8022 Acc: 0.7656
Epoch 2/56
----------
train Loss: 1.4619 Acc: 0.8097
val Loss: 4.5102 Acc: 0.8125
Epoch 3/56
----------
train Loss: 0.7983 Acc: 0.9182
val Loss: 3.9987 Acc: 0.7422
Epoch 4/56
----------
train Loss: 0.9706 Acc: 0.8715
val Loss: 4.8163 Acc: 0.7656
Epoch 5/56
----------
train Loss: 0.7029 Acc: 0.9449
val Loss: 3.8614 Acc: 0.6953
Epoch 6/56
----------
train Loss: 0.4604 Acc: 0.9382
val Loss: 5.5694 Acc: 0.7422
Epoch 7/56
----------
train Loss: 0.3460 Acc: 0.9683
val Loss: 5.5936 Acc: 0.7891
Epoch 8/56
----------
train Loss: 0.2520 Acc: 0.9800
val Loss: 5.8643 Acc: 0.6875
Epoch 9/56
----------
train Loss: 0.3534 Acc: 0.9599
val Loss: 7.1937 Acc: 0.7812
Epoch 10/56
----------
train Loss: 0.4433 Acc: 0.9549
val Loss: 5.2984 Acc: 0.7422
Epoch 11/56
----------
train Loss: 0.3516 Acc: 0.9449
val Loss: 8.1018 Acc: 0.7578
Epoch 12/56
----------
train Loss: 0.3414 Acc: 0.9633
val Loss: 4.6843 Acc: 0.7656
Epoch 13/56
----------
train Loss: 0.3739 Acc: 0.9482
val Loss: 6.3145 Acc: 0.7734
Epoch 14/56
----------
train Loss: 0.7063 Acc: 0.9265
val Loss: 5.1611 Acc: 0.6875
Epoch 15/56
----------
train Loss: 0.9294 Acc: 0.9115
val Loss: 11.4755 Acc: 0.7578
Epoch 16/56
----------
train Loss: 0.7511 Acc: 0.9065
val Loss: 4.2234 Acc: 0.8047
Epoch 17/56
----------
train Loss: 0.9277 Acc: 0.8948
val Loss: 3.8405 Acc: 0.7109
Epoch 18/56
----------
train Loss: 0.7862 Acc: 0.9082
val Loss: 4.7864 Acc: 0.7734
Epoch 19/56
----------
train Loss: 0.4296 Acc: 0.9633
val Loss: 5.3217 Acc: 0.7734
Epoch 20/56
----------
train Loss: 0.1532 Acc: 0.9900
val Loss: 5.9509 Acc: 0.8125
Epoch 21/56
----------
train Loss: 0.0673 Acc: 0.9900
val Loss: 5.5142 Acc: 0.8125
Epoch 22/56
----------
train Loss: 0.0574 Acc: 0.9950
val Loss: 5.8104 Acc: 0.7969
Epoch 23/56
----------
train Loss: 0.0596 Acc: 0.9967
val Loss: 5.8064 Acc: 0.7734
Epoch 24/56
----------
train Loss: 0.0268 Acc: 0.9967
val Loss: 6.0351 Acc: 0.7969
Epoch 25/56
----------
train Loss: 0.0254 Acc: 0.9983
val Loss: 6.2750 Acc: 0.7656
Epoch 26/56
----------
train Loss: 0.0202 Acc: 0.9983
val Loss: 6.1252 Acc: 0.7969
Epoch 27/56
----------
train Loss: 0.0137 Acc: 0.9983
val Loss: 5.9551 Acc: 0.7969
Epoch 28/56
----------
train Loss: 0.0796 Acc: 0.9900
val Loss: 5.1533 Acc: 0.8359
Epoch 29/56
----------
train Loss: 0.1140 Acc: 0.9883
val Loss: 5.3369 Acc: 0.7734
Epoch 30/56
----------
train Loss: 0.1952 Acc: 0.9783
val Loss: 5.1921 Acc: 0.8125
Epoch 31/56
----------
train Loss: 0.2529 Acc: 0.9766
val Loss: 5.0339 Acc: 0.7656
Epoch 32/56
----------
train Loss: 0.3066 Acc: 0.9633
val Loss: 4.7976 Acc: 0.8203
Epoch 33/56
----------
train Loss: 0.6184 Acc: 0.9482
val Loss: 4.4577 Acc: 0.6641
Epoch 34/56
----------
train Loss: 0.4638 Acc: 0.9599
val Loss: 4.3782 Acc: 0.6953
Epoch 35/56
----------
train Loss: 1.0362 Acc: 0.9032
val Loss: 5.7416 Acc: 0.7266
Epoch 36/56
----------
train Loss: 0.6906 Acc: 0.9199
val Loss: 7.8383 Acc: 0.7891
Epoch 37/56
----------
train Loss: 0.6423 Acc: 0.9432
val Loss: 6.9607 Acc: 0.4375
Epoch 38/56
----------
train Loss: 0.9975 Acc: 0.8932
val Loss: 8.7618 Acc: 0.7109
Epoch 39/56
----------
train Loss: 0.5675 Acc: 0.9432
val Loss: 5.0891 Acc: 0.7109
Epoch 40/56
----------
train Loss: 0.7797 Acc: 0.9182
val Loss: 4.8977 Acc: 0.7109
Epoch 41/56
----------
train Loss: 0.5689 Acc: 0.9282
val Loss: 3.9599 Acc: 0.7578
Epoch 42/56
----------
train Loss: 0.2532 Acc: 0.9733
val Loss: 6.3375 Acc: 0.8047
Epoch 43/56
----------
train Loss: 0.2811 Acc: 0.9633
val Loss: 5.4002 Acc: 0.7734
Epoch 44/56
----------
train Loss: 0.1308 Acc: 0.9833
val Loss: 3.6475 Acc: 0.7734
Epoch 45/56
----------
train Loss: 0.1013 Acc: 0.9850
val Loss: 5.0628 Acc: 0.7422
Epoch 46/56
----------
train Loss: 0.4317 Acc: 0.9583
val Loss: 4.8443 Acc: 0.7891
Epoch 47/56
----------
train Loss: 0.2022 Acc: 0.9716
val Loss: 5.1743 Acc: 0.7734
Epoch 48/56
----------
train Loss: 0.1969 Acc: 0.9866
val Loss: 4.2938 Acc: 0.7422
Epoch 49/56
----------
train Loss: 0.2619 Acc: 0.9816
val Loss: 7.0897 Acc: 0.7422
Epoch 50/56
----------
train Loss: 0.2565 Acc: 0.9783
val Loss: 3.7733 Acc: 0.7656
Epoch 51/56
----------
train Loss: 0.1527 Acc: 0.9816
val Loss: 9.0903 Acc: 0.7969
Epoch 52/56
----------
train Loss: 0.1402 Acc: 0.9733
val Loss: 7.0802 Acc: 0.8047
Epoch 53/56
----------
train Loss: 0.3528 Acc: 0.9683
val Loss: 6.1768 Acc: 0.7031
Epoch 54/56
----------
train Loss: 0.2060 Acc: 0.9800
val Loss: 6.0623 Acc: 0.8203
Epoch 55/56
----------
train Loss: 0.1324 Acc: 0.9850
val Loss: 6.7265 Acc: 0.7969
Epoch 56/56
----------
train Loss: 0.0441 Acc: 0.9983
[I 2024-10-15 20:59:23,719] Trial 173 finished with value: 0.796875 and parameters: {'batch_size': 109, 'lr': 0.00024054069722653424, 'num_epochs': 56, 'weight_decay': 0.017806803143565194, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 5.3077 Acc: 0.7969
Best val Acc: 0.796875
Model weights saved at ./model_weights/ResNet34_bs_109_lr_0.00024054069722653424_epoch_56_wd_0.017806803143565194_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/64
----------
train Loss: 4.3431 Acc: 0.5776
val Loss: 10.5622 Acc: 0.6875
Epoch 2/64
----------
train Loss: 2.4214 Acc: 0.7346
val Loss: 5.0475 Acc: 0.6797
Epoch 3/64
----------
train Loss: 2.1645 Acc: 0.7596
val Loss: 4.7781 Acc: 0.7422
Epoch 4/64
----------
train Loss: 1.1568 Acc: 0.8531
val Loss: 2.3382 Acc: 0.7500
Epoch 5/64
----------
train Loss: 1.0478 Acc: 0.8831
val Loss: 3.6484 Acc: 0.6719
Epoch 6/64
----------
train Loss: 0.7717 Acc: 0.9048
val Loss: 2.7333 Acc: 0.7344
Epoch 7/64
----------
train Loss: 0.8761 Acc: 0.9032
val Loss: 4.3627 Acc: 0.6562
Epoch 8/64
----------
train Loss: 0.9978 Acc: 0.8748
val Loss: 4.8379 Acc: 0.5703
Epoch 9/64
----------
train Loss: 1.1200 Acc: 0.8698
val Loss: 5.5024 Acc: 0.6641
Epoch 10/64
----------
train Loss: 1.2113 Acc: 0.8681
val Loss: 4.2192 Acc: 0.6250
Epoch 11/64
----------
train Loss: 1.4587 Acc: 0.8815
[I 2024-10-15 21:00:13,861] Trial 174 finished with value: 0.734375 and parameters: {'batch_size': 85, 'lr': 0.00039855283977112524, 'num_epochs': 64, 'weight_decay': 0.05052050260905564, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 2.5385 Acc: 0.6406
Early stopping at epoch 11 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.734375
Model weights saved at ./model_weights/ResNet34_bs_85_lr_0.00039855283977112524_epoch_64_wd_0.05052050260905564_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/58
----------
train Loss: 4.2818 Acc: 0.4374
val Loss: 3.0057 Acc: 0.7812
Epoch 2/58
----------
train Loss: 1.0958 Acc: 0.8781
val Loss: 3.0774 Acc: 0.8281
Epoch 3/58
----------
train Loss: 0.3638 Acc: 0.9566
val Loss: 2.5082 Acc: 0.8359
Epoch 4/58
----------
train Loss: 0.2987 Acc: 0.9633
val Loss: 2.6997 Acc: 0.7812
Epoch 5/58
----------
train Loss: 0.3570 Acc: 0.9783
val Loss: 3.4292 Acc: 0.8438
Epoch 6/58
----------
train Loss: 0.2127 Acc: 0.9800
val Loss: 4.0412 Acc: 0.8359
Epoch 7/58
----------
train Loss: 0.1119 Acc: 0.9900
val Loss: 3.3052 Acc: 0.8438
Epoch 8/58
----------
train Loss: 0.1775 Acc: 0.9850
val Loss: 5.5808 Acc: 0.7812
Epoch 9/58
----------
train Loss: 0.3879 Acc: 0.9583
val Loss: 5.1898 Acc: 0.8047
Epoch 10/58
----------
train Loss: 0.7409 Acc: 0.9115
val Loss: 3.6029 Acc: 0.7500
Epoch 11/58
----------
train Loss: 0.7381 Acc: 0.9232
val Loss: 4.2948 Acc: 0.6562
Epoch 12/58
----------
train Loss: 1.4237 Acc: 0.8965
val Loss: 2.7496 Acc: 0.8047
Epoch 13/58
----------
train Loss: 0.7011 Acc: 0.9182
val Loss: 4.7194 Acc: 0.7891
Epoch 14/58
----------
train Loss: 0.2592 Acc: 0.9699
val Loss: 3.4897 Acc: 0.7891
Epoch 15/58
----------
train Loss: 0.2107 Acc: 0.9783
val Loss: 3.5894 Acc: 0.8203
Epoch 16/58
----------
train Loss: 0.1990 Acc: 0.9683
val Loss: 3.3699 Acc: 0.8281
Epoch 17/58
----------
train Loss: 0.3343 Acc: 0.9649
val Loss: 3.3041 Acc: 0.7734
Epoch 18/58
----------
train Loss: 0.1899 Acc: 0.9800
val Loss: 4.1457 Acc: 0.8281
Epoch 19/58
----------
train Loss: 0.1285 Acc: 0.9866
val Loss: 3.3919 Acc: 0.8203
Epoch 20/58
----------
train Loss: 0.0763 Acc: 0.9950
val Loss: 3.0012 Acc: 0.8281
Epoch 21/58
----------
train Loss: 0.0589 Acc: 0.9950
val Loss: 3.3787 Acc: 0.8359
Epoch 22/58
----------
train Loss: 0.0354 Acc: 0.9950
val Loss: 3.4100 Acc: 0.8359
Epoch 23/58
----------
train Loss: 0.0208 Acc: 0.9967
val Loss: 3.5368 Acc: 0.8281
Epoch 24/58
----------
train Loss: 0.0238 Acc: 0.9967
val Loss: 3.6439 Acc: 0.8359
Epoch 25/58
----------
train Loss: 0.0253 Acc: 0.9967
val Loss: 3.7101 Acc: 0.8359
Epoch 26/58
----------
train Loss: 0.0170 Acc: 0.9967
val Loss: 3.5987 Acc: 0.8359
Epoch 27/58
----------
train Loss: 0.0421 Acc: 0.9967
val Loss: 4.8459 Acc: 0.8438
Epoch 28/58
----------
train Loss: 0.0270 Acc: 0.9967
val Loss: 4.0953 Acc: 0.8672
Epoch 29/58
----------
train Loss: 0.0256 Acc: 0.9967
val Loss: 4.0982 Acc: 0.8438
Epoch 30/58
----------
train Loss: 0.0199 Acc: 0.9967
val Loss: 4.1230 Acc: 0.8672
Epoch 31/58
----------
train Loss: 0.0445 Acc: 0.9917
val Loss: 3.0546 Acc: 0.7891
Epoch 32/58
----------
train Loss: 0.2502 Acc: 0.9683
val Loss: 4.1674 Acc: 0.7969
Epoch 33/58
----------
train Loss: 1.5092 Acc: 0.8898
val Loss: 5.0134 Acc: 0.6016
Epoch 34/58
----------
train Loss: 2.3774 Acc: 0.7846
val Loss: 5.7888 Acc: 0.6875
Epoch 35/58
----------
train Loss: 2.0814 Acc: 0.8481
[I 2024-10-15 21:02:50,159] Trial 175 finished with value: 0.8671875 and parameters: {'batch_size': 96, 'lr': 0.00014490295139282436, 'num_epochs': 58, 'weight_decay': 0.03793898763946246, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 2.7544 Acc: 0.7344
Early stopping at epoch 35 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.867188
Model weights saved at ./model_weights/ResNet34_bs_96_lr_0.00014490295139282436_epoch_58_wd_0.03793898763946246_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/51
----------
train Loss: 4.8112 Acc: 0.4925
val Loss: 13.2126 Acc: 0.3516
Epoch 2/51
----------
train Loss: 3.7299 Acc: 0.6160
val Loss: 6.4470 Acc: 0.2109
Epoch 3/51
----------
train Loss: 2.8593 Acc: 0.7062
val Loss: 4.9341 Acc: 0.6719
Epoch 4/51
----------
train Loss: 2.4411 Acc: 0.7730
val Loss: 5.4914 Acc: 0.5938
Epoch 5/51
----------
train Loss: 1.5138 Acc: 0.8230
val Loss: 3.4488 Acc: 0.6094
Epoch 6/51
----------
train Loss: 1.5824 Acc: 0.8414
val Loss: 5.8495 Acc: 0.7109
Epoch 7/51
----------
train Loss: 1.4069 Acc: 0.8481
val Loss: 5.7803 Acc: 0.7422
Epoch 8/51
----------
train Loss: 1.2403 Acc: 0.8514
val Loss: 5.3045 Acc: 0.5703
Epoch 9/51
----------
train Loss: 1.2662 Acc: 0.8765
val Loss: 7.7985 Acc: 0.4375
Epoch 10/51
----------
train Loss: 1.0424 Acc: 0.8881
val Loss: 6.1802 Acc: 0.6016
Epoch 11/51
----------
train Loss: 1.7263 Acc: 0.8264
val Loss: 22.2439 Acc: 0.5391
Epoch 12/51
----------
train Loss: 1.6787 Acc: 0.7913
[I 2024-10-15 21:03:44,438] Trial 176 finished with value: 0.7421875 and parameters: {'batch_size': 91, 'lr': 0.0005511782633132964, 'num_epochs': 51, 'weight_decay': 0.02188597847673603, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 4.2565 Acc: 0.6797
Early stopping at epoch 12 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.742188
Model weights saved at ./model_weights/ResNet34_bs_91_lr_0.0005511782633132964_epoch_51_wd_0.02188597847673603_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/54
----------
train Loss: 0.8252 Acc: 0.6811
val Loss: 0.4898 Acc: 0.8047
Epoch 2/54
----------
train Loss: 0.2343 Acc: 0.9366
val Loss: 0.6484 Acc: 0.7969
Epoch 3/54
----------
train Loss: 0.1144 Acc: 0.9566
val Loss: 0.4681 Acc: 0.8359
Epoch 4/54
----------
train Loss: 0.0880 Acc: 0.9716
val Loss: 0.6745 Acc: 0.8125
Epoch 5/54
----------
train Loss: 0.0714 Acc: 0.9800
val Loss: 0.6502 Acc: 0.8438
Epoch 6/54
----------
train Loss: 0.0912 Acc: 0.9683
val Loss: 0.5220 Acc: 0.8672
Epoch 7/54
----------
train Loss: 0.1053 Acc: 0.9699
val Loss: 0.7530 Acc: 0.8281
Epoch 8/54
----------
train Loss: 0.1125 Acc: 0.9599
val Loss: 0.7970 Acc: 0.8359
Epoch 9/54
----------
train Loss: 0.0692 Acc: 0.9716
val Loss: 0.7056 Acc: 0.8359
Epoch 10/54
----------
train Loss: 0.0796 Acc: 0.9716
val Loss: 0.9341 Acc: 0.7969
Epoch 11/54
----------
train Loss: 0.0487 Acc: 0.9800
val Loss: 0.8656 Acc: 0.8203
Epoch 12/54
----------
train Loss: 0.0701 Acc: 0.9750
val Loss: 1.0293 Acc: 0.7969
Epoch 13/54
----------
train Loss: 0.0407 Acc: 0.9866
val Loss: 0.8153 Acc: 0.8438
Epoch 14/54
----------
train Loss: 0.0280 Acc: 0.9883
val Loss: 0.6427 Acc: 0.8516
Epoch 15/54
----------
train Loss: 0.0314 Acc: 0.9883
val Loss: 0.7825 Acc: 0.8438
Epoch 16/54
----------
train Loss: 0.0108 Acc: 0.9983
val Loss: 0.6869 Acc: 0.8438
Epoch 17/54
----------
train Loss: 0.0233 Acc: 0.9917
val Loss: 0.5690 Acc: 0.8359
Epoch 18/54
----------
train Loss: 0.0145 Acc: 0.9950
val Loss: 0.6747 Acc: 0.8594
Epoch 19/54
----------
train Loss: 0.0434 Acc: 0.9833
val Loss: 0.8772 Acc: 0.8438
Epoch 20/54
----------
train Loss: 0.0550 Acc: 0.9783
val Loss: 1.0642 Acc: 0.7812
Epoch 21/54
----------
train Loss: 0.0204 Acc: 0.9900
val Loss: 0.9334 Acc: 0.8359
Epoch 22/54
----------
train Loss: 0.0311 Acc: 0.9866
val Loss: 0.5424 Acc: 0.8516
Epoch 23/54
----------
train Loss: 0.0354 Acc: 0.9866
val Loss: 0.9004 Acc: 0.8047
Epoch 24/54
----------
train Loss: 0.0163 Acc: 0.9967
val Loss: 0.6133 Acc: 0.8750
Epoch 25/54
----------
train Loss: 0.0376 Acc: 0.9833
val Loss: 0.6693 Acc: 0.8281
Epoch 26/54
----------
train Loss: 0.0684 Acc: 0.9699
val Loss: 0.5677 Acc: 0.8516
Epoch 27/54
----------
train Loss: 0.0846 Acc: 0.9633
val Loss: 0.6882 Acc: 0.8438
Epoch 28/54
----------
train Loss: 0.1128 Acc: 0.9633
val Loss: 1.2420 Acc: 0.7656
Epoch 29/54
----------
train Loss: 0.0813 Acc: 0.9716
val Loss: 0.5042 Acc: 0.8203
Epoch 30/54
----------
train Loss: 0.0606 Acc: 0.9800
val Loss: 0.5470 Acc: 0.8594
Epoch 31/54
----------
train Loss: 0.0319 Acc: 0.9917
val Loss: 0.6830 Acc: 0.8438
Epoch 32/54
----------
train Loss: 0.0389 Acc: 0.9850
val Loss: 0.8047 Acc: 0.8203
Epoch 33/54
----------
train Loss: 0.0282 Acc: 0.9900
val Loss: 0.7029 Acc: 0.8516
Epoch 34/54
----------
train Loss: 0.0289 Acc: 0.9933
val Loss: 0.5958 Acc: 0.8750
Epoch 35/54
----------
train Loss: 0.0140 Acc: 0.9950
val Loss: 0.5659 Acc: 0.8594
Epoch 36/54
----------
train Loss: 0.0293 Acc: 0.9900
val Loss: 1.0787 Acc: 0.7734
Epoch 37/54
----------
train Loss: 0.0224 Acc: 0.9950
val Loss: 0.6960 Acc: 0.8438
Epoch 38/54
----------
train Loss: 0.0151 Acc: 0.9950
val Loss: 0.6403 Acc: 0.8281
Epoch 39/54
----------
train Loss: 0.0151 Acc: 0.9933
val Loss: 0.6368 Acc: 0.8594
Epoch 40/54
----------
train Loss: 0.0137 Acc: 0.9950
val Loss: 0.7969 Acc: 0.8438
Epoch 41/54
----------
train Loss: 0.0159 Acc: 0.9900
val Loss: 0.6730 Acc: 0.8438
Epoch 42/54
----------
train Loss: 0.0113 Acc: 0.9967
val Loss: 0.6052 Acc: 0.8594
Epoch 43/54
----------
train Loss: 0.0055 Acc: 0.9983
val Loss: 0.6038 Acc: 0.8750
Epoch 44/54
----------
train Loss: 0.0070 Acc: 0.9950
val Loss: 0.7074 Acc: 0.8516
Epoch 45/54
----------
train Loss: 0.0037 Acc: 0.9983
val Loss: 0.6182 Acc: 0.8594
Epoch 46/54
----------
train Loss: 0.0061 Acc: 0.9967
val Loss: 0.5870 Acc: 0.8594
Epoch 47/54
----------
train Loss: 0.0041 Acc: 0.9983
val Loss: 0.6151 Acc: 0.8672
Epoch 48/54
----------
train Loss: 0.0036 Acc: 0.9983
val Loss: 0.6322 Acc: 0.8594
Epoch 49/54
----------
train Loss: 0.0036 Acc: 0.9983
val Loss: 0.6636 Acc: 0.8594
Epoch 50/54
----------
train Loss: 0.0061 Acc: 0.9950
val Loss: 0.8597 Acc: 0.8281
Epoch 51/54
----------
train Loss: 0.0044 Acc: 0.9983
val Loss: 0.7587 Acc: 0.8516
Epoch 52/54
----------
train Loss: 0.0039 Acc: 0.9967
val Loss: 0.7307 Acc: 0.8594
Epoch 53/54
----------
train Loss: 0.0041 Acc: 0.9967
val Loss: 0.7143 Acc: 0.8594
Epoch 54/54
----------
train Loss: 0.0039 Acc: 0.9967
[I 2024-10-15 21:07:46,179] Trial 177 finished with value: 0.859375 and parameters: {'batch_size': 103, 'lr': 0.000181937277855708, 'num_epochs': 54, 'weight_decay': 0.0010638402321536465, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 0.7229 Acc: 0.8594
Best val Acc: 0.859375
Model weights saved at ./model_weights/ResNet34_bs_103_lr_0.000181937277855708_epoch_54_wd_0.0010638402321536465_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/61
----------
train Loss: 3.8413 Acc: 0.5225
val Loss: 1.4659 Acc: 0.7812
Epoch 2/61
----------
train Loss: 1.3497 Acc: 0.8364
val Loss: 1.2859 Acc: 0.8125
Epoch 3/61
----------
train Loss: 0.7430 Acc: 0.8982
val Loss: 1.5522 Acc: 0.8516
Epoch 4/61
----------
train Loss: 0.5493 Acc: 0.9449
val Loss: 2.4437 Acc: 0.8594
Epoch 5/61
----------
train Loss: 0.3021 Acc: 0.9549
val Loss: 2.3221 Acc: 0.8672
Epoch 6/61
----------
train Loss: 0.2349 Acc: 0.9783
val Loss: 1.5505 Acc: 0.8594
Epoch 7/61
----------
train Loss: 0.1599 Acc: 0.9816
val Loss: 1.7381 Acc: 0.8906
Epoch 8/61
----------
train Loss: 0.1149 Acc: 0.9883
val Loss: 2.7940 Acc: 0.8984
Epoch 9/61
----------
train Loss: 0.1080 Acc: 0.9833
val Loss: 1.6111 Acc: 0.8672
Epoch 10/61
----------
train Loss: 0.1042 Acc: 0.9883
val Loss: 2.6712 Acc: 0.7031
Epoch 11/61
----------
train Loss: 0.4171 Acc: 0.9533
val Loss: 6.3419 Acc: 0.6016
Epoch 12/61
----------
train Loss: 1.1224 Acc: 0.8831
val Loss: 5.3488 Acc: 0.8125
Epoch 13/61
----------
train Loss: 1.2276 Acc: 0.8798
val Loss: 5.2615 Acc: 0.8359
Epoch 14/61
----------
train Loss: 1.4273 Acc: 0.8564
val Loss: 2.0231 Acc: 0.8359
Epoch 15/61
----------
train Loss: 0.5994 Acc: 0.9349
val Loss: 1.6877 Acc: 0.8594
Epoch 16/61
----------
train Loss: 0.2322 Acc: 0.9666
val Loss: 1.8019 Acc: 0.8750
Epoch 17/61
----------
train Loss: 0.1656 Acc: 0.9816
val Loss: 1.7352 Acc: 0.8438
Epoch 18/61
----------
train Loss: 0.1214 Acc: 0.9816
val Loss: 2.4533 Acc: 0.8516
Epoch 19/61
----------
train Loss: 0.1147 Acc: 0.9917
val Loss: 2.6213 Acc: 0.8828
Epoch 20/61
----------
train Loss: 0.0762 Acc: 0.9883
val Loss: 2.3365 Acc: 0.8516
Epoch 21/61
----------
train Loss: 0.0709 Acc: 0.9883
val Loss: 2.4577 Acc: 0.8750
Epoch 22/61
----------
train Loss: 0.0726 Acc: 0.9900
val Loss: 2.6506 Acc: 0.8984
Epoch 23/61
----------
train Loss: 0.0476 Acc: 0.9950
val Loss: 1.9692 Acc: 0.8750
Epoch 24/61
----------
train Loss: 0.0362 Acc: 0.9950
val Loss: 1.9584 Acc: 0.8672
Epoch 25/61
----------
train Loss: 0.0670 Acc: 0.9917
val Loss: 2.5389 Acc: 0.8750
Epoch 26/61
----------
train Loss: 0.0523 Acc: 0.9933
val Loss: 2.4664 Acc: 0.8828
Epoch 27/61
----------
train Loss: 0.0632 Acc: 0.9917
val Loss: 2.4068 Acc: 0.8516
Epoch 28/61
----------
train Loss: 0.0336 Acc: 0.9950
val Loss: 2.3739 Acc: 0.8750
Epoch 29/61
----------
train Loss: 0.0337 Acc: 0.9950
val Loss: 2.4764 Acc: 0.8828
Epoch 30/61
----------
train Loss: 0.0268 Acc: 0.9950
val Loss: 2.4847 Acc: 0.8828
Epoch 31/61
----------
train Loss: 0.0262 Acc: 0.9950
val Loss: 2.6843 Acc: 0.8906
Epoch 32/61
----------
train Loss: 0.0262 Acc: 0.9950
val Loss: 2.8870 Acc: 0.8906
Epoch 33/61
----------
train Loss: 0.0293 Acc: 0.9950
val Loss: 2.9665 Acc: 0.8828
Epoch 34/61
----------
train Loss: 0.0276 Acc: 0.9950
val Loss: 2.9819 Acc: 0.8750
Epoch 35/61
----------
train Loss: 0.0276 Acc: 0.9950
val Loss: 2.9652 Acc: 0.8828
Epoch 36/61
----------
train Loss: 0.0269 Acc: 0.9950
val Loss: 2.8189 Acc: 0.8984
Epoch 37/61
----------
train Loss: 0.0274 Acc: 0.9950
val Loss: 3.1078 Acc: 0.8828
Epoch 38/61
----------
train Loss: 0.0310 Acc: 0.9950
val Loss: 4.1208 Acc: 0.8828
Epoch 39/61
----------
train Loss: 0.4350 Acc: 0.9583
val Loss: 15.0200 Acc: 0.6094
Epoch 40/61
----------
train Loss: 3.3401 Acc: 0.7095
val Loss: 3.7445 Acc: 0.4297
Epoch 41/61
----------
train Loss: 2.4217 Acc: 0.7229
val Loss: 9.7591 Acc: 0.3906
Epoch 42/61
----------
train Loss: 2.5669 Acc: 0.7679
val Loss: 4.0500 Acc: 0.7109
Epoch 43/61
----------
train Loss: 1.5534 Acc: 0.7796
val Loss: 1.9302 Acc: 0.8594
Epoch 44/61
----------
train Loss: 0.7103 Acc: 0.9182
val Loss: 2.0132 Acc: 0.7891
Epoch 45/61
----------
train Loss: 0.5755 Acc: 0.9265
val Loss: 1.8710 Acc: 0.8906
Epoch 46/61
----------
train Loss: 0.4469 Acc: 0.9349
val Loss: 1.5043 Acc: 0.9219
Epoch 47/61
----------
train Loss: 0.3815 Acc: 0.9499
val Loss: 1.8055 Acc: 0.9062
Epoch 48/61
----------
train Loss: 0.1928 Acc: 0.9733
val Loss: 1.6818 Acc: 0.8750
Epoch 49/61
----------
train Loss: 0.1069 Acc: 0.9933
val Loss: 1.6316 Acc: 0.8594
Epoch 50/61
----------
train Loss: 0.0617 Acc: 0.9950
val Loss: 1.8340 Acc: 0.9141
Epoch 51/61
----------
train Loss: 0.0443 Acc: 0.9950
val Loss: 2.2717 Acc: 0.8906
Epoch 52/61
----------
train Loss: 0.0966 Acc: 0.9883
val Loss: 1.8699 Acc: 0.9062
Epoch 53/61
----------
train Loss: 0.0975 Acc: 0.9833
val Loss: 1.3877 Acc: 0.8828
Epoch 54/61
----------
train Loss: 0.1224 Acc: 0.9900
val Loss: 1.5758 Acc: 0.9062
Epoch 55/61
----------
train Loss: 0.0695 Acc: 0.9933
val Loss: 1.7613 Acc: 0.9219
Epoch 56/61
----------
train Loss: 0.0612 Acc: 0.9917
val Loss: 1.7807 Acc: 0.9219
Epoch 57/61
----------
train Loss: 0.0936 Acc: 0.9900
val Loss: 1.8933 Acc: 0.8750
Epoch 58/61
----------
train Loss: 0.0811 Acc: 0.9850
val Loss: 1.6360 Acc: 0.8750
Epoch 59/61
----------
train Loss: 0.1089 Acc: 0.9900
val Loss: 3.0119 Acc: 0.8359
Epoch 60/61
----------
train Loss: 0.2217 Acc: 0.9750
val Loss: 6.8551 Acc: 0.7266
Epoch 61/61
----------
train Loss: 0.3190 Acc: 0.9666
[I 2024-10-15 21:12:19,521] Trial 178 finished with value: 0.8671875 and parameters: {'batch_size': 83, 'lr': 0.000208632571309203, 'num_epochs': 61, 'weight_decay': 0.015724418542610228, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 3.6328 Acc: 0.8672
Best val Acc: 0.867188
Model weights saved at ./model_weights/ResNet34_bs_83_lr_0.000208632571309203_epoch_61_wd_0.015724418542610228_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/49
----------
train Loss: 6.2374 Acc: 0.2471
val Loss: 4.9145 Acc: 0.2734
Epoch 2/49
----------
train Loss: 5.6085 Acc: 0.3055
val Loss: 4.7906 Acc: 0.3672
Epoch 3/49
----------
train Loss: 5.0255 Acc: 0.3756
val Loss: 4.6389 Acc: 0.3750
Epoch 4/49
----------
train Loss: 4.5472 Acc: 0.4324
val Loss: 4.4765 Acc: 0.4141
Epoch 5/49
----------
train Loss: 4.1658 Acc: 0.5058
val Loss: 4.3274 Acc: 0.4844
Epoch 6/49
----------
train Loss: 3.8633 Acc: 0.5526
val Loss: 4.2219 Acc: 0.5234
Epoch 7/49
----------
train Loss: 3.5618 Acc: 0.6144
val Loss: 4.1388 Acc: 0.5391
Epoch 8/49
----------
train Loss: 3.2735 Acc: 0.6578
val Loss: 4.0364 Acc: 0.5312
Epoch 9/49
----------
train Loss: 3.0244 Acc: 0.6845
val Loss: 3.9599 Acc: 0.5391
Epoch 10/49
----------
train Loss: 2.7559 Acc: 0.7129
val Loss: 3.8903 Acc: 0.5547
Epoch 11/49
----------
train Loss: 2.5750 Acc: 0.7346
val Loss: 3.8305 Acc: 0.5625
Epoch 12/49
----------
train Loss: 2.3730 Acc: 0.7713
val Loss: 3.7747 Acc: 0.5859
Epoch 13/49
----------
train Loss: 2.2083 Acc: 0.7880
val Loss: 3.7221 Acc: 0.6094
Epoch 14/49
----------
train Loss: 2.0691 Acc: 0.8197
val Loss: 3.7026 Acc: 0.6250
Epoch 15/49
----------
train Loss: 1.9428 Acc: 0.8080
val Loss: 3.6289 Acc: 0.6328
Epoch 16/49
----------
train Loss: 1.7943 Acc: 0.8381
val Loss: 3.6165 Acc: 0.6641
Epoch 17/49
----------
train Loss: 1.6872 Acc: 0.8614
val Loss: 3.5602 Acc: 0.6641
Epoch 18/49
----------
train Loss: 1.5349 Acc: 0.8664
val Loss: 3.5280 Acc: 0.6641
Epoch 19/49
----------
train Loss: 1.4973 Acc: 0.8715
val Loss: 3.5166 Acc: 0.6875
Epoch 20/49
----------
train Loss: 1.4099 Acc: 0.8648
val Loss: 3.4688 Acc: 0.6875
Epoch 21/49
----------
train Loss: 1.3133 Acc: 0.8915
val Loss: 3.4550 Acc: 0.6875
Epoch 22/49
----------
train Loss: 1.2189 Acc: 0.9065
val Loss: 3.4353 Acc: 0.7031
Epoch 23/49
----------
train Loss: 1.1393 Acc: 0.9199
val Loss: 3.4300 Acc: 0.7266
Epoch 24/49
----------
train Loss: 1.1243 Acc: 0.9215
val Loss: 3.4362 Acc: 0.7344
Epoch 25/49
----------
train Loss: 1.0029 Acc: 0.9449
val Loss: 3.3810 Acc: 0.7266
Epoch 26/49
----------
train Loss: 0.9488 Acc: 0.9332
val Loss: 3.3646 Acc: 0.7422
Epoch 27/49
----------
train Loss: 0.8870 Acc: 0.9533
val Loss: 3.3971 Acc: 0.7422
Epoch 28/49
----------
train Loss: 0.8432 Acc: 0.9482
val Loss: 3.3794 Acc: 0.7500
Epoch 29/49
----------
train Loss: 0.8442 Acc: 0.9499
val Loss: 3.3745 Acc: 0.7500
Epoch 30/49
----------
train Loss: 0.7321 Acc: 0.9649
val Loss: 3.3606 Acc: 0.7500
Epoch 31/49
----------
train Loss: 0.6934 Acc: 0.9633
val Loss: 3.3447 Acc: 0.7422
Epoch 32/49
----------
train Loss: 0.7053 Acc: 0.9649
val Loss: 3.3740 Acc: 0.7422
Epoch 33/49
----------
train Loss: 0.6237 Acc: 0.9783
val Loss: 3.3466 Acc: 0.7500
Epoch 34/49
----------
train Loss: 0.6066 Acc: 0.9716
val Loss: 3.3670 Acc: 0.7422
Epoch 35/49
----------
train Loss: 0.5599 Acc: 0.9816
val Loss: 3.3796 Acc: 0.7344
Epoch 36/49
----------
train Loss: 0.5438 Acc: 0.9866
val Loss: 3.3738 Acc: 0.7500
Epoch 37/49
----------
train Loss: 0.4893 Acc: 0.9883
val Loss: 3.4080 Acc: 0.7422
Epoch 38/49
----------
train Loss: 0.4681 Acc: 0.9900
val Loss: 3.3814 Acc: 0.7422
Epoch 39/49
----------
train Loss: 0.4548 Acc: 0.9917
val Loss: 3.3945 Acc: 0.7500
Epoch 40/49
----------
train Loss: 0.4517 Acc: 0.9866
val Loss: 3.4058 Acc: 0.7500
Epoch 41/49
----------
train Loss: 0.4121 Acc: 0.9983
val Loss: 3.4484 Acc: 0.7422
Epoch 42/49
----------
train Loss: 0.4039 Acc: 0.9950
val Loss: 3.4216 Acc: 0.7500
Epoch 43/49
----------
train Loss: 0.3833 Acc: 0.9967
val Loss: 3.4842 Acc: 0.7734
Epoch 44/49
----------
train Loss: 0.3715 Acc: 0.9950
val Loss: 3.4694 Acc: 0.7500
Epoch 45/49
----------
train Loss: 0.3603 Acc: 0.9933
val Loss: 3.5077 Acc: 0.7500
Epoch 46/49
----------
train Loss: 0.3278 Acc: 0.9950
val Loss: 3.5189 Acc: 0.7500
Epoch 47/49
----------
train Loss: 0.3107 Acc: 0.9983
val Loss: 3.5404 Acc: 0.7656
Epoch 48/49
----------
train Loss: 0.3344 Acc: 0.9967
val Loss: 3.5545 Acc: 0.7500
Epoch 49/49
----------
train Loss: 0.3026 Acc: 0.9983
[I 2024-10-15 21:15:59,031] Trial 179 finished with value: 0.7578125 and parameters: {'batch_size': 94, 'lr': 2.431552746841234e-06, 'num_epochs': 49, 'weight_decay': 0.0793793938415419, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 3.6017 Acc: 0.7578
Best val Acc: 0.757812
Model weights saved at ./model_weights/ResNet34_bs_94_lr_2.431552746841234e-06_epoch_49_wd_0.0793793938415419_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/47
----------
train Loss: 3.6838 Acc: 0.6127
val Loss: 3.1068 Acc: 0.7188
Epoch 2/47
----------
train Loss: 2.0304 Acc: 0.8063
val Loss: 4.7226 Acc: 0.5547
Epoch 3/47
----------
train Loss: 1.4334 Acc: 0.8531
val Loss: 1.9879 Acc: 0.7188
Epoch 4/47
----------
train Loss: 0.8072 Acc: 0.8731
val Loss: 3.0193 Acc: 0.7500
Epoch 5/47
----------
train Loss: 0.4689 Acc: 0.9316
val Loss: 2.3320 Acc: 0.8047
Epoch 6/47
----------
train Loss: 0.4658 Acc: 0.9533
val Loss: 3.1555 Acc: 0.7891
Epoch 7/47
----------
train Loss: 0.6382 Acc: 0.9165
val Loss: 4.4803 Acc: 0.7734
Epoch 8/47
----------
train Loss: 0.8173 Acc: 0.9199
val Loss: 4.0497 Acc: 0.3906
Epoch 9/47
----------
train Loss: 1.6159 Acc: 0.8147
val Loss: 9.9785 Acc: 0.4922
Epoch 10/47
----------
train Loss: 1.7990 Acc: 0.8247
val Loss: 2.7660 Acc: 0.7422
Epoch 11/47
----------
train Loss: 1.1392 Acc: 0.8531
val Loss: 2.9000 Acc: 0.6641
Epoch 12/47
----------
train Loss: 0.6940 Acc: 0.9165
val Loss: 4.1411 Acc: 0.7422
Epoch 13/47
----------
train Loss: 1.0254 Acc: 0.9215
val Loss: 5.5764 Acc: 0.5938
Epoch 14/47
----------
train Loss: 0.8249 Acc: 0.8881
val Loss: 4.2360 Acc: 0.8281
Epoch 15/47
----------
train Loss: 0.4623 Acc: 0.9199
val Loss: 3.5222 Acc: 0.6406
Epoch 16/47
----------
train Loss: 0.2482 Acc: 0.9683
val Loss: 2.3051 Acc: 0.8594
Epoch 17/47
----------
train Loss: 0.2406 Acc: 0.9666
val Loss: 3.3268 Acc: 0.8281
Epoch 18/47
----------
train Loss: 0.3393 Acc: 0.9566
val Loss: 2.5746 Acc: 0.8203
Epoch 19/47
----------
train Loss: 0.6012 Acc: 0.9666
val Loss: 3.9648 Acc: 0.8281
Epoch 20/47
----------
train Loss: 0.5625 Acc: 0.9449
val Loss: 4.9980 Acc: 0.7500
Epoch 21/47
----------
train Loss: 0.6736 Acc: 0.9115
val Loss: 6.4285 Acc: 0.8359
Epoch 22/47
----------
train Loss: 0.7489 Acc: 0.9249
val Loss: 7.6646 Acc: 0.3984
Epoch 23/47
----------
train Loss: 1.3798 Acc: 0.8664
val Loss: 7.2173 Acc: 0.6406
Epoch 24/47
----------
train Loss: 1.3339 Acc: 0.8581
val Loss: 6.2076 Acc: 0.6641
Epoch 25/47
----------
train Loss: 0.9791 Acc: 0.8982
val Loss: 4.4069 Acc: 0.4688
Epoch 26/47
----------
train Loss: 0.9368 Acc: 0.9115
[I 2024-10-15 21:17:56,422] Trial 180 finished with value: 0.8359375 and parameters: {'batch_size': 69, 'lr': 0.000297497808354925, 'num_epochs': 47, 'weight_decay': 0.04601389882372583, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 3.2442 Acc: 0.7266
Early stopping at epoch 26 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.835938
Model weights saved at ./model_weights/ResNet34_bs_69_lr_0.000297497808354925_epoch_47_wd_0.04601389882372583_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/51
----------
train Loss: 4.2603 Acc: 0.5943
val Loss: 4.7031 Acc: 0.3359
Epoch 2/51
----------
train Loss: 2.1110 Acc: 0.8047
val Loss: 3.7921 Acc: 0.6484
Epoch 3/51
----------
train Loss: 1.2160 Acc: 0.8681
val Loss: 3.3179 Acc: 0.6484
Epoch 4/51
----------
train Loss: 0.6413 Acc: 0.9232
val Loss: 2.2417 Acc: 0.8516
Epoch 5/51
----------
train Loss: 0.5080 Acc: 0.9533
val Loss: 2.8468 Acc: 0.7266
Epoch 6/51
----------
train Loss: 0.6847 Acc: 0.8998
val Loss: 2.8784 Acc: 0.7891
Epoch 7/51
----------
train Loss: 0.4446 Acc: 0.9382
val Loss: 3.3684 Acc: 0.8359
Epoch 8/51
----------
train Loss: 0.6586 Acc: 0.9399
val Loss: 2.6692 Acc: 0.6328
Epoch 9/51
----------
train Loss: 0.6866 Acc: 0.9165
val Loss: 1.8593 Acc: 0.8281
Epoch 10/51
----------
train Loss: 0.9297 Acc: 0.8982
val Loss: 8.9581 Acc: 0.4141
Epoch 11/51
----------
train Loss: 1.9368 Acc: 0.8497
val Loss: 7.4957 Acc: 0.6406
Epoch 12/51
----------
train Loss: 1.7554 Acc: 0.8548
val Loss: 3.9147 Acc: 0.7188
Epoch 13/51
----------
train Loss: 0.9668 Acc: 0.9115
val Loss: 5.0195 Acc: 0.8203
Epoch 14/51
----------
train Loss: 1.0140 Acc: 0.8965
val Loss: 2.2840 Acc: 0.7734
Epoch 15/51
----------
train Loss: 0.7932 Acc: 0.9165
val Loss: 4.6600 Acc: 0.6562
Epoch 16/51
----------
train Loss: 0.8915 Acc: 0.9015
val Loss: 2.1522 Acc: 0.8203
Epoch 17/51
----------
train Loss: 0.4121 Acc: 0.9566
val Loss: 2.9261 Acc: 0.8125
Epoch 18/51
----------
train Loss: 0.2667 Acc: 0.9833
val Loss: 4.3089 Acc: 0.8359
Epoch 19/51
----------
train Loss: 0.3956 Acc: 0.9282
val Loss: 4.1676 Acc: 0.8438
Epoch 20/51
----------
train Loss: 0.1948 Acc: 0.9766
val Loss: 3.7577 Acc: 0.8594
Epoch 21/51
----------
train Loss: 0.0827 Acc: 0.9917
val Loss: 3.2456 Acc: 0.8828
Epoch 22/51
----------
train Loss: 0.1958 Acc: 0.9766
val Loss: 4.6611 Acc: 0.8594
Epoch 23/51
----------
train Loss: 0.3477 Acc: 0.9683
val Loss: 5.4069 Acc: 0.7031
Epoch 24/51
----------
train Loss: 0.6630 Acc: 0.9282
val Loss: 4.3300 Acc: 0.8281
Epoch 25/51
----------
train Loss: 1.2750 Acc: 0.8865
val Loss: 21.3380 Acc: 0.3750
Epoch 26/51
----------
train Loss: 1.0651 Acc: 0.8865
val Loss: 6.6382 Acc: 0.6250
Epoch 27/51
----------
train Loss: 0.6880 Acc: 0.9115
val Loss: 4.3697 Acc: 0.7891
Epoch 28/51
----------
train Loss: 1.2033 Acc: 0.9182
val Loss: 6.7999 Acc: 0.6953
Epoch 29/51
----------
train Loss: 0.6835 Acc: 0.9132
val Loss: 2.4471 Acc: 0.7344
Epoch 30/51
----------
train Loss: 0.3601 Acc: 0.9649
val Loss: 4.7319 Acc: 0.7734
Epoch 31/51
----------
train Loss: 0.5312 Acc: 0.9232
val Loss: 3.0375 Acc: 0.8203
Epoch 32/51
----------
train Loss: 0.4088 Acc: 0.9616
val Loss: 2.5068 Acc: 0.8906
Epoch 33/51
----------
train Loss: 0.3123 Acc: 0.9733
val Loss: 3.2261 Acc: 0.8359
Epoch 34/51
----------
train Loss: 0.1721 Acc: 0.9883
val Loss: 4.7876 Acc: 0.8516
Epoch 35/51
----------
train Loss: 0.3286 Acc: 0.9499
val Loss: 6.2696 Acc: 0.8203
Epoch 36/51
----------
train Loss: 0.6493 Acc: 0.9098
val Loss: 3.6154 Acc: 0.8281
Epoch 37/51
----------
train Loss: 0.4960 Acc: 0.9382
val Loss: 5.4579 Acc: 0.7812
Epoch 38/51
----------
train Loss: 0.8203 Acc: 0.9449
val Loss: 25.0726 Acc: 0.4297
Epoch 39/51
----------
train Loss: 0.5075 Acc: 0.9666
val Loss: 4.7442 Acc: 0.7422
Epoch 40/51
----------
train Loss: 0.8917 Acc: 0.8948
val Loss: 3.3905 Acc: 0.7969
Epoch 41/51
----------
train Loss: 1.0090 Acc: 0.9048
val Loss: 3.7464 Acc: 0.6875
Epoch 42/51
----------
train Loss: 0.5528 Acc: 0.9382
val Loss: 3.6856 Acc: 0.8516
Epoch 43/51
----------
train Loss: 0.2519 Acc: 0.9716
val Loss: 4.7609 Acc: 0.8281
Epoch 44/51
----------
train Loss: 0.1863 Acc: 0.9816
val Loss: 4.7297 Acc: 0.7969
Epoch 45/51
----------
train Loss: 0.1734 Acc: 0.9766
val Loss: 3.9708 Acc: 0.7891
Epoch 46/51
----------
train Loss: 0.2114 Acc: 0.9733
val Loss: 5.1270 Acc: 0.7969
Epoch 47/51
----------
train Loss: 0.4846 Acc: 0.9416
val Loss: 7.8948 Acc: 0.5391
Epoch 48/51
----------
train Loss: 1.0986 Acc: 0.8831
val Loss: 5.5286 Acc: 0.5547
Epoch 49/51
----------
train Loss: 0.7348 Acc: 0.9316
val Loss: 6.1699 Acc: 0.8359
Epoch 50/51
----------
train Loss: 0.4784 Acc: 0.9332
val Loss: 5.7231 Acc: 0.8047
Epoch 51/51
----------
train Loss: 0.2762 Acc: 0.9766
[I 2024-10-15 21:21:45,578] Trial 181 finished with value: 0.78125 and parameters: {'batch_size': 88, 'lr': 0.00028470051432210523, 'num_epochs': 51, 'weight_decay': 0.043313074208217485, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 3.7977 Acc: 0.7812
Best val Acc: 0.781250
Model weights saved at ./model_weights/ResNet34_bs_88_lr_0.00028470051432210523_epoch_51_wd_0.043313074208217485_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/52
----------
train Loss: 4.2866 Acc: 0.5559
val Loss: 4.7846 Acc: 0.8125
Epoch 2/52
----------
train Loss: 1.5138 Acc: 0.8614
val Loss: 3.0342 Acc: 0.7734
Epoch 3/52
----------
train Loss: 0.8611 Acc: 0.9132
val Loss: 3.1336 Acc: 0.8047
Epoch 4/52
----------
train Loss: 1.0449 Acc: 0.9065
val Loss: 5.1924 Acc: 0.8125
Epoch 5/52
----------
train Loss: 1.5178 Acc: 0.9115
val Loss: 5.4762 Acc: 0.8125
Epoch 6/52
----------
train Loss: 0.8289 Acc: 0.9115
val Loss: 3.2878 Acc: 0.8281
Epoch 7/52
----------
train Loss: 0.3350 Acc: 0.9533
val Loss: 3.6036 Acc: 0.8594
Epoch 8/52
----------
train Loss: 0.5335 Acc: 0.9683
val Loss: 2.5222 Acc: 0.6406
Epoch 9/52
----------
train Loss: 0.6153 Acc: 0.9366
val Loss: 4.5347 Acc: 0.7656
Epoch 10/52
----------
train Loss: 0.5036 Acc: 0.9416
val Loss: 2.7895 Acc: 0.8438
Epoch 11/52
----------
train Loss: 0.9672 Acc: 0.9232
val Loss: 2.4858 Acc: 0.8594
Epoch 12/52
----------
train Loss: 0.4229 Acc: 0.9499
val Loss: 3.1339 Acc: 0.7500
Epoch 13/52
----------
train Loss: 0.4224 Acc: 0.9566
val Loss: 3.6113 Acc: 0.8359
Epoch 14/52
----------
train Loss: 0.6111 Acc: 0.9566
val Loss: 4.4454 Acc: 0.6562
Epoch 15/52
----------
train Loss: 0.4184 Acc: 0.9683
val Loss: 2.7390 Acc: 0.7969
Epoch 16/52
----------
train Loss: 0.4432 Acc: 0.9516
val Loss: 1.6841 Acc: 0.8984
Epoch 17/52
----------
train Loss: 0.5657 Acc: 0.9449
val Loss: 3.4425 Acc: 0.8047
Epoch 18/52
----------
train Loss: 0.3272 Acc: 0.9666
val Loss: 3.2830 Acc: 0.8281
Epoch 19/52
----------
train Loss: 0.6909 Acc: 0.9633
val Loss: 2.8019 Acc: 0.8750
Epoch 20/52
----------
train Loss: 0.8159 Acc: 0.9299
val Loss: 2.2150 Acc: 0.8438
Epoch 21/52
----------
train Loss: 0.5163 Acc: 0.9533
val Loss: 2.4150 Acc: 0.7812
Epoch 22/52
----------
train Loss: 0.3850 Acc: 0.9649
val Loss: 5.4455 Acc: 0.8438
Epoch 23/52
----------
train Loss: 0.2813 Acc: 0.9750
val Loss: 3.4468 Acc: 0.8672
Epoch 24/52
----------
train Loss: 0.2070 Acc: 0.9816
val Loss: 3.8327 Acc: 0.8672
Epoch 25/52
----------
train Loss: 0.1762 Acc: 0.9850
val Loss: 3.2283 Acc: 0.8125
Epoch 26/52
----------
train Loss: 0.1128 Acc: 0.9883
val Loss: 3.8050 Acc: 0.8750
Epoch 27/52
----------
train Loss: 0.0575 Acc: 0.9933
val Loss: 3.0895 Acc: 0.8750
Epoch 28/52
----------
train Loss: 0.0379 Acc: 0.9950
val Loss: 3.1455 Acc: 0.8750
Epoch 29/52
----------
train Loss: 0.0370 Acc: 0.9950
val Loss: 3.2732 Acc: 0.8984
Epoch 30/52
----------
train Loss: 0.0683 Acc: 0.9917
val Loss: 7.4161 Acc: 0.8672
Epoch 31/52
----------
train Loss: 0.0938 Acc: 0.9833
val Loss: 4.2768 Acc: 0.8594
Epoch 32/52
----------
train Loss: 0.0963 Acc: 0.9883
val Loss: 3.3330 Acc: 0.8672
Epoch 33/52
----------
train Loss: 0.0990 Acc: 0.9900
val Loss: 3.7153 Acc: 0.8750
Epoch 34/52
----------
train Loss: 0.7319 Acc: 0.9566
val Loss: 11.3958 Acc: 0.5469
Epoch 35/52
----------
train Loss: 0.9730 Acc: 0.9082
val Loss: 9.9799 Acc: 0.8047
Epoch 36/52
----------
train Loss: 1.3349 Acc: 0.8464
val Loss: 2.7238 Acc: 0.7969
Epoch 37/52
----------
train Loss: 0.8832 Acc: 0.9098
val Loss: 6.2850 Acc: 0.7812
Epoch 38/52
----------
train Loss: 1.9647 Acc: 0.7913
[I 2024-10-15 21:24:35,412] Trial 182 finished with value: 0.875 and parameters: {'batch_size': 93, 'lr': 0.00024744509266788953, 'num_epochs': 52, 'weight_decay': 0.027134009061079198, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 11.2234 Acc: 0.5000
Early stopping at epoch 38 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.875000
Model weights saved at ./model_weights/ResNet34_bs_93_lr_0.00024744509266788953_epoch_52_wd_0.027134009061079198_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/56
----------
train Loss: 3.7856 Acc: 0.5593
val Loss: 3.5002 Acc: 0.7812
Epoch 2/56
----------
train Loss: 1.1151 Acc: 0.8664
val Loss: 2.6625 Acc: 0.7344
Epoch 3/56
----------
train Loss: 0.4244 Acc: 0.9599
val Loss: 2.9300 Acc: 0.8203
Epoch 4/56
----------
train Loss: 0.2101 Acc: 0.9833
val Loss: 3.5257 Acc: 0.7969
Epoch 5/56
----------
train Loss: 0.1679 Acc: 0.9850
val Loss: 3.7107 Acc: 0.8359
Epoch 6/56
----------
train Loss: 0.1622 Acc: 0.9833
val Loss: 3.8537 Acc: 0.7109
Epoch 7/56
----------
train Loss: 0.2332 Acc: 0.9783
val Loss: 4.2160 Acc: 0.8281
Epoch 8/56
----------
train Loss: 0.1291 Acc: 0.9866
val Loss: 3.7479 Acc: 0.8359
Epoch 9/56
----------
train Loss: 0.0965 Acc: 0.9900
val Loss: 3.9553 Acc: 0.8047
Epoch 10/56
----------
train Loss: 0.1394 Acc: 0.9816
val Loss: 3.4297 Acc: 0.8281
Epoch 11/56
----------
train Loss: 0.1304 Acc: 0.9850
val Loss: 3.5285 Acc: 0.8047
Epoch 12/56
----------
train Loss: 0.2914 Acc: 0.9766
val Loss: 3.1866 Acc: 0.7812
Epoch 13/56
----------
train Loss: 0.6041 Acc: 0.9449
val Loss: 5.7761 Acc: 0.7891
Epoch 14/56
----------
train Loss: 0.6175 Acc: 0.9282
val Loss: 3.4431 Acc: 0.7578
Epoch 15/56
----------
train Loss: 0.8327 Acc: 0.9165
val Loss: 9.0730 Acc: 0.6797
Epoch 16/56
----------
train Loss: 1.2619 Acc: 0.9048
val Loss: 4.8944 Acc: 0.5156
Epoch 17/56
----------
train Loss: 0.6988 Acc: 0.9149
val Loss: 4.7359 Acc: 0.8047
Epoch 18/56
----------
train Loss: 0.2621 Acc: 0.9666
val Loss: 2.2786 Acc: 0.8281
Epoch 19/56
----------
train Loss: 0.1687 Acc: 0.9783
val Loss: 2.3430 Acc: 0.8594
Epoch 20/56
----------
train Loss: 0.1375 Acc: 0.9866
val Loss: 2.8745 Acc: 0.8438
Epoch 21/56
----------
train Loss: 0.1970 Acc: 0.9833
val Loss: 3.0483 Acc: 0.8750
Epoch 22/56
----------
train Loss: 0.1104 Acc: 0.9850
val Loss: 2.4777 Acc: 0.8516
Epoch 23/56
----------
train Loss: 0.0867 Acc: 0.9900
val Loss: 2.6994 Acc: 0.8828
Epoch 24/56
----------
train Loss: 0.0878 Acc: 0.9933
val Loss: 2.8394 Acc: 0.8672
Epoch 25/56
----------
train Loss: 0.1055 Acc: 0.9900
val Loss: 3.2779 Acc: 0.8516
Epoch 26/56
----------
train Loss: 0.0806 Acc: 0.9900
val Loss: 3.4048 Acc: 0.8125
Epoch 27/56
----------
train Loss: 0.0814 Acc: 0.9917
val Loss: 4.2658 Acc: 0.8672
Epoch 28/56
----------
train Loss: 0.0612 Acc: 0.9933
val Loss: 3.4669 Acc: 0.8594
Epoch 29/56
----------
train Loss: 0.0539 Acc: 0.9933
val Loss: 2.9570 Acc: 0.8438
Epoch 30/56
----------
train Loss: 0.0410 Acc: 0.9967
val Loss: 3.5746 Acc: 0.8672
Epoch 31/56
----------
train Loss: 0.0345 Acc: 0.9967
val Loss: 3.6579 Acc: 0.8750
Epoch 32/56
----------
train Loss: 0.0382 Acc: 0.9967
val Loss: 3.6852 Acc: 0.8672
Epoch 33/56
----------
train Loss: 0.0355 Acc: 0.9967
val Loss: 3.2801 Acc: 0.8594
Epoch 34/56
----------
train Loss: 0.0419 Acc: 0.9950
val Loss: 3.0055 Acc: 0.8438
Epoch 35/56
----------
train Loss: 0.0369 Acc: 0.9950
val Loss: 3.6794 Acc: 0.8672
Epoch 36/56
----------
train Loss: 0.0607 Acc: 0.9900
val Loss: 4.7365 Acc: 0.8281
Epoch 37/56
----------
train Loss: 0.1186 Acc: 0.9866
val Loss: 3.2761 Acc: 0.7734
Epoch 38/56
----------
train Loss: 0.2625 Acc: 0.9850
val Loss: 4.1854 Acc: 0.7031
Epoch 39/56
----------
train Loss: 0.2994 Acc: 0.9666
val Loss: 6.9430 Acc: 0.8281
Epoch 40/56
----------
train Loss: 0.4394 Acc: 0.9516
val Loss: 4.4618 Acc: 0.7734
Epoch 41/56
----------
train Loss: 0.6018 Acc: 0.9366
val Loss: 3.7387 Acc: 0.7891
Epoch 42/56
----------
train Loss: 2.0277 Acc: 0.8881
val Loss: 34.1158 Acc: 0.2500
Epoch 43/56
----------
train Loss: 2.0751 Acc: 0.8347
val Loss: 4.5279 Acc: 0.7656
Epoch 44/56
----------
train Loss: 1.1696 Acc: 0.8848
val Loss: 4.0451 Acc: 0.7109
Epoch 45/56
----------
train Loss: 0.4265 Acc: 0.9533
val Loss: 3.4984 Acc: 0.8203
Epoch 46/56
----------
train Loss: 0.1798 Acc: 0.9833
val Loss: 3.8878 Acc: 0.8203
Epoch 47/56
----------
train Loss: 0.2368 Acc: 0.9866
val Loss: 4.1033 Acc: 0.8047
Epoch 48/56
----------
train Loss: 0.3114 Acc: 0.9633
val Loss: 3.5500 Acc: 0.8203
Epoch 49/56
----------
train Loss: 0.2405 Acc: 0.9800
val Loss: 4.1901 Acc: 0.8125
Epoch 50/56
----------
train Loss: 0.1985 Acc: 0.9800
val Loss: 5.2996 Acc: 0.8125
Epoch 51/56
----------
train Loss: 0.1490 Acc: 0.9850
val Loss: 4.3886 Acc: 0.7891
Epoch 52/56
----------
train Loss: 0.1328 Acc: 0.9866
val Loss: 3.9307 Acc: 0.8594
Epoch 53/56
----------
train Loss: 0.0571 Acc: 0.9917
val Loss: 3.7052 Acc: 0.8516
Epoch 54/56
----------
train Loss: 0.0537 Acc: 0.9933
val Loss: 3.8121 Acc: 0.8281
Epoch 55/56
----------
train Loss: 0.0790 Acc: 0.9950
val Loss: 4.9067 Acc: 0.8359
Epoch 56/56
----------
train Loss: 0.0610 Acc: 0.9933
[I 2024-10-15 21:28:45,870] Trial 183 finished with value: 0.859375 and parameters: {'batch_size': 98, 'lr': 0.00011843030590447268, 'num_epochs': 56, 'weight_decay': 0.026890566128182174, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 3.7325 Acc: 0.8594
Best val Acc: 0.859375
Model weights saved at ./model_weights/ResNet34_bs_98_lr_0.00011843030590447268_epoch_56_wd_0.026890566128182174_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/50
----------
train Loss: 4.1619 Acc: 0.4624
val Loss: 3.1876 Acc: 0.6641
Epoch 2/50
----------
train Loss: 1.9985 Acc: 0.7997
val Loss: 4.6221 Acc: 0.7188
Epoch 3/50
----------
train Loss: 1.8136 Acc: 0.8280
val Loss: 3.6164 Acc: 0.6250
Epoch 4/50
----------
train Loss: 0.8814 Acc: 0.8965
val Loss: 3.3019 Acc: 0.8125
Epoch 5/50
----------
train Loss: 0.6973 Acc: 0.9232
val Loss: 1.7977 Acc: 0.8047
Epoch 6/50
----------
train Loss: 0.5975 Acc: 0.9382
val Loss: 3.3321 Acc: 0.7734
Epoch 7/50
----------
train Loss: 0.5711 Acc: 0.9466
val Loss: 5.1232 Acc: 0.7578
Epoch 8/50
----------
train Loss: 0.5617 Acc: 0.9366
val Loss: 2.8252 Acc: 0.8203
Epoch 9/50
----------
train Loss: 0.3939 Acc: 0.9633
val Loss: 2.3322 Acc: 0.8203
Epoch 10/50
----------
train Loss: 0.8789 Acc: 0.9032
val Loss: 3.1219 Acc: 0.7656
Epoch 11/50
----------
train Loss: 0.9679 Acc: 0.8915
val Loss: 2.8785 Acc: 0.8672
Epoch 12/50
----------
train Loss: 1.1719 Acc: 0.8865
val Loss: 4.2765 Acc: 0.6484
Epoch 13/50
----------
train Loss: 0.8435 Acc: 0.9015
val Loss: 1.7842 Acc: 0.8594
Epoch 14/50
----------
train Loss: 0.5731 Acc: 0.9332
val Loss: 2.0754 Acc: 0.7422
Epoch 15/50
----------
train Loss: 0.3061 Acc: 0.9633
val Loss: 1.9889 Acc: 0.8672
Epoch 16/50
----------
train Loss: 0.2192 Acc: 0.9783
val Loss: 1.6564 Acc: 0.8828
Epoch 17/50
----------
train Loss: 0.2026 Acc: 0.9750
val Loss: 2.0806 Acc: 0.8516
Epoch 18/50
----------
train Loss: 0.1905 Acc: 0.9750
val Loss: 1.8768 Acc: 0.8750
Epoch 19/50
----------
train Loss: 0.2271 Acc: 0.9750
val Loss: 3.0695 Acc: 0.8672
Epoch 20/50
----------
train Loss: 0.1578 Acc: 0.9783
val Loss: 1.6604 Acc: 0.8594
Epoch 21/50
----------
train Loss: 0.1405 Acc: 0.9800
val Loss: 2.3009 Acc: 0.8984
Epoch 22/50
----------
train Loss: 0.1148 Acc: 0.9883
val Loss: 1.7837 Acc: 0.8516
Epoch 23/50
----------
train Loss: 0.1131 Acc: 0.9900
val Loss: 1.4849 Acc: 0.8594
Epoch 24/50
----------
train Loss: 0.3726 Acc: 0.9549
val Loss: 3.0799 Acc: 0.7344
Epoch 25/50
----------
train Loss: 0.8207 Acc: 0.9149
val Loss: 8.3202 Acc: 0.6562
Epoch 26/50
----------
train Loss: 0.5609 Acc: 0.9265
val Loss: 3.2346 Acc: 0.6875
Epoch 27/50
----------
train Loss: 1.1880 Acc: 0.8965
val Loss: 3.8795 Acc: 0.6953
Epoch 28/50
----------
train Loss: 1.0658 Acc: 0.8965
[I 2024-10-15 21:30:51,460] Trial 184 finished with value: 0.859375 and parameters: {'batch_size': 92, 'lr': 0.0002320031692904186, 'num_epochs': 50, 'weight_decay': 0.03204520261349744, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 7.4829 Acc: 0.5000
Early stopping at epoch 28 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.859375
Model weights saved at ./model_weights/ResNet34_bs_92_lr_0.0002320031692904186_epoch_50_wd_0.03204520261349744_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/53
----------
train Loss: 3.8055 Acc: 0.5459
val Loss: 3.6513 Acc: 0.7578
Epoch 2/53
----------
train Loss: 1.6759 Acc: 0.8280
val Loss: 2.2698 Acc: 0.7734
Epoch 3/53
----------
train Loss: 0.9341 Acc: 0.9032
val Loss: 1.8955 Acc: 0.8359
Epoch 4/53
----------
train Loss: 0.6627 Acc: 0.9265
val Loss: 1.9347 Acc: 0.8438
Epoch 5/53
----------
train Loss: 0.2231 Acc: 0.9750
val Loss: 1.7278 Acc: 0.8516
Epoch 6/53
----------
train Loss: 0.2664 Acc: 0.9800
val Loss: 2.4054 Acc: 0.8281
Epoch 7/53
----------
train Loss: 0.1822 Acc: 0.9766
val Loss: 2.2289 Acc: 0.8516
Epoch 8/53
----------
train Loss: 0.1408 Acc: 0.9866
val Loss: 2.6067 Acc: 0.8516
Epoch 9/53
----------
train Loss: 0.1224 Acc: 0.9883
val Loss: 2.9204 Acc: 0.8281
Epoch 10/53
----------
train Loss: 0.1490 Acc: 0.9816
val Loss: 2.7126 Acc: 0.8594
Epoch 11/53
----------
train Loss: 0.2677 Acc: 0.9716
val Loss: 4.5380 Acc: 0.7266
Epoch 12/53
----------
train Loss: 0.4469 Acc: 0.9549
val Loss: 3.7897 Acc: 0.7578
Epoch 13/53
----------
train Loss: 1.1179 Acc: 0.8798
val Loss: 4.5686 Acc: 0.6172
Epoch 14/53
----------
train Loss: 1.3316 Acc: 0.8865
val Loss: 4.4042 Acc: 0.8281
Epoch 15/53
----------
train Loss: 1.3568 Acc: 0.9199
val Loss: 7.7436 Acc: 0.4766
Epoch 16/53
----------
train Loss: 0.8828 Acc: 0.9048
val Loss: 3.5571 Acc: 0.7656
Epoch 17/53
----------
train Loss: 0.7338 Acc: 0.9332
val Loss: 2.2286 Acc: 0.7656
Epoch 18/53
----------
train Loss: 0.4032 Acc: 0.9649
val Loss: 1.7764 Acc: 0.8281
Epoch 19/53
----------
train Loss: 0.2337 Acc: 0.9766
val Loss: 2.4506 Acc: 0.8047
Epoch 20/53
----------
train Loss: 0.1119 Acc: 0.9900
val Loss: 2.4326 Acc: 0.8359
Epoch 21/53
----------
train Loss: 0.1152 Acc: 0.9883
val Loss: 2.4251 Acc: 0.8594
Epoch 22/53
----------
train Loss: 0.0939 Acc: 0.9883
val Loss: 2.4648 Acc: 0.8594
Epoch 23/53
----------
train Loss: 0.0884 Acc: 0.9933
val Loss: 2.5479 Acc: 0.8906
Epoch 24/53
----------
train Loss: 0.0826 Acc: 0.9917
val Loss: 2.6593 Acc: 0.8359
Epoch 25/53
----------
train Loss: 0.1406 Acc: 0.9833
val Loss: 2.5377 Acc: 0.8516
Epoch 26/53
----------
train Loss: 0.1404 Acc: 0.9816
val Loss: 2.1372 Acc: 0.8672
Epoch 27/53
----------
train Loss: 0.1046 Acc: 0.9917
val Loss: 2.2796 Acc: 0.8516
Epoch 28/53
----------
train Loss: 0.1385 Acc: 0.9883
val Loss: 2.7970 Acc: 0.8438
Epoch 29/53
----------
train Loss: 0.1110 Acc: 0.9833
val Loss: 2.1871 Acc: 0.8125
Epoch 30/53
----------
train Loss: 0.2589 Acc: 0.9666
val Loss: 3.8490 Acc: 0.7969
Epoch 31/53
----------
train Loss: 0.1986 Acc: 0.9766
val Loss: 3.3573 Acc: 0.8125
Epoch 32/53
----------
train Loss: 0.1113 Acc: 0.9850
val Loss: 2.4160 Acc: 0.8594
Epoch 33/53
----------
train Loss: 0.0976 Acc: 0.9850
val Loss: 2.1479 Acc: 0.8203
Epoch 34/53
----------
train Loss: 0.0666 Acc: 0.9967
val Loss: 2.6314 Acc: 0.8594
Epoch 35/53
----------
train Loss: 0.0552 Acc: 0.9900
val Loss: 2.6325 Acc: 0.8828
Epoch 36/53
----------
train Loss: 0.1079 Acc: 0.9850
val Loss: 2.8544 Acc: 0.8516
Epoch 37/53
----------
train Loss: 0.0624 Acc: 0.9933
val Loss: 3.1344 Acc: 0.8750
Epoch 38/53
----------
train Loss: 0.0422 Acc: 0.9967
val Loss: 2.9324 Acc: 0.8672
Epoch 39/53
----------
train Loss: 0.0464 Acc: 0.9950
val Loss: 2.9159 Acc: 0.8672
Epoch 40/53
----------
train Loss: 0.1086 Acc: 0.9900
val Loss: 3.1784 Acc: 0.8516
Epoch 41/53
----------
train Loss: 0.2931 Acc: 0.9733
val Loss: 13.5164 Acc: 0.4375
Epoch 42/53
----------
train Loss: 0.7664 Acc: 0.9282
val Loss: 5.2965 Acc: 0.8203
Epoch 43/53
----------
train Loss: 0.6606 Acc: 0.9416
val Loss: 4.1891 Acc: 0.5859
Epoch 44/53
----------
train Loss: 1.3210 Acc: 0.8831
val Loss: 7.0007 Acc: 0.5469
Epoch 45/53
----------
train Loss: 1.2068 Acc: 0.8631
val Loss: 4.1560 Acc: 0.6406
Epoch 46/53
----------
train Loss: 0.8576 Acc: 0.9249
val Loss: 3.0834 Acc: 0.8125
Epoch 47/53
----------
train Loss: 0.3830 Acc: 0.9616
val Loss: 2.3037 Acc: 0.8594
Epoch 48/53
----------
train Loss: 0.3273 Acc: 0.9699
val Loss: 2.8550 Acc: 0.6641
Epoch 49/53
----------
train Loss: 0.3138 Acc: 0.9399
val Loss: 2.6524 Acc: 0.8281
Epoch 50/53
----------
train Loss: 0.1357 Acc: 0.9850
val Loss: 2.7347 Acc: 0.8438
Epoch 51/53
----------
train Loss: 0.1127 Acc: 0.9883
val Loss: 2.0668 Acc: 0.8594
Epoch 52/53
----------
train Loss: 0.0610 Acc: 0.9933
val Loss: 2.0277 Acc: 0.8750
Epoch 53/53
----------
train Loss: 0.0454 Acc: 0.9933
[I 2024-10-15 21:34:49,258] Trial 185 finished with value: 0.859375 and parameters: {'batch_size': 95, 'lr': 0.00016649404933779795, 'num_epochs': 53, 'weight_decay': 0.01902063182622276, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 2.5662 Acc: 0.8594
Best val Acc: 0.859375
Model weights saved at ./model_weights/ResNet34_bs_95_lr_0.00016649404933779795_epoch_53_wd_0.01902063182622276_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/54
----------
train Loss: 4.4715 Acc: 0.3856
val Loss: 2.6489 Acc: 0.6484
Epoch 2/54
----------
train Loss: 1.2449 Acc: 0.8397
val Loss: 1.8281 Acc: 0.8281
Epoch 3/54
----------
train Loss: 0.4977 Acc: 0.9583
val Loss: 1.4800 Acc: 0.8203
Epoch 4/54
----------
train Loss: 0.2404 Acc: 0.9833
val Loss: 1.6752 Acc: 0.8750
Epoch 5/54
----------
train Loss: 0.1301 Acc: 0.9933
val Loss: 1.6067 Acc: 0.8906
Epoch 6/54
----------
train Loss: 0.0957 Acc: 0.9950
val Loss: 2.1120 Acc: 0.8828
Epoch 7/54
----------
train Loss: 0.0718 Acc: 0.9950
val Loss: 2.0532 Acc: 0.8750
Epoch 8/54
----------
train Loss: 0.0517 Acc: 0.9950
val Loss: 1.9410 Acc: 0.8672
Epoch 9/54
----------
train Loss: 0.0625 Acc: 0.9933
val Loss: 2.2673 Acc: 0.8672
Epoch 10/54
----------
train Loss: 0.0690 Acc: 0.9950
val Loss: 2.0828 Acc: 0.8516
Epoch 11/54
----------
train Loss: 0.0429 Acc: 0.9950
val Loss: 2.0091 Acc: 0.8672
Epoch 12/54
----------
train Loss: 0.0586 Acc: 0.9950
val Loss: 2.3148 Acc: 0.8750
Epoch 13/54
----------
train Loss: 0.0438 Acc: 0.9950
val Loss: 2.1450 Acc: 0.8750
Epoch 14/54
----------
train Loss: 0.0447 Acc: 0.9967
val Loss: 2.0570 Acc: 0.8750
Epoch 15/54
----------
train Loss: 0.0396 Acc: 0.9950
val Loss: 2.2975 Acc: 0.8672
Epoch 16/54
----------
train Loss: 0.0455 Acc: 0.9967
val Loss: 2.4682 Acc: 0.8672
Epoch 17/54
----------
train Loss: 0.0385 Acc: 0.9967
val Loss: 2.6517 Acc: 0.8828
Epoch 18/54
----------
train Loss: 0.0441 Acc: 0.9967
val Loss: 2.6306 Acc: 0.8750
Epoch 19/54
----------
train Loss: 0.0328 Acc: 0.9967
val Loss: 2.4528 Acc: 0.8594
Epoch 20/54
----------
train Loss: 0.2318 Acc: 0.9900
val Loss: 3.4893 Acc: 0.7734
Epoch 21/54
----------
train Loss: 1.0413 Acc: 0.8781
val Loss: 4.9890 Acc: 0.5547
Epoch 22/54
----------
train Loss: 3.8509 Acc: 0.7212
val Loss: 8.7523 Acc: 0.4531
Epoch 23/54
----------
train Loss: 2.1102 Acc: 0.7863
val Loss: 2.0933 Acc: 0.7891
Epoch 24/54
----------
train Loss: 1.0650 Acc: 0.8932
val Loss: 1.6735 Acc: 0.8359
Epoch 25/54
----------
train Loss: 0.5803 Acc: 0.9416
val Loss: 1.9677 Acc: 0.8672
Epoch 26/54
----------
train Loss: 0.3152 Acc: 0.9616
val Loss: 2.5566 Acc: 0.8281
Epoch 27/54
----------
train Loss: 0.2090 Acc: 0.9716
val Loss: 1.7833 Acc: 0.8281
Epoch 28/54
----------
train Loss: 0.1576 Acc: 0.9866
val Loss: 2.0500 Acc: 0.8984
Epoch 29/54
----------
train Loss: 0.0829 Acc: 0.9917
val Loss: 2.1238 Acc: 0.8828
Epoch 30/54
----------
train Loss: 0.0720 Acc: 0.9917
val Loss: 2.0812 Acc: 0.9062
Epoch 31/54
----------
train Loss: 0.0921 Acc: 0.9900
val Loss: 2.2159 Acc: 0.8359
Epoch 32/54
----------
train Loss: 0.0694 Acc: 0.9866
val Loss: 2.2118 Acc: 0.8906
Epoch 33/54
----------
train Loss: 0.0733 Acc: 0.9933
val Loss: 2.6607 Acc: 0.8359
Epoch 34/54
----------
train Loss: 0.0544 Acc: 0.9917
val Loss: 2.5111 Acc: 0.8594
Epoch 35/54
----------
train Loss: 0.0615 Acc: 0.9950
val Loss: 2.5893 Acc: 0.8281
Epoch 36/54
----------
train Loss: 0.0428 Acc: 0.9950
val Loss: 2.4754 Acc: 0.8359
Epoch 37/54
----------
train Loss: 0.0890 Acc: 0.9917
val Loss: 3.3363 Acc: 0.8359
Epoch 38/54
----------
train Loss: 0.0828 Acc: 0.9883
val Loss: 2.9306 Acc: 0.8438
Epoch 39/54
----------
train Loss: 0.0777 Acc: 0.9967
val Loss: 3.0966 Acc: 0.8750
Epoch 40/54
----------
train Loss: 0.0656 Acc: 0.9900
val Loss: 2.7111 Acc: 0.8750
Epoch 41/54
----------
train Loss: 0.0575 Acc: 0.9917
val Loss: 2.6136 Acc: 0.8750
Epoch 42/54
----------
train Loss: 0.0402 Acc: 0.9933
val Loss: 2.7631 Acc: 0.8906
Epoch 43/54
----------
train Loss: 0.0440 Acc: 0.9967
val Loss: 2.6341 Acc: 0.8906
Epoch 44/54
----------
train Loss: 0.0500 Acc: 0.9933
val Loss: 2.6481 Acc: 0.8672
Epoch 45/54
----------
train Loss: 0.0632 Acc: 0.9917
val Loss: 2.2795 Acc: 0.8359
Epoch 46/54
----------
train Loss: 0.1352 Acc: 0.9833
val Loss: 2.7013 Acc: 0.7891
Epoch 47/54
----------
train Loss: 0.2573 Acc: 0.9633
val Loss: 2.7128 Acc: 0.8906
Epoch 48/54
----------
train Loss: 0.0970 Acc: 0.9917
val Loss: 2.9379 Acc: 0.8750
Epoch 49/54
----------
train Loss: 0.0785 Acc: 0.9917
val Loss: 3.5422 Acc: 0.8828
Epoch 50/54
----------
train Loss: 0.1346 Acc: 0.9866
val Loss: 3.0031 Acc: 0.8203
Epoch 51/54
----------
train Loss: 0.3565 Acc: 0.9649
val Loss: 8.2296 Acc: 0.5625
Epoch 52/54
----------
train Loss: 0.7300 Acc: 0.9316
val Loss: 9.5626 Acc: 0.4922
Epoch 53/54
----------
train Loss: 2.1264 Acc: 0.7863
val Loss: 4.9312 Acc: 0.7500
Epoch 54/54
----------
train Loss: 1.5230 Acc: 0.8715
[I 2024-10-15 21:38:51,489] Trial 186 finished with value: 0.8828125 and parameters: {'batch_size': 89, 'lr': 9.988490914729152e-05, 'num_epochs': 54, 'weight_decay': 0.022652240492070444, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 3.7356 Acc: 0.8047
Early stopping at epoch 54 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.882812
Model weights saved at ./model_weights/ResNet34_bs_89_lr_9.988490914729152e-05_epoch_54_wd_0.022652240492070444_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/57
----------
train Loss: 2.9435 Acc: 0.6795
val Loss: 1.9124 Acc: 0.7578
Epoch 2/57
----------
train Loss: 1.7017 Acc: 0.8147
val Loss: 1.5802 Acc: 0.7734
Epoch 3/57
----------
train Loss: 1.3772 Acc: 0.8781
val Loss: 1.4535 Acc: 0.7891
Epoch 4/57
----------
train Loss: 1.3794 Acc: 0.8614
val Loss: 1.6088 Acc: 0.7656
Epoch 5/57
----------
train Loss: 1.4785 Acc: 0.7947
val Loss: 1.4310 Acc: 0.7891
Epoch 6/57
----------
train Loss: 1.3615 Acc: 0.8397
val Loss: 1.5262 Acc: 0.7578
Epoch 7/57
----------
train Loss: 1.4286 Acc: 0.8748
val Loss: 1.5564 Acc: 0.7578
Epoch 8/57
----------
train Loss: 1.2861 Acc: 0.8748
val Loss: 1.7525 Acc: 0.7422
Epoch 9/57
----------
train Loss: 1.1202 Acc: 0.9349
val Loss: 1.5424 Acc: 0.7969
Epoch 10/57
----------
train Loss: 1.1950 Acc: 0.9149
val Loss: 1.5340 Acc: 0.8125
Epoch 11/57
----------
train Loss: 1.1371 Acc: 0.9132
val Loss: 1.6644 Acc: 0.7578
Epoch 12/57
----------
train Loss: 1.1124 Acc: 0.9048
val Loss: 1.4441 Acc: 0.7500
Epoch 13/57
----------
train Loss: 1.0957 Acc: 0.9232
val Loss: 1.4010 Acc: 0.7812
Epoch 14/57
----------
train Loss: 1.1863 Acc: 0.9048
val Loss: 1.7043 Acc: 0.7578
Epoch 15/57
----------
train Loss: 1.2399 Acc: 0.8948
val Loss: 1.5885 Acc: 0.7734
Epoch 16/57
----------
train Loss: 1.2884 Acc: 0.9149
val Loss: 1.5165 Acc: 0.7578
Epoch 17/57
----------
train Loss: 1.1114 Acc: 0.9499
val Loss: 1.5101 Acc: 0.7812
Epoch 18/57
----------
train Loss: 1.1919 Acc: 0.8664
val Loss: 1.7199 Acc: 0.7812
Epoch 19/57
----------
train Loss: 1.1427 Acc: 0.9182
val Loss: 1.6535 Acc: 0.7891
Epoch 20/57
----------
train Loss: 1.3190 Acc: 0.8748
val Loss: 1.6536 Acc: 0.7578
Epoch 21/57
----------
train Loss: 1.1779 Acc: 0.9032
val Loss: 1.3904 Acc: 0.7734
Epoch 22/57
----------
train Loss: 1.1002 Acc: 0.9249
val Loss: 1.3569 Acc: 0.7578
Epoch 23/57
----------
train Loss: 1.0459 Acc: 0.9199
val Loss: 1.6198 Acc: 0.7578
Epoch 24/57
----------
train Loss: 1.2472 Acc: 0.8998
val Loss: 1.4016 Acc: 0.8125
Epoch 25/57
----------
train Loss: 1.2903 Acc: 0.8998
val Loss: 1.4463 Acc: 0.7422
Epoch 26/57
----------
train Loss: 1.2460 Acc: 0.9082
val Loss: 1.6290 Acc: 0.7500
Epoch 27/57
----------
train Loss: 1.1866 Acc: 0.9416
val Loss: 1.4111 Acc: 0.7969
Epoch 28/57
----------
train Loss: 1.2368 Acc: 0.8614
val Loss: 1.4331 Acc: 0.7812
Epoch 29/57
----------
train Loss: 1.2818 Acc: 0.8765
val Loss: 1.4025 Acc: 0.7891
Epoch 30/57
----------
train Loss: 1.0169 Acc: 0.9399
val Loss: 1.7360 Acc: 0.7812
Epoch 31/57
----------
train Loss: 1.2820 Acc: 0.9032
val Loss: 1.6243 Acc: 0.7500
Epoch 32/57
----------
train Loss: 1.1841 Acc: 0.8815
val Loss: 1.7337 Acc: 0.6875
Epoch 33/57
----------
train Loss: 1.1306 Acc: 0.9382
val Loss: 2.3030 Acc: 0.7344
Epoch 34/57
----------
train Loss: 1.0942 Acc: 0.9549
val Loss: 1.6069 Acc: 0.8047
Epoch 35/57
----------
train Loss: 1.0910 Acc: 0.9115
val Loss: 1.5690 Acc: 0.7734
Epoch 36/57
----------
train Loss: 1.2410 Acc: 0.8982
val Loss: 1.6124 Acc: 0.7578
Epoch 37/57
----------
train Loss: 1.2088 Acc: 0.9165
val Loss: 1.5646 Acc: 0.8047
Epoch 38/57
----------
train Loss: 1.0892 Acc: 0.9149
val Loss: 1.3046 Acc: 0.7891
Epoch 39/57
----------
train Loss: 1.2400 Acc: 0.9332
val Loss: 1.5785 Acc: 0.7344
Epoch 40/57
----------
train Loss: 1.0981 Acc: 0.9316
val Loss: 1.4132 Acc: 0.7891
Epoch 41/57
----------
train Loss: 1.2558 Acc: 0.8898
val Loss: 1.4377 Acc: 0.7578
Epoch 42/57
----------
train Loss: 1.0496 Acc: 0.9282
val Loss: 1.4184 Acc: 0.8125
Epoch 43/57
----------
train Loss: 1.1826 Acc: 0.9065
val Loss: 1.5617 Acc: 0.7656
Epoch 44/57
----------
train Loss: 1.0880 Acc: 0.9165
val Loss: 1.6113 Acc: 0.7734
Epoch 45/57
----------
train Loss: 1.0943 Acc: 0.9165
val Loss: 1.5890 Acc: 0.8125
Epoch 46/57
----------
train Loss: 1.0594 Acc: 0.9616
val Loss: 1.3956 Acc: 0.7734
Epoch 47/57
----------
train Loss: 1.1829 Acc: 0.9082
val Loss: 1.3522 Acc: 0.8203
Epoch 48/57
----------
train Loss: 1.0643 Acc: 0.9499
val Loss: 1.6044 Acc: 0.7734
Epoch 49/57
----------
train Loss: 1.1033 Acc: 0.8982
val Loss: 1.5556 Acc: 0.7734
Epoch 50/57
----------
train Loss: 1.0573 Acc: 0.9516
val Loss: 1.6689 Acc: 0.7578
Epoch 51/57
----------
train Loss: 1.1376 Acc: 0.8965
val Loss: 1.6107 Acc: 0.8047
Epoch 52/57
----------
train Loss: 1.1606 Acc: 0.9032
val Loss: 1.5309 Acc: 0.7578
Epoch 53/57
----------
train Loss: 1.2308 Acc: 0.9232
val Loss: 1.5329 Acc: 0.7891
Epoch 54/57
----------
train Loss: 1.2207 Acc: 0.8681
val Loss: 1.5291 Acc: 0.7656
Epoch 55/57
----------
train Loss: 1.0436 Acc: 0.9349
val Loss: 1.3769 Acc: 0.8203
Epoch 56/57
----------
train Loss: 1.1486 Acc: 0.8948
val Loss: 1.7848 Acc: 0.7969
Epoch 57/57
----------
train Loss: 1.0272 Acc: 0.9199
[I 2024-10-15 21:43:06,526] Trial 187 finished with value: 0.796875 and parameters: {'batch_size': 86, 'lr': 8.701411135148382e-05, 'num_epochs': 57, 'weight_decay': 0.014508503142431656, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 150 with value: 0.9140625.
val Loss: 1.4204 Acc: 0.7969
Best val Acc: 0.796875
Model weights saved at ./model_weights/ResNet34_bs_86_lr_8.701411135148382e-05_epoch_57_wd_0.014508503142431656_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/48
----------
train Loss: 0.9153 Acc: 0.6628
val Loss: 0.5556 Acc: 0.8047
Epoch 2/48
----------
train Loss: 0.2700 Acc: 0.9098
val Loss: 0.5690 Acc: 0.8594
Epoch 3/48
----------
train Loss: 0.1297 Acc: 0.9549
val Loss: 0.5181 Acc: 0.8203
Epoch 4/48
----------
train Loss: 0.0649 Acc: 0.9733
val Loss: 0.6138 Acc: 0.8359
Epoch 5/48
----------
train Loss: 0.0671 Acc: 0.9816
val Loss: 0.6209 Acc: 0.8438
Epoch 6/48
----------
train Loss: 0.0682 Acc: 0.9716
val Loss: 0.8449 Acc: 0.7812
Epoch 7/48
----------
train Loss: 0.0757 Acc: 0.9733
val Loss: 0.6382 Acc: 0.8047
Epoch 8/48
----------
train Loss: 0.1839 Acc: 0.9249
val Loss: 1.2480 Acc: 0.7422
Epoch 9/48
----------
train Loss: 0.3431 Acc: 0.8881
val Loss: 0.7460 Acc: 0.7578
Epoch 10/48
----------
train Loss: 0.2048 Acc: 0.9282
val Loss: 1.0060 Acc: 0.7656
Epoch 11/48
----------
train Loss: 0.1145 Acc: 0.9599
val Loss: 0.6212 Acc: 0.8281
Epoch 12/48
----------
train Loss: 0.0837 Acc: 0.9666
val Loss: 0.5723 Acc: 0.8438
Epoch 13/48
----------
train Loss: 0.0936 Acc: 0.9699
val Loss: 0.6141 Acc: 0.8516
Epoch 14/48
----------
train Loss: 0.0974 Acc: 0.9666
val Loss: 1.0607 Acc: 0.8047
Epoch 15/48
----------
train Loss: 0.1107 Acc: 0.9683
val Loss: 0.4806 Acc: 0.8359
Epoch 16/48
----------
train Loss: 0.1786 Acc: 0.9566
val Loss: 0.9336 Acc: 0.7578
Epoch 17/48
----------
train Loss: 0.1562 Acc: 0.9533
val Loss: 0.9938 Acc: 0.7109
Epoch 18/48
----------
train Loss: 0.1489 Acc: 0.9516
val Loss: 0.6265 Acc: 0.8281
Epoch 19/48
----------
train Loss: 0.1392 Acc: 0.9583
val Loss: 0.6383 Acc: 0.7891
Epoch 20/48
----------
train Loss: 0.0948 Acc: 0.9649
val Loss: 0.7292 Acc: 0.8438
Epoch 21/48
----------
train Loss: 0.0638 Acc: 0.9833
val Loss: 0.6756 Acc: 0.8359
Epoch 22/48
----------
train Loss: 0.0372 Acc: 0.9933
val Loss: 0.6966 Acc: 0.8281
Epoch 23/48
----------
train Loss: 0.0728 Acc: 0.9850
val Loss: 0.6046 Acc: 0.8594
Epoch 24/48
----------
train Loss: 0.0783 Acc: 0.9699
val Loss: 1.0223 Acc: 0.8203
Epoch 25/48
----------
train Loss: 0.0672 Acc: 0.9816
val Loss: 0.6513 Acc: 0.8516
Epoch 26/48
----------
train Loss: 0.0714 Acc: 0.9750
val Loss: 0.7248 Acc: 0.8125
Epoch 27/48
----------
train Loss: 0.0667 Acc: 0.9716
val Loss: 1.3198 Acc: 0.7578
Epoch 28/48
----------
train Loss: 0.1650 Acc: 0.9482
val Loss: 1.1937 Acc: 0.6719
Epoch 29/48
----------
train Loss: 0.1733 Acc: 0.9349
val Loss: 0.9823 Acc: 0.7891
Epoch 30/48
----------
train Loss: 0.1290 Acc: 0.9649
val Loss: 0.6560 Acc: 0.8203
Epoch 31/48
----------
train Loss: 0.0905 Acc: 0.9699
val Loss: 0.5020 Acc: 0.8672
Epoch 32/48
----------
train Loss: 0.0785 Acc: 0.9766
val Loss: 0.6960 Acc: 0.8125
Epoch 33/48
----------
train Loss: 0.0846 Acc: 0.9733
val Loss: 0.5896 Acc: 0.8281
Epoch 34/48
----------
train Loss: 0.1277 Acc: 0.9499
val Loss: 1.0062 Acc: 0.8125
Epoch 35/48
----------
train Loss: 0.1027 Acc: 0.9683
val Loss: 0.7373 Acc: 0.8203
Epoch 36/48
----------
train Loss: 0.1113 Acc: 0.9566
val Loss: 0.9399 Acc: 0.7891
Epoch 37/48
----------
train Loss: 0.0835 Acc: 0.9683
val Loss: 0.8174 Acc: 0.8047
Epoch 38/48
----------
train Loss: 0.1686 Acc: 0.9499
val Loss: 1.1841 Acc: 0.7891
Epoch 39/48
----------
train Loss: 0.1711 Acc: 0.9549
val Loss: 1.3492 Acc: 0.7109
Epoch 40/48
----------
train Loss: 0.1166 Acc: 0.9516
val Loss: 0.7293 Acc: 0.8125
Epoch 41/48
----------
train Loss: 0.1050 Acc: 0.9666
val Loss: 0.6972 Acc: 0.7734
Epoch 42/48
----------
train Loss: 0.1479 Acc: 0.9516
val Loss: 0.8219 Acc: 0.8359
Epoch 43/48
----------
train Loss: 0.0788 Acc: 0.9766
val Loss: 0.7587 Acc: 0.8203
Epoch 44/48
----------
train Loss: 0.0456 Acc: 0.9866
val Loss: 0.7485 Acc: 0.8281
Epoch 45/48
----------
train Loss: 0.0510 Acc: 0.9883
val Loss: 0.5855 Acc: 0.8438
Epoch 46/48
----------
train Loss: 0.0293 Acc: 0.9900
val Loss: 0.6870 Acc: 0.8203
Epoch 47/48
----------
train Loss: 0.0855 Acc: 0.9783
val Loss: 0.7983 Acc: 0.8047
Epoch 48/48
----------
train Loss: 0.0625 Acc: 0.9866
[I 2024-10-15 21:46:41,951] Trial 188 finished with value: 0.796875 and parameters: {'batch_size': 89, 'lr': 0.00013807011133846336, 'num_epochs': 48, 'weight_decay': 0.022249354662101296, 'weight_loss_flag': False, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 0.9652 Acc: 0.7969
Best val Acc: 0.796875
Model weights saved at ./model_weights/ResNet34_bs_89_lr_0.00013807011133846336_epoch_48_wd_0.022249354662101296_wlf_False.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/36
----------
train Loss: 3.8582 Acc: 0.6344
val Loss: 3.1306 Acc: 0.7422
Epoch 2/36
----------
train Loss: 1.0815 Acc: 0.8447
val Loss: 2.1559 Acc: 0.8281
Epoch 3/36
----------
train Loss: 0.3948 Acc: 0.9533
val Loss: 2.5103 Acc: 0.8750
Epoch 4/36
----------
train Loss: 0.1737 Acc: 0.9850
val Loss: 2.5749 Acc: 0.8672
Epoch 5/36
----------
train Loss: 0.1077 Acc: 0.9917
val Loss: 2.7529 Acc: 0.8438
Epoch 6/36
----------
train Loss: 0.0915 Acc: 0.9917
val Loss: 2.2572 Acc: 0.8281
Epoch 7/36
----------
train Loss: 0.2201 Acc: 0.9699
val Loss: 3.2304 Acc: 0.8359
Epoch 8/36
----------
train Loss: 0.1547 Acc: 0.9866
val Loss: 3.1259 Acc: 0.8047
Epoch 9/36
----------
train Loss: 0.0963 Acc: 0.9900
val Loss: 3.9082 Acc: 0.8125
Epoch 10/36
----------
train Loss: 0.1310 Acc: 0.9850
val Loss: 2.9058 Acc: 0.8047
Epoch 11/36
----------
train Loss: 0.1961 Acc: 0.9716
val Loss: 4.0051 Acc: 0.8672
Epoch 12/36
----------
train Loss: 0.9700 Acc: 0.9432
val Loss: 4.9482 Acc: 0.6328
Epoch 13/36
----------
train Loss: 1.3536 Acc: 0.8581
val Loss: 4.2943 Acc: 0.5938
Epoch 14/36
----------
train Loss: 1.0266 Acc: 0.9082
val Loss: 5.7063 Acc: 0.7969
Epoch 15/36
----------
train Loss: 1.0196 Acc: 0.9215
val Loss: 3.2821 Acc: 0.8281
Epoch 16/36
----------
train Loss: 0.6004 Acc: 0.9416
val Loss: 3.1847 Acc: 0.7812
Epoch 17/36
----------
train Loss: 0.3708 Acc: 0.9683
val Loss: 3.3497 Acc: 0.8047
Epoch 18/36
----------
train Loss: 0.1327 Acc: 0.9850
val Loss: 3.1774 Acc: 0.8516
Epoch 19/36
----------
train Loss: 0.1471 Acc: 0.9833
val Loss: 3.4259 Acc: 0.8438
Epoch 20/36
----------
train Loss: 0.1199 Acc: 0.9850
val Loss: 3.1481 Acc: 0.8516
Epoch 21/36
----------
train Loss: 0.1864 Acc: 0.9800
val Loss: 3.2847 Acc: 0.8125
Epoch 22/36
----------
train Loss: 0.0849 Acc: 0.9933
val Loss: 4.1054 Acc: 0.8203
Epoch 23/36
----------
train Loss: 0.0624 Acc: 0.9950
val Loss: 4.2213 Acc: 0.8125
Epoch 24/36
----------
train Loss: 0.0861 Acc: 0.9866
val Loss: 3.2661 Acc: 0.8359
Epoch 25/36
----------
train Loss: 0.3889 Acc: 0.9549
val Loss: 3.9304 Acc: 0.8047
Epoch 26/36
----------
train Loss: 0.2800 Acc: 0.9750
val Loss: 4.2559 Acc: 0.8438
Epoch 27/36
----------
train Loss: 0.3269 Acc: 0.9549
val Loss: 5.5166 Acc: 0.5391
Epoch 28/36
----------
train Loss: 0.4071 Acc: 0.9549
val Loss: 4.3823 Acc: 0.8203
Epoch 29/36
----------
train Loss: 0.3439 Acc: 0.9549
val Loss: 3.3570 Acc: 0.8281
Epoch 30/36
----------
train Loss: 0.1635 Acc: 0.9816
val Loss: 3.2798 Acc: 0.8281
Epoch 31/36
----------
train Loss: 0.3375 Acc: 0.9733
val Loss: 4.5024 Acc: 0.7422
Epoch 32/36
----------
train Loss: 0.3810 Acc: 0.9616
val Loss: 4.5758 Acc: 0.8672
Epoch 33/36
----------
train Loss: 0.4220 Acc: 0.9499
val Loss: 3.8412 Acc: 0.7109
Epoch 34/36
----------
train Loss: 0.5227 Acc: 0.9583
val Loss: 3.0124 Acc: 0.7734
Epoch 35/36
----------
train Loss: 0.4023 Acc: 0.9549
val Loss: 3.5347 Acc: 0.8047
Epoch 36/36
----------
train Loss: 0.3408 Acc: 0.9666
[I 2024-10-15 21:49:27,165] Trial 189 finished with value: 0.8515625 and parameters: {'batch_size': 107, 'lr': 0.0001071072344371536, 'num_epochs': 36, 'weight_decay': 0.05706370852600536, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 3.0253 Acc: 0.8516
Best val Acc: 0.851562
Model weights saved at ./model_weights/ResNet34_bs_107_lr_0.0001071072344371536_epoch_36_wd_0.05706370852600536_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/55
----------
train Loss: 2.6690 Acc: 0.6778
val Loss: 1.6063 Acc: 0.7656
Epoch 2/55
----------
train Loss: 1.8184 Acc: 0.7596
val Loss: 1.2049 Acc: 0.8047
Epoch 3/55
----------
train Loss: 1.8289 Acc: 0.7730
val Loss: 1.3755 Acc: 0.8125
Epoch 4/55
----------
train Loss: 1.7500 Acc: 0.7963
val Loss: 1.4451 Acc: 0.8125
Epoch 5/55
----------
train Loss: 1.6592 Acc: 0.7863
val Loss: 1.5928 Acc: 0.7344
Epoch 6/55
----------
train Loss: 1.5458 Acc: 0.8815
val Loss: 1.1565 Acc: 0.8438
Epoch 7/55
----------
train Loss: 1.3358 Acc: 0.8781
val Loss: 1.3173 Acc: 0.8047
Epoch 8/55
----------
train Loss: 1.4111 Acc: 0.8548
val Loss: 1.4513 Acc: 0.8594
Epoch 9/55
----------
train Loss: 1.6228 Acc: 0.8297
val Loss: 1.3128 Acc: 0.8203
Epoch 10/55
----------
train Loss: 1.7181 Acc: 0.8114
val Loss: 1.6966 Acc: 0.7578
Epoch 11/55
----------
train Loss: 1.3129 Acc: 0.8831
val Loss: 1.5271 Acc: 0.7891
Epoch 12/55
----------
train Loss: 1.3999 Acc: 0.8631
val Loss: 1.3322 Acc: 0.7891
Epoch 13/55
----------
train Loss: 1.4557 Acc: 0.8898
val Loss: 1.3531 Acc: 0.7891
Epoch 14/55
----------
train Loss: 1.3126 Acc: 0.9065
val Loss: 1.7635 Acc: 0.7344
Epoch 15/55
----------
train Loss: 1.5133 Acc: 0.8564
val Loss: 2.1584 Acc: 0.6094
Epoch 16/55
----------
train Loss: 1.3971 Acc: 0.8965
val Loss: 2.0190 Acc: 0.7266
Epoch 17/55
----------
train Loss: 1.4962 Acc: 0.8648
val Loss: 1.7594 Acc: 0.7422
Epoch 18/55
----------
train Loss: 1.5716 Acc: 0.8598
val Loss: 1.8443 Acc: 0.6875
Epoch 19/55
----------
train Loss: 1.4557 Acc: 0.8631
val Loss: 2.1709 Acc: 0.7188
Epoch 20/55
----------
train Loss: 1.4247 Acc: 0.8631
val Loss: 1.6876 Acc: 0.7969
Epoch 21/55
----------
train Loss: 1.2776 Acc: 0.8898
val Loss: 1.5672 Acc: 0.7656
Epoch 22/55
----------
train Loss: 1.5002 Acc: 0.8731
val Loss: 2.1222 Acc: 0.7500
Epoch 23/55
----------
train Loss: 1.2662 Acc: 0.8915
val Loss: 1.4355 Acc: 0.7656
Epoch 24/55
----------
train Loss: 1.5204 Acc: 0.8664
val Loss: 1.3548 Acc: 0.7969
Epoch 25/55
----------
train Loss: 1.4652 Acc: 0.8497
val Loss: 1.2001 Acc: 0.8125
Epoch 26/55
----------
train Loss: 1.3148 Acc: 0.8815
val Loss: 1.5453 Acc: 0.7422
Epoch 27/55
----------
train Loss: 1.2499 Acc: 0.9115
val Loss: 1.7442 Acc: 0.7812
Epoch 28/55
----------
train Loss: 1.5122 Acc: 0.8715
val Loss: 1.5670 Acc: 0.7578
Epoch 29/55
----------
train Loss: 1.5286 Acc: 0.8230
val Loss: 1.2680 Acc: 0.8203
Epoch 30/55
----------
train Loss: 1.5576 Acc: 0.8164
val Loss: 1.8105 Acc: 0.7656
Epoch 31/55
----------
train Loss: 1.4966 Acc: 0.8097
val Loss: 1.6815 Acc: 0.7344
Epoch 32/55
----------
train Loss: 1.5553 Acc: 0.8497
val Loss: 1.8969 Acc: 0.7422
Epoch 33/55
----------
train Loss: 1.5844 Acc: 0.8414
val Loss: 1.4153 Acc: 0.7812
Epoch 34/55
----------
train Loss: 1.2720 Acc: 0.9015
val Loss: 1.8296 Acc: 0.7500
Epoch 35/55
----------
train Loss: 1.5015 Acc: 0.8063
val Loss: 1.5246 Acc: 0.7500
Epoch 36/55
----------
train Loss: 1.5837 Acc: 0.8164
val Loss: 1.8744 Acc: 0.7109
Epoch 37/55
----------
train Loss: 1.4493 Acc: 0.8681
val Loss: 1.4766 Acc: 0.7734
Epoch 38/55
----------
train Loss: 1.3678 Acc: 0.8715
val Loss: 1.8021 Acc: 0.7188
Epoch 39/55
----------
train Loss: 1.4158 Acc: 0.8748
val Loss: 2.0776 Acc: 0.7422
Epoch 40/55
----------
train Loss: 1.2294 Acc: 0.9115
val Loss: 2.0812 Acc: 0.7188
Epoch 41/55
----------
train Loss: 1.1685 Acc: 0.9065
val Loss: 1.9947 Acc: 0.6562
Epoch 42/55
----------
train Loss: 1.3826 Acc: 0.8664
val Loss: 1.9225 Acc: 0.7344
Epoch 43/55
----------
train Loss: 1.5451 Acc: 0.8097
val Loss: 2.1994 Acc: 0.6172
Epoch 44/55
----------
train Loss: 1.3387 Acc: 0.8631
val Loss: 1.5581 Acc: 0.7578
Epoch 45/55
----------
train Loss: 1.5176 Acc: 0.8548
val Loss: 1.6627 Acc: 0.7969
Epoch 46/55
----------
train Loss: 1.4333 Acc: 0.8731
val Loss: 1.5262 Acc: 0.7969
Epoch 47/55
----------
train Loss: 1.2670 Acc: 0.9115
val Loss: 1.6926 Acc: 0.7109
Epoch 48/55
----------
train Loss: 1.3246 Acc: 0.8982
val Loss: 1.6305 Acc: 0.7734
Epoch 49/55
----------
train Loss: 1.2645 Acc: 0.8898
val Loss: 2.2418 Acc: 0.6953
Epoch 50/55
----------
train Loss: 1.4759 Acc: 0.8681
val Loss: 1.8788 Acc: 0.7188
Epoch 51/55
----------
train Loss: 1.3065 Acc: 0.9082
val Loss: 1.4348 Acc: 0.8047
Epoch 52/55
----------
train Loss: 1.3151 Acc: 0.8982
val Loss: 1.5044 Acc: 0.7422
Epoch 53/55
----------
train Loss: 1.4981 Acc: 0.8698
val Loss: 1.5035 Acc: 0.7969
Epoch 54/55
----------
train Loss: 1.5074 Acc: 0.8781
val Loss: 1.8418 Acc: 0.7109
Epoch 55/55
----------
train Loss: 1.2690 Acc: 0.9165
[I 2024-10-15 21:53:33,490] Trial 190 finished with value: 0.796875 and parameters: {'batch_size': 81, 'lr': 0.00019286093010816455, 'num_epochs': 55, 'weight_decay': 0.03456783964394443, 'weight_loss_flag': True, 'mixup_flag': True}. Best is trial 150 with value: 0.9140625.
val Loss: 1.8907 Acc: 0.7266
Best val Acc: 0.796875
Model weights saved at ./model_weights/ResNet34_bs_81_lr_0.00019286093010816455_epoch_55_wd_0.03456783964394443_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/52
----------
train Loss: 4.6287 Acc: 0.5209
val Loss: 3.1960 Acc: 0.7578
Epoch 2/52
----------
train Loss: 1.2589 Acc: 0.8180
val Loss: 2.6648 Acc: 0.7812
Epoch 3/52
----------
train Loss: 0.4622 Acc: 0.9583
val Loss: 2.7437 Acc: 0.8438
Epoch 4/52
----------
train Loss: 0.2010 Acc: 0.9917
val Loss: 2.8815 Acc: 0.8359
Epoch 5/52
----------
train Loss: 0.1180 Acc: 0.9967
val Loss: 3.0022 Acc: 0.8359
Epoch 6/52
----------
train Loss: 0.1178 Acc: 0.9933
val Loss: 3.1063 Acc: 0.8438
Epoch 7/52
----------
train Loss: 0.0994 Acc: 0.9933
val Loss: 2.9218 Acc: 0.8359
Epoch 8/52
----------
train Loss: 0.0942 Acc: 0.9950
val Loss: 3.2308 Acc: 0.8281
Epoch 9/52
----------
train Loss: 0.1150 Acc: 0.9900
val Loss: 3.0869 Acc: 0.8516
Epoch 10/52
----------
train Loss: 0.0681 Acc: 0.9967
val Loss: 3.4087 Acc: 0.8594
Epoch 11/52
----------
train Loss: 0.0459 Acc: 0.9967
val Loss: 3.7421 Acc: 0.8516
Epoch 12/52
----------
train Loss: 0.0477 Acc: 0.9967
val Loss: 3.7474 Acc: 0.8438
Epoch 13/52
----------
train Loss: 0.0294 Acc: 0.9967
val Loss: 3.9976 Acc: 0.8438
Epoch 14/52
----------
train Loss: 0.0331 Acc: 0.9967
val Loss: 4.0445 Acc: 0.8516
Epoch 15/52
----------
train Loss: 0.0364 Acc: 0.9967
val Loss: 4.2314 Acc: 0.8359
Epoch 16/52
----------
train Loss: 0.0230 Acc: 0.9967
val Loss: 3.7111 Acc: 0.8594
Epoch 17/52
----------
train Loss: 0.0227 Acc: 0.9967
val Loss: 3.8192 Acc: 0.8516
Epoch 18/52
----------
train Loss: 0.0276 Acc: 0.9983
val Loss: 4.6541 Acc: 0.8047
Epoch 19/52
----------
train Loss: 0.0865 Acc: 0.9900
val Loss: 4.8241 Acc: 0.7969
Epoch 20/52
----------
train Loss: 0.6895 Acc: 0.9482
val Loss: 6.3824 Acc: 0.7344
Epoch 21/52
----------
train Loss: 1.0928 Acc: 0.8715
val Loss: 6.0325 Acc: 0.6172
Epoch 22/52
----------
train Loss: 0.5565 Acc: 0.9332
val Loss: 6.2678 Acc: 0.6406
Epoch 23/52
----------
train Loss: 0.4675 Acc: 0.9416
val Loss: 4.5811 Acc: 0.8125
Epoch 24/52
----------
train Loss: 0.2914 Acc: 0.9599
val Loss: 4.4045 Acc: 0.7891
Epoch 25/52
----------
train Loss: 0.1932 Acc: 0.9833
val Loss: 4.6245 Acc: 0.7891
Epoch 26/52
----------
train Loss: 0.0748 Acc: 0.9917
val Loss: 4.1831 Acc: 0.8359
Epoch 27/52
----------
train Loss: 0.0544 Acc: 0.9983
val Loss: 4.0746 Acc: 0.8438
Epoch 28/52
----------
train Loss: 0.0334 Acc: 0.9967
val Loss: 3.9418 Acc: 0.8438
Epoch 29/52
----------
train Loss: 0.0199 Acc: 0.9983
val Loss: 3.9684 Acc: 0.8359
Epoch 30/52
----------
train Loss: 0.0158 Acc: 0.9983
val Loss: 3.9849 Acc: 0.8359
Epoch 31/52
----------
train Loss: 0.0162 Acc: 0.9983
val Loss: 4.1895 Acc: 0.8281
Epoch 32/52
----------
train Loss: 0.0144 Acc: 0.9983
val Loss: 4.1553 Acc: 0.8359
Epoch 33/52
----------
train Loss: 0.0138 Acc: 1.0000
val Loss: 4.1811 Acc: 0.8281
Epoch 34/52
----------
train Loss: 0.0114 Acc: 0.9983
val Loss: 4.3504 Acc: 0.8281
Epoch 35/52
----------
train Loss: 0.0162 Acc: 0.9983
val Loss: 4.2250 Acc: 0.8281
Epoch 36/52
----------
train Loss: 0.0135 Acc: 0.9983
val Loss: 4.2822 Acc: 0.8359
Epoch 37/52
----------
train Loss: 0.0099 Acc: 0.9983
val Loss: 4.4600 Acc: 0.8281
Epoch 38/52
----------
train Loss: 0.0186 Acc: 0.9983
val Loss: 4.2840 Acc: 0.8359
Epoch 39/52
----------
train Loss: 0.0199 Acc: 0.9983
val Loss: 4.4325 Acc: 0.8516
Epoch 40/52
----------
train Loss: 0.0136 Acc: 0.9983
val Loss: 4.2051 Acc: 0.8359
Epoch 41/52
----------
train Loss: 0.0109 Acc: 0.9983
val Loss: 4.4025 Acc: 0.8281
Epoch 42/52
----------
train Loss: 0.0135 Acc: 0.9983
val Loss: 4.4090 Acc: 0.8438
Epoch 43/52
----------
train Loss: 0.0133 Acc: 0.9983
val Loss: 4.4497 Acc: 0.8281
Epoch 44/52
----------
train Loss: 0.0126 Acc: 0.9983
val Loss: 4.2015 Acc: 0.8359
Epoch 45/52
----------
train Loss: 0.0106 Acc: 0.9983
val Loss: 4.2504 Acc: 0.8281
Epoch 46/52
----------
train Loss: 0.0124 Acc: 0.9983
val Loss: 4.2069 Acc: 0.8359
Epoch 47/52
----------
train Loss: 0.0133 Acc: 0.9983
val Loss: 4.4053 Acc: 0.8281
Epoch 48/52
----------
train Loss: 0.0121 Acc: 0.9983
val Loss: 4.2943 Acc: 0.8281
Epoch 49/52
----------
train Loss: 0.0103 Acc: 0.9983
val Loss: 4.2676 Acc: 0.8281
Epoch 50/52
----------
train Loss: 0.0218 Acc: 0.9967
val Loss: 4.3826 Acc: 0.8203
Epoch 51/52
----------
train Loss: 0.1237 Acc: 0.9866
val Loss: 6.7204 Acc: 0.8203
Epoch 52/52
----------
train Loss: 0.4359 Acc: 0.9399
[I 2024-10-15 21:57:26,561] Trial 191 finished with value: 0.8203125 and parameters: {'batch_size': 90, 'lr': 6.592152195156157e-05, 'num_epochs': 52, 'weight_decay': 0.024982264223958637, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 5.8633 Acc: 0.6875
Best val Acc: 0.820312
Model weights saved at ./model_weights/ResNet34_bs_90_lr_6.592152195156157e-05_epoch_52_wd_0.024982264223958637_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/54
----------
train Loss: 3.8796 Acc: 0.5576
val Loss: 5.9914 Acc: 0.4375
Epoch 2/54
----------
train Loss: 3.1126 Acc: 0.7396
val Loss: 5.2015 Acc: 0.5000
Epoch 3/54
----------
train Loss: 1.7322 Acc: 0.8214
val Loss: 4.3572 Acc: 0.6172
Epoch 4/54
----------
train Loss: 0.9706 Acc: 0.8831
val Loss: 3.4519 Acc: 0.6562
Epoch 5/54
----------
train Loss: 0.7774 Acc: 0.9249
val Loss: 2.8960 Acc: 0.7812
Epoch 6/54
----------
train Loss: 0.5790 Acc: 0.9349
val Loss: 3.0407 Acc: 0.6172
Epoch 7/54
----------
train Loss: 0.5602 Acc: 0.9366
val Loss: 5.9790 Acc: 0.5938
Epoch 8/54
----------
train Loss: 0.8128 Acc: 0.9115
val Loss: 5.0633 Acc: 0.7188
Epoch 9/54
----------
train Loss: 0.7553 Acc: 0.9249
val Loss: 4.6559 Acc: 0.5312
Epoch 10/54
----------
train Loss: 0.5827 Acc: 0.9533
[I 2024-10-15 21:58:12,006] Trial 192 finished with value: 0.78125 and parameters: {'batch_size': 100, 'lr': 0.0003733771966358838, 'num_epochs': 54, 'weight_decay': 0.017433323920255057, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 9.0261 Acc: 0.6641
Early stopping at epoch 10 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.781250
Model weights saved at ./model_weights/ResNet34_bs_100_lr_0.0003733771966358838_epoch_54_wd_0.017433323920255057_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/59
----------
train Loss: 3.6777 Acc: 0.5643
val Loss: 4.5600 Acc: 0.7500
Epoch 2/59
----------
train Loss: 1.0229 Acc: 0.8731
val Loss: 3.3211 Acc: 0.7344
Epoch 3/59
----------
train Loss: 0.3226 Acc: 0.9633
val Loss: 3.2251 Acc: 0.8047
Epoch 4/59
----------
train Loss: 0.2941 Acc: 0.9783
val Loss: 3.8601 Acc: 0.7422
Epoch 5/59
----------
train Loss: 0.1937 Acc: 0.9850
val Loss: 3.3691 Acc: 0.8203
Epoch 6/59
----------
train Loss: 0.1147 Acc: 0.9883
val Loss: 4.1659 Acc: 0.8203
Epoch 7/59
----------
train Loss: 0.1302 Acc: 0.9900
val Loss: 4.0609 Acc: 0.8203
Epoch 8/59
----------
train Loss: 0.0577 Acc: 0.9933
val Loss: 4.0167 Acc: 0.8281
Epoch 9/59
----------
train Loss: 0.1173 Acc: 0.9850
val Loss: 3.7889 Acc: 0.8047
Epoch 10/59
----------
train Loss: 0.0893 Acc: 0.9900
val Loss: 4.1746 Acc: 0.8047
Epoch 11/59
----------
train Loss: 0.0805 Acc: 0.9917
val Loss: 3.9939 Acc: 0.8203
Epoch 12/59
----------
train Loss: 0.0908 Acc: 0.9900
val Loss: 4.6327 Acc: 0.7969
Epoch 13/59
----------
train Loss: 0.0598 Acc: 0.9950
val Loss: 3.9958 Acc: 0.8047
Epoch 14/59
----------
train Loss: 0.0552 Acc: 0.9933
val Loss: 4.1399 Acc: 0.8125
Epoch 15/59
----------
train Loss: 0.0723 Acc: 0.9933
val Loss: 4.2986 Acc: 0.8125
Epoch 16/59
----------
train Loss: 0.0484 Acc: 0.9950
val Loss: 4.7572 Acc: 0.8203
Epoch 17/59
----------
train Loss: 0.0509 Acc: 0.9950
val Loss: 4.6953 Acc: 0.8359
Epoch 18/59
----------
train Loss: 0.0439 Acc: 0.9933
val Loss: 4.4785 Acc: 0.8281
Epoch 19/59
----------
train Loss: 0.0403 Acc: 0.9933
val Loss: 4.2049 Acc: 0.8359
Epoch 20/59
----------
train Loss: 0.0345 Acc: 0.9950
val Loss: 4.2045 Acc: 0.8281
Epoch 21/59
----------
train Loss: 0.0358 Acc: 0.9950
val Loss: 4.6626 Acc: 0.8203
Epoch 22/59
----------
train Loss: 0.0494 Acc: 0.9933
val Loss: 4.6104 Acc: 0.8203
Epoch 23/59
----------
train Loss: 0.0541 Acc: 0.9933
val Loss: 4.7476 Acc: 0.8125
Epoch 24/59
----------
train Loss: 0.0397 Acc: 0.9933
val Loss: 4.7090 Acc: 0.8438
Epoch 25/59
----------
train Loss: 0.0354 Acc: 0.9950
val Loss: 4.5533 Acc: 0.8281
Epoch 26/59
----------
train Loss: 0.0488 Acc: 0.9950
val Loss: 4.6642 Acc: 0.8359
Epoch 27/59
----------
train Loss: 0.0367 Acc: 0.9950
val Loss: 4.6654 Acc: 0.8516
Epoch 28/59
----------
train Loss: 0.0356 Acc: 0.9950
val Loss: 4.5533 Acc: 0.8516
Epoch 29/59
----------
train Loss: 0.0525 Acc: 0.9933
val Loss: 4.2459 Acc: 0.8359
Epoch 30/59
----------
train Loss: 0.0406 Acc: 0.9950
val Loss: 4.6114 Acc: 0.8516
Epoch 31/59
----------
train Loss: 0.0403 Acc: 0.9950
val Loss: 4.5319 Acc: 0.8594
Epoch 32/59
----------
train Loss: 0.0388 Acc: 0.9933
val Loss: 4.2357 Acc: 0.8438
Epoch 33/59
----------
train Loss: 0.0414 Acc: 0.9950
val Loss: 4.3842 Acc: 0.8359
Epoch 34/59
----------
train Loss: 0.0364 Acc: 0.9950
val Loss: 4.4686 Acc: 0.8438
Epoch 35/59
----------
train Loss: 0.0390 Acc: 0.9933
val Loss: 4.5572 Acc: 0.8516
Epoch 36/59
----------
train Loss: 0.0346 Acc: 0.9950
val Loss: 4.6465 Acc: 0.8438
Epoch 37/59
----------
train Loss: 0.0363 Acc: 0.9950
val Loss: 4.6996 Acc: 0.8438
Epoch 38/59
----------
train Loss: 0.0447 Acc: 0.9950
val Loss: 4.7583 Acc: 0.8594
Epoch 39/59
----------
train Loss: 0.0377 Acc: 0.9933
val Loss: 4.7227 Acc: 0.8359
Epoch 40/59
----------
train Loss: 0.0364 Acc: 0.9950
val Loss: 4.4734 Acc: 0.8359
Epoch 41/59
----------
train Loss: 0.0327 Acc: 0.9950
val Loss: 4.3765 Acc: 0.8359
Epoch 42/59
----------
train Loss: 0.0333 Acc: 0.9950
val Loss: 4.4271 Acc: 0.8359
Epoch 43/59
----------
train Loss: 0.0439 Acc: 0.9950
val Loss: 4.4056 Acc: 0.8203
Epoch 44/59
----------
train Loss: 0.0437 Acc: 0.9933
val Loss: 5.4405 Acc: 0.8281
Epoch 45/59
----------
train Loss: 0.0441 Acc: 0.9950
val Loss: 5.3002 Acc: 0.7969
Epoch 46/59
----------
train Loss: 0.0701 Acc: 0.9917
val Loss: 3.8559 Acc: 0.8047
Epoch 47/59
----------
train Loss: 1.7361 Acc: 0.8715
val Loss: 12.0455 Acc: 0.6641
Epoch 48/59
----------
train Loss: 3.0307 Acc: 0.7329
val Loss: 19.6110 Acc: 0.7031
Epoch 49/59
----------
train Loss: 2.0950 Acc: 0.7546
val Loss: 33.2500 Acc: 0.3984
Epoch 50/59
----------
train Loss: 1.8980 Acc: 0.8280
val Loss: 5.0319 Acc: 0.6875
Epoch 51/59
----------
train Loss: 0.9275 Acc: 0.8798
val Loss: 3.5352 Acc: 0.8047
Epoch 52/59
----------
train Loss: 0.5106 Acc: 0.9366
val Loss: 5.3691 Acc: 0.7188
Epoch 53/59
----------
train Loss: 0.3294 Acc: 0.9616
val Loss: 4.8178 Acc: 0.8047
Epoch 54/59
----------
train Loss: 0.2607 Acc: 0.9649
val Loss: 5.3927 Acc: 0.8047
Epoch 55/59
----------
train Loss: 0.4522 Acc: 0.9616
val Loss: 4.3311 Acc: 0.7812
Epoch 56/59
----------
train Loss: 0.3119 Acc: 0.9649
val Loss: 7.2512 Acc: 0.7188
Epoch 57/59
----------
train Loss: 0.1744 Acc: 0.9850
val Loss: 5.2945 Acc: 0.7656
Epoch 58/59
----------
train Loss: 0.1142 Acc: 0.9883
val Loss: 6.2964 Acc: 0.8359
Epoch 59/59
----------
train Loss: 0.1033 Acc: 0.9933
[I 2024-10-15 22:02:37,353] Trial 193 finished with value: 0.8359375 and parameters: {'batch_size': 97, 'lr': 0.0001332283518619105, 'num_epochs': 59, 'weight_decay': 0.0015665982664435567, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 5.7093 Acc: 0.8359
Best val Acc: 0.835938
Model weights saved at ./model_weights/ResNet34_bs_97_lr_0.0001332283518619105_epoch_59_wd_0.0015665982664435567_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/52
----------
train Loss: 6.3963 Acc: 0.3890
val Loss: 42.1192 Acc: 0.3125
Epoch 2/52
----------
train Loss: 4.4582 Acc: 0.5359
val Loss: 4.6068 Acc: 0.4531
Epoch 3/52
----------
train Loss: 3.9241 Acc: 0.6227
val Loss: 3.6234 Acc: 0.5781
Epoch 4/52
----------
train Loss: 4.3623 Acc: 0.5292
val Loss: 8.7620 Acc: 0.2969
Epoch 5/52
----------
train Loss: 4.1149 Acc: 0.6060
val Loss: 17.0258 Acc: 0.2266
Epoch 6/52
----------
train Loss: 3.9178 Acc: 0.6127
val Loss: 4.1363 Acc: 0.6328
Epoch 7/52
----------
train Loss: 3.6310 Acc: 0.6311
val Loss: 3.2847 Acc: 0.7188
Epoch 8/52
----------
train Loss: 3.9186 Acc: 0.6160
val Loss: 4.1254 Acc: 0.6016
Epoch 9/52
----------
train Loss: 3.5591 Acc: 0.6594
val Loss: 9.2170 Acc: 0.5703
Epoch 10/52
----------
train Loss: 3.4643 Acc: 0.5893
val Loss: 4.4250 Acc: 0.6953
Epoch 11/52
----------
train Loss: 3.1211 Acc: 0.7095
val Loss: 6.5292 Acc: 0.3984
Epoch 12/52
----------
train Loss: 3.3044 Acc: 0.6628
val Loss: 5.0412 Acc: 0.5938
Epoch 13/52
----------
train Loss: 3.3333 Acc: 0.6861
val Loss: 3.0707 Acc: 0.6953
Epoch 14/52
----------
train Loss: 2.9137 Acc: 0.6928
val Loss: 4.9694 Acc: 0.6406
Epoch 15/52
----------
train Loss: 3.8795 Acc: 0.5927
val Loss: 14.2609 Acc: 0.1953
Epoch 16/52
----------
train Loss: 3.5686 Acc: 0.6561
val Loss: 6.2893 Acc: 0.5469
Epoch 17/52
----------
train Loss: 3.6468 Acc: 0.6978
val Loss: 5.8277 Acc: 0.4375
Epoch 18/52
----------
train Loss: 3.2194 Acc: 0.6628
val Loss: 3.7664 Acc: 0.7188
Epoch 19/52
----------
train Loss: 2.8241 Acc: 0.7162
val Loss: 4.8326 Acc: 0.5000
Epoch 20/52
----------
train Loss: 3.7464 Acc: 0.6544
val Loss: 5.9906 Acc: 0.6250
Epoch 21/52
----------
train Loss: 3.2537 Acc: 0.6811
val Loss: 4.2454 Acc: 0.7031
Epoch 22/52
----------
train Loss: 2.9563 Acc: 0.7095
val Loss: 3.8812 Acc: 0.6797
Epoch 23/52
----------
train Loss: 3.4114 Acc: 0.6978
val Loss: 9.6430 Acc: 0.2422
Epoch 24/52
----------
train Loss: 3.0163 Acc: 0.6594
val Loss: 4.5214 Acc: 0.7188
Epoch 25/52
----------
train Loss: 2.4696 Acc: 0.7379
val Loss: 7.3455 Acc: 0.5156
Epoch 26/52
----------
train Loss: 2.7070 Acc: 0.7212
val Loss: 12.0149 Acc: 0.6484
Epoch 27/52
----------
train Loss: 2.1948 Acc: 0.7613
val Loss: 5.5303 Acc: 0.6016
Epoch 28/52
----------
train Loss: 1.8478 Acc: 0.7763
val Loss: 4.7209 Acc: 0.7188
Epoch 29/52
----------
train Loss: 2.3495 Acc: 0.7579
val Loss: 4.9549 Acc: 0.6953
Epoch 30/52
----------
train Loss: 2.5224 Acc: 0.7446
val Loss: 4.7198 Acc: 0.5000
Epoch 31/52
----------
train Loss: 2.5121 Acc: 0.7212
val Loss: 4.2615 Acc: 0.6719
Epoch 32/52
----------
train Loss: 2.0639 Acc: 0.7980
val Loss: 6.0827 Acc: 0.5547
Epoch 33/52
----------
train Loss: 1.9626 Acc: 0.7696
val Loss: 7.9055 Acc: 0.6953
Epoch 34/52
----------
train Loss: 2.5623 Acc: 0.7195
val Loss: 4.7310 Acc: 0.6016
Epoch 35/52
----------
train Loss: 2.0558 Acc: 0.7730
val Loss: 6.7786 Acc: 0.7422
Epoch 36/52
----------
train Loss: 1.9596 Acc: 0.7646
val Loss: 8.1442 Acc: 0.5781
Epoch 37/52
----------
train Loss: 2.0262 Acc: 0.7780
val Loss: 5.6379 Acc: 0.5312
Epoch 38/52
----------
train Loss: 1.9148 Acc: 0.7613
val Loss: 4.7636 Acc: 0.5469
Epoch 39/52
----------
train Loss: 1.7935 Acc: 0.7746
val Loss: 4.8181 Acc: 0.5000
Epoch 40/52
----------
train Loss: 1.7495 Acc: 0.7896
[I 2024-10-15 22:05:37,454] Trial 194 finished with value: 0.7421875 and parameters: {'batch_size': 92, 'lr': 0.0011301822436847984, 'num_epochs': 52, 'weight_decay': 0.02792193012208216, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 5.2338 Acc: 0.5625
Early stopping at epoch 40 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.742188
Model weights saved at ./model_weights/ResNet34_bs_92_lr_0.0011301822436847984_epoch_52_wd_0.02792193012208216_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/57
----------
train Loss: 4.0435 Acc: 0.5058
val Loss: 3.4532 Acc: 0.8047
Epoch 2/57
----------
train Loss: 0.9793 Acc: 0.8614
val Loss: 2.6145 Acc: 0.8359
Epoch 3/57
----------
train Loss: 0.2634 Acc: 0.9750
val Loss: 3.0378 Acc: 0.8047
Epoch 4/57
----------
train Loss: 0.1985 Acc: 0.9833
val Loss: 2.9971 Acc: 0.8203
Epoch 5/57
----------
train Loss: 0.1661 Acc: 0.9816
val Loss: 3.2317 Acc: 0.8516
Epoch 6/57
----------
train Loss: 0.1892 Acc: 0.9866
val Loss: 4.9805 Acc: 0.7812
Epoch 7/57
----------
train Loss: 0.1576 Acc: 0.9850
val Loss: 2.9164 Acc: 0.8750
Epoch 8/57
----------
train Loss: 0.0737 Acc: 0.9900
val Loss: 4.5163 Acc: 0.8047
Epoch 9/57
----------
train Loss: 0.0890 Acc: 0.9900
val Loss: 3.5110 Acc: 0.8359
Epoch 10/57
----------
train Loss: 0.0619 Acc: 0.9950
val Loss: 3.9955 Acc: 0.8047
Epoch 11/57
----------
train Loss: 0.0573 Acc: 0.9950
val Loss: 3.7482 Acc: 0.8047
Epoch 12/57
----------
train Loss: 0.0320 Acc: 0.9967
val Loss: 3.4136 Acc: 0.7969
Epoch 13/57
----------
train Loss: 0.0279 Acc: 0.9967
val Loss: 4.1825 Acc: 0.8281
Epoch 14/57
----------
train Loss: 0.0262 Acc: 0.9983
val Loss: 4.2788 Acc: 0.8516
Epoch 15/57
----------
train Loss: 0.0176 Acc: 0.9983
val Loss: 4.7853 Acc: 0.8203
Epoch 16/57
----------
train Loss: 0.0166 Acc: 0.9983
val Loss: 4.7033 Acc: 0.8203
Epoch 17/57
----------
train Loss: 0.0305 Acc: 0.9967
val Loss: 4.8166 Acc: 0.7969
Epoch 18/57
----------
train Loss: 0.0230 Acc: 0.9983
val Loss: 4.1116 Acc: 0.8359
Epoch 19/57
----------
train Loss: 0.0226 Acc: 0.9983
val Loss: 5.1581 Acc: 0.7969
Epoch 20/57
----------
train Loss: 0.1133 Acc: 0.9900
val Loss: 3.9804 Acc: 0.8438
Epoch 21/57
----------
train Loss: 0.6158 Acc: 0.9499
val Loss: 7.8766 Acc: 0.5547
Epoch 22/57
----------
train Loss: 2.1353 Acc: 0.7896
val Loss: 6.7735 Acc: 0.6172
Epoch 23/57
----------
train Loss: 1.8386 Acc: 0.8247
val Loss: 3.6655 Acc: 0.6875
Epoch 24/57
----------
train Loss: 0.8982 Acc: 0.8982
val Loss: 2.4406 Acc: 0.8047
Epoch 25/57
----------
train Loss: 0.4465 Acc: 0.9633
val Loss: 3.1045 Acc: 0.7344
Epoch 26/57
----------
train Loss: 0.1656 Acc: 0.9850
val Loss: 3.1384 Acc: 0.7891
Epoch 27/57
----------
train Loss: 0.1088 Acc: 0.9917
val Loss: 3.5874 Acc: 0.7656
Epoch 28/57
----------
train Loss: 0.0870 Acc: 0.9900
val Loss: 3.9870 Acc: 0.7812
Epoch 29/57
----------
train Loss: 0.0684 Acc: 0.9950
val Loss: 3.4196 Acc: 0.8047
Epoch 30/57
----------
train Loss: 0.0515 Acc: 0.9950
val Loss: 3.7505 Acc: 0.7891
Epoch 31/57
----------
train Loss: 0.0248 Acc: 0.9967
val Loss: 3.7245 Acc: 0.7812
Epoch 32/57
----------
train Loss: 0.0220 Acc: 0.9983
val Loss: 3.9360 Acc: 0.8125
Epoch 33/57
----------
train Loss: 0.0260 Acc: 0.9983
val Loss: 3.9902 Acc: 0.7891
Epoch 34/57
----------
train Loss: 0.0197 Acc: 0.9983
val Loss: 4.5274 Acc: 0.7969
Epoch 35/57
----------
train Loss: 0.0221 Acc: 0.9983
val Loss: 4.9689 Acc: 0.8125
Epoch 36/57
----------
train Loss: 0.0292 Acc: 0.9967
val Loss: 4.8837 Acc: 0.8047
Epoch 37/57
----------
train Loss: 0.0685 Acc: 0.9917
val Loss: 4.5817 Acc: 0.8203
Epoch 38/57
----------
train Loss: 0.0741 Acc: 0.9933
val Loss: 5.2806 Acc: 0.8203
Epoch 39/57
----------
train Loss: 0.0437 Acc: 0.9983
val Loss: 3.8081 Acc: 0.8281
Epoch 40/57
----------
train Loss: 0.0640 Acc: 0.9933
val Loss: 5.2360 Acc: 0.8203
Epoch 41/57
----------
train Loss: 0.0485 Acc: 0.9917
val Loss: 3.8336 Acc: 0.8047
Epoch 42/57
----------
train Loss: 0.0149 Acc: 1.0000
val Loss: 4.6753 Acc: 0.8125
Epoch 43/57
----------
train Loss: 0.0541 Acc: 0.9950
val Loss: 4.7474 Acc: 0.8125
Epoch 44/57
----------
train Loss: 0.1643 Acc: 0.9833
val Loss: 3.2938 Acc: 0.7891
Epoch 45/57
----------
train Loss: 0.1701 Acc: 0.9816
val Loss: 4.7330 Acc: 0.7734
Epoch 46/57
----------
train Loss: 0.3354 Acc: 0.9716
val Loss: 5.2787 Acc: 0.7656
Epoch 47/57
----------
train Loss: 0.6036 Acc: 0.9265
val Loss: 6.5908 Acc: 0.7266
Epoch 48/57
----------
train Loss: 0.8668 Acc: 0.9032
val Loss: 4.8266 Acc: 0.5781
Epoch 49/57
----------
train Loss: 0.3851 Acc: 0.9583
val Loss: 2.7236 Acc: 0.8281
Epoch 50/57
----------
train Loss: 0.3561 Acc: 0.9583
val Loss: 4.3630 Acc: 0.7969
Epoch 51/57
----------
train Loss: 0.5097 Acc: 0.9716
val Loss: 3.9350 Acc: 0.8047
Epoch 52/57
----------
train Loss: 0.6978 Acc: 0.9299
val Loss: 4.0335 Acc: 0.7969
Epoch 53/57
----------
train Loss: 0.4443 Acc: 0.9516
val Loss: 4.0849 Acc: 0.7812
Epoch 54/57
----------
train Loss: 0.2461 Acc: 0.9716
val Loss: 3.3708 Acc: 0.7734
Epoch 55/57
----------
train Loss: 0.1133 Acc: 0.9866
val Loss: 4.9602 Acc: 0.7969
Epoch 56/57
----------
train Loss: 0.0487 Acc: 0.9950
val Loss: 4.3359 Acc: 0.7656
Epoch 57/57
----------
train Loss: 0.0307 Acc: 0.9967
[I 2024-10-15 22:09:53,499] Trial 195 finished with value: 0.78125 and parameters: {'batch_size': 75, 'lr': 9.745171321230692e-05, 'num_epochs': 57, 'weight_decay': 0.022019295043871897, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 4.6010 Acc: 0.7812
Best val Acc: 0.781250
Model weights saved at ./model_weights/ResNet34_bs_75_lr_9.745171321230692e-05_epoch_57_wd_0.022019295043871897_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/54
----------
train Loss: 3.9458 Acc: 0.5159
val Loss: 3.8899 Acc: 0.6875
Epoch 2/54
----------
train Loss: 1.5201 Acc: 0.8381
val Loss: 3.5176 Acc: 0.7969
Epoch 3/54
----------
train Loss: 0.6555 Acc: 0.9149
val Loss: 2.3023 Acc: 0.8047
Epoch 4/54
----------
train Loss: 0.3829 Acc: 0.9499
val Loss: 3.3167 Acc: 0.8203
Epoch 5/54
----------
train Loss: 0.3533 Acc: 0.9649
val Loss: 3.6307 Acc: 0.8359
Epoch 6/54
----------
train Loss: 0.9592 Acc: 0.9082
val Loss: 3.6069 Acc: 0.7109
Epoch 7/54
----------
train Loss: 0.9825 Acc: 0.9048
val Loss: 7.6678 Acc: 0.7578
Epoch 8/54
----------
train Loss: 0.8608 Acc: 0.9115
val Loss: 3.2162 Acc: 0.7266
Epoch 9/54
----------
train Loss: 0.7918 Acc: 0.9132
val Loss: 3.7233 Acc: 0.7891
Epoch 10/54
----------
train Loss: 0.5635 Acc: 0.9466
val Loss: 3.1726 Acc: 0.7188
Epoch 11/54
----------
train Loss: 0.6906 Acc: 0.9332
val Loss: 5.2751 Acc: 0.7188
Epoch 12/54
----------
train Loss: 0.9274 Acc: 0.9115
val Loss: 4.8494 Acc: 0.7578
Epoch 13/54
----------
train Loss: 0.5451 Acc: 0.9082
val Loss: 4.1083 Acc: 0.7266
Epoch 14/54
----------
train Loss: 0.2360 Acc: 0.9850
val Loss: 4.5142 Acc: 0.7891
Epoch 15/54
----------
train Loss: 0.3564 Acc: 0.9633
val Loss: 3.1476 Acc: 0.7422
Epoch 16/54
----------
train Loss: 0.5090 Acc: 0.9449
val Loss: 3.1551 Acc: 0.8047
Epoch 17/54
----------
train Loss: 0.5067 Acc: 0.9382
val Loss: 3.2842 Acc: 0.8438
Epoch 18/54
----------
train Loss: 0.4879 Acc: 0.9449
val Loss: 3.6305 Acc: 0.8047
Epoch 19/54
----------
train Loss: 0.3009 Acc: 0.9616
val Loss: 3.1844 Acc: 0.8281
Epoch 20/54
----------
train Loss: 0.2062 Acc: 0.9800
val Loss: 3.5561 Acc: 0.8203
Epoch 21/54
----------
train Loss: 0.2816 Acc: 0.9733
val Loss: 5.4308 Acc: 0.8281
Epoch 22/54
----------
train Loss: 0.2862 Acc: 0.9683
val Loss: 5.3428 Acc: 0.7969
Epoch 23/54
----------
train Loss: 0.2553 Acc: 0.9766
val Loss: 5.5315 Acc: 0.8125
Epoch 24/54
----------
train Loss: 0.3226 Acc: 0.9733
val Loss: 3.0798 Acc: 0.7969
Epoch 25/54
----------
train Loss: 0.1607 Acc: 0.9833
val Loss: 4.6004 Acc: 0.8125
Epoch 26/54
----------
train Loss: 0.0747 Acc: 0.9967
val Loss: 3.2784 Acc: 0.8203
Epoch 27/54
----------
train Loss: 0.2005 Acc: 0.9800
val Loss: 4.5580 Acc: 0.7969
Epoch 28/54
----------
train Loss: 0.1938 Acc: 0.9866
val Loss: 3.5548 Acc: 0.7188
Epoch 29/54
----------
train Loss: 0.1986 Acc: 0.9699
val Loss: 3.4062 Acc: 0.7734
Epoch 30/54
----------
train Loss: 0.2878 Acc: 0.9699
val Loss: 3.4999 Acc: 0.7578
Epoch 31/54
----------
train Loss: 0.7402 Acc: 0.9332
val Loss: 10.5994 Acc: 0.5703
Epoch 32/54
----------
train Loss: 0.8626 Acc: 0.9115
val Loss: 3.9103 Acc: 0.6641
Epoch 33/54
----------
train Loss: 1.2505 Acc: 0.8765
val Loss: 5.6856 Acc: 0.6406
Epoch 34/54
----------
train Loss: 0.8904 Acc: 0.9065
val Loss: 4.8984 Acc: 0.7109
Epoch 35/54
----------
train Loss: 1.5442 Acc: 0.8598
val Loss: 9.4008 Acc: 0.5625
Epoch 36/54
----------
train Loss: 1.0581 Acc: 0.8815
val Loss: 3.3488 Acc: 0.7891
Epoch 37/54
----------
train Loss: 0.7737 Acc: 0.9366
val Loss: 3.2114 Acc: 0.7656
Epoch 38/54
----------
train Loss: 0.4056 Acc: 0.9482
val Loss: 3.3477 Acc: 0.8281
Epoch 39/54
----------
train Loss: 0.1484 Acc: 0.9850
val Loss: 3.8270 Acc: 0.8359
Epoch 40/54
----------
train Loss: 0.1626 Acc: 0.9850
val Loss: 4.3837 Acc: 0.8359
Epoch 41/54
----------
train Loss: 0.1802 Acc: 0.9783
val Loss: 3.9680 Acc: 0.8438
Epoch 42/54
----------
train Loss: 0.1125 Acc: 0.9883
val Loss: 4.1348 Acc: 0.8281
Epoch 43/54
----------
train Loss: 0.0968 Acc: 0.9866
val Loss: 2.6373 Acc: 0.8203
Epoch 44/54
----------
train Loss: 0.1130 Acc: 0.9883
val Loss: 6.3736 Acc: 0.8125
Epoch 45/54
----------
train Loss: 0.2954 Acc: 0.9599
val Loss: 4.4164 Acc: 0.8125
Epoch 46/54
----------
train Loss: 0.1888 Acc: 0.9750
val Loss: 3.8157 Acc: 0.7578
Epoch 47/54
----------
train Loss: 0.0856 Acc: 0.9933
val Loss: 4.1998 Acc: 0.7969
Epoch 48/54
----------
train Loss: 0.2208 Acc: 0.9883
val Loss: 5.6037 Acc: 0.6172
Epoch 49/54
----------
train Loss: 0.2181 Acc: 0.9766
val Loss: 4.8938 Acc: 0.7812
Epoch 50/54
----------
train Loss: 0.3004 Acc: 0.9750
val Loss: 6.0451 Acc: 0.7969
Epoch 51/54
----------
train Loss: 0.1124 Acc: 0.9883
val Loss: 4.7657 Acc: 0.8047
Epoch 52/54
----------
train Loss: 0.1010 Acc: 0.9883
val Loss: 3.5995 Acc: 0.7656
Epoch 53/54
----------
train Loss: 0.1418 Acc: 0.9866
val Loss: 4.2872 Acc: 0.8203
Epoch 54/54
----------
train Loss: 0.2004 Acc: 0.9833
[I 2024-10-15 22:13:55,279] Trial 196 finished with value: 0.796875 and parameters: {'batch_size': 87, 'lr': 0.00023540925891584114, 'num_epochs': 54, 'weight_decay': 0.035313338084844624, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 6.4130 Acc: 0.7969
Best val Acc: 0.796875
Model weights saved at ./model_weights/ResNet34_bs_87_lr_0.00023540925891584114_epoch_54_wd_0.035313338084844624_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/50
----------
train Loss: 3.8346 Acc: 0.5676
val Loss: 3.1030 Acc: 0.6797
Epoch 2/50
----------
train Loss: 1.1236 Acc: 0.8497
val Loss: 3.2271 Acc: 0.7891
Epoch 3/50
----------
train Loss: 0.5398 Acc: 0.9432
val Loss: 3.7921 Acc: 0.7578
Epoch 4/50
----------
train Loss: 0.3407 Acc: 0.9633
val Loss: 5.3384 Acc: 0.7812
Epoch 5/50
----------
train Loss: 0.1943 Acc: 0.9733
val Loss: 4.2944 Acc: 0.7812
Epoch 6/50
----------
train Loss: 0.4182 Acc: 0.9583
val Loss: 4.4167 Acc: 0.6562
Epoch 7/50
----------
train Loss: 1.0226 Acc: 0.8881
val Loss: 11.3204 Acc: 0.4062
Epoch 8/50
----------
train Loss: 1.9047 Acc: 0.8314
val Loss: 4.1078 Acc: 0.6016
Epoch 9/50
----------
train Loss: 1.4306 Acc: 0.8531
val Loss: 4.2335 Acc: 0.7734
Epoch 10/50
----------
train Loss: 0.8033 Acc: 0.9332
val Loss: 3.2048 Acc: 0.8516
Epoch 11/50
----------
train Loss: 0.6300 Acc: 0.9449
val Loss: 3.1601 Acc: 0.7734
Epoch 12/50
----------
train Loss: 0.3966 Acc: 0.9533
val Loss: 2.9490 Acc: 0.8125
Epoch 13/50
----------
train Loss: 0.3388 Acc: 0.9549
val Loss: 2.7133 Acc: 0.7188
Epoch 14/50
----------
train Loss: 0.5694 Acc: 0.9432
val Loss: 4.8088 Acc: 0.8047
Epoch 15/50
----------
train Loss: 0.7373 Acc: 0.9199
val Loss: 3.2402 Acc: 0.8047
Epoch 16/50
----------
train Loss: 0.7560 Acc: 0.9265
val Loss: 6.3312 Acc: 0.6484
Epoch 17/50
----------
train Loss: 0.9309 Acc: 0.9165
val Loss: 3.4491 Acc: 0.7656
Epoch 18/50
----------
train Loss: 1.6157 Acc: 0.8464
val Loss: 3.3679 Acc: 0.6562
Epoch 19/50
----------
train Loss: 1.9115 Acc: 0.8698
val Loss: 3.3556 Acc: 0.7422
Epoch 20/50
----------
train Loss: 0.8066 Acc: 0.9165
val Loss: 4.0314 Acc: 0.7500
Epoch 21/50
----------
train Loss: 0.7954 Acc: 0.9149
val Loss: 3.7559 Acc: 0.7969
Epoch 22/50
----------
train Loss: 1.2580 Acc: 0.8598
val Loss: 4.0634 Acc: 0.7578
Epoch 23/50
----------
train Loss: 0.8657 Acc: 0.9232
val Loss: 4.4183 Acc: 0.8125
Epoch 24/50
----------
train Loss: 0.8270 Acc: 0.9332
val Loss: 3.9946 Acc: 0.8047
Epoch 25/50
----------
train Loss: 0.2425 Acc: 0.9699
val Loss: 4.3261 Acc: 0.8203
Epoch 26/50
----------
train Loss: 0.2163 Acc: 0.9750
val Loss: 4.3976 Acc: 0.8281
Epoch 27/50
----------
train Loss: 0.2240 Acc: 0.9800
val Loss: 4.6415 Acc: 0.7891
Epoch 28/50
----------
train Loss: 0.2303 Acc: 0.9766
val Loss: 4.1228 Acc: 0.7891
Epoch 29/50
----------
train Loss: 0.1197 Acc: 0.9866
val Loss: 4.2535 Acc: 0.7969
Epoch 30/50
----------
train Loss: 0.3823 Acc: 0.9466
val Loss: 4.6285 Acc: 0.8203
Epoch 31/50
----------
train Loss: 0.4306 Acc: 0.9649
val Loss: 4.4701 Acc: 0.7656
Epoch 32/50
----------
train Loss: 0.3084 Acc: 0.9683
val Loss: 5.1257 Acc: 0.7578
Epoch 33/50
----------
train Loss: 0.5422 Acc: 0.9583
val Loss: 8.3819 Acc: 0.7109
Epoch 34/50
----------
train Loss: 1.1451 Acc: 0.8965
val Loss: 6.4401 Acc: 0.5156
Epoch 35/50
----------
train Loss: 2.4391 Acc: 0.7679
[I 2024-10-15 22:16:32,247] Trial 197 finished with value: 0.8203125 and parameters: {'batch_size': 94, 'lr': 0.00017769885718746216, 'num_epochs': 50, 'weight_decay': 0.11623324521922533, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 87.1149 Acc: 0.2891
Early stopping at epoch 35 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.820312
Model weights saved at ./model_weights/ResNet34_bs_94_lr_0.00017769885718746216_epoch_50_wd_0.11623324521922533_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/46
----------
train Loss: 3.9253 Acc: 0.4624
val Loss: 2.4943 Acc: 0.7500
Epoch 2/46
----------
train Loss: 1.1485 Acc: 0.8748
val Loss: 2.1863 Acc: 0.8047
Epoch 3/46
----------
train Loss: 0.4599 Acc: 0.9432
val Loss: 3.4378 Acc: 0.8438
Epoch 4/46
----------
train Loss: 0.1622 Acc: 0.9850
val Loss: 3.1854 Acc: 0.8359
Epoch 5/46
----------
train Loss: 0.1017 Acc: 0.9917
val Loss: 3.6939 Acc: 0.8516
Epoch 6/46
----------
train Loss: 0.1448 Acc: 0.9883
val Loss: 3.7150 Acc: 0.8594
Epoch 7/46
----------
train Loss: 0.2194 Acc: 0.9683
val Loss: 3.1662 Acc: 0.7578
Epoch 8/46
----------
train Loss: 0.7125 Acc: 0.9232
val Loss: 4.9921 Acc: 0.8047
Epoch 9/46
----------
train Loss: 1.2047 Acc: 0.8781
val Loss: 10.4944 Acc: 0.3906
Epoch 10/46
----------
train Loss: 1.5521 Acc: 0.8815
val Loss: 3.5131 Acc: 0.7422
Epoch 11/46
----------
train Loss: 0.8649 Acc: 0.8982
[I 2024-10-15 22:17:22,621] Trial 198 finished with value: 0.859375 and parameters: {'batch_size': 103, 'lr': 0.0001242443122568145, 'num_epochs': 46, 'weight_decay': 0.07344031685531537, 'weight_loss_flag': True, 'mixup_flag': False}. Best is trial 150 with value: 0.9140625.
val Loss: 4.1540 Acc: 0.7891
Early stopping at epoch 11 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.859375
Model weights saved at ./model_weights/ResNet34_bs_103_lr_0.0001242443122568145_epoch_46_wd_0.07344031685531537_wlf_True.pth
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Classes with more than 50 images: ['Chornic', 'Aom', 'Normal', 'Earwax']
Old to New Class Index Mapping: {0: 0, 1: 1, 3: 2, 5: 3}
Number of samples after filtering and remapping: 856
New class-to-index mapping: {'Aom': 0, 'Chornic': 1, 'Earwax': 2, 'Normal': 3}
Number of training images: 599
Number of validation images: 128
Number of test images: 129
Epoch 1/31
----------
train Loss: 0.4392 Acc: 0.6711
val Loss: 0.2630 Acc: 0.8047
Epoch 2/31
----------
train Loss: 0.3396 Acc: 0.7629
val Loss: 0.2400 Acc: 0.7969
Epoch 3/31
----------
train Loss: 0.3151 Acc: 0.7563
val Loss: 0.2474 Acc: 0.8359
Epoch 4/31
----------
train Loss: 0.2912 Acc: 0.8297
val Loss: 0.2159 Acc: 0.8672
Epoch 5/31
----------
train Loss: 0.3040 Acc: 0.8164
val Loss: 0.2518 Acc: 0.8047
Epoch 6/31
----------
train Loss: 0.2839 Acc: 0.8047
val Loss: 0.1799 Acc: 0.8672
Epoch 7/31
----------
train Loss: 0.2772 Acc: 0.8030
val Loss: 0.2839 Acc: 0.7812
Epoch 8/31
----------
train Loss: 0.2877 Acc: 0.8130
val Loss: 0.2257 Acc: 0.8359
Epoch 9/31
----------
train Loss: 0.2507 Acc: 0.8698
val Loss: 0.2116 Acc: 0.8750
Epoch 10/31
----------
train Loss: 0.2739 Acc: 0.8497
val Loss: 0.2514 Acc: 0.8281
Epoch 11/31
----------
train Loss: 0.2844 Acc: 0.8397
val Loss: 0.2199 Acc: 0.8672
Epoch 12/31
----------
train Loss: 0.2835 Acc: 0.8314
val Loss: 0.2107 Acc: 0.8438
Epoch 13/31
----------
train Loss: 0.2713 Acc: 0.8447
val Loss: 0.1953 Acc: 0.8438
Epoch 14/31
----------
train Loss: 0.2918 Acc: 0.8230
val Loss: 0.2824 Acc: 0.7969
Epoch 15/31
----------
train Loss: 0.2727 Acc: 0.8130
val Loss: 0.2090 Acc: 0.8594
Epoch 16/31
----------
train Loss: 0.2688 Acc: 0.8748
val Loss: 0.1672 Acc: 0.8906
Epoch 17/31
----------
train Loss: 0.2786 Acc: 0.8197
val Loss: 0.2736 Acc: 0.7812
Epoch 18/31
----------
train Loss: 0.2940 Acc: 0.8130
val Loss: 0.2065 Acc: 0.9141
Epoch 19/31
----------
train Loss: 0.2754 Acc: 0.8264
val Loss: 0.1955 Acc: 0.8359
Epoch 20/31
----------
train Loss: 0.2703 Acc: 0.8481
val Loss: 0.2325 Acc: 0.8047
Epoch 21/31
----------
train Loss: 0.2956 Acc: 0.8080
val Loss: 0.2200 Acc: 0.8516
Epoch 22/31
----------
train Loss: 0.2687 Acc: 0.8414
val Loss: 0.2059 Acc: 0.8594
Epoch 23/31
----------
train Loss: 0.2970 Acc: 0.8264
[I 2024-10-15 22:19:05,226] Trial 199 finished with value: 0.9140625 and parameters: {'batch_size': 125, 'lr': 0.0001586758147325034, 'num_epochs': 31, 'weight_decay': 0.019709331509375618, 'weight_loss_flag': False, 'mixup_flag': True}. Best is trial 150 with value: 0.9140625.
val Loss: 0.3755 Acc: 0.7891
Early stopping at epoch 23 due to no improvement in validation accuracy for 5 consecutive epochs.
Best val Acc: 0.914062
Model weights saved at ./model_weights/ResNet34_bs_125_lr_0.0001586758147325034_epoch_31_wd_0.019709331509375618_wlf_False.pth
Best parameters: {'batch_size': 122, 'lr': 0.00020471349670332024, 'num_epochs': 56, 'weight_decay': 0.032993571440402165, 'weight_loss_flag': True, 'mixup_flag': False}
Best score: 0.9140625
